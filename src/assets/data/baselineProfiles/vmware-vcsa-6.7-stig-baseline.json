{
  "name": "vmware-vcsa-6.7-stig-baseline-wrapper",
  "title": "InSpec Wrapper Profile for VMware vCenter Service Appliance 6.7 DISA STIG",
  "maintainer": "The Authors",
  "copyright": "The Authors",
  "copyright_email": "stigs@vmware.com",
  "license": "Apache-2.0",
  "summary": "An InSpec Compliance Profile",
  "version": "6.7.0",
  "depends": [
    {
      "name": "eam",
      "path": "../eam",
      "status": "loaded"
    },
    {
      "name": "perfcharts",
      "path": "../perfcharts",
      "status": "loaded"
    },
    {
      "name": "photon",
      "path": "../photon",
      "status": "loaded"
    },
    {
      "name": "postgres",
      "path": "../postgres",
      "status": "loaded"
    },
    {
      "name": "rhttpproxy",
      "path": "../rhttpproxy",
      "status": "loaded"
    },
    {
      "name": "sts",
      "path": "../sts",
      "status": "loaded"
    },
    {
      "name": "vami",
      "path": "../vami",
      "status": "loaded"
    },
    {
      "name": "vsphere-client",
      "path": "../vsphere-client",
      "status": "loaded"
    },
    {
      "name": "vsphere-ui",
      "path": "../vsphere-ui",
      "status": "loaded"
    }
  ],
  "supports": [],
  "controls": [
    {
      "title": "ESX Agent Manager must not show directory listings.",
      "desc": "Enumeration techniques, such as URL parameter manipulation, rely upon\nbeing able to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. Ensuring that directory listing is disabled is one approach to\nmitigating the vulnerability.",
      "descriptions": {
        "default": "Enumeration techniques, such as URL parameter manipulation, rely upon\nbeing able to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. Ensuring that directory listing is disabled is one approach to\nmitigating the vulnerability.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml | sed 's/xmlns=\".*\"//g' | xmllint --xpath '//param-name[text()=\"listings\"]/parent::init-param' -\n\nExpected result:\n\nXPath set is empty\n\nIf the output of the command does not match the expected result, this is a finding.",
        "fix": "Navigate to and open /usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml\n\nFind and remove the entire block returned in the check.\n\nExample:\n\n<init-param>\n      <param-name>listings</param-name>\n      <param-value>true</param-value>\n</init-param>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000266-WSR-000142",
        "gid": null,
        "rid": "VCEM-67-000023",
        "stig_id": "VCEM-67-000023",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCEM-67-000023\" do\n  title \"ESX Agent Manager must not show directory listings.\"\n  desc  \"Enumeration techniques, such as URL parameter manipulation, rely upon\nbeing able to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. Ensuring that directory listing is disabled is one approach to\nmitigating the vulnerability.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000266-WSR-000142\"\n  tag gid: nil\n  tag rid: \"VCEM-67-000023\"\n  tag stig_id: \"VCEM-67-000023\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml | sed 's/xmlns=\\\".*\\\"//g' | xmllint --xpath '//param-name[text()=\\\"listings\\\"]/parent::init-param' -\n\nExpected result:\n\nXPath set is empty\n\nIf the output of the command does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml\n\nFind and remove the entire block returned in the check.\n\nExample:\n\n<init-param>\n      <param-name>listings</param-name>\n      <param-value>true</param-value>\n</init-param>\"\n\n  describe xml('/usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml') do\n    its('/web-app/servlet/init-param[param-name=\"listings\"]/param-value') { should eq [] }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000023.rb",
        "line": 1
      },
      "id": "VCEM-67-000023"
    },
    {
      "title": "ESX Agent Manager must have the debug option turned off.",
      "desc": "Information needed by an attacker to begin looking for possible\nvulnerabilities in a web server includes any information about the web server\nand plug-ins or modules being used. When debugging or trace information is\nenabled in a production web server, information about the web server, such as\nweb server type, version, patches installed, plug-ins and modules installed,\ntype of code being used by the hosted application, and any backends being used\nfor data storage may be displayed. Since this information may be placed in logs\nand general messages during normal operation of the web server, an attacker\ndoes not need to cause an error condition to gain this information.\n\n    ESX Agent Manager can be configured to set the debugging level. By setting\nthe debugging level to zero (0), no debugging information will be provided to a\nmalicious user.",
      "descriptions": {
        "default": "Information needed by an attacker to begin looking for possible\nvulnerabilities in a web server includes any information about the web server\nand plug-ins or modules being used. When debugging or trace information is\nenabled in a production web server, information about the web server, such as\nweb server type, version, patches installed, plug-ins and modules installed,\ntype of code being used by the hosted application, and any backends being used\nfor data storage may be displayed. Since this information may be placed in logs\nand general messages during normal operation of the web server, an attacker\ndoes not need to cause an error condition to gain this information.\n\n    ESX Agent Manager can be configured to set the debugging level. By setting\nthe debugging level to zero (0), no debugging information will be provided to a\nmalicious user.",
        "check": "At the command prompt, execute the following command:\n\n#  xmllint --format /usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml | sed\n's/xmlns=\".*\"//g' | xmllint --xpath\n'//param-name[text()=\"debug\"]/parent::init-param' -\n\nExpected result:\n\n<param-value>0</param-value>\n\nIf the output does not match the expected result, this is a finding. If no\nlines is returned this is NOT a finding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml\n\n\nNavigate to all <debug> nodes that are not set to \"0\".\n\nSet the <param-value> to \"0\" in all <param-name>debug</param-name> nodes.\n\nNote: The debug setting should look like the below:\n\n<init-param>\n      <param-name>debug</param-name>\n      <param-value>0</param-value>\n    </init-param>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000266-WSR-000160",
        "gid": null,
        "rid": "VCEM-67-000026",
        "stig_id": "VCEM-67-000026",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCEM-67-000026\" do\n  title \"ESX Agent Manager must have the debug option turned off.\"\n  desc  \"Information needed by an attacker to begin looking for possible\nvulnerabilities in a web server includes any information about the web server\nand plug-ins or modules being used. When debugging or trace information is\nenabled in a production web server, information about the web server, such as\nweb server type, version, patches installed, plug-ins and modules installed,\ntype of code being used by the hosted application, and any backends being used\nfor data storage may be displayed. Since this information may be placed in logs\nand general messages during normal operation of the web server, an attacker\ndoes not need to cause an error condition to gain this information.\n\n    ESX Agent Manager can be configured to set the debugging level. By setting\nthe debugging level to zero (0), no debugging information will be provided to a\nmalicious user.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000266-WSR-000160\"\n  tag gid: nil\n  tag rid: \"VCEM-67-000026\"\n  tag stig_id: \"VCEM-67-000026\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n#  xmllint --format /usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml | sed\n's/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'//param-name[text()=\\\"debug\\\"]/parent::init-param' -\n\nExpected result:\n\n<param-value>0</param-value>\n\nIf the output does not match the expected result, this is a finding. If no\nlines is returned this is NOT a finding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml\n\n\nNavigate to all <debug> nodes that are not set to \\\"0\\\".\n\nSet the <param-value> to \\\"0\\\" in all <param-name>debug</param-name> nodes.\n\nNote: The debug setting should look like the below:\n\n<init-param>\n      <param-name>debug</param-name>\n      <param-value>0</param-value>\n    </init-param>\"\n\n  describe.one do\n\n    describe xml('/usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml') do\n      its('/web-app/servlet/init-param[param-name=\"debug\"]/param-value') { should eq [] }\n    end\n\n    describe xml('/usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml') do\n      its('/web-app/servlet/init-param[param-name=\"debug\"]/param-value') { should cmp \"0\" }\n    end\n\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000026.rb",
        "line": 1
      },
      "id": "VCEM-67-000026"
    },
    {
      "title": "ESX Agent Manager must not have any symbolic links in the web content\ndirectory tree.",
      "desc": "A web server is designed to deliver content and execute scripts or\napplications on the request of a client or user. Containing user requests to\nfiles in the directory tree of the hosted web application and limiting the\nexecution of scripts and applications guarantees that the user is not accessing\ninformation protected outside the application's realm. By checking that no\nsymbolic links exist in the document root, the web server is protected from\nusers jumping outside the hosted application directory tree and gaining access\nto the other directories, including the system root.",
      "descriptions": {
        "default": "A web server is designed to deliver content and execute scripts or\napplications on the request of a client or user. Containing user requests to\nfiles in the directory tree of the hosted web application and limiting the\nexecution of scripts and applications guarantees that the user is not accessing\ninformation protected outside the application's realm. By checking that no\nsymbolic links exist in the document root, the web server is protected from\nusers jumping outside the hosted application directory tree and gaining access\nto the other directories, including the system root.",
        "check": "At the command prompt, execute the following command:\n\n# find /usr/lib/vmware-eam/web/webapps/ -type l -ls\n\nIf the command produces any output, this is a finding.",
        "fix": "At the command prompt, execute the following commands:\n\nNote: Replace <file_name> for the name of any files that were returned.\n\nunlink <file_name>\n\nRepeat the commands for each file that was returned."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000141-WSR-000087",
        "gid": null,
        "rid": "VCEM-67-000016",
        "stig_id": "VCEM-67-000016",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCEM-67-000016\" do\n  title \"ESX Agent Manager must not have any symbolic links in the web content\ndirectory tree.\"\n  desc  \"A web server is designed to deliver content and execute scripts or\napplications on the request of a client or user. Containing user requests to\nfiles in the directory tree of the hosted web application and limiting the\nexecution of scripts and applications guarantees that the user is not accessing\ninformation protected outside the application's realm. By checking that no\nsymbolic links exist in the document root, the web server is protected from\nusers jumping outside the hosted application directory tree and gaining access\nto the other directories, including the system root.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000141-WSR-000087\"\n  tag gid: nil\n  tag rid: \"VCEM-67-000016\"\n  tag stig_id: \"VCEM-67-000016\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# find /usr/lib/vmware-eam/web/webapps/ -type l -ls\n\nIf the command produces any output, this is a finding.\"\n  desc 'fix', \"At the command prompt, execute the following commands:\n\nNote: Replace <file_name> for the name of any files that were returned.\n\nunlink <file_name>\n\nRepeat the commands for each file that was returned.\"\n\n  describe command('find /usr/lib/vmware-eam/web/webapps/ -type l -ls') do\n    its ('stdout.strip') { should eq '' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000016.rb",
        "line": 1
      },
      "id": "VCEM-67-000016"
    },
    {
      "title": "ESX Agent Manager must limit the number of allowed connections.",
      "desc": "Limiting the number of established connections to the ESX Agent\nManager is a basic DoS protection. Servers where the limit is too high or\nunlimited can potentially run out of system resources and negatively affect\nsystem availability.",
      "descriptions": {
        "default": "Limiting the number of established connections to the ESX Agent\nManager is a basic DoS protection. Servers where the limit is too high or\nunlimited can potentially run out of system resources and negatively affect\nsystem availability.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --xpath '/Server/Service/Connector/@acceptCount'\n/usr/lib/vmware-eam/web/conf/server.xml\n\nExpected result:\n\nacceptCount=\"300\"\n\nIf the output does not match the expected result, this is a finding",
        "fix": "Navigate to and open /usr/lib/vmware-eam/web/conf/server.xml\n\nConfigure the <Connector> node with the value:\n\nacceptCount=\"300\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000246-WSR-000149",
        "gid": null,
        "rid": "VCEM-67-000019",
        "stig_id": "VCEM-67-000019",
        "cci": "CCI-001094",
        "nist": [
          "SC-5 (1)",
          "Rev_4"
        ]
      },
      "code": "control \"VCEM-67-000019\" do\n  title \"ESX Agent Manager must limit the number of allowed connections.\"\n  desc  \"Limiting the number of established connections to the ESX Agent\nManager is a basic DoS protection. Servers where the limit is too high or\nunlimited can potentially run out of system resources and negatively affect\nsystem availability.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000246-WSR-000149\"\n  tag gid: nil\n  tag rid: \"VCEM-67-000019\"\n  tag stig_id: \"VCEM-67-000019\"\n  tag cci: \"CCI-001094\"\n  tag nist: [\"SC-5 (1)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --xpath '/Server/Service/Connector/@acceptCount'\n/usr/lib/vmware-eam/web/conf/server.xml\n\nExpected result:\n\nacceptCount=\\\"300\\\"\n\nIf the output does not match the expected result, this is a finding\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-eam/web/conf/server.xml\n\nConfigure the <Connector> node with the value:\n\nacceptCount=\\\"300\\\"\"\n\n  describe xml('/usr/lib/vmware-eam/web/conf/server.xml') do\n    its(['Server/Service/Connector/@acceptCount']) { should cmp '300'}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000019.rb",
        "line": 1
      },
      "id": "VCEM-67-000019"
    },
    {
      "title": "ESX Agent Manager must have mappings set for Java servlet pages.",
      "desc": "Resource mapping is the process of tying a particular file type to a\nprocess in the web server that can serve that type of file to a requesting\nclient and to identify which file types are not to be delivered to a client.\n\n    By not specifying which files can and which files cannot be served to a\nuser, the web server could deliver to a user web server configuration files,\nlog files, password files, etc.\n\n    As Tomcat is a java-based web server, the main file extension used is\n*.jsp.  This check ensures that the *.jsp file type has been properly mapped to\nservlets.",
      "descriptions": {
        "default": "Resource mapping is the process of tying a particular file type to a\nprocess in the web server that can serve that type of file to a requesting\nclient and to identify which file types are not to be delivered to a client.\n\n    By not specifying which files can and which files cannot be served to a\nuser, the web server could deliver to a user web server configuration files,\nlog files, password files, etc.\n\n    As Tomcat is a java-based web server, the main file extension used is\n*.jsp.  This check ensures that the *.jsp file type has been properly mapped to\nservlets.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml | sed\n's/xmlns=\".*\"//g' | xmllint --xpath\n'/web-app/servlet-mapping/servlet-name[text()=\"JspServlet\"]/parent::servlet-mapping'\n-\n\nExpected result:\n\n<servlet-mapping>\n    <servlet-name>JspServlet</servlet-name>\n    <url-pattern>*.jsp</url-pattern>\n  </servlet-mapping>\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml\n\nNavigate to and locate the mapping for the JSP servlet. It is the\n<servlet-mapping> node that contains\n<servlet-name>JspServlet</servlet-name>\n\nConfigure the <servlet-mapping> node to look like the code snippet below\n\n<servlet-mapping>\n    <servlet-name>JspServlet</servlet-name>\n    <url-pattern>*.jsp</url-pattern>\n  </servlet-mapping>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000141-WSR-000083",
        "gid": null,
        "rid": "VCEM-67-000013",
        "stig_id": "VCEM-67-000013",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCEM-67-000013\" do\n  title \"ESX Agent Manager must have mappings set for Java servlet pages.\"\n  desc  \"Resource mapping is the process of tying a particular file type to a\nprocess in the web server that can serve that type of file to a requesting\nclient and to identify which file types are not to be delivered to a client.\n\n    By not specifying which files can and which files cannot be served to a\nuser, the web server could deliver to a user web server configuration files,\nlog files, password files, etc.\n\n    As Tomcat is a java-based web server, the main file extension used is\n*.jsp.  This check ensures that the *.jsp file type has been properly mapped to\nservlets.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000141-WSR-000083\"\n  tag gid: nil\n  tag rid: \"VCEM-67-000013\"\n  tag stig_id: \"VCEM-67-000013\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml | sed\n's/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'/web-app/servlet-mapping/servlet-name[text()=\\\"JspServlet\\\"]/parent::servlet-mapping'\n-\n\nExpected result:\n\n<servlet-mapping>\n    <servlet-name>JspServlet</servlet-name>\n    <url-pattern>*.jsp</url-pattern>\n  </servlet-mapping>\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml\n\nNavigate to and locate the mapping for the JSP servlet. It is the\n<servlet-mapping> node that contains\n<servlet-name>JspServlet</servlet-name>\n\nConfigure the <servlet-mapping> node to look like the code snippet below\n\n<servlet-mapping>\n    <servlet-name>JspServlet</servlet-name>\n    <url-pattern>*.jsp</url-pattern>\n  </servlet-mapping>\"\n\n  list = [\"*.jsp\", \"*.jspx\"]\n  describe xml('/usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml') do\n    its('/web-app/servlet-mapping[servlet-name=\"JspServlet\"]/url-pattern') { should be_in list }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000013.rb",
        "line": 1
      },
      "id": "VCEM-67-000013"
    },
    {
      "title": "ESX Agent Manager must record user access in a format that enables\nmonitoring of remote access.",
      "desc": "Remote access can be exploited by an attacker to compromise the\nserver.  By recording all remote access activities, it will be possible to\ndetermine the attacker's location, intent, and degree of success.\n\n    Tomcat can be configured with an AccessLogValve, a component that can be\ninserted into the request processing pipeline to provide robust access logging.\nThe Access Log Valve creates log files in the same format as those created by\nstandard web servers. When AccessLogValve is properly configured, log files\nwill contain all the forensic information necessary in the case of a security\nincident.",
      "descriptions": {
        "default": "Remote access can be exploited by an attacker to compromise the\nserver.  By recording all remote access activities, it will be possible to\ndetermine the attacker's location, intent, and degree of success.\n\n    Tomcat can be configured with an AccessLogValve, a component that can be\ninserted into the request processing pipeline to provide robust access logging.\nThe Access Log Valve creates log files in the same format as those created by\nstandard web servers. When AccessLogValve is properly configured, log files\nwill contain all the forensic information necessary in the case of a security\nincident.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --xpath\n'/Server/Service/Engine/Host/Valve[@className=\"org.apache.catalina.valves.AccessLogValve\"]'/@pattern\n/usr/lib/vmware-eam/web/conf/server.xml\n\nExpected result:\n\npattern=\"%h %{X-Forwarded-For}i %l %u %t [%I] &quot;%r&quot; %s %b [Processing time %D msec] &quot;%{User-Agent}i&quot;\"\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open /usr/lib/vmware-eam/web/conf/server.xml\n\nConfigure the <Host> node with the two nodes below.\n\n<Valve className=\"org.apache.catalina.valves.RemoteIpValve\"\nhttpServerPort=\"80\"httpsServerPort=\"443\"\nprotocolHeader=\"x-forwarded-proto\"proxiesHeader=\"x-forwarded-by\"\nremoteIpHeader=\"x-forwarded-for\"\nrequestAttributesEnabled=\"true\"\ninternalProxies=\"127\\.0\\.0\\.1\"/>\n\n<Valve className=\"org.apache.catalina.valves.AccessLogValve\"\ndirectory=\"${eam.catalina.logdir}\"\npattern=\"%h %{X-Forwarded-For}i %l %u %t [%I] &quot;%r&quot; %s %b [Processing time %D msec] &quot;%{User-Agent}i&quot;\"\nresolveHosts=\"false\"\nprefix=\"localhost_access_log\"\nsuffix=\".txt\"/>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000016-WSR-000005",
        "gid": null,
        "rid": "VCEM-67-000005",
        "stig_id": "VCEM-67-000005",
        "cci": "CCI-000067",
        "nist": [
          "AC-17 (1)",
          "Rev_4"
        ]
      },
      "code": "control \"VCEM-67-000005\" do\n  title \"ESX Agent Manager must record user access in a format that enables\nmonitoring of remote access.\"\n  desc  \"Remote access can be exploited by an attacker to compromise the\nserver.  By recording all remote access activities, it will be possible to\ndetermine the attacker's location, intent, and degree of success.\n\n    Tomcat can be configured with an AccessLogValve, a component that can be\ninserted into the request processing pipeline to provide robust access logging.\nThe Access Log Valve creates log files in the same format as those created by\nstandard web servers. When AccessLogValve is properly configured, log files\nwill contain all the forensic information necessary in the case of a security\nincident.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000016-WSR-000005\"\n  tag gid: nil\n  tag rid: \"VCEM-67-000005\"\n  tag stig_id: \"VCEM-67-000005\"\n  tag cci: \"CCI-000067\"\n  tag nist: [\"AC-17 (1)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --xpath\n'/Server/Service/Engine/Host/Valve[@className=\\\"org.apache.catalina.valves.AccessLogValve\\\"]'/@pattern\n/usr/lib/vmware-eam/web/conf/server.xml\n\nExpected result:\n\npattern=\\\"%h %{X-Forwarded-For}i %l %u %t [%I] &quot;%r&quot; %s %b [Processing time %D msec] &quot;%{User-Agent}i&quot;\\\"\n\nIf the output does not match the expected result, this is a finding.\n\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-eam/web/conf/server.xml\n\nConfigure the <Host> node with the two nodes below.\n\n<Valve className=\\\"org.apache.catalina.valves.RemoteIpValve\\\"\nhttpServerPort=\\\"80\\\"httpsServerPort=\\\"443\\\"\nprotocolHeader=\\\"x-forwarded-proto\\\"proxiesHeader=\\\"x-forwarded-by\\\"\nremoteIpHeader=\\\"x-forwarded-for\\\"\nrequestAttributesEnabled=\\\"true\\\"\ninternalProxies=\\\"127\\\\.0\\\\.0\\\\.1\\\"/>\n\n<Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\"\ndirectory=\\\"${eam.catalina.logdir}\\\"\npattern=\\\"%h %{X-Forwarded-For}i %l %u %t [%I] &quot;%r&quot; %s %b [Processing time %D msec] &quot;%{User-Agent}i&quot;\\\"\nresolveHosts=\\\"false\\\"\nprefix=\\\"localhost_access_log\\\"\nsuffix=\\\".txt\\\"/>\"\n\n  describe xml('/usr/lib/vmware-eam/web/conf/server.xml') do\n    its(['Server/Service/Engine/Host/Valve[@className=\"org.apache.catalina.valves.AccessLogValve\"]/@pattern']) { should cmp ['%h %{X-Forwarded-For}i %l %u %t [%I] &quot;%r&quot; %s %b [Processing time %D msec] &quot;%{User-Agent}i&quot;'] }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000005.rb",
        "line": 1
      },
      "id": "VCEM-67-000005"
    },
    {
      "title": "ESX Agent Manager must not be configured with unsupported realms.",
      "desc": "ESX Agent Manager performs authentication at the application level and\nnot through Tomcat. In the name of eliminating unnecessary features and to\nensure that ESX Agent Manager remains in it's shipping state, the lack of a\nUserDatabaseRealm configuration must be confirmed.",
      "descriptions": {
        "default": "ESX Agent Manager performs authentication at the application level and\nnot through Tomcat. In the name of eliminating unnecessary features and to\nensure that ESX Agent Manager remains in it's shipping state, the lack of a\nUserDatabaseRealm configuration must be confirmed.",
        "check": "At the command prompt, execute the following command:\n\n# grep UserDatabaseRealm /usr/lib/vmware-eam/web/conf/server.xml\n\nIf the command produces any output, this is a finding.",
        "fix": "Navigate to and open /usr/lib/vmware-eam/web/conf/server.xml .\nRemove the <Realm> node returned in the check."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000141-WSR-000015",
        "gid": null,
        "rid": "VCEM-67-000010",
        "stig_id": "VCEM-67-000010",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCEM-67-000010\" do\n  title \"ESX Agent Manager must not be configured with unsupported realms.\"\n  desc  \"ESX Agent Manager performs authentication at the application level and\nnot through Tomcat. In the name of eliminating unnecessary features and to\nensure that ESX Agent Manager remains in it's shipping state, the lack of a\nUserDatabaseRealm configuration must be confirmed.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000141-WSR-000015\"\n  tag gid: nil\n  tag rid: \"VCEM-67-000010\"\n  tag stig_id: \"VCEM-67-000010\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep UserDatabaseRealm /usr/lib/vmware-eam/web/conf/server.xml\n\nIf the command produces any output, this is a finding.\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-eam/web/conf/server.xml .\nRemove the <Realm> node returned in the check.\"\n\n  describe command('grep UserDatabaseRealm /usr/lib/vmware-eam/web/conf/server.xml') do\n    its ('stdout.strip') { should eq '' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000010.rb",
        "line": 1
      },
      "id": "VCEM-67-000010"
    },
    {
      "title": "ESX Agent Manager application files must be verified for their\nintegrity.",
      "desc": "Verifying that ESX Agent Manager application code is unchanged from\nit's shipping state is essential for file validation and non-repudiation of the\nESX Agent Manager itself. There is no reason that the MD5 hash of the rpm\noriginal files should be changed after installation, excluding configuration\nfiles.",
      "descriptions": {
        "default": "Verifying that ESX Agent Manager application code is unchanged from\nit's shipping state is essential for file validation and non-repudiation of the\nESX Agent Manager itself. There is no reason that the MD5 hash of the rpm\noriginal files should be changed after installation, excluding configuration\nfiles.",
        "check": "At the command prompt, execute the following command:\n\n# rpm -V vmware-eam|grep \"^..5......\"|grep -E \"\\.war|\\.jar|\\.sh|\\.py\"\n\nIf is any output, this is a finding.",
        "fix": "Re-install the VCSA or roll back to a snapshot. Modifying the EAM\ninstallation files manually is not supported by VMware."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000131-WSR-000051",
        "gid": null,
        "rid": "VCEM-67-000008",
        "stig_id": "VCEM-67-000008",
        "cci": "CCI-001749",
        "nist": [
          "CM-5 (3)",
          "Rev_4"
        ]
      },
      "code": "control \"VCEM-67-000008\" do\n  title \"ESX Agent Manager application files must be verified for their\nintegrity.\"\n  desc  \"Verifying that ESX Agent Manager application code is unchanged from\nit's shipping state is essential for file validation and non-repudiation of the\nESX Agent Manager itself. There is no reason that the MD5 hash of the rpm\noriginal files should be changed after installation, excluding configuration\nfiles.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000131-WSR-000051\"\n  tag gid: nil\n  tag rid: \"VCEM-67-000008\"\n  tag stig_id: \"VCEM-67-000008\"\n  tag cci: \"CCI-001749\"\n  tag nist: [\"CM-5 (3)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# rpm -V vmware-eam|grep \\\"^..5......\\\"|grep -E \\\"\\\\.war|\\\\.jar|\\\\.sh|\\\\.py\\\"\n\nIf is any output, this is a finding.\"\n  desc 'fix', \"Re-install the VCSA or roll back to a snapshot. Modifying the EAM\ninstallation files manually is not supported by VMware.\"\n\n  describe command('rpm -V vmware-eam|grep \"^..5......\"|grep -E \"\\.war|\\.jar|\\.sh|\\.py\"') do\n    its ('stdout.strip') { should eq '' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000008.rb",
        "line": 1
      },
      "id": "VCEM-67-000008"
    },
    {
      "title": "ESX Agent Manager must disable the shutdown port.",
      "desc": "An attacker has at least two reasons to stop a web server. The first\nis to cause a DoS, and the second is to put in place changes the attacker made\nto the web server configuration. If the Tomcat shutdown port feature is\nenabled, a shutdown signal can be sent to the ESX Agent Manager through this\nport. To ensure availability, the shutdown port must be disabled.",
      "descriptions": {
        "default": "An attacker has at least two reasons to stop a web server. The first\nis to cause a DoS, and the second is to put in place changes the attacker made\nto the web server configuration. If the Tomcat shutdown port feature is\nenabled, a shutdown signal can be sent to the ESX Agent Manager through this\nport. To ensure availability, the shutdown port must be disabled.",
        "check": "At the command prompt, execute the following command:\n\n# grep 'base.shutdown.port' /etc/vmware-eam/catalina.properties\n\nExpected result:\n\nbase.shutdown.port=-1\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Open /etc/vmware-eam/catalina.properties in a text editor.\n\nAdd or modify the setting 'base.shutdown.port=-1' in the catalina.properties\nfile."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000435-WSR-000147",
        "gid": null,
        "rid": "VCEM-67-000030",
        "stig_id": "VCEM-67-000030",
        "cci": "CCI-002385",
        "nist": [
          "SC-5",
          "Rev_4"
        ]
      },
      "code": "control \"VCEM-67-000030\" do\n  title \"ESX Agent Manager must disable the shutdown port.\"\n  desc  \"An attacker has at least two reasons to stop a web server. The first\nis to cause a DoS, and the second is to put in place changes the attacker made\nto the web server configuration. If the Tomcat shutdown port feature is\nenabled, a shutdown signal can be sent to the ESX Agent Manager through this\nport. To ensure availability, the shutdown port must be disabled.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000435-WSR-000147\"\n  tag gid: nil\n  tag rid: \"VCEM-67-000030\"\n  tag stig_id: \"VCEM-67-000030\"\n  tag cci: \"CCI-002385\"\n  tag nist: [\"SC-5\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep 'base.shutdown.port' /etc/vmware-eam/catalina.properties\n\nExpected result:\n\nbase.shutdown.port=-1\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Open /etc/vmware-eam/catalina.properties in a text editor.\n\nAdd or modify the setting 'base.shutdown.port=-1' in the catalina.properties\nfile.\"\n\n  describe parse_config_file('/etc/vmware-eam/catalina.properties').params['base.shutdown.port'] do\n    it { should eq '-1' }\n  end\n\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000030.rb",
        "line": 1
      },
      "id": "VCEM-67-000030"
    },
    {
      "title": "ESX Agent Manager must limit the number of concurrent connections\npermitted.",
      "desc": "Resource exhaustion can occur when an unlimited number of concurrent\nrequests are allowed on a web site, facilitating a denial of service attack.\nUnless the number of requests is controlled, the web server can consume enough\nsystem resources to cause a system crash.\n\n    Mitigating this kind of attack will include limiting the number of\nconcurrent HTTP/HTTPS requests. In Tomcat, each incoming request requires a\nthread for the duration of that request. If more simultaneous requests are\nreceived than can be handled by the currently available request processing\nthreads, additional threads will be created up to the value of the maxThreads\nattribute.",
      "descriptions": {
        "default": "Resource exhaustion can occur when an unlimited number of concurrent\nrequests are allowed on a web site, facilitating a denial of service attack.\nUnless the number of requests is controlled, the web server can consume enough\nsystem resources to cause a system crash.\n\n    Mitigating this kind of attack will include limiting the number of\nconcurrent HTTP/HTTPS requests. In Tomcat, each incoming request requires a\nthread for the duration of that request. If more simultaneous requests are\nreceived than can be handled by the currently available request processing\nthreads, additional threads will be created up to the value of the maxThreads\nattribute.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --xpath\n'/Server/Service/Executor[@name=\"tomcatThreadPool\"]/@maxThreads'\n/usr/lib/vmware-eam/web/conf/server.xml\n\nExpected result:\n\nmaxThreads=\"300\"\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open /usr/lib/vmware-eam/web/conf/server.xml\n\nNavigate to the <Executor> mode with the name of tomcatThreadPool and configure\nwith the value 'maxThreads=\"300\"'\n\nNote: The <Executor> node should be configured per the below:\n\n<Executor maxThreads=\"300\"\n                minSpareThreads=\"50\"\n                name=\"tomcatThreadPool\"\n                namePrefix=\"tomcat-http--\"/>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000001-WSR-000001",
        "gid": null,
        "rid": "VCEM-67-000002",
        "stig_id": "VCEM-67-000002",
        "cci": "CCI-000054",
        "nist": [
          "AC-10",
          "Rev_4"
        ]
      },
      "code": "control \"VCEM-67-000002\" do\n  title \"ESX Agent Manager must limit the number of concurrent connections\npermitted.\"\n  desc  \"Resource exhaustion can occur when an unlimited number of concurrent\nrequests are allowed on a web site, facilitating a denial of service attack.\nUnless the number of requests is controlled, the web server can consume enough\nsystem resources to cause a system crash.\n\n    Mitigating this kind of attack will include limiting the number of\nconcurrent HTTP/HTTPS requests. In Tomcat, each incoming request requires a\nthread for the duration of that request. If more simultaneous requests are\nreceived than can be handled by the currently available request processing\nthreads, additional threads will be created up to the value of the maxThreads\nattribute.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000001-WSR-000001\"\n  tag gid: nil\n  tag rid: \"VCEM-67-000002\"\n  tag stig_id: \"VCEM-67-000002\"\n  tag cci: \"CCI-000054\"\n  tag nist: [\"AC-10\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --xpath\n'/Server/Service/Executor[@name=\\\"tomcatThreadPool\\\"]/@maxThreads'\n/usr/lib/vmware-eam/web/conf/server.xml\n\nExpected result:\n\nmaxThreads=\\\"300\\\"\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-eam/web/conf/server.xml\n\nNavigate to the <Executor> mode with the name of tomcatThreadPool and configure\nwith the value 'maxThreads=\\\"300\\\"'\n\nNote: The <Executor> node should be configured per the below:\n\n<Executor maxThreads=\\\"300\\\"\n                minSpareThreads=\\\"50\\\"\n                name=\\\"tomcatThreadPool\\\"\n                namePrefix=\\\"tomcat-http--\\\"/>\"\n\n  describe xml('/usr/lib/vmware-eam/web/conf/server.xml') do\n    its(['/Server/Service/Executor[@name=\"tomcatThreadPool\"]/@maxThreads']) { should cmp '300' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000002.rb",
        "line": 1
      },
      "id": "VCEM-67-000002"
    },
    {
      "title": "ESX Agent Manager must be configured with memory leak protection.",
      "desc": "The Java Runtime environment can cause a memory leak or lock files\nunder certain conditions. Without memory leak protection, ESX Agent Manager can\ncontinue to consume system resources which will lead to OutOfMemoryErrors when\nre-loading web applications.\n\n    Memory leaks occur when JRE code uses the context class loader to load a\nsingleton as this will cause a memory leak if a web application class loader\nhappens to be the context class loader at the time. The\nJreMemoryLeakPreventionListener class is designed to initialise these\nsingletons when Tomcat's common class loader is the context class loader.\nProper use of JRE memory leak protection will ensure that the hosted\napplication does not consume system resources and cause an unstable environment.",
      "descriptions": {
        "default": "The Java Runtime environment can cause a memory leak or lock files\nunder certain conditions. Without memory leak protection, ESX Agent Manager can\ncontinue to consume system resources which will lead to OutOfMemoryErrors when\nre-loading web applications.\n\n    Memory leaks occur when JRE code uses the context class loader to load a\nsingleton as this will cause a memory leak if a web application class loader\nhappens to be the context class loader at the time. The\nJreMemoryLeakPreventionListener class is designed to initialise these\nsingletons when Tomcat's common class loader is the context class loader.\nProper use of JRE memory leak protection will ensure that the hosted\napplication does not consume system resources and cause an unstable environment.",
        "check": "At the command prompt, execute the following command:\n\n# grep JreMemoryLeakPreventionListener /usr/lib/vmware-eam/web/conf/server.xml\n\nExpected result:\n\n<Listener\nclassName=\"org.apache.catalina.core.JreMemoryLeakPreventionListener\"/>\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open /usr/lib/vmware-eam/web/conf/server.xml\n\nNavigate to the <Server> node.\n\nAdd '<Listener\nclassName=\"org.apache.catalina.core.JreMemoryLeakPreventionListener\"/>' to\nthe <Server> node.."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000141-WSR-000086",
        "gid": null,
        "rid": "VCEM-67-000015",
        "stig_id": "VCEM-67-000015",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCEM-67-000015\" do\n  title \"ESX Agent Manager must be configured with memory leak protection.\"\n  desc  \"The Java Runtime environment can cause a memory leak or lock files\nunder certain conditions. Without memory leak protection, ESX Agent Manager can\ncontinue to consume system resources which will lead to OutOfMemoryErrors when\nre-loading web applications.\n\n    Memory leaks occur when JRE code uses the context class loader to load a\nsingleton as this will cause a memory leak if a web application class loader\nhappens to be the context class loader at the time. The\nJreMemoryLeakPreventionListener class is designed to initialise these\nsingletons when Tomcat's common class loader is the context class loader.\nProper use of JRE memory leak protection will ensure that the hosted\napplication does not consume system resources and cause an unstable environment.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000141-WSR-000086\"\n  tag gid: nil\n  tag rid: \"VCEM-67-000015\"\n  tag stig_id: \"VCEM-67-000015\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep JreMemoryLeakPreventionListener /usr/lib/vmware-eam/web/conf/server.xml\n\nExpected result:\n\n<Listener\nclassName=\\\"org.apache.catalina.core.JreMemoryLeakPreventionListener\\\"/>\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-eam/web/conf/server.xml\n\nNavigate to the <Server> node.\n\nAdd '<Listener\nclassName=\\\"org.apache.catalina.core.JreMemoryLeakPreventionListener\\\"/>' to\nthe <Server> node..\"\n\n  describe xml('/usr/lib/vmware-eam/web/conf/server.xml') do\n    its('Server/Listener/attribute::className') { should include 'org.apache.catalina.core.JreMemoryLeakPreventionListener' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000015.rb",
        "line": 1
      },
      "id": "VCEM-67-000015"
    },
    {
      "title": "ESX Agent Manager must be configured with the appropriate ports.",
      "desc": "Web servers provide numerous processes, features, and functionalities\nthat utilize TCP/IP ports. Some of these processes may be deemed unnecessary or\ntoo unsecure to run on a production system. The ports that the ESX Agent\nManager listens on are configured in the catalina.properties file and must be\nveriified as accurate to their shipping state.",
      "descriptions": {
        "default": "Web servers provide numerous processes, features, and functionalities\nthat utilize TCP/IP ports. Some of these processes may be deemed unnecessary or\ntoo unsecure to run on a production system. The ports that the ESX Agent\nManager listens on are configured in the catalina.properties file and must be\nveriified as accurate to their shipping state.",
        "check": "At the command prompt, execute the following command:\n\n# grep 'bio.http.port' /etc/vmware-eam/catalina.properties\n\nExpected result:\n\nbio.http.port=15005\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open /etc/vmware-eam/catalina.properties\n\nNavigate to the ports specification section.\n\nSet the ESX Agent Manager port specifications according to the below list:\n\nbio.http.port=15005"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000383-WSR-000175",
        "gid": null,
        "rid": "VCEM-67-000029",
        "stig_id": "VCEM-67-000029",
        "cci": "CCI-001762",
        "nist": [
          "CM-7 (1) (b)",
          "Rev_4"
        ]
      },
      "code": "control \"VCEM-67-000029\" do\n  title \"ESX Agent Manager must be configured with the appropriate ports.\"\n  desc  \"Web servers provide numerous processes, features, and functionalities\nthat utilize TCP/IP ports. Some of these processes may be deemed unnecessary or\ntoo unsecure to run on a production system. The ports that the ESX Agent\nManager listens on are configured in the catalina.properties file and must be\nveriified as accurate to their shipping state.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000383-WSR-000175\"\n  tag gid: nil\n  tag rid: \"VCEM-67-000029\"\n  tag stig_id: \"VCEM-67-000029\"\n  tag cci: \"CCI-001762\"\n  tag nist: [\"CM-7 (1) (b)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep 'bio.http.port' /etc/vmware-eam/catalina.properties\n\nExpected result:\n\nbio.http.port=15005\n\nIf the output of the command does not match the expected result, this is a\nfinding.\n\"\n  desc 'fix', \"Navigate to and open /etc/vmware-eam/catalina.properties\n\nNavigate to the ports specification section.\n\nSet the ESX Agent Manager port specifications according to the below list:\n\nbio.http.port=15005\n\"\n\n  describe parse_config_file('/etc/vmware-eam/catalina.properties').params['bio.http.port'] do\n    it { should eq '15005' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000029.rb",
        "line": 1
      },
      "id": "VCEM-67-000029"
    },
    {
      "title": "ESX Agent Manager log files must only be modifiable by privileged\nusers.",
      "desc": "Log data is essential in the investigation of events. The accuracy of\nthe information is always pertinent. One of the first steps an attacker will\nundertake is the modification or deletion of log records to cover his tracks\nand prolong discovery. The web server must protect the log data from\nunauthorized modification. ESX Agent Manager restricts all modification of log\nfiles by default but this configuration must be verified.",
      "descriptions": {
        "default": "Log data is essential in the investigation of events. The accuracy of\nthe information is always pertinent. One of the first steps an attacker will\nundertake is the modification or deletion of log records to cover his tracks\nand prolong discovery. The web server must protect the log data from\nunauthorized modification. ESX Agent Manager restricts all modification of log\nfiles by default but this configuration must be verified.",
        "check": "At the command prompt, execute the following command:\n\n# find /var/log/vmware/eam/web/ -xdev -type f -a '(' -perm -o+w -o -not -user\neam -o -not -group users ')' -exec ls -ld {} \\;\n\nIf any files are returned, this is a finding.",
        "fix": "At the command prompt, execute the following commands:\n\n# chmod o-w <file>\n# chown eam:users <file>\n\nNote: Subsitute <file> with the listed file."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000119-WSR-000069",
        "gid": null,
        "rid": "VCEM-67-000007",
        "stig_id": "VCEM-67-000007",
        "cci": "CCI-000163",
        "nist": [
          "AU-9",
          "Rev_4"
        ]
      },
      "code": "control \"VCEM-67-000007\" do\n  title \"ESX Agent Manager log files must only be modifiable by privileged\nusers.\"\n  desc  \"Log data is essential in the investigation of events. The accuracy of\nthe information is always pertinent. One of the first steps an attacker will\nundertake is the modification or deletion of log records to cover his tracks\nand prolong discovery. The web server must protect the log data from\nunauthorized modification. ESX Agent Manager restricts all modification of log\nfiles by default but this configuration must be verified.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000119-WSR-000069\"\n  tag gid: nil\n  tag rid: \"VCEM-67-000007\"\n  tag stig_id: \"VCEM-67-000007\"\n  tag cci: \"CCI-000163\"\n  tag nist: [\"AU-9\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# find /var/log/vmware/eam/web/ -xdev -type f -a '(' -perm -o+w -o -not -user\neam -o -not -group users ')' -exec ls -ld {} \\\\;\n\nIf any files are returned, this is a finding.\"\n  desc 'fix', \"At the command prompt, execute the following commands:\n\n# chmod o-w <file>\n# chown eam:users <file>\n\nNote: Subsitute <file> with the listed file.\"\n\n  command('find /var/log/vmware/eam/web/ -type f -xdev').stdout.split.each do | fname |\n    describe file(fname) do\n      it { should_not be_more_permissive_than('0644') }\n      its('owner') {should eq 'eam'}\n      its('group') {should eq 'users'}\n    end\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000007.rb",
        "line": 1
      },
      "id": "VCEM-67-000007"
    },
    {
      "title": "ESX Agent Manager must set URIEncoding to UTF-8.",
      "desc": "Invalid user input occurs when a user inserts data or characters into\na hosted application's data entry field and the hosted application is\nunprepared to process that data. This results in unanticipated application\nbehavior, potentially leading to an application compromise. Invalid user input\nis one of the primary methods employed when attempting to compromise an\napplication.\n\n    An attacker can also enter Unicode characters into hosted applications in\nan effort to break out of the document home or root home directory or to bypass\nsecurity checks. ESX Agent Manager must be configured to use a consistent\ncharacter set via the URIEncoding attribute on the Connector nodes.",
      "descriptions": {
        "default": "Invalid user input occurs when a user inserts data or characters into\na hosted application's data entry field and the hosted application is\nunprepared to process that data. This results in unanticipated application\nbehavior, potentially leading to an application compromise. Invalid user input\nis one of the primary methods employed when attempting to compromise an\napplication.\n\n    An attacker can also enter Unicode characters into hosted applications in\nan effort to break out of the document home or root home directory or to bypass\nsecurity checks. ESX Agent Manager must be configured to use a consistent\ncharacter set via the URIEncoding attribute on the Connector nodes.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --xpath '/Server/Service/Connector/@URIEncoding'\n/usr/lib/vmware-eam/web/conf/server.xml\n\nExpected result:\n\nURIEncoding=\"UTF-8\"\n\nIf the output does not match the expected result, this is a finding",
        "fix": "Navigate to and open /usr/lib/vmware-eam/web/conf/server.xml\n\nConfigure the <Connector> node with the value:\n\nURIEncoding=\"UTF-8\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000251-WSR-000157",
        "gid": null,
        "rid": "VCEM-67-000020",
        "stig_id": "VCEM-67-000020",
        "cci": "CCI-001310",
        "nist": [
          "SI-10",
          "Rev_4"
        ]
      },
      "code": "control \"VCEM-67-000020\" do\n  title \"ESX Agent Manager must set URIEncoding to UTF-8.\"\n  desc  \"Invalid user input occurs when a user inserts data or characters into\na hosted application's data entry field and the hosted application is\nunprepared to process that data. This results in unanticipated application\nbehavior, potentially leading to an application compromise. Invalid user input\nis one of the primary methods employed when attempting to compromise an\napplication.\n\n    An attacker can also enter Unicode characters into hosted applications in\nan effort to break out of the document home or root home directory or to bypass\nsecurity checks. ESX Agent Manager must be configured to use a consistent\ncharacter set via the URIEncoding attribute on the Connector nodes.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000251-WSR-000157\"\n  tag gid: nil\n  tag rid: \"VCEM-67-000020\"\n  tag stig_id: \"VCEM-67-000020\"\n  tag cci: \"CCI-001310\"\n  tag nist: [\"SI-10\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --xpath '/Server/Service/Connector/@URIEncoding'\n/usr/lib/vmware-eam/web/conf/server.xml\n\nExpected result:\n\nURIEncoding=\\\"UTF-8\\\"\n\nIf the output does not match the expected result, this is a finding\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-eam/web/conf/server.xml\n\nConfigure the <Connector> node with the value:\n\nURIEncoding=\\\"UTF-8\\\"\"\n\n  describe xml('/usr/lib/vmware-eam/web/conf/server.xml') do\n    its(['Server/Service/Connector/@URIEncoding']) { should cmp 'UTF-8'}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000020.rb",
        "line": 1
      },
      "id": "VCEM-67-000020"
    },
    {
      "title": "ESX Agent Manager must not enable support for TRACE requests.",
      "desc": "\"Trace\" is a technique for a user to request internal information\nabout Tomcat. This is useful during product development, but should not be\nenabled in production.  Allowing a attacker to conduct a Trace operation\nagainst ESX Agent Manager will expose information that would be useful to\nperform a more targeted attack. ESX Agent Manager provides the allowTrace\nparameter as means to disable responding to Trace requests.",
      "descriptions": {
        "default": "\"Trace\" is a technique for a user to request internal information\nabout Tomcat. This is useful during product development, but should not be\nenabled in production.  Allowing a attacker to conduct a Trace operation\nagainst ESX Agent Manager will expose information that would be useful to\nperform a more targeted attack. ESX Agent Manager provides the allowTrace\nparameter as means to disable responding to Trace requests.",
        "check": "At the command prompt, execute the following command:\n\n# grep allowTrace /usr/lib/vmware-eam/web/conf/server.xml\n\nIf allowTrace is set to \"true\", this is a finding. If no line is returned\nthis is NOT a finding.",
        "fix": "Navigate to and open /usr/lib/vmware-eam/web/conf/server.xml\n\nNavigate to and locate 'allowTrace=\"true\"'\n\nRemove the 'allowTrace=\"true\"' setting."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000266-WSR-000160",
        "gid": null,
        "rid": "VCEM-67-000025",
        "stig_id": "VCEM-67-000025",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCEM-67-000025\" do\n  title \"ESX Agent Manager must not enable support for TRACE requests.\"\n  desc  \"\\\"Trace\\\" is a technique for a user to request internal information\nabout Tomcat. This is useful during product development, but should not be\nenabled in production.  Allowing a attacker to conduct a Trace operation\nagainst ESX Agent Manager will expose information that would be useful to\nperform a more targeted attack. ESX Agent Manager provides the allowTrace\nparameter as means to disable responding to Trace requests.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000266-WSR-000160\"\n  tag gid: nil\n  tag rid: \"VCEM-67-000025\"\n  tag stig_id: \"VCEM-67-000025\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep allowTrace /usr/lib/vmware-eam/web/conf/server.xml\n\nIf allowTrace is set to \\\"true\\\", this is a finding. If no line is returned\nthis is NOT a finding.\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-eam/web/conf/server.xml\n\nNavigate to and locate 'allowTrace=\\\"true\\\"'\n\nRemove the 'allowTrace=\\\"true\\\"' setting.\"\n\n  describe.one do\n    describe xml('/usr/lib/vmware-eam/web/conf/server.xml') do\n      its(['Server/Service/Connector/attribute::allowTrace']) { should eq [] }\n    end\n\n    describe xml('/usr/lib/vmware-eam/web/conf/server.xml') do\n      its(['Server/Service/Connector/attribute::allowTrace']) { should cmp \"false\" }\n    end\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000025.rb",
        "line": 1
      },
      "id": "VCEM-67-000025"
    },
    {
      "title": "ESX Agent Manager must use the setCharacterEncodingFilter filter.",
      "desc": "Invalid user input occurs when a user inserts data or characters into\na hosted application's data entry field and the hosted application is\nunprepared to process that data. This results in unanticipated application\nbehavior, potentially leading to an application compromise. Invalid user input\nis one of the primary methods employed when attempting to compromise an\napplication.\n\n    An attacker can also enter Unicode characters into hosted applications in\nan effort to break out of the document home or root home directory or to bypass\nsecurity checks. VMware utilizes the standard Tomcat SetCharacterEncodingFilter\nto provide a layer of defense against character encoding attacks. Filters are\nJava objects that performs filtering tasks on either the request to a resource\n(a servlet or static content), or on the response from a resource, or both.",
      "descriptions": {
        "default": "Invalid user input occurs when a user inserts data or characters into\na hosted application's data entry field and the hosted application is\nunprepared to process that data. This results in unanticipated application\nbehavior, potentially leading to an application compromise. Invalid user input\nis one of the primary methods employed when attempting to compromise an\napplication.\n\n    An attacker can also enter Unicode characters into hosted applications in\nan effort to break out of the document home or root home directory or to bypass\nsecurity checks. VMware utilizes the standard Tomcat SetCharacterEncodingFilter\nto provide a layer of defense against character encoding attacks. Filters are\nJava objects that performs filtering tasks on either the request to a resource\n(a servlet or static content), or on the response from a resource, or both.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml | sed 's/xmlns=\".*\"//g' | xmllint --xpath '/web-app/filter-mapping/filter-name[text()=\"setCharacterEncodingFilter\"]/parent::filter-mapping' -\n\nExpected result:\n\n<filter-mapping>\n    <filter-name>setCharacterEncodingFilter</filter-name>\n    <url-pattern>/*</url-pattern>\n</filter-mapping>\n\nIf the output is does not match the expected result, this is a finding.\n\nAt the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml | sed 's/xmlns=\".*\"//g' | xmllint --xpath '/web-app/filter/filter-name[text()=\"setCharacterEncodingFilter\"]/parent::filter' -\n\nExpected result:\n\n<filter>\n  <filter-name>setCharacterEncodingFilter</filter-name>\n  <filter-class>org.apache.catalina.filters.SetCharacterEncodingFilter</filter-class>\n  <init-param>\n    <param-name>encoding</param-name>\n    <param-value>UTF-8</param-value>\n\t</init-param>\n\t<init-param>\n    <param-name>ignore</param-name>\n    <param-value>false</param-value>\n  </init-param>\n\t<async-supported>true</async-supported>\n</filter>\n\nIf the output is does not match the expected result, this is a finding.",
        "fix": "Navigate to and open /usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml\n\nConfigure the <web-app> node with the child nodes listed below.\n\n<filter-mapping>\n    <filter-name>setCharacterEncodingFilter</filter-name>\n    <url-pattern>/*</url-pattern>\n</filter-mapping>\n\n<filter>\n  <filter-name>setCharacterEncodingFilter</filter-name>\n  <filter-class>org.apache.catalina.filters.SetCharacterEncodingFilter</filter-class>\n  <init-param>\n    <param-name>encoding</param-name>\n    <param-value>UTF-8</param-value>\n\t</init-param>\n\t<init-param>\n    <param-name>ignore</param-name>\n    <param-value>false</param-value>\n  </init-param>\n\t<async-supported>true</async-supported>\n</filter>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000251-WSR-000157",
        "gid": null,
        "rid": "VCEM-67-000021",
        "stig_id": "VCEM-67-000021",
        "cci": "CCI-001310",
        "nist": [
          "SI-10",
          "Rev_4"
        ]
      },
      "code": "control \"VCEM-67-000021\" do\n  title \"ESX Agent Manager must use the setCharacterEncodingFilter filter.\"\n  desc  \"Invalid user input occurs when a user inserts data or characters into\na hosted application's data entry field and the hosted application is\nunprepared to process that data. This results in unanticipated application\nbehavior, potentially leading to an application compromise. Invalid user input\nis one of the primary methods employed when attempting to compromise an\napplication.\n\n    An attacker can also enter Unicode characters into hosted applications in\nan effort to break out of the document home or root home directory or to bypass\nsecurity checks. VMware utilizes the standard Tomcat SetCharacterEncodingFilter\nto provide a layer of defense against character encoding attacks. Filters are\nJava objects that performs filtering tasks on either the request to a resource\n(a servlet or static content), or on the response from a resource, or both.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000251-WSR-000157\"\n  tag gid: nil\n  tag rid: \"VCEM-67-000021\"\n  tag stig_id: \"VCEM-67-000021\"\n  tag cci: \"CCI-001310\"\n  tag nist: [\"SI-10\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml | sed 's/xmlns=\\\".*\\\"//g' | xmllint --xpath '/web-app/filter-mapping/filter-name[text()=\\\"setCharacterEncodingFilter\\\"]/parent::filter-mapping' -\n\nExpected result:\n\n<filter-mapping>\n    <filter-name>setCharacterEncodingFilter</filter-name>\n    <url-pattern>/*</url-pattern>\n</filter-mapping>\n\nIf the output is does not match the expected result, this is a finding.\n\nAt the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml | sed 's/xmlns=\\\".*\\\"//g' | xmllint --xpath '/web-app/filter/filter-name[text()=\\\"setCharacterEncodingFilter\\\"]/parent::filter' -\n\nExpected result:\n\n<filter>\n  <filter-name>setCharacterEncodingFilter</filter-name>\n  <filter-class>org.apache.catalina.filters.SetCharacterEncodingFilter</filter-class>\n  <init-param>\n    <param-name>encoding</param-name>\n    <param-value>UTF-8</param-value>\n\t</init-param>\n\t<init-param>\n    <param-name>ignore</param-name>\n    <param-value>false</param-value>\n  </init-param>\n\t<async-supported>true</async-supported>\n</filter>\n\nIf the output is does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml\n\nConfigure the <web-app> node with the child nodes listed below.\n\n<filter-mapping>\n    <filter-name>setCharacterEncodingFilter</filter-name>\n    <url-pattern>/*</url-pattern>\n</filter-mapping>\n\n<filter>\n  <filter-name>setCharacterEncodingFilter</filter-name>\n  <filter-class>org.apache.catalina.filters.SetCharacterEncodingFilter</filter-class>\n  <init-param>\n    <param-name>encoding</param-name>\n    <param-value>UTF-8</param-value>\n\t</init-param>\n\t<init-param>\n    <param-name>ignore</param-name>\n    <param-value>false</param-value>\n  </init-param>\n\t<async-supported>true</async-supported>\n</filter>\"\n\n  describe xml('/usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml') do\n    its('/web-app/filter-mapping[filter-name=\"setCharacterEncodingFilter\"]/url-pattern') { should cmp '*' }\n    its('/web-app/filter[filter-name=\"setCharacterEncodingFilter\"]/filter-class') { should cmp 'org.apache.catalina.filters.SetCharacterEncodingFilter' }\n    its('/web-app/filter[filter-name=\"setCharacterEncodingFilter\"]/init-param[param-name=\"encoding\"]/param-value') { should cmp 'UTF-8' }\n    its('/web-app/filter[filter-name=\"setCharacterEncodingFilter\"]/init-param[param-name=\"ignore\"]/param-value') { should cmp 'false' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000021.rb",
        "line": 1
      },
      "id": "VCEM-67-000021"
    },
    {
      "title": "ESX Agent Manager must generate log records for system startup and\nshutdown.",
      "desc": "Logging must be started as soon as possible when a service starts and\nas late as possible when a service is stopped. Many forms of suspicious actions\ncan be detected by analyzing logs for unexpected service starts and stops.\nAlso, by starting to log immediately after a service starts, it becomes more\ndifficult for suspicous activity to go un-logged.",
      "descriptions": {
        "default": "Logging must be started as soon as possible when a service starts and\nas late as possible when a service is stopped. Many forms of suspicious actions\ncan be detected by analyzing logs for unexpected service starts and stops.\nAlso, by starting to log immediately after a service starts, it becomes more\ndifficult for suspicous activity to go un-logged.",
        "check": "At the command prompt, execute the following command:\n\n# grep StreamRedirectFile /etc/vmware/vmware-vmon/svcCfgfiles/eam.json\n\nExpected output:\n\n\"StreamRedirectFile\" : \"%VMWARE_LOG_DIR%/vmware/eam/jvm.log\",\n\nIf there is no log file specified for the StreamRedirectFile setting, this is a\nfinding.",
        "fix": "Navigate to and open /etc/vmware/vmware-vmon/svcCfgfiles/eam.json .\nBelow the last line of the 'PreStartCommandArg' block add the following line:\n\n\"StreamRedirectFile\" : \"%VMWARE_LOG_DIR%/vmware/eam/jvm.log\",\n\nRestart the appliance for changes to take effect."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000089-WSR-000047",
        "gid": null,
        "rid": "VCEM-67-000006",
        "stig_id": "VCEM-67-000006",
        "cci": "CCI-000169",
        "nist": [
          "AU-12 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCEM-67-000006\" do\n  title \"ESX Agent Manager must generate log records for system startup and\nshutdown.\"\n  desc  \"Logging must be started as soon as possible when a service starts and\nas late as possible when a service is stopped. Many forms of suspicious actions\ncan be detected by analyzing logs for unexpected service starts and stops.\nAlso, by starting to log immediately after a service starts, it becomes more\ndifficult for suspicous activity to go un-logged.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000089-WSR-000047\"\n  tag gid: nil\n  tag rid: \"VCEM-67-000006\"\n  tag stig_id: \"VCEM-67-000006\"\n  tag cci: \"CCI-000169\"\n  tag nist: [\"AU-12 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep StreamRedirectFile /etc/vmware/vmware-vmon/svcCfgfiles/eam.json\n\nExpected output:\n\n\\\"StreamRedirectFile\\\" : \\\"%VMWARE_LOG_DIR%/vmware/eam/jvm.log\\\",\n\nIf there is no log file specified for the StreamRedirectFile setting, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open /etc/vmware/vmware-vmon/svcCfgfiles/eam.json .\nBelow the last line of the 'PreStartCommandArg' block add the following line:\n\n\\\"StreamRedirectFile\\\" : \\\"%VMWARE_LOG_DIR%/vmware/eam/jvm.log\\\",\n\nRestart the appliance for changes to take effect.\"\n\n  describe json('/etc/vmware/vmware-vmon/svcCfgfiles/eam.json') do\n    its('StreamRedirectFile') { should eq '%VMWARE_LOG_DIR%/vmware/eam/jvm.log'}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000006.rb",
        "line": 1
      },
      "id": "VCEM-67-000006"
    },
    {
      "title": "Rsyslog must be configured to monitor and ship ESX Agent Manager log\nfiles.",
      "desc": "ESX Agent Manager a number of logs that must be offloaded from the\noriginating system. This information can then be used for diagnostic purposes,\nforensics purposes, or other purposes relevant to ensuring the availability and\nintegrity of the hosted application.",
      "descriptions": {
        "default": "ESX Agent Manager a number of logs that must be offloaded from the\noriginating system. This information can then be used for diagnostic purposes,\nforensics purposes, or other purposes relevant to ensuring the availability and\nintegrity of the hosted application.",
        "check": "At the command prompt, execute the following command:\n\n# grep -v \"^#\" /etc/vmware-syslog/stig-services-eam.conf\n\nExpected result:\n\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/eam/eam.log\"\n      Tag=\"eam-main\"\n      Severity=\"info\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/eam/web/localhost_access_log*.txt\"\n      Tag=\"eam-access\"\n      Severity=\"info\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/eam/jvm.log.std*\"\n      Tag=\"eam-stdout\"\n      Severity=\"info\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/eam/web/catalina*.log\"\n      Tag=\"eam-catalina\"\n      Severity=\"info\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/eam/web/localhost.*.log\"\n      Tag=\"eam-catalina\"\n      Severity=\"info\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/firstboot/eam_firstboot.py*.log\"\n      Tag=\"eam-firstboot\"\n      Severity=\"info\"\n      Facility=\"local0\")\nFile=\"/var/log/vmware/firstboot/eam_firstboot.py*.log\"\n      Tag=\"eam-firstboot\"\n      Severity=\"info\"\n      Facility=\"local0\")\n\nIf the file does not exist, this is a finding.\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open /etc/vmware-syslog/stig-services-eam.conf ,\ncreating the file if it does not exist.\n\nSet the contents of the file as follows:\n\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/eam/eam.log\"\n      Tag=\"eam-main\"\n      Severity=\"info\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/eam/web/localhost_access_log*.txt\"\n      Tag=\"eam-access\"\n      Severity=\"info\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/eam/jvm.log.std*\"\n      Tag=\"eam-stdout\"\n      Severity=\"info\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/eam/web/catalina*.log\"\n      Tag=\"eam-catalina\"\n      Severity=\"info\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/eam/web/localhost.*.log\"\n      Tag=\"eam-catalina\"\n      Severity=\"info\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/firstboot/eam_firstboot.py*.log\"\n      Tag=\"eam-firstboot\"\n      Severity=\"info\"\n      Facility=\"local0\")"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000358-WSR-000163",
        "gid": null,
        "rid": "VCEM-67-000027",
        "stig_id": "VCEM-67-000027",
        "cci": "CCI-001851",
        "nist": [
          "AU-4 (1)",
          "Rev_4"
        ]
      },
      "code": "control \"VCEM-67-000027\" do\n  title \"Rsyslog must be configured to monitor and ship ESX Agent Manager log\nfiles.\"\n  desc  \"ESX Agent Manager a number of logs that must be offloaded from the\noriginating system. This information can then be used for diagnostic purposes,\nforensics purposes, or other purposes relevant to ensuring the availability and\nintegrity of the hosted application.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000358-WSR-000163\"\n  tag gid: nil\n  tag rid: \"VCEM-67-000027\"\n  tag stig_id: \"VCEM-67-000027\"\n  tag cci: \"CCI-001851\"\n  tag nist: [\"AU-4 (1)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep -v \\\"^#\\\" /etc/vmware-syslog/stig-services-eam.conf\n\nExpected result:\n\ninput(type=\\\"imfile\\\"\n      File=\\\"/var/log/vmware/eam/eam.log\\\"\n      Tag=\\\"eam-main\\\"\n      Severity=\\\"info\\\"\n      Facility=\\\"local0\\\")\ninput(type=\\\"imfile\\\"\n      File=\\\"/var/log/vmware/eam/web/localhost_access_log*.txt\\\"\n      Tag=\\\"eam-access\\\"\n      Severity=\\\"info\\\"\n      Facility=\\\"local0\\\")\ninput(type=\\\"imfile\\\"\n      File=\\\"/var/log/vmware/eam/jvm.log.std*\\\"\n      Tag=\\\"eam-stdout\\\"\n      Severity=\\\"info\\\"\n      Facility=\\\"local0\\\")\ninput(type=\\\"imfile\\\"\n      File=\\\"/var/log/vmware/eam/web/catalina*.log\\\"\n      Tag=\\\"eam-catalina\\\"\n      Severity=\\\"info\\\"\n      Facility=\\\"local0\\\")\ninput(type=\\\"imfile\\\"\n      File=\\\"/var/log/vmware/eam/web/localhost.*.log\\\"\n      Tag=\\\"eam-catalina\\\"\n      Severity=\\\"info\\\"\n      Facility=\\\"local0\\\")\ninput(type=\\\"imfile\\\"\n      File=\\\"/var/log/vmware/firstboot/eam_firstboot.py*.log\\\"\n      Tag=\\\"eam-firstboot\\\"\n      Severity=\\\"info\\\"\n      Facility=\\\"local0\\\")\nFile=\\\"/var/log/vmware/firstboot/eam_firstboot.py*.log\\\"\n      Tag=\\\"eam-firstboot\\\"\n      Severity=\\\"info\\\"\n      Facility=\\\"local0\\\")\n\nIf the file does not exist, this is a finding.\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open /etc/vmware-syslog/stig-services-eam.conf ,\ncreating the file if it does not exist.\n\nSet the contents of the file as follows:\n\ninput(type=\\\"imfile\\\"\n      File=\\\"/var/log/vmware/eam/eam.log\\\"\n      Tag=\\\"eam-main\\\"\n      Severity=\\\"info\\\"\n      Facility=\\\"local0\\\")\ninput(type=\\\"imfile\\\"\n      File=\\\"/var/log/vmware/eam/web/localhost_access_log*.txt\\\"\n      Tag=\\\"eam-access\\\"\n      Severity=\\\"info\\\"\n      Facility=\\\"local0\\\")\ninput(type=\\\"imfile\\\"\n      File=\\\"/var/log/vmware/eam/jvm.log.std*\\\"\n      Tag=\\\"eam-stdout\\\"\n      Severity=\\\"info\\\"\n      Facility=\\\"local0\\\")\ninput(type=\\\"imfile\\\"\n      File=\\\"/var/log/vmware/eam/web/catalina*.log\\\"\n      Tag=\\\"eam-catalina\\\"\n      Severity=\\\"info\\\"\n      Facility=\\\"local0\\\")\ninput(type=\\\"imfile\\\"\n      File=\\\"/var/log/vmware/eam/web/localhost.*.log\\\"\n      Tag=\\\"eam-catalina\\\"\n      Severity=\\\"info\\\"\n      Facility=\\\"local0\\\")\ninput(type=\\\"imfile\\\"\n      File=\\\"/var/log/vmware/firstboot/eam_firstboot.py*.log\\\"\n      Tag=\\\"eam-firstboot\\\"\n      Severity=\\\"info\\\"\n      Facility=\\\"local0\\\")\"\n\n  describe file('/etc/vmware-syslog/stig-services-eam.conf') do\n    it { should exist }\n  end\n  describe command('grep -v \"^#\" /etc/vmware-syslog/stig-services-eam.conf') do\n    its ('stdout') { should match \"input(type=\\\"imfile\\\"\\n      File=\\\"/var/log/vmware/eam/eam.log\\\"\\n      Tag=\\\"eam-main\\\"\\n      Severity=\\\"info\\\"\\n      Facility=\\\"local0\\\")\\ninput(type=\\\"imfile\\\"\\n      File=\\\"/var/log/vmware/eam/web/localhost_access_log*.txt\\\"\\n      Tag=\\\"eam-access\\\"\\n      Severity=\\\"info\\\"\\n      Facility=\\\"local0\\\")\\ninput(type=\\\"imfile\\\"\\n      File=\\\"/var/log/vmware/eam/jvm.log.std*\\\"\\n      Tag=\\\"eam-stdout\\\"\\n      Severity=\\\"info\\\"\\n      Facility=\\\"local0\\\")\\ninput(type=\\\"imfile\\\"\\n      File=\\\"/var/log/vmware/eam/web/catalina*.log\\\"\\n      Tag=\\\"eam-catalina\\\"\\n      Severity=\\\"info\\\"\\n      Facility=\\\"local0\\\")\\ninput(type=\\\"imfile\\\"\\n      File=\\\"/var/log/vmware/eam/web/localhost.*.log\\\"\\n      Tag=\\\"eam-catalina\\\"\\n      Severity=\\\"info\\\"\\n      Facility=\\\"local0\\\")\\ninput(type=\\\"imfile\\\"\\n      File=\\\"/var/log/vmware/firstboot/eam_firstboot.py*.log\\\"\\n      Tag=\\\"eam-firstboot\\\"\\n      Severity=\\\"info\\\"\\n      Facility=\\\"local0\\\")\\n\" }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000027.rb",
        "line": 1
      },
      "id": "VCEM-67-000027"
    },
    {
      "title": "ESX Agent Manager must set the welcome-file node to a default web\npage.",
      "desc": "Enumeration techniques, such as URL parameter manipulation, rely upon\nbeing able to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. By having a default hosted application web page, the anonymous web\nuser will not obtain directory browsing information or an error message that\nreveals the server type and version. Ensuring that every document directory has\nan index.jsp (or equivalent) file is one approach to mitigating the\nvulnerability.",
      "descriptions": {
        "default": "Enumeration techniques, such as URL parameter manipulation, rely upon\nbeing able to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. By having a default hosted application web page, the anonymous web\nuser will not obtain directory browsing information or an error message that\nreveals the server type and version. Ensuring that every document directory has\nan index.jsp (or equivalent) file is one approach to mitigating the\nvulnerability.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml | sed\n's/xmlns=\".*\"//g' | xmllint --xpath '/web-app/welcome-file-list' -\n\nExpected result:\n\n<welcome-file-list>\n    <welcome-file>index.jsp</welcome-file>\n  </welcome-file-list>\n\nIf the output does not match the expected result, this is a finding",
        "fix": "Navigate to and open\n/usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml\n\nAdd the following section under the <web-apps> node:\n\n<welcome-file-list>\n    <welcome-file>index.jsp</welcome-file>\n  </welcome-file-list>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000266-WSR-000142",
        "gid": null,
        "rid": "VCEM-67-000022",
        "stig_id": "VCEM-67-000022",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCEM-67-000022\" do\n  title \"ESX Agent Manager must set the welcome-file node to a default web\npage.\"\n  desc  \"Enumeration techniques, such as URL parameter manipulation, rely upon\nbeing able to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. By having a default hosted application web page, the anonymous web\nuser will not obtain directory browsing information or an error message that\nreveals the server type and version. Ensuring that every document directory has\nan index.jsp (or equivalent) file is one approach to mitigating the\nvulnerability.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000266-WSR-000142\"\n  tag gid: nil\n  tag rid: \"VCEM-67-000022\"\n  tag stig_id: \"VCEM-67-000022\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml | sed\n's/xmlns=\\\".*\\\"//g' | xmllint --xpath '/web-app/welcome-file-list' -\n\nExpected result:\n\n<welcome-file-list>\n    <welcome-file>index.jsp</welcome-file>\n  </welcome-file-list>\n\nIf the output does not match the expected result, this is a finding\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml\n\nAdd the following section under the <web-apps> node:\n\n<welcome-file-list>\n    <welcome-file>index.jsp</welcome-file>\n  </welcome-file-list>\n\"\n\n  list = [\"index.jsp\"]\n  describe xml('/usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml') do\n    its('/web-app/welcome-file-list/welcome-file') { should be_in list }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000022.rb",
        "line": 1
      },
      "id": "VCEM-67-000022"
    },
    {
      "title": "ESX Agent Manager must have Multipurpose Internet Mail Extensions\n(MIME) that invoke OS shell programs disabled..",
      "desc": "MIME mappings tell ESX Agent Manager what type of program various file\ntypes and extensions are and what external utilities or programs are needed to\nexecute the file type.  By ensuring that various shell script MIME types\nare not included in web.xml, the server is protected against malicious users\ntricking the server into executing shell command files.",
      "descriptions": {
        "default": "MIME mappings tell ESX Agent Manager what type of program various file\ntypes and extensions are and what external utilities or programs are needed to\nexecute the file type.  By ensuring that various shell script MIME types\nare not included in web.xml, the server is protected against malicious users\ntricking the server into executing shell command files.",
        "check": "At the command prompt, execute the following command:\n\n# grep -En '(x-csh<)|(x-sh<)|(x-shar<)|(x-ksh<)'\n/usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml\n\nIf the command produces any output, this is a finding.",
        "fix": "Open /usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml in a text\neditor. Remove any and all of the following nodes lines.\n\n<mime-type>application/x-csh</mime-type>\n<mime-type>application/x-shar</mime-type>\n<mime-type>application/x-sh</mime-type>\n<mime-type>application/x-ksh</mime-type>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000141-WSR-000081",
        "gid": null,
        "rid": "VCEM-67-000012",
        "stig_id": "VCEM-67-000012",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCEM-67-000012\" do\n  title \"ESX Agent Manager must have Multipurpose Internet Mail Extensions\n(MIME) that invoke OS shell programs disabled..\"\n  desc  \"MIME mappings tell ESX Agent Manager what type of program various file\ntypes and extensions are and what external utilities or programs are needed to\nexecute the file type.  By ensuring that various shell script MIME types\nare not included in web.xml, the server is protected against malicious users\ntricking the server into executing shell command files.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000141-WSR-000081\"\n  tag gid: nil\n  tag rid: \"VCEM-67-000012\"\n  tag stig_id: \"VCEM-67-000012\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep -En '(x-csh<)|(x-sh<)|(x-shar<)|(x-ksh<)'\n/usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml\n\nIf the command produces any output, this is a finding.\"\n  desc 'fix', \"Open /usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml in a text\neditor. Remove any and all of the following nodes lines.\n\n<mime-type>application/x-csh</mime-type>\n<mime-type>application/x-shar</mime-type>\n<mime-type>application/x-sh</mime-type>\n<mime-type>application/x-ksh</mime-type>\"\n\n  describe command('grep -En \\'(x-csh<)|(x-sh<)|(x-shar<)|(x-ksh<)\\' /usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml') do\n    its ('stdout.strip') { should eq '' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000012.rb",
        "line": 1
      },
      "id": "VCEM-67-000012"
    },
    {
      "title": "ESX Agent Manager must configured to show error pages with minimal\ninformation.",
      "desc": "Web servers will often display error messages to client users\ndisplaying enough information to aid in the debugging of the error. The\ninformation given back in error messages may display the web server type,\nversion, patches installed, plug-ins and modules installed, type of code being\nused by the hosted application, and any backends being used for data storage.\nThis information could be used by an attacker to blueprint what type of attacks\nmight be successful. As such, the Security Token Service must be configured\nwith a catch-all error handler that redirects to a standard error.jsp.",
      "descriptions": {
        "default": "Web servers will often display error messages to client users\ndisplaying enough information to aid in the debugging of the error. The\ninformation given back in error messages may display the web server type,\nversion, patches installed, plug-ins and modules installed, type of code being\nused by the hosted application, and any backends being used for data storage.\nThis information could be used by an attacker to blueprint what type of attacks\nmight be successful. As such, the Security Token Service must be configured\nwith a catch-all error handler that redirects to a standard error.jsp.",
        "check": "At the command prompt, execute the following command:\n\n#  xmllint --format /usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml | sed\n's/xmlns=\".*\"//g' | xmllint --xpath\n'/web-app/error-page/exception-type[\"text()=java.lang.Throwable\"]/parent::error-page'\n-\n\nExpected result:\n\n<error-page>\n    <exception-type>java.lang.Throwable</exception-type>\n    <location>/error.jsp</location>\n  </error-page>\n\nIf the output does not match the expected result, this is a finding",
        "fix": "Navigate to and open\n/usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml\n\nAdd the following section under the <web-apps> node:\n\n<error-page>\n    <exception-type>java.lang.Throwable</exception-type>\n    <location>/error.jsp</location>\n  </error-page>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000266-WSR-000159",
        "gid": null,
        "rid": "VCEM-67-000024",
        "stig_id": "VCEM-67-000024",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCEM-67-000024\" do\n  title \"ESX Agent Manager must configured to show error pages with minimal\ninformation.\"\n  desc  \"Web servers will often display error messages to client users\ndisplaying enough information to aid in the debugging of the error. The\ninformation given back in error messages may display the web server type,\nversion, patches installed, plug-ins and modules installed, type of code being\nused by the hosted application, and any backends being used for data storage.\nThis information could be used by an attacker to blueprint what type of attacks\nmight be successful. As such, the Security Token Service must be configured\nwith a catch-all error handler that redirects to a standard error.jsp.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000266-WSR-000159\"\n  tag gid: nil\n  tag rid: \"VCEM-67-000024\"\n  tag stig_id: \"VCEM-67-000024\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n#  xmllint --format /usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml | sed\n's/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'/web-app/error-page/exception-type[\\\"text()=java.lang.Throwable\\\"]/parent::error-page'\n-\n\nExpected result:\n\n<error-page>\n    <exception-type>java.lang.Throwable</exception-type>\n    <location>/error.jsp</location>\n  </error-page>\n\nIf the output does not match the expected result, this is a finding\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml\n\nAdd the following section under the <web-apps> node:\n\n<error-page>\n    <exception-type>java.lang.Throwable</exception-type>\n    <location>/error.jsp</location>\n  </error-page>\n\"\n\n  describe xml('/usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml') do\n    its(['/web-app/error-page[exception-type=\"java.lang.Throwable\"]/location']) { should cmp '/error.jsp' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000024.rb",
        "line": 1
      },
      "id": "VCEM-67-000024"
    },
    {
      "title": "ESX Agent Manager must fail to a known safe state if system\ninitialization fails, shutdown fails, or aborts fail.",
      "desc": "Determining a safe state for failure and weighing that against a\npotential DoS for users depends on what type of application the web server is\nhosting. For the ESX Agent Manager, it is preferable that the service abort\nstartup on any initialization failure rather than continuing in a degraded, and\npotentailly insecure, state.",
      "descriptions": {
        "default": "Determining a safe state for failure and weighing that against a\npotential DoS for users depends on what type of application the web server is\nhosting. For the ESX Agent Manager, it is preferable that the service abort\nstartup on any initialization failure rather than continuing in a degraded, and\npotentailly insecure, state.",
        "check": "At the command line, execute the following command:\n\n# grep EXIT_ON_INIT_FAILURE /etc/vmware-eam/catalina.properties\n\nExpected result :\n\norg.apache.catalina.startup.EXIT_ON_INIT_FAILURE=true\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open /etc/vmware-eam/catalina.properties\n\nAdd or change the following line:\n\norg.apache.catalina.startup.EXIT_ON_INIT_FAILURE=true"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000225-WSR-000140",
        "gid": null,
        "rid": "VCEM-67-000018",
        "stig_id": "VCEM-67-000018",
        "cci": "CCI-001190",
        "nist": [
          "SC-24",
          "Rev_4"
        ]
      },
      "code": "control \"VCEM-67-000018\" do\n  title \"ESX Agent Manager must fail to a known safe state if system\ninitialization fails, shutdown fails, or aborts fail.\"\n  desc  \"Determining a safe state for failure and weighing that against a\npotential DoS for users depends on what type of application the web server is\nhosting. For the ESX Agent Manager, it is preferable that the service abort\nstartup on any initialization failure rather than continuing in a degraded, and\npotentailly insecure, state.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000225-WSR-000140\"\n  tag gid: nil\n  tag rid: \"VCEM-67-000018\"\n  tag stig_id: \"VCEM-67-000018\"\n  tag cci: \"CCI-001190\"\n  tag nist: [\"SC-24\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep EXIT_ON_INIT_FAILURE /etc/vmware-eam/catalina.properties\n\nExpected result :\n\norg.apache.catalina.startup.EXIT_ON_INIT_FAILURE=true\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open /etc/vmware-eam/catalina.properties\n\nAdd or change the following line:\n\norg.apache.catalina.startup.EXIT_ON_INIT_FAILURE=true\"\n\n  describe parse_config_file('/etc/vmware-eam/catalina.properties').params['org.apache.catalina.startup.EXIT_ON_INIT_FAILURE'] do\n    it { should eq 'true' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000018.rb",
        "line": 1
      },
      "id": "VCEM-67-000018"
    },
    {
      "title": "ESX Agent Manager must limit the maximum size of a POST request.",
      "desc": "The 'maxPostSize' value is the maximum size in bytes of the POST which\nwill be handled by the container FORM URL parameter parsing. Limit its size to\nreduce exposure to a DOS attack. If 'maxPostSize' is not set, the default value\nof 2097152 (2MB) is used. ESX Agent Manager is configured in it's shipping\nstate to not set a value for 'maxPostSize'.",
      "descriptions": {
        "default": "The 'maxPostSize' value is the maximum size in bytes of the POST which\nwill be handled by the container FORM URL parameter parsing. Limit its size to\nreduce exposure to a DOS attack. If 'maxPostSize' is not set, the default value\nof 2097152 (2MB) is used. ESX Agent Manager is configured in it's shipping\nstate to not set a value for 'maxPostSize'.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --xpath\n'/Server/Service/Connector[@port=\"${bio-custom.http.port}\"]/@maxPostSize'\n/usr/lib/vmware-eam/web/conf/server.xml\n\nExpected result:\n\nXPath set is empty\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open /usr/lib/vmware-eam/web/conf/server.xml\n\nRemove any configuration for 'maxPostSize' from the <Connector> node."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000001-WSR-000001",
        "gid": null,
        "rid": "VCEM-67-000003",
        "stig_id": "VCEM-67-000003",
        "cci": "CCI-000054",
        "nist": [
          "AC-10",
          "Rev_4"
        ]
      },
      "code": "control \"VCEM-67-000003\" do\n  title \"ESX Agent Manager must limit the maximum size of a POST request.\"\n  desc  \"The 'maxPostSize' value is the maximum size in bytes of the POST which\nwill be handled by the container FORM URL parameter parsing. Limit its size to\nreduce exposure to a DOS attack. If 'maxPostSize' is not set, the default value\nof 2097152 (2MB) is used. ESX Agent Manager is configured in it's shipping\nstate to not set a value for 'maxPostSize'.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000001-WSR-000001\"\n  tag gid: nil\n  tag rid: \"VCEM-67-000003\"\n  tag stig_id: \"VCEM-67-000003\"\n  tag cci: \"CCI-000054\"\n  tag nist: [\"AC-10\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --xpath\n'/Server/Service/Connector[@port=\\\"${bio-custom.http.port}\\\"]/@maxPostSize'\n/usr/lib/vmware-eam/web/conf/server.xml\n\nExpected result:\n\nXPath set is empty\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-eam/web/conf/server.xml\n\nRemove any configuration for 'maxPostSize' from the <Connector> node.\"\n\n  describe xml('/usr/lib/vmware-eam/web/conf/server.xml') do\n    its('Server/Service/Connector/attribute::maxPostSize') { should eq [] }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000003.rb",
        "line": 1
      },
      "id": "VCEM-67-000003"
    },
    {
      "title": "ESX Agent Manager must protect cookies from XSS.",
      "desc": "Cookies are a common way to save session state over the HTTP(S)\nprotocol. If an attacker can compromise session data stored in a cookie, they\nare better able to launch an attack against the server and its applications.\nWhen you tag a cookie with the HttpOnly flag, it tells the browser that this\nparticular cookie should only be accessed by the originating server. Any\nattempt to access the cookie from client script is strictly forbidden.",
      "descriptions": {
        "default": "Cookies are a common way to save session state over the HTTP(S)\nprotocol. If an attacker can compromise session data stored in a cookie, they\nare better able to launch an attack against the server and its applications.\nWhen you tag a cookie with the HttpOnly flag, it tells the browser that this\nparticular cookie should only be accessed by the originating server. Any\nattempt to access the cookie from client script is strictly forbidden.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml | sed\n's/xmlns=\".*\"//g' | xmllint --xpath\n'/web-app/session-config/cookie-config/http-only' -\n\nExpected result:\n\n<http-only>true</http-only>\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml\n\nNavigate to the <session-config> node and configure it as follows.\n\n    <session-config>\n      <cookie-config>\n         <http-only>true</http-only>\n         <secure>true</secure>\n      </cookie-config>\n      <session-timeout>30</session-timeout>\n   </session-config>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000001-WSR-000002",
        "gid": null,
        "rid": "VCEM-67-000004",
        "stig_id": "VCEM-67-000004",
        "cci": "CCI-000054",
        "nist": [
          "AC-10",
          "Rev_4"
        ]
      },
      "code": "control \"VCEM-67-000004\" do\n  title \"ESX Agent Manager must protect cookies from XSS.\"\n  desc  \"Cookies are a common way to save session state over the HTTP(S)\nprotocol. If an attacker can compromise session data stored in a cookie, they\nare better able to launch an attack against the server and its applications.\nWhen you tag a cookie with the HttpOnly flag, it tells the browser that this\nparticular cookie should only be accessed by the originating server. Any\nattempt to access the cookie from client script is strictly forbidden.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000001-WSR-000002\"\n  tag gid: nil\n  tag rid: \"VCEM-67-000004\"\n  tag stig_id: \"VCEM-67-000004\"\n  tag cci: \"CCI-000054\"\n  tag nist: [\"AC-10\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml | sed\n's/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'/web-app/session-config/cookie-config/http-only' -\n\nExpected result:\n\n<http-only>true</http-only>\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml\n\nNavigate to the <session-config> node and configure it as follows.\n\n    <session-config>\n      <cookie-config>\n         <http-only>true</http-only>\n         <secure>true</secure>\n      </cookie-config>\n      <session-timeout>30</session-timeout>\n   </session-config>\"\n\n  describe xml('/usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml') do\n    its(['/web-app/session-config/cookie-config/http-only']) { should cmp 'true' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000004.rb",
        "line": 1
      },
      "id": "VCEM-67-000004"
    },
    {
      "title": "ESX Agent Manager must not have the Web Distributed Authoring (WebDAV)\nservlet installed.",
      "desc": "Web Distributed Authoring (WebDAV) is an extension to the HTTP\nprotocol that, when developed, was meant to allow users to create, change, and\nmove documents on a server, typically a web server or web share. WebDAV is not\nwidely used and has serious security concerns because it may allow clients to\nmodify unauthorized files on the web server and must therefore be disabled.\n\n    Tomcat uses the org.apache.catalina.servlets.WebdavServlet servlet to\nprovide WebDAV services. Because the WebDAV service has been found to have an\nexcessive number of vulnerabilities, this servlet must not be installed. ESX\nAgent Manager does not configure WebDAV by default.",
      "descriptions": {
        "default": "Web Distributed Authoring (WebDAV) is an extension to the HTTP\nprotocol that, when developed, was meant to allow users to create, change, and\nmove documents on a server, typically a web server or web share. WebDAV is not\nwidely used and has serious security concerns because it may allow clients to\nmodify unauthorized files on the web server and must therefore be disabled.\n\n    Tomcat uses the org.apache.catalina.servlets.WebdavServlet servlet to\nprovide WebDAV services. Because the WebDAV service has been found to have an\nexcessive number of vulnerabilities, this servlet must not be installed. ESX\nAgent Manager does not configure WebDAV by default.",
        "check": "At the command prompt, execute the following command:\n\n# grep -n 'webdav' /usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml\n\nIf the command produces any output, this is a finding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml\n\nFind the <servlet-name>webdav</servlet-name> node and remove the entire parent\n<servlet> block.\n\nFind the <servlet-name>webdav</servlet-name> node and remove the entire parent\n<servlet-mapping> block."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000141-WSR-000085",
        "gid": null,
        "rid": "VCEM-67-000014",
        "stig_id": "VCEM-67-000014",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCEM-67-000014\" do\n  title \"ESX Agent Manager must not have the Web Distributed Authoring (WebDAV)\nservlet installed.\"\n  desc  \"Web Distributed Authoring (WebDAV) is an extension to the HTTP\nprotocol that, when developed, was meant to allow users to create, change, and\nmove documents on a server, typically a web server or web share. WebDAV is not\nwidely used and has serious security concerns because it may allow clients to\nmodify unauthorized files on the web server and must therefore be disabled.\n\n    Tomcat uses the org.apache.catalina.servlets.WebdavServlet servlet to\nprovide WebDAV services. Because the WebDAV service has been found to have an\nexcessive number of vulnerabilities, this servlet must not be installed. ESX\nAgent Manager does not configure WebDAV by default.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000141-WSR-000085\"\n  tag gid: nil\n  tag rid: \"VCEM-67-000014\"\n  tag stig_id: \"VCEM-67-000014\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep -n 'webdav' /usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml\n\nIf the command produces any output, this is a finding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml\n\nFind the <servlet-name>webdav</servlet-name> node and remove the entire parent\n<servlet> block.\n\nFind the <servlet-name>webdav</servlet-name> node and remove the entire parent\n<servlet-mapping> block.\"\n\n  describe xml('/usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml') do\n    its('/web-app/servlet-mapping[servlet-name=\"webdav\"]') { should eq [] }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000014.rb",
        "line": 1
      },
      "id": "VCEM-67-000014"
    },
    {
      "title": "ESX Agent Manager directory tree must have permissions in an \"out of\nthe box\" state.",
      "desc": "As a rule, accounts on a web server are to be kept to a minimum. Only\nadministrators, web managers, developers, auditors, and web authors require\naccounts on the machine hosting the web server. The resources to which these\naccounts have access must also be closely monitored and controlled. ESX Agent\nManager files must be adequately protected with correct permissions as applied\n\"out of the box\".",
      "descriptions": {
        "default": "As a rule, accounts on a web server are to be kept to a minimum. Only\nadministrators, web managers, developers, auditors, and web authors require\naccounts on the machine hosting the web server. The resources to which these\naccounts have access must also be closely monitored and controlled. ESX Agent\nManager files must be adequately protected with correct permissions as applied\n\"out of the box\".",
        "check": "At the command prompt, execute the following command:\n\n# find /usr/lib/vmware-eam/web/ -xdev -type f -a '(' -not -user eam -o -not\n-group cis ')' -exec ls -ld {} \\;\n\nIf the command produces any output, this is a finding.",
        "fix": "At the command prompt, execute the following command:\n\n# chown eam:cis <file_name>\n\nRepeat the command for each file that was returned\n\nNote: Replace <file_name> for the name of the file that was returned."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000211-WSR-000030",
        "gid": null,
        "rid": "VCEM-67-000017",
        "stig_id": "VCEM-67-000017",
        "cci": "CCI-001082",
        "nist": [
          "SC-2",
          "Rev_4"
        ]
      },
      "code": "control \"VCEM-67-000017\" do\n  title \"ESX Agent Manager directory tree must have permissions in an \\\"out of\nthe box\\\" state.\"\n  desc  \"As a rule, accounts on a web server are to be kept to a minimum. Only\nadministrators, web managers, developers, auditors, and web authors require\naccounts on the machine hosting the web server. The resources to which these\naccounts have access must also be closely monitored and controlled. ESX Agent\nManager files must be adequately protected with correct permissions as applied\n\\\"out of the box\\\".\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000211-WSR-000030\"\n  tag gid: nil\n  tag rid: \"VCEM-67-000017\"\n  tag stig_id: \"VCEM-67-000017\"\n  tag cci: \"CCI-001082\"\n  tag nist: [\"SC-2\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# find /usr/lib/vmware-eam/web/ -xdev -type f -a '(' -not -user eam -o -not\n-group cis ')' -exec ls -ld {} \\\\;\n\nIf the command produces any output, this is a finding.\"\n  desc 'fix', \"At the command prompt, execute the following command:\n\n# chown eam:cis <file_name>\n\nRepeat the command for each file that was returned\n\nNote: Replace <file_name> for the name of the file that was returned.\"\n\n  describe command('find /usr/lib/vmware-eam/web/ -xdev -type f -a \\'(\\' -not -user eam -o -not -group cis \\')\\' -exec ls -ld {} \\;') do\n   its('stdout.strip') { should eq ''}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000017.rb",
        "line": 1
      },
      "id": "VCEM-67-000017"
    },
    {
      "title": "ESX Agent Manager must limit the amount of time that each TCP\nconnection is kept alive.",
      "desc": "Denial of Service is one threat against web servers.  Many DoS attacks\nattempt to consume web server resources in such a way that no more resources\nare available to satisfy legitimate requests.\n\n    In Tomcat, the 'connectionTimeout' attribute sets the number of\nmilliseconds the server will wait after accepting a connection for the request\nURI line to be presented. This timeout will also be used when reading the\nrequest body (if any). This prevents idle sockets that are not sending HTTP\nrequests from consuming system resources and potentially denying new\nconnections.",
      "descriptions": {
        "default": "Denial of Service is one threat against web servers.  Many DoS attacks\nattempt to consume web server resources in such a way that no more resources\nare available to satisfy legitimate requests.\n\n    In Tomcat, the 'connectionTimeout' attribute sets the number of\nmilliseconds the server will wait after accepting a connection for the request\nURI line to be presented. This timeout will also be used when reading the\nrequest body (if any). This prevents idle sockets that are not sending HTTP\nrequests from consuming system resources and potentially denying new\nconnections.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --xpath '/Server/Service/Connector/@connectionTimeout'\n/usr/lib/vmware-eam/web/conf/server.xml\n\nExpected result:\n\nconnectionTimeout=\"20000\"\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open /usr/lib/vmware-eam/web/conf/server.xml\n\nConfigure the <Connector> node with the value:\n\nconnectionTimeout=\"20000\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000001-WSR-000001",
        "gid": null,
        "rid": "VCEM-67-000001",
        "stig_id": "VCEM-67-000001",
        "cci": "CCI-000054",
        "nist": [
          "AC-10",
          "Rev_4"
        ]
      },
      "code": "control \"VCEM-67-000001\" do\n  title \"ESX Agent Manager must limit the amount of time that each TCP\nconnection is kept alive.\"\n  desc  \"Denial of Service is one threat against web servers.  Many DoS attacks\nattempt to consume web server resources in such a way that no more resources\nare available to satisfy legitimate requests.\n\n    In Tomcat, the 'connectionTimeout' attribute sets the number of\nmilliseconds the server will wait after accepting a connection for the request\nURI line to be presented. This timeout will also be used when reading the\nrequest body (if any). This prevents idle sockets that are not sending HTTP\nrequests from consuming system resources and potentially denying new\nconnections.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000001-WSR-000001\"\n  tag gid: nil\n  tag rid: \"VCEM-67-000001\"\n  tag stig_id: \"VCEM-67-000001\"\n  tag cci: \"CCI-000054\"\n  tag nist: [\"AC-10\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --xpath '/Server/Service/Connector/@connectionTimeout'\n/usr/lib/vmware-eam/web/conf/server.xml\n\nExpected result:\n\nconnectionTimeout=\\\"20000\\\"\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-eam/web/conf/server.xml\n\nConfigure the <Connector> node with the value:\n\nconnectionTimeout=\\\"20000\\\"\"\n\n  begin\n    vcui_conf = xml('/usr/lib/vmware-eam/web/conf/server.xml')\n\n      if vcui_conf['Server/Service/Connector/attribute::connectionTimeout'].is_a?(Array)\n        vcui_conf['Server/Service/Connector/attribute::connectionTimeout'].each do |x|\n          describe x do\n            it { should eq \"20000\" }\n          end\n        end\n      else\n        describe xml(vcui_conf['Server/Service/Connector/attribute::connectionTimeout']) do\n          it { should eq \"20000\" }\n        end\n      end\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000001.rb",
        "line": 1
      },
      "id": "VCEM-67-000001"
    },
    {
      "title": "ESX Agent Manager must only run one webapp.",
      "desc": "VMware ships ESX Agent Managers on the VCSA with one webapp. Any other\npath is potentially malicious and must be removed.",
      "descriptions": {
        "default": "VMware ships ESX Agent Managers on the VCSA with one webapp. Any other\npath is potentially malicious and must be removed.",
        "check": "At the command prompt, execute the following command:\n\n# ls -A /usr/lib/vmware-eam/web/webapps\n\nExpected result:\n\neam\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "For each unexpected directory returned in the check, run the\nfollowing command:\n\n# rm /usr/lib/vmware-eam/web/webapps/<NAME>\n\nRestart the service with the following command:\n\n# vmon-cli --restart eam"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000131-WSR-000073",
        "gid": null,
        "rid": "VCEM-67-000009",
        "stig_id": "VCEM-67-000009",
        "cci": "CCI-001749",
        "nist": [
          "CM-5 (3)",
          "Rev_4"
        ]
      },
      "code": "control \"VCEM-67-000009\" do\n  title \"ESX Agent Manager must only run one webapp.\"\n  desc  \"VMware ships ESX Agent Managers on the VCSA with one webapp. Any other\npath is potentially malicious and must be removed.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000131-WSR-000073\"\n  tag gid: nil\n  tag rid: \"VCEM-67-000009\"\n  tag stig_id: \"VCEM-67-000009\"\n  tag cci: \"CCI-001749\"\n  tag nist: [\"CM-5 (3)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# ls -A /usr/lib/vmware-eam/web/webapps\n\nExpected result:\n\neam\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"For each unexpected directory returned in the check, run the\nfollowing command:\n\n# rm /usr/lib/vmware-eam/web/webapps/<NAME>\n\nRestart the service with the following command:\n\n# vmon-cli --restart eam\"\n\n  describe command('ls -A /usr/lib/vmware-eam/web/webapps') do\n    its ('stdout.strip') { should eq 'eam' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000009.rb",
        "line": 1
      },
      "id": "VCEM-67-000009"
    },
    {
      "title": "ESX Agent Manager must be configured to limit access to internal\npackages.",
      "desc": "The 'package.access' entry in the catalina.properties file implements\naccess control at the package level. When properly configured, a Security\nException will be reported should an errant or malicious webapp attempt to\naccess the listed internal classes directly, or if a new class is defined under\nthe protected packages. The ESX Agent Manager comes pre-configured with the\nappropriate packages defined in 'package.access' and this configuration must be\nmaintained.",
      "descriptions": {
        "default": "The 'package.access' entry in the catalina.properties file implements\naccess control at the package level. When properly configured, a Security\nException will be reported should an errant or malicious webapp attempt to\naccess the listed internal classes directly, or if a new class is defined under\nthe protected packages. The ESX Agent Manager comes pre-configured with the\nappropriate packages defined in 'package.access' and this configuration must be\nmaintained.",
        "check": "At the command prompt, execute the following command:\n\n# grep \"package.access\" -A 5 /etc/vmware-eam/catalina.properties\n\nExpected result:\n\npackage.access=\\\nsun.,\\\norg.apache.catalina.,\\\norg.apache.coyote.,\\\norg.apache.tomcat.,\\\norg.apache.jasper.\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open  /etc/vmware-eam/catalina.properties and\nensure that the 'package.access' line is configured as follows:\n\npackage.access=\\\nsun.,\\\norg.apache.catalina.,\\\norg.apache.coyote.,\\\norg.apache.tomcat.,\\\norg.apache.jasper."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000141-WSR-000075",
        "gid": null,
        "rid": "VCEM-67-000011",
        "stig_id": "VCEM-67-000011",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCEM-67-000011\" do\n  title \"ESX Agent Manager must be configured to limit access to internal\npackages.\"\n  desc  \"The 'package.access' entry in the catalina.properties file implements\naccess control at the package level. When properly configured, a Security\nException will be reported should an errant or malicious webapp attempt to\naccess the listed internal classes directly, or if a new class is defined under\nthe protected packages. The ESX Agent Manager comes pre-configured with the\nappropriate packages defined in 'package.access' and this configuration must be\nmaintained.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000141-WSR-000075\"\n  tag gid: nil\n  tag rid: \"VCEM-67-000011\"\n  tag stig_id: \"VCEM-67-000011\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep \\\"package.access\\\" -A 5 /etc/vmware-eam/catalina.properties\n\nExpected result:\n\npackage.access=\\\\\nsun.,\\\\\norg.apache.catalina.,\\\\\norg.apache.coyote.,\\\\\norg.apache.tomcat.,\\\\\norg.apache.jasper.\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open  /etc/vmware-eam/catalina.properties and\nensure that the 'package.access' line is configured as follows:\n\npackage.access=\\\\\nsun.,\\\\\norg.apache.catalina.,\\\\\norg.apache.coyote.,\\\\\norg.apache.tomcat.,\\\\\norg.apache.jasper.\"\n\n  describe command('grep \"package.access\" -A 5 /etc/vmware-eam/catalina.properties') do\n    its ('stdout.strip') { should eq \"package.access=\\\\\\nsun.,\\\\\\norg.apache.catalina.,\\\\\\norg.apache.coyote.,\\\\\\norg.apache.tomcat.,\\\\\\norg.apache.jasper.\" }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000011.rb",
        "line": 1
      },
      "id": "VCEM-67-000011"
    },
    {
      "title": "ESX Agent Manager must set the secure flag for cookies.",
      "desc": "The secure flag is an option that can be set by the application server\nwhen sending a new cookie to the user within an HTTP Response. The purpose of\nthe secure flag is to prevent cookies from being observed by unauthorized\nparties due to the transmission of a the cookie in clear text. By setting the\nsecure flag, the browser will prevent the transmission of a cookie over an\nunencrypted channel. The ESX Agent Manager is configured to only be accessible\nover a TLS tunnel but this cookie flag is still a recommended best practice.",
      "descriptions": {
        "default": "The secure flag is an option that can be set by the application server\nwhen sending a new cookie to the user within an HTTP Response. The purpose of\nthe secure flag is to prevent cookies from being observed by unauthorized\nparties due to the transmission of a the cookie in clear text. By setting the\nsecure flag, the browser will prevent the transmission of a cookie over an\nunencrypted channel. The ESX Agent Manager is configured to only be accessible\nover a TLS tunnel but this cookie flag is still a recommended best practice.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml | sed\n's/xmlns=\".*\"//g' | xmllint --xpath\n'/web-app/session-config/cookie-config/secure' -\n\nExpected result:\n\n<secure>true</secure>\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml\n\nNavigate to the /<web-apps>/<session-config>/<cookie-config> node and configure\nit as follows.\n\n    <cookie-config>\n      <http-only>true</http-only>\n      <secure>true</secure>\n    </cookie-config>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000380-WSR-000072",
        "gid": null,
        "rid": "VCEM-67-000028",
        "stig_id": "VCEM-67-000028",
        "cci": "CCI-001813",
        "nist": [
          "CM-5 (1)",
          "Rev_4"
        ]
      },
      "code": "control \"VCEM-67-000028\" do\n  title \"ESX Agent Manager must set the secure flag for cookies.\"\n  desc  \"The secure flag is an option that can be set by the application server\nwhen sending a new cookie to the user within an HTTP Response. The purpose of\nthe secure flag is to prevent cookies from being observed by unauthorized\nparties due to the transmission of a the cookie in clear text. By setting the\nsecure flag, the browser will prevent the transmission of a cookie over an\nunencrypted channel. The ESX Agent Manager is configured to only be accessible\nover a TLS tunnel but this cookie flag is still a recommended best practice.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000380-WSR-000072\"\n  tag gid: nil\n  tag rid: \"VCEM-67-000028\"\n  tag stig_id: \"VCEM-67-000028\"\n  tag cci: \"CCI-001813\"\n  tag nist: [\"CM-5 (1)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml | sed\n's/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'/web-app/session-config/cookie-config/secure' -\n\nExpected result:\n\n<secure>true</secure>\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml\n\nNavigate to the /<web-apps>/<session-config>/<cookie-config> node and configure\nit as follows.\n\n    <cookie-config>\n      <http-only>true</http-only>\n      <secure>true</secure>\n    </cookie-config>\"\n\n  describe xml('/usr/lib/vmware-eam/web/webapps/eam/WEB-INF/web.xml') do\n    its('/web-app/session-config/cookie-config/secure') { should cmp 'true' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000028.rb",
        "line": 1
      },
      "id": "VCEM-67-000028"
    },
    {
      "title": "Performance Charts must have mappings set for Java servlet pages.",
      "desc": "Resource mapping is the process of tying a particular file type to a\nprocess in the web server that can serve that type of file to a requesting\nclient and to identify which file types are not to be delivered to a client.\n\n    By not specifying which files can and which files cannot be served to a\nuser, the web server could deliver to a user web server configuration files,\nlog files, password files, etc.\n\n    As Tomcat is a java-based web server, the main file extension used is\n*.jsp.  This check ensures that the *.jsp and *.jspx file types has been\nproperly mapped to servlets.",
      "descriptions": {
        "default": "Resource mapping is the process of tying a particular file type to a\nprocess in the web server that can serve that type of file to a requesting\nclient and to identify which file types are not to be delivered to a client.\n\n    By not specifying which files can and which files cannot be served to a\nuser, the web server could deliver to a user web server configuration files,\nlog files, password files, etc.\n\n    As Tomcat is a java-based web server, the main file extension used is\n*.jsp.  This check ensures that the *.jsp and *.jspx file types has been\nproperly mapped to servlets.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-perfcharts/tc-instance/conf/web.xml | sed '2\ns/xmlns=\".*\"//g' | xmllint --xpath\n'/web-app/servlet-mapping/servlet-name[text()=\"jsp\"]/parent::servlet-mapping'\n-\n\nExpected result:\n\n<servlet-mapping>\n    <servlet-name>jsp</servlet-name>\n    <url-pattern>*.jsp</url-pattern>\n    <url-pattern>*.jspx</url-pattern>\n  </servlet-mapping>\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/conf/web.xml\n\nInside the <web-app> parent node, add the following:\n\n<servlet-mapping>\n    <servlet-name>jsp</servlet-name>\n    <url-pattern>*.jsp</url-pattern>\n    <url-pattern>*.jspx</url-pattern>\n  </servlet-mapping>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000141-WSR-000083",
        "gid": null,
        "rid": "VCPF-67-000012",
        "stig_id": "VCPF-67-000012",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCPF-67-000012\" do\n  title \"Performance Charts must have mappings set for Java servlet pages.\"\n  desc  \"Resource mapping is the process of tying a particular file type to a\nprocess in the web server that can serve that type of file to a requesting\nclient and to identify which file types are not to be delivered to a client.\n\n    By not specifying which files can and which files cannot be served to a\nuser, the web server could deliver to a user web server configuration files,\nlog files, password files, etc.\n\n    As Tomcat is a java-based web server, the main file extension used is\n*.jsp.  This check ensures that the *.jsp and *.jspx file types has been\nproperly mapped to servlets.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000141-WSR-000083\"\n  tag gid: nil\n  tag rid: \"VCPF-67-000012\"\n  tag stig_id: \"VCPF-67-000012\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-perfcharts/tc-instance/conf/web.xml | sed '2\ns/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'/web-app/servlet-mapping/servlet-name[text()=\\\"jsp\\\"]/parent::servlet-mapping'\n-\n\nExpected result:\n\n<servlet-mapping>\n    <servlet-name>jsp</servlet-name>\n    <url-pattern>*.jsp</url-pattern>\n    <url-pattern>*.jspx</url-pattern>\n  </servlet-mapping>\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/conf/web.xml\n\nInside the <web-app> parent node, add the following:\n\n<servlet-mapping>\n    <servlet-name>jsp</servlet-name>\n    <url-pattern>*.jsp</url-pattern>\n    <url-pattern>*.jspx</url-pattern>\n  </servlet-mapping>\"\n\n  list = [\"*.jsp\", \"*.jspx\"]\n  describe xml('/usr/lib/vmware-perfcharts/tc-instance/conf/web.xml') do\n    its('/web-app/servlet-mapping[servlet-name=\"jsp\"]/url-pattern') { should be_in list }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000012.rb",
        "line": 1
      },
      "id": "VCPF-67-000012"
    },
    {
      "title": "Performance Charts must set URIEncoding to UTF-8.",
      "desc": "Invalid user input occurs when a user inserts data or characters into\na hosted application's data entry field and the hosted application is\nunprepared to process that data. This results in unanticipated application\nbehavior, potentially leading to an application compromise. Invalid user input\nis one of the primary methods employed when attempting to compromise an\napplication.\n\n    An attacker can also enter Unicode characters into hosted applications in\nan effort to break out of the document home or root home directory or to bypass\nsecurity checks. Performance Charts must be configured to use a consistent\ncharacter set via the URIEncoding attribute on the Connector nodes.",
      "descriptions": {
        "default": "Invalid user input occurs when a user inserts data or characters into\na hosted application's data entry field and the hosted application is\nunprepared to process that data. This results in unanticipated application\nbehavior, potentially leading to an application compromise. Invalid user input\nis one of the primary methods employed when attempting to compromise an\napplication.\n\n    An attacker can also enter Unicode characters into hosted applications in\nan effort to break out of the document home or root home directory or to bypass\nsecurity checks. Performance Charts must be configured to use a consistent\ncharacter set via the URIEncoding attribute on the Connector nodes.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --xpath '/Server/Service/Connector/@URIEncoding'\n/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nExpected result:\n\nURIEncoding=\"UTF-8\"\n\nIf the output does not match the expected result, this is a finding",
        "fix": "Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nConfigure the <Connector> node with the value 'URIEncoding=\"UTF-8\"'."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000251-WSR-000157",
        "gid": null,
        "rid": "VCPF-67-000019",
        "stig_id": "VCPF-67-000019",
        "cci": "CCI-001310",
        "nist": [
          "SI-10",
          "Rev_4"
        ]
      },
      "code": "control \"VCPF-67-000019\" do\n  title \"Performance Charts must set URIEncoding to UTF-8.\"\n  desc  \"Invalid user input occurs when a user inserts data or characters into\na hosted application's data entry field and the hosted application is\nunprepared to process that data. This results in unanticipated application\nbehavior, potentially leading to an application compromise. Invalid user input\nis one of the primary methods employed when attempting to compromise an\napplication.\n\n    An attacker can also enter Unicode characters into hosted applications in\nan effort to break out of the document home or root home directory or to bypass\nsecurity checks. Performance Charts must be configured to use a consistent\ncharacter set via the URIEncoding attribute on the Connector nodes.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000251-WSR-000157\"\n  tag gid: nil\n  tag rid: \"VCPF-67-000019\"\n  tag stig_id: \"VCPF-67-000019\"\n  tag cci: \"CCI-001310\"\n  tag nist: [\"SI-10\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --xpath '/Server/Service/Connector/@URIEncoding'\n/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nExpected result:\n\nURIEncoding=\\\"UTF-8\\\"\n\nIf the output does not match the expected result, this is a finding\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nConfigure the <Connector> node with the value 'URIEncoding=\\\"UTF-8\\\"'.\"\n\n  describe xml('/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml') do\n    its(['Server/Service/Connector/@URIEncoding']) { should cmp 'UTF-8'}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000019.rb",
        "line": 1
      },
      "id": "VCPF-67-000019"
    },
    {
      "title": "Performance Charts must to limit the number of allowed connections.",
      "desc": "Limiting the number of established connections to Performance Charts\nis a basic DoS protection. Servers where the limit is too high or unlimited can\npotentially run out of system resources and negatively affect system\navailability.",
      "descriptions": {
        "default": "Limiting the number of established connections to Performance Charts\nis a basic DoS protection. Servers where the limit is too high or unlimited can\npotentially run out of system resources and negatively affect system\navailability.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --xpath '/Server/Service/Connector/@acceptCount'\n/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nExpected result:\n\nacceptCount=\"300\"\n\nIf the output does not match the expected result, this is a finding",
        "fix": "Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nConfigure the <Connector> node with the value:\n\nacceptCount=\"300\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000246-WSR-000149",
        "gid": null,
        "rid": "VCPF-67-000018",
        "stig_id": "VCPF-67-000018",
        "cci": "CCI-001094",
        "nist": [
          "SC-5 (1)",
          "Rev_4"
        ]
      },
      "code": "control \"VCPF-67-000018\" do\n  title \"Performance Charts must to limit the number of allowed connections.\"\n  desc  \"Limiting the number of established connections to Performance Charts\nis a basic DoS protection. Servers where the limit is too high or unlimited can\npotentially run out of system resources and negatively affect system\navailability.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000246-WSR-000149\"\n  tag gid: nil\n  tag rid: \"VCPF-67-000018\"\n  tag stig_id: \"VCPF-67-000018\"\n  tag cci: \"CCI-001094\"\n  tag nist: [\"SC-5 (1)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --xpath '/Server/Service/Connector/@acceptCount'\n/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nExpected result:\n\nacceptCount=\\\"300\\\"\n\nIf the output does not match the expected result, this is a finding\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nConfigure the <Connector> node with the value:\n\nacceptCount=\\\"300\\\"\"\n\n  describe xml('/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml') do\n    its(['Server/Service/Connector/@acceptCount']) { should cmp '300'}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000018.rb",
        "line": 1
      },
      "id": "VCPF-67-000018"
    },
    {
      "title": "Performance Charts must be configured with memory leak protection.",
      "desc": "The Java Runtime environment can cause a memory leak or lock files\nunder certain conditions. Without memory leak protection, Performance Chart can\ncontinue to consume system resources which will lead to OutOfMemoryErrors when\nre-loading web applications.\n\n    Memory leaks occur when JRE code uses the context class loader to load a\nsingleton as this will cause a memory leak if a web application class loader\nhappens to be the context class loader at the time. The\nJreMemoryLeakPreventionListener class is designed to initialise these\nsingletons when Tomcat's common class loader is the context class loader.\nProper use of JRE memory leak protection will ensure that the hosted\napplication does not consume system resources and cause an unstable environment.",
      "descriptions": {
        "default": "The Java Runtime environment can cause a memory leak or lock files\nunder certain conditions. Without memory leak protection, Performance Chart can\ncontinue to consume system resources which will lead to OutOfMemoryErrors when\nre-loading web applications.\n\n    Memory leaks occur when JRE code uses the context class loader to load a\nsingleton as this will cause a memory leak if a web application class loader\nhappens to be the context class loader at the time. The\nJreMemoryLeakPreventionListener class is designed to initialise these\nsingletons when Tomcat's common class loader is the context class loader.\nProper use of JRE memory leak protection will ensure that the hosted\napplication does not consume system resources and cause an unstable environment.",
        "check": "At the command prompt, execute the following command:\n\n# grep JreMemoryLeakPreventionListener\n/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nExpected result:\n\n<Listener\nclassName=\"org.apache.catalina.core.JreMemoryLeakPreventionListener\"/>\n\nIf the output of the command does not match the expected result, this is a\nfinding",
        "fix": "Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nNavigate to the <Server> node.\n\nAdd '<Listener\nclassName=\"org.apache.catalina.core.JreMemoryLeakPreventionListener\"/>' to\nthe <Server> node."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000141-WSR-000086",
        "gid": null,
        "rid": "VCPF-67-000014",
        "stig_id": "VCPF-67-000014",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCPF-67-000014\" do\n  title \"Performance Charts must be configured with memory leak protection.\"\n  desc  \"The Java Runtime environment can cause a memory leak or lock files\nunder certain conditions. Without memory leak protection, Performance Chart can\ncontinue to consume system resources which will lead to OutOfMemoryErrors when\nre-loading web applications.\n\n    Memory leaks occur when JRE code uses the context class loader to load a\nsingleton as this will cause a memory leak if a web application class loader\nhappens to be the context class loader at the time. The\nJreMemoryLeakPreventionListener class is designed to initialise these\nsingletons when Tomcat's common class loader is the context class loader.\nProper use of JRE memory leak protection will ensure that the hosted\napplication does not consume system resources and cause an unstable environment.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000141-WSR-000086\"\n  tag gid: nil\n  tag rid: \"VCPF-67-000014\"\n  tag stig_id: \"VCPF-67-000014\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep JreMemoryLeakPreventionListener\n/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nExpected result:\n\n<Listener\nclassName=\\\"org.apache.catalina.core.JreMemoryLeakPreventionListener\\\"/>\n\nIf the output of the command does not match the expected result, this is a\nfinding\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nNavigate to the <Server> node.\n\nAdd '<Listener\nclassName=\\\"org.apache.catalina.core.JreMemoryLeakPreventionListener\\\"/>' to\nthe <Server> node.\"\n\n  describe xml('/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml') do\n    its('Server/Listener/attribute::className') { should include 'org.apache.catalina.core.JreMemoryLeakPreventionListener' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000014.rb",
        "line": 1
      },
      "id": "VCPF-67-000014"
    },
    {
      "title": "Performance Charts must disable the shutdown port.",
      "desc": "An attacker has at least two reasons to stop a web server. The first\nis to cause a DoS, and the second is to put in place changes the attacker made\nto the web server configuration. If the Tomcat shutdown port feature is\nenabled, a shutdown signal can be sent to Performance Chart through this port.\nTo ensure availability, the shutdown port must be disabled.",
      "descriptions": {
        "default": "An attacker has at least two reasons to stop a web server. The first\nis to cause a DoS, and the second is to put in place changes the attacker made\nto the web server configuration. If the Tomcat shutdown port feature is\nenabled, a shutdown signal can be sent to Performance Chart through this port.\nTo ensure availability, the shutdown port must be disabled.",
        "check": "At the command prompt, execute the following command:\n\n# grep base.shutdown.port\n/usr/lib/vmware-perfcharts/tc-instance/conf/catalina.properties\n\nExpected result:\n\nbase.shutdown.port=-1\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open /etc/vmware-eam/catalina.properties\n\nNavigate to the ports specification section.\n\nAdd or modify the following line:\n\nbase.shutdown.port=-1"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000435-WSR-000147",
        "gid": null,
        "rid": "VCPF-67-000029",
        "stig_id": "VCPF-67-000029",
        "cci": "CCI-002385",
        "nist": [
          "SC-5",
          "Rev_4"
        ]
      },
      "code": "control \"VCPF-67-000029\" do\n  title \"Performance Charts must disable the shutdown port.\"\n  desc  \"An attacker has at least two reasons to stop a web server. The first\nis to cause a DoS, and the second is to put in place changes the attacker made\nto the web server configuration. If the Tomcat shutdown port feature is\nenabled, a shutdown signal can be sent to Performance Chart through this port.\nTo ensure availability, the shutdown port must be disabled.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000435-WSR-000147\"\n  tag gid: nil\n  tag rid: \"VCPF-67-000029\"\n  tag stig_id: \"VCPF-67-000029\"\n  tag cci: \"CCI-002385\"\n  tag nist: [\"SC-5\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep base.shutdown.port\n/usr/lib/vmware-perfcharts/tc-instance/conf/catalina.properties\n\nExpected result:\n\nbase.shutdown.port=-1\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open /etc/vmware-eam/catalina.properties\n\nNavigate to the ports specification section.\n\nAdd or modify the following line:\n\nbase.shutdown.port=-1\"\n\n  describe parse_config_file('/usr/lib/vmware-perfcharts/tc-instance/conf/catalina.properties').params['base.shutdown.port'] do\n    it { should eq '-1' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000029.rb",
        "line": 1
      },
      "id": "VCPF-67-000029"
    },
    {
      "title": "Performance Charts must have Multipurpose Internet Mail Extensions\n(MIME) that invoke OS shell programs disabled.",
      "desc": "MIME mappings tell the Performance Charts what type of program various\nfile types and extensions are and what external utilities or programs are\nneeded to execute the file type. By ensuring that various shell script\nMIME types are not included in web.xml, the server is protected against\nmalicious users tricking the server into executing shell command files.",
      "descriptions": {
        "default": "MIME mappings tell the Performance Charts what type of program various\nfile types and extensions are and what external utilities or programs are\nneeded to execute the file type. By ensuring that various shell script\nMIME types are not included in web.xml, the server is protected against\nmalicious users tricking the server into executing shell command files.",
        "check": "At the command prompt, execute the following command:\n\n# grep -En '(x-csh<)|(x-sh<)|(x-shar<)|(x-ksh<)'\n/usr/lib/vmware-perfcharts/tc-instance/conf/web.xml\n\nIf the command produces any output, this is a finding.",
        "fix": "Open /usr/lib/vmware-perfcharts/tc-instance/conf/web.xml in a text\neditor. Remove any and all of the following nodes lines.\n\n<mime-type>application/x-csh</mime-type>\n<mime-type>application/x-shar</mime-type>\n<mime-type>application/x-sh</mime-type>\n<mime-type>application/x-ksh</mime-type>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000141-WSR-000081",
        "gid": null,
        "rid": "VCPF-67-000011",
        "stig_id": "VCPF-67-000011",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCPF-67-000011\" do\n  title \"Performance Charts must have Multipurpose Internet Mail Extensions\n(MIME) that invoke OS shell programs disabled.\"\n  desc  \"MIME mappings tell the Performance Charts what type of program various\nfile types and extensions are and what external utilities or programs are\nneeded to execute the file type. By ensuring that various shell script\nMIME types are not included in web.xml, the server is protected against\nmalicious users tricking the server into executing shell command files.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000141-WSR-000081\"\n  tag gid: nil\n  tag rid: \"VCPF-67-000011\"\n  tag stig_id: \"VCPF-67-000011\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep -En '(x-csh<)|(x-sh<)|(x-shar<)|(x-ksh<)'\n/usr/lib/vmware-perfcharts/tc-instance/conf/web.xml\n\nIf the command produces any output, this is a finding.\"\n  desc 'fix', \"Open /usr/lib/vmware-perfcharts/tc-instance/conf/web.xml in a text\neditor. Remove any and all of the following nodes lines.\n\n<mime-type>application/x-csh</mime-type>\n<mime-type>application/x-shar</mime-type>\n<mime-type>application/x-sh</mime-type>\n<mime-type>application/x-ksh</mime-type>\"\n\n  describe command('grep -En \\'(x-csh<)|(x-sh<)|(x-shar<)|(x-ksh<)\\' /usr/lib/vmware-perfcharts/tc-instance/conf/web.xml') do\n    its ('stdout.strip') { should eq '' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000011.rb",
        "line": 1
      },
      "id": "VCPF-67-000011"
    },
    {
      "title": "Performance Charts must only run one webapp.",
      "desc": "VMware ships Performance Charts on the VCSA with one webapp. Any other\npath is potentially malicious and must be removed.",
      "descriptions": {
        "default": "VMware ships Performance Charts on the VCSA with one webapp. Any other\npath is potentially malicious and must be removed.",
        "check": "At the command prompt, execute the following command:\n\n# ls -A /usr/lib/vmware-perfcharts/tc-instance/webapps\n\nExpected result:\n\nstatsreport\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "For each unexpected directory returned in the check, run the\nfollowing command:\n\n# rm /usr/lib/vmware-sso/vmware-sts/webapps/<NAME>\n\nRestart the service with the following command:\n\n# service-control --restart vmware-perfcharts"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000131-WSR-000073",
        "gid": null,
        "rid": "VCPF-67-000009",
        "stig_id": "VCPF-67-000009",
        "cci": "CCI-001749",
        "nist": [
          "CM-5 (3)",
          "Rev_4"
        ]
      },
      "code": "control \"VCPF-67-000009\" do\n  title \"Performance Charts must only run one webapp.\"\n  desc  \"VMware ships Performance Charts on the VCSA with one webapp. Any other\npath is potentially malicious and must be removed.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000131-WSR-000073\"\n  tag gid: nil\n  tag rid: \"VCPF-67-000009\"\n  tag stig_id: \"VCPF-67-000009\"\n  tag cci: \"CCI-001749\"\n  tag nist: [\"CM-5 (3)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# ls -A /usr/lib/vmware-perfcharts/tc-instance/webapps\n\nExpected result:\n\nstatsreport\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"For each unexpected directory returned in the check, run the\nfollowing command:\n\n# rm /usr/lib/vmware-sso/vmware-sts/webapps/<NAME>\n\nRestart the service with the following command:\n\n# service-control --restart vmware-perfcharts\"\n\n  describe command('ls -A /usr/lib/vmware-perfcharts/tc-instance/webapps') do\n    its ('stdout.strip') { should eq 'statsreport' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000009.rb",
        "line": 1
      },
      "id": "VCPF-67-000009"
    },
    {
      "title": "Performance Charts must limit the maximum size of a POST request.",
      "desc": "The 'maxPostSize' value is the maximum size in bytes of the POST which\nwill be handled by the container FORM URL parameter parsing. Limit its size to\nreduce exposure to a DOS attack. If 'maxPostSize' is not set, the default value\nof 2097152 (2MB) is used. Performance Charts is configured in it's shipping\nstate to not set a value for 'maxPostSize'.",
      "descriptions": {
        "default": "The 'maxPostSize' value is the maximum size in bytes of the POST which\nwill be handled by the container FORM URL parameter parsing. Limit its size to\nreduce exposure to a DOS attack. If 'maxPostSize' is not set, the default value\nof 2097152 (2MB) is used. Performance Charts is configured in it's shipping\nstate to not set a value for 'maxPostSize'.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --xpath '/Server/Service/Connector/@maxPostSize'\n/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nExpected result:\n\nXPath set is empty\n\nIf the output does not match the expected result, this is a finding",
        "fix": "Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nNavigate to each of the <Connector> nodes.\n\nRemove any configuration for 'maxPostSize'."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000001-WSR-000001",
        "gid": null,
        "rid": "VCPF-67-000003",
        "stig_id": "VCPF-67-000003",
        "cci": "CCI-000054",
        "nist": [
          "AC-10",
          "Rev_4"
        ]
      },
      "code": "control \"VCPF-67-000003\" do\n  title \"Performance Charts must limit the maximum size of a POST request.\"\n  desc  \"The 'maxPostSize' value is the maximum size in bytes of the POST which\nwill be handled by the container FORM URL parameter parsing. Limit its size to\nreduce exposure to a DOS attack. If 'maxPostSize' is not set, the default value\nof 2097152 (2MB) is used. Performance Charts is configured in it's shipping\nstate to not set a value for 'maxPostSize'.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000001-WSR-000001\"\n  tag gid: nil\n  tag rid: \"VCPF-67-000003\"\n  tag stig_id: \"VCPF-67-000003\"\n  tag cci: \"CCI-000054\"\n  tag nist: [\"AC-10\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --xpath '/Server/Service/Connector/@maxPostSize'\n/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nExpected result:\n\nXPath set is empty\n\nIf the output does not match the expected result, this is a finding\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nNavigate to each of the <Connector> nodes.\n\nRemove any configuration for 'maxPostSize'.\"\n\n  describe xml('/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml') do\n    its('Server/Service/Connector/attribute::maxPostSize') { should eq [] }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000003.rb",
        "line": 1
      },
      "id": "VCPF-67-000003"
    },
    {
      "title": "Performance Charts must fail to a known safe state if system\ninitialization fails, shutdown fails, or aborts fail.",
      "desc": "Determining a safe state for failure and weighing that against a\npotential DoS for users depends on what type of application the web server is\nhosting. For Performance Charts, it is preferable that the service abort\nstartup on any initialization failure rather than continuing in a degraded, and\npotentailly insecure, state.",
      "descriptions": {
        "default": "Determining a safe state for failure and weighing that against a\npotential DoS for users depends on what type of application the web server is\nhosting. For Performance Charts, it is preferable that the service abort\nstartup on any initialization failure rather than continuing in a degraded, and\npotentailly insecure, state.",
        "check": "At the command line, execute the following command:\n\n# grep EXIT_ON_INIT_FAILURE\n/usr/lib/vmware-perfcharts/tc-instance/conf/catalina.properties\n\nExpected result:\n\norg.apache.catalina.startup.EXIT_ON_INIT_FAILURE = true\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/conf/catalina.properties\n\nAdd or change the following line:\n\norg.apache.catalina.startup.EXIT_ON_INIT_FAILURE=true"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000225-WSR-000140",
        "gid": null,
        "rid": "VCPF-67-000017",
        "stig_id": "VCPF-67-000017",
        "cci": "CCI-001190",
        "nist": [
          "SC-24",
          "Rev_4"
        ]
      },
      "code": "control \"VCPF-67-000017\" do\n  title \"Performance Charts must fail to a known safe state if system\ninitialization fails, shutdown fails, or aborts fail.\"\n  desc  \"Determining a safe state for failure and weighing that against a\npotential DoS for users depends on what type of application the web server is\nhosting. For Performance Charts, it is preferable that the service abort\nstartup on any initialization failure rather than continuing in a degraded, and\npotentailly insecure, state.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000225-WSR-000140\"\n  tag gid: nil\n  tag rid: \"VCPF-67-000017\"\n  tag stig_id: \"VCPF-67-000017\"\n  tag cci: \"CCI-001190\"\n  tag nist: [\"SC-24\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep EXIT_ON_INIT_FAILURE\n/usr/lib/vmware-perfcharts/tc-instance/conf/catalina.properties\n\nExpected result:\n\norg.apache.catalina.startup.EXIT_ON_INIT_FAILURE = true\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/conf/catalina.properties\n\nAdd or change the following line:\n\norg.apache.catalina.startup.EXIT_ON_INIT_FAILURE=true\"\n\n  describe parse_config_file('/usr/lib/vmware-perfcharts/tc-instance/conf/catalina.properties').params['org.apache.catalina.startup.EXIT_ON_INIT_FAILURE'] do\n    it { should eq 'true' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000017.rb",
        "line": 1
      },
      "id": "VCPF-67-000017"
    },
    {
      "title": "Performance Charts directory tree must have permissions in an \"out of\nthe box\" state.",
      "desc": "As a rule, accounts on a web server are to be kept to a minimum. Only\nadministrators, web managers, developers, auditors, and web authors require\naccounts on the machine hosting the web server. The resources to which these\naccounts have access must also be closely monitored and controlled. Performance\nCharts files must be adequately protected with correct permissions as applied\n\"out of the box\".",
      "descriptions": {
        "default": "As a rule, accounts on a web server are to be kept to a minimum. Only\nadministrators, web managers, developers, auditors, and web authors require\naccounts on the machine hosting the web server. The resources to which these\naccounts have access must also be closely monitored and controlled. Performance\nCharts files must be adequately protected with correct permissions as applied\n\"out of the box\".",
        "check": "At the command prompt, execute the following command:\n\n# find /usr/lib/vmware-perfcharts/tc-instance/webapps/ -xdev -type f -a '('\n-not -user perfcharts -o -not -group cis ')' -exec ls -A {} \\;\n\nExpected result:\n\n/usr/lib/vmware-perfcharts/tc-instance/webapps/statsreport/WEB-INF/web.xml\n\nIf the command does not produce output, this is NOT a finding. If the output of\nthe command does not match the expected result, this is a finding.",
        "fix": "At the command prompt, execute the following command:\n\n# chown perfcharts:cis <file_name>\n\nRepeat the command for each file that was returned\n\nNote: Replace <file_name> for the name of the file that was returned."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000211-WSR-000030",
        "gid": null,
        "rid": "VCPF-67-000016",
        "stig_id": "VCPF-67-000016",
        "cci": "CCI-001082",
        "nist": [
          "SC-2",
          "Rev_4"
        ]
      },
      "code": "control \"VCPF-67-000016\" do\n  title \"Performance Charts directory tree must have permissions in an \\\"out of\nthe box\\\" state.\"\n  desc  \"As a rule, accounts on a web server are to be kept to a minimum. Only\nadministrators, web managers, developers, auditors, and web authors require\naccounts on the machine hosting the web server. The resources to which these\naccounts have access must also be closely monitored and controlled. Performance\nCharts files must be adequately protected with correct permissions as applied\n\\\"out of the box\\\".\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000211-WSR-000030\"\n  tag gid: nil\n  tag rid: \"VCPF-67-000016\"\n  tag stig_id: \"VCPF-67-000016\"\n  tag cci: \"CCI-001082\"\n  tag nist: [\"SC-2\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# find /usr/lib/vmware-perfcharts/tc-instance/webapps/ -xdev -type f -a '('\n-not -user perfcharts -o -not -group cis ')' -exec ls -A {} \\\\;\n\nExpected result:\n\n/usr/lib/vmware-perfcharts/tc-instance/webapps/statsreport/WEB-INF/web.xml\n\nIf the command does not produce output, this is NOT a finding. If the output of\nthe command does not match the expected result, this is a finding.\"\n  desc 'fix', \"At the command prompt, execute the following command:\n\n# chown perfcharts:cis <file_name>\n\nRepeat the command for each file that was returned\n\nNote: Replace <file_name> for the name of the file that was returned.\n\"\n\n  describe command('find /usr/lib/vmware-perfcharts/tc-instance/webapps/ -xdev -type f -a \\'(\\' -not -user perfcharts -o -not -group cis \\')\\' -exec ls -A {} \\;') do\n   its('stdout.strip') { should eq '/usr/lib/vmware-perfcharts/tc-instance/webapps/statsreport/WEB-INF/web.xml'}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000016.rb",
        "line": 1
      },
      "id": "VCPF-67-000016"
    },
    {
      "title": "Performance Charts must not have any symbolic links in the web content\ndirectory tree.",
      "desc": "A web server is designed to deliver content and execute scripts or\napplications on the request of a client or user. Containing user requests to\nfiles in the directory tree of the hosted web application and limiting the\nexecution of scripts and applications guarantees that the user is not accessing\ninformation protected outside the application's realm. By checking that no\nsymbolic links exist in the document root, the web server is protected from\nusers jumping outside the hosted application directory tree and gaining access\nto the other directories, including the system root.",
      "descriptions": {
        "default": "A web server is designed to deliver content and execute scripts or\napplications on the request of a client or user. Containing user requests to\nfiles in the directory tree of the hosted web application and limiting the\nexecution of scripts and applications guarantees that the user is not accessing\ninformation protected outside the application's realm. By checking that no\nsymbolic links exist in the document root, the web server is protected from\nusers jumping outside the hosted application directory tree and gaining access\nto the other directories, including the system root.",
        "check": "At the command prompt, execute the following command:\n\n# find /usr/lib/vmware-perfcharts/tc-instance/webapps/ -type l -ls\n\nIf the command produces any output, this is a finding.",
        "fix": "At the command prompt, execute the following commands:\n\nNote: Replace <file_name> for the name of any files that were returned.\n\n# unlink <file_name>\n\nRepeat the commands for each file that was returned."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000141-WSR-000087",
        "gid": null,
        "rid": "VCPF-67-000015",
        "stig_id": "VCPF-67-000015",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCPF-67-000015\" do\n  title \"Performance Charts must not have any symbolic links in the web content\ndirectory tree.\"\n  desc  \"A web server is designed to deliver content and execute scripts or\napplications on the request of a client or user. Containing user requests to\nfiles in the directory tree of the hosted web application and limiting the\nexecution of scripts and applications guarantees that the user is not accessing\ninformation protected outside the application's realm. By checking that no\nsymbolic links exist in the document root, the web server is protected from\nusers jumping outside the hosted application directory tree and gaining access\nto the other directories, including the system root.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000141-WSR-000087\"\n  tag gid: nil\n  tag rid: \"VCPF-67-000015\"\n  tag stig_id: \"VCPF-67-000015\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# find /usr/lib/vmware-perfcharts/tc-instance/webapps/ -type l -ls\n\nIf the command produces any output, this is a finding.\"\n  desc 'fix', \"At the command prompt, execute the following commands:\n\nNote: Replace <file_name> for the name of any files that were returned.\n\n# unlink <file_name>\n\nRepeat the commands for each file that was returned.\"\n\n  describe command('find /usr/lib/vmware-perfcharts/tc-instance/webapps/ -type l -ls') do\n    its ('stdout.strip') { should eq '' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000015.rb",
        "line": 1
      },
      "id": "VCPF-67-000015"
    },
    {
      "title": "Performance Charts must record user access in a format that enables\nmonitoring of remote access.",
      "desc": "Remote access can be exploited by an attacker to compromise the\nserver.  By recording all remote access activities, it will be possible to\ndetermine the attacker's location, intent, and degree of success.\n\n    Tomcat can be configured with an AccessLogValve, a component that can be\ninserted into the request processing pipeline to provide robust access logging.\nThe Access Log Valve creates log files in the same format as those created by\nstandard web servers. When AccessLogValve is properly configured, log files\nwill contain all the forensic information necessary in the case of a security\nincident.",
      "descriptions": {
        "default": "Remote access can be exploited by an attacker to compromise the\nserver.  By recording all remote access activities, it will be possible to\ndetermine the attacker's location, intent, and degree of success.\n\n    Tomcat can be configured with an AccessLogValve, a component that can be\ninserted into the request processing pipeline to provide robust access logging.\nThe Access Log Valve creates log files in the same format as those created by\nstandard web servers. When AccessLogValve is properly configured, log files\nwill contain all the forensic information necessary in the case of a security\nincident.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-perfcharts/tc-instance/conf/server.xml | sed\n'2 s/xmlns=\".*\"//g' |  xmllint --xpath\n'/Server/Service/Engine/Host/Valve[@className=\"org.apache.catalina.valves.AccessLogValve\"]'/@pattern\n-\n\nExpected result:\n\npattern=\"%h %{X-Forwarded-For}i %l %u %t &quot;%r&quot; %s %b\n&quot;%{User-Agent}i&quot;\" resolveHosts=\"false\"\nprefix=\"localhost_access_log\" suffix=\".txt\" />\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nConfigure the <Host> node with the two nodes below.\n\n<Valve className=\"org.apache.catalina.valves.RemoteIpValve\"\nhttpServerPort=\"80\"\nhttpsServerPort=\"443protocolHeader=\"x-forwarded-proto\"\nproxiesHeader=\"x-forwarded-by\"\nremoteIpHeader=\"x-forwarded-for\"\nrequestAttributesEnabled=\"true\"\ninternalProxies=\"127\\.0\\.0\\.1\"/>\n\n<Valve className=\"org.apache.catalina.valves.AccessLogValve\"\ndirectory=\"${vim.logdir}\"\npattern=\"%h %{X-Forwarded-For}i %l %u %t &quot;%r&quot; %s %b &quot;%{User-Agent}i&quot;\"\nresolveHosts=\"false\"\nprefix=\"localhost_access_log\"\nsuffix=\".txt\"/>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000016-WSR-000005",
        "gid": null,
        "rid": "VCPF-67-000005",
        "stig_id": "VCPF-67-000005",
        "cci": "CCI-000067",
        "nist": [
          "AC-17 (1)",
          "Rev_4"
        ]
      },
      "code": "control \"VCPF-67-000005\" do\n  title \"Performance Charts must record user access in a format that enables\nmonitoring of remote access.\"\n  desc  \"Remote access can be exploited by an attacker to compromise the\nserver.  By recording all remote access activities, it will be possible to\ndetermine the attacker's location, intent, and degree of success.\n\n    Tomcat can be configured with an AccessLogValve, a component that can be\ninserted into the request processing pipeline to provide robust access logging.\nThe Access Log Valve creates log files in the same format as those created by\nstandard web servers. When AccessLogValve is properly configured, log files\nwill contain all the forensic information necessary in the case of a security\nincident.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000016-WSR-000005\"\n  tag gid: nil\n  tag rid: \"VCPF-67-000005\"\n  tag stig_id: \"VCPF-67-000005\"\n  tag cci: \"CCI-000067\"\n  tag nist: [\"AC-17 (1)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-perfcharts/tc-instance/conf/server.xml | sed\n'2 s/xmlns=\\\".*\\\"//g' |  xmllint --xpath\n'/Server/Service/Engine/Host/Valve[@className=\\\"org.apache.catalina.valves.AccessLogValve\\\"]'/@pattern\n-\n\nExpected result:\n\npattern=\\\"%h %{X-Forwarded-For}i %l %u %t &quot;%r&quot; %s %b\n&quot;%{User-Agent}i&quot;\\\" resolveHosts=\\\"false\\\"\nprefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\" />\n\nIf the output does not match the expected result, this is a finding.\n\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nConfigure the <Host> node with the two nodes below.\n\n<Valve className=\\\"org.apache.catalina.valves.RemoteIpValve\\\"\nhttpServerPort=\\\"80\\\"\nhttpsServerPort=\\\"443\\\nprotocolHeader=\\\"x-forwarded-proto\\\"\nproxiesHeader=\\\"x-forwarded-by\\\"\nremoteIpHeader=\\\"x-forwarded-for\\\"\nrequestAttributesEnabled=\\\"true\\\"\ninternalProxies=\\\"127\\\\.0\\\\.0\\\\.1\\\"/>\n\n<Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\"\ndirectory=\\\"${vim.logdir}\\\"\npattern=\\\"%h %{X-Forwarded-For}i %l %u %t &quot;%r&quot; %s %b &quot;%{User-Agent}i&quot;\\\"\nresolveHosts=\\\"false\\\"\nprefix=\\\"localhost_access_log\\\"\nsuffix=\\\".txt\\\"/>\"\n\n  describe xml('/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml') do\n    its(['Server/Service/Engine/Host/Valve[@className=\"org.apache.catalina.valves.AccessLogValve\"]/@pattern']) { should cmp ['%h %{X-Forwarded-For}i %l %u %t &quot;%r&quot; %s %b &quot;%{User-Agent}i&quot;'] }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000005.rb",
        "line": 1
      },
      "id": "VCPF-67-000005"
    },
    {
      "title": "Performance Charts must use the setCharacterEncodingFilter filter.",
      "desc": "Invalid user input occurs when a user inserts data or characters into\na hosted application's data entry field and the hosted application is\nunprepared to process that data. This results in unanticipated application\nbehavior, potentially leading to an application compromise. Invalid user input\nis one of the primary methods employed when attempting to compromise an\napplication.\n\n    An attacker can also enter Unicode characters into hosted applications in\nan effort to break out of the document home or root home directory or to bypass\nsecurity checks. VMware utilizes the standard Tomcat SetCharacterEncodingFilter\nto provide a layer of defense against character encoding attacks. Filters are\nJava objects that performs filtering tasks on either the request to a resource\n(a servlet or static content), or on the response from a resource, or both.",
      "descriptions": {
        "default": "Invalid user input occurs when a user inserts data or characters into\na hosted application's data entry field and the hosted application is\nunprepared to process that data. This results in unanticipated application\nbehavior, potentially leading to an application compromise. Invalid user input\nis one of the primary methods employed when attempting to compromise an\napplication.\n\n    An attacker can also enter Unicode characters into hosted applications in\nan effort to break out of the document home or root home directory or to bypass\nsecurity checks. VMware utilizes the standard Tomcat SetCharacterEncodingFilter\nto provide a layer of defense against character encoding attacks. Filters are\nJava objects that performs filtering tasks on either the request to a resource\n(a servlet or static content), or on the response from a resource, or both.",
        "check": "At the command prompt, execute the following command:\n\n#  xmllint --format /usr/lib/vmware-perfcharts/tc-instance/conf/web.xml | sed\n'2 s/xmlns=\".*\"//g' | xmllint --xpath\n'/web-app/filter-mapping/filter-name[text()=\"setCharacterEncodingFilter\"]/parent::filter-mapping'\n-\n\nExpected result:\n\n<filter-mapping>\n    <filter-name>setCharacterEncodingFilter</filter-name>\n    <url-pattern>/*</url-pattern>\n</filter-mapping>\n\nIf the output is does not match the expected result, this is a finding.\n\nAt the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-perfcharts/tc-instance/conf/web.xml | sed '2\ns/xmlns=\".*\"//g' | xmllint --xpath\n'/web-app/filter/filter-name[text()=\"setCharacterEncodingFilter\"]/parent::filter'\n-\n\nExpected result:\n\n<filter>\n  <filter-name>setCharacterEncodingFilter</filter-name>\n  <filter-class>org.apache.catalina.filters.SetCharacterEncodingFilter</filter-class>\n  <init-param>\n    <param-name>encoding</param-name>\n    <param-value>UTF-8</param-value>\n\t</init-param>\n\t<init-param>\n    <param-name>ignore</param-name>\n    <param-value>false</param-value>\n  </init-param>\n\t<async-supported>true</async-supported>\n</filter>\n\nIf the output is does not match the expected result, this is a finding.",
        "fix": "Open /usr/lib/vmware-perfcharts/tc-instance/conf/web.xml in a text\neditor.\n\nConfigure the <web-app> node with the child nodes listed below.\n\n<filter-mapping>\n    <filter-name>setCharacterEncodingFilter</filter-name>\n    <url-pattern>/*</url-pattern>\n</filter-mapping>\n\n<filter>\n  <filter-name>setCharacterEncodingFilter</filter-name>\n  <filter-class>org.apache.catalina.filters.SetCharacterEncodingFilter</filter-class>\n  <init-param>\n    <param-name>encoding</param-name>\n    <param-value>UTF-8</param-value>\n\t</init-param>\n\t<init-param>\n    <param-name>ignore</param-name>\n    <param-value>false</param-value>\n  </init-param>\n\t<async-supported>true</async-supported>\n</filter>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000251-WSR-000157",
        "gid": null,
        "rid": "VCPF-67-000020",
        "stig_id": "VCPF-67-000020",
        "cci": "CCI-001310",
        "nist": [
          "SI-10",
          "Rev_4"
        ]
      },
      "code": "control \"VCPF-67-000020\" do\n  title \"Performance Charts must use the setCharacterEncodingFilter filter.\"\n  desc  \"Invalid user input occurs when a user inserts data or characters into\na hosted application's data entry field and the hosted application is\nunprepared to process that data. This results in unanticipated application\nbehavior, potentially leading to an application compromise. Invalid user input\nis one of the primary methods employed when attempting to compromise an\napplication.\n\n    An attacker can also enter Unicode characters into hosted applications in\nan effort to break out of the document home or root home directory or to bypass\nsecurity checks. VMware utilizes the standard Tomcat SetCharacterEncodingFilter\nto provide a layer of defense against character encoding attacks. Filters are\nJava objects that performs filtering tasks on either the request to a resource\n(a servlet or static content), or on the response from a resource, or both.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000251-WSR-000157\"\n  tag gid: nil\n  tag rid: \"VCPF-67-000020\"\n  tag stig_id: \"VCPF-67-000020\"\n  tag cci: \"CCI-001310\"\n  tag nist: [\"SI-10\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n#  xmllint --format /usr/lib/vmware-perfcharts/tc-instance/conf/web.xml | sed\n'2 s/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'/web-app/filter-mapping/filter-name[text()=\\\"setCharacterEncodingFilter\\\"]/parent::filter-mapping'\n-\n\nExpected result:\n\n<filter-mapping>\n    <filter-name>setCharacterEncodingFilter</filter-name>\n    <url-pattern>/*</url-pattern>\n</filter-mapping>\n\nIf the output is does not match the expected result, this is a finding.\n\nAt the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-perfcharts/tc-instance/conf/web.xml | sed '2\ns/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'/web-app/filter/filter-name[text()=\\\"setCharacterEncodingFilter\\\"]/parent::filter'\n-\n\nExpected result:\n\n<filter>\n  <filter-name>setCharacterEncodingFilter</filter-name>\n  <filter-class>org.apache.catalina.filters.SetCharacterEncodingFilter</filter-class>\n  <init-param>\n    <param-name>encoding</param-name>\n    <param-value>UTF-8</param-value>\n\t</init-param>\n\t<init-param>\n    <param-name>ignore</param-name>\n    <param-value>false</param-value>\n  </init-param>\n\t<async-supported>true</async-supported>\n</filter>\n\nIf the output is does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /usr/lib/vmware-perfcharts/tc-instance/conf/web.xml in a text\neditor.\n\nConfigure the <web-app> node with the child nodes listed below.\n\n<filter-mapping>\n    <filter-name>setCharacterEncodingFilter</filter-name>\n    <url-pattern>/*</url-pattern>\n</filter-mapping>\n\n<filter>\n  <filter-name>setCharacterEncodingFilter</filter-name>\n  <filter-class>org.apache.catalina.filters.SetCharacterEncodingFilter</filter-class>\n  <init-param>\n    <param-name>encoding</param-name>\n    <param-value>UTF-8</param-value>\n\t</init-param>\n\t<init-param>\n    <param-name>ignore</param-name>\n    <param-value>false</param-value>\n  </init-param>\n\t<async-supported>true</async-supported>\n</filter>\"\n\n  describe xml('/usr/lib/vmware-perfcharts/tc-instance/conf/web.xml') do\n    its('/web-app/filter-mapping[filter-name=\"setCharacterEncodingFilter\"]/url-pattern') { should cmp '*' }\n    its('/web-app/filter[filter-name=\"setCharacterEncodingFilter\"]/filter-class') { should cmp 'org.apache.catalina.filters.SetCharacterEncodingFilter' }\n    its('/web-app/filter[filter-name=\"setCharacterEncodingFilter\"]/init-param[param-name=\"encoding\"]/param-value') { should cmp 'UTF-8' }\n    its('/web-app/filter[filter-name=\"setCharacterEncodingFilter\"]/init-param[param-name=\"ignore\"]/param-value') { should cmp 'false' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000020.rb",
        "line": 1
      },
      "id": "VCPF-67-000020"
    },
    {
      "title": "Performance Charts application files must be verified for their\nintegrity.",
      "desc": "Verifying that the Security Token Service application code is\nunchanged from it's shipping state is essential for file validation and\nnon-repudiation of Performance Charts itself. There is no reason that the MD5\nhash of the rpm original files should be changed after installation, excluding\nconfiguration files.",
      "descriptions": {
        "default": "Verifying that the Security Token Service application code is\nunchanged from it's shipping state is essential for file validation and\nnon-repudiation of Performance Charts itself. There is no reason that the MD5\nhash of the rpm original files should be changed after installation, excluding\nconfiguration files.",
        "check": "At the command prompt, execute the following command:\n\n# rpm -V VMware-perfcharts|grep \"^..5......\"|grep \"/usr/lib\"|grep -v -E\n\"\\.properties|\\.conf|\\.xml\"\n\nIf any files are returned, this is a finding.",
        "fix": "Re-install the VCSA or roll back to a snapshot. Modifying the\nPerformance Charts installation files manually is not supported by VMware."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000131-WSR-000051",
        "gid": null,
        "rid": "VCPF-67-000008",
        "stig_id": "VCPF-67-000008",
        "cci": "CCI-001749",
        "nist": [
          "CM-5 (3)",
          "Rev_4"
        ]
      },
      "code": "control \"VCPF-67-000008\" do\n  title \"Performance Charts application files must be verified for their\nintegrity.\"\n  desc  \"Verifying that the Security Token Service application code is\nunchanged from it's shipping state is essential for file validation and\nnon-repudiation of Performance Charts itself. There is no reason that the MD5\nhash of the rpm original files should be changed after installation, excluding\nconfiguration files.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000131-WSR-000051\"\n  tag gid: nil\n  tag rid: \"VCPF-67-000008\"\n  tag stig_id: \"VCPF-67-000008\"\n  tag cci: \"CCI-001749\"\n  tag nist: [\"CM-5 (3)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# rpm -V VMware-perfcharts|grep \\\"^..5......\\\"|grep \\\"/usr/lib\\\"|grep -v -E\n\\\"\\\\.properties|\\\\.conf|\\\\.xml\\\"\n\nIf any files are returned, this is a finding.\"\n  desc 'fix', \"Re-install the VCSA or roll back to a snapshot. Modifying the\nPerformance Charts installation files manually is not supported by VMware.\"\n\n  describe command('rpm -V VMware-perfcharts|grep \"^..5......\"|grep \"/usr/lib\"|grep -v -E \"\\.properties|\\.conf|\\.xml\"') do\n    its ('stdout.strip') { should eq '' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000008.rb",
        "line": 1
      },
      "id": "VCPF-67-000008"
    },
    {
      "title": "Performance Charts must have the debug option turned off.",
      "desc": "Information needed by an attacker to begin looking for possible\nvulnerabilities in a web server includes any information about the web server\nand plug-ins or modules being used. When debugging or trace information is\nenabled in a production web server, information about the web server, such as\nweb server type, version, patches installed, plug-ins and modules installed,\ntype of code being used by the hosted application, and any backends being used\nfor data storage may be displayed. Since this information may be placed in logs\nand general messages during normal operation of the web server, an attacker\ndoes not need to cause an error condition to gain this information.\n\n    The Performance Charts Service can be configured to set the debugging\nlevel. By setting the debugging level to zero (0), no debugging information\nwill be provided to a malicious user.",
      "descriptions": {
        "default": "Information needed by an attacker to begin looking for possible\nvulnerabilities in a web server includes any information about the web server\nand plug-ins or modules being used. When debugging or trace information is\nenabled in a production web server, information about the web server, such as\nweb server type, version, patches installed, plug-ins and modules installed,\ntype of code being used by the hosted application, and any backends being used\nfor data storage may be displayed. Since this information may be placed in logs\nand general messages during normal operation of the web server, an attacker\ndoes not need to cause an error condition to gain this information.\n\n    The Performance Charts Service can be configured to set the debugging\nlevel. By setting the debugging level to zero (0), no debugging information\nwill be provided to a malicious user.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-perfcharts/tc-instance/conf/web.xml | sed '2\ns/xmlns=\".*\"//g' | xmllint --xpath\n'//param-name[text()=\"debug\"]/parent::init-param' -\n\nExpected result:\n\n<init-param>\n      <param-name>debug</param-name>\n      <param-value>0</param-value>\n    </init-param>\n\nIf the output of the command does not match the expected result, this is a\nfinding. If no lines is returned this is NOT a finding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/conf/web.xml\n\nNavigate to all <debug> nodes that are not set to \"0\".\n\nSet the <param-value> to \"0\" in all <param-name>debug</param-name> nodes.\n\nNote: The debug setting should look like the below:\n\n<init-param>\n      <param-name>debug</param-name>\n      <param-value>0</param-value>\n    </init-param>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000266-WSR-000160",
        "gid": null,
        "rid": "VCPF-67-000025",
        "stig_id": "VCPF-67-000025",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCPF-67-000025\" do\n  title \"Performance Charts must have the debug option turned off.\"\n  desc  \"Information needed by an attacker to begin looking for possible\nvulnerabilities in a web server includes any information about the web server\nand plug-ins or modules being used. When debugging or trace information is\nenabled in a production web server, information about the web server, such as\nweb server type, version, patches installed, plug-ins and modules installed,\ntype of code being used by the hosted application, and any backends being used\nfor data storage may be displayed. Since this information may be placed in logs\nand general messages during normal operation of the web server, an attacker\ndoes not need to cause an error condition to gain this information.\n\n    The Performance Charts Service can be configured to set the debugging\nlevel. By setting the debugging level to zero (0), no debugging information\nwill be provided to a malicious user.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000266-WSR-000160\"\n  tag gid: nil\n  tag rid: \"VCPF-67-000025\"\n  tag stig_id: \"VCPF-67-000025\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-perfcharts/tc-instance/conf/web.xml | sed '2\ns/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'//param-name[text()=\\\"debug\\\"]/parent::init-param' -\n\nExpected result:\n\n<init-param>\n      <param-name>debug</param-name>\n      <param-value>0</param-value>\n    </init-param>\n\nIf the output of the command does not match the expected result, this is a\nfinding. If no lines is returned this is NOT a finding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/conf/web.xml\n\nNavigate to all <debug> nodes that are not set to \\\"0\\\".\n\nSet the <param-value> to \\\"0\\\" in all <param-name>debug</param-name> nodes.\n\nNote: The debug setting should look like the below:\n\n<init-param>\n      <param-name>debug</param-name>\n      <param-value>0</param-value>\n    </init-param>\"\n\n  describe.one do\n\n    describe xml('/usr/lib/vmware-perfcharts/tc-instance/conf/web.xml') do\n      its('/web-app/servlet/init-param[param-name=\"debug\"]/param-value') { should eq [] }\n    end\n\n    describe xml('/usr/lib/vmware-perfcharts/tc-instance/conf/web.xml') do\n      its('/web-app/servlet/init-param[param-name=\"debug\"]/param-value') { should cmp \"0\" }\n    end\n\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000025.rb",
        "line": 1
      },
      "id": "VCPF-67-000025"
    },
    {
      "title": "Performance Charts must configured to show error pages with minimal\ninformation.",
      "desc": "Web servers will often display error messages to client users\ndisplaying enough information to aid in the debugging of the error. The\ninformation given back in error messages may display the web server type,\nversion, patches installed, plug-ins and modules installed, type of code being\nused by the hosted application, and any backends being used for data storage.\nThis information could be used by an attacker to blueprint what type of attacks\nmight be successful. As such, Performance Charts must be configured with a\ncatch-all error handler that redirects to a standard error.jsp.",
      "descriptions": {
        "default": "Web servers will often display error messages to client users\ndisplaying enough information to aid in the debugging of the error. The\ninformation given back in error messages may display the web server type,\nversion, patches installed, plug-ins and modules installed, type of code being\nused by the hosted application, and any backends being used for data storage.\nThis information could be used by an attacker to blueprint what type of attacks\nmight be successful. As such, Performance Charts must be configured with a\ncatch-all error handler that redirects to a standard error.jsp.",
        "check": "At the command prompt, execute the following command:\n\n#  xmllint --format\n/usr/lib/vmware-perfcharts/tc-instance/webapps/statsreport/WEB-INF/web.xml |\nsed '2 s/xmlns=\".*\"//g' | xmllint --xpath\n'/web-app/error-page/exception-type[\"text()=java.lang.Throwable\"]/parent::error-page'\n-\n\nExpected result:\n\n<error-page>\n    <exception-type>java.lang.Throwable</exception-type>\n    <location>/error.jsp</location>\n  </error-page>\n\nIf the output does not match the expected result, this is a finding",
        "fix": "Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/webapps/statsreport/WEB-INF/web.xml\n\nAdd the following section under the <web-apps> node:\n\n<error-page>\n    <exception-type>java.lang.Throwable</exception-type>\n    <location>/error.jsp</location>\n  </error-page>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000266-WSR-000159",
        "gid": null,
        "rid": "VCPF-67-000023",
        "stig_id": "VCPF-67-000023",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCPF-67-000023\" do\n  title \"Performance Charts must configured to show error pages with minimal\ninformation.\"\n  desc  \"Web servers will often display error messages to client users\ndisplaying enough information to aid in the debugging of the error. The\ninformation given back in error messages may display the web server type,\nversion, patches installed, plug-ins and modules installed, type of code being\nused by the hosted application, and any backends being used for data storage.\nThis information could be used by an attacker to blueprint what type of attacks\nmight be successful. As such, Performance Charts must be configured with a\ncatch-all error handler that redirects to a standard error.jsp.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000266-WSR-000159\"\n  tag gid: nil\n  tag rid: \"VCPF-67-000023\"\n  tag stig_id: \"VCPF-67-000023\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n#  xmllint --format\n/usr/lib/vmware-perfcharts/tc-instance/webapps/statsreport/WEB-INF/web.xml |\nsed '2 s/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'/web-app/error-page/exception-type[\\\"text()=java.lang.Throwable\\\"]/parent::error-page'\n-\n\nExpected result:\n\n<error-page>\n    <exception-type>java.lang.Throwable</exception-type>\n    <location>/error.jsp</location>\n  </error-page>\n\nIf the output does not match the expected result, this is a finding\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/webapps/statsreport/WEB-INF/web.xml\n\nAdd the following section under the <web-apps> node:\n\n<error-page>\n    <exception-type>java.lang.Throwable</exception-type>\n    <location>/error.jsp</location>\n  </error-page>\"\n\n  describe xml('/usr/lib/vmware-perfcharts/tc-instance/webapps/statsreport/WEB-INF/web.xml') do\n    its(['/web-app/error-page[exception-type=\"java.lang.Throwable\"]/location']) { should cmp '/error.jsp' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000023.rb",
        "line": 1
      },
      "id": "VCPF-67-000023"
    },
    {
      "title": "Performance Charts must generate log records for system startup and\nshutdown.",
      "desc": "Logging must be started as soon as possible when a service starts and\nwhen a service is stopped. Many forms of suspicious actions can be detected by\nanalyzing logs for unexpected service starts and stops. Also, by starting to\nlog immediately after a service starts, it becomes more difficult for suspicous\nactivity to go un-logged.\n\n    On the VCSA, the vmware-vmon service starts up the JVMs for various vCenter\nprocesses, including Performance Charts, and the individual json config files\ncontrol the early jvm logging. Ensuring these json files are configured\ncorrectly enables early java stdout and stderr logging.",
      "descriptions": {
        "default": "Logging must be started as soon as possible when a service starts and\nwhen a service is stopped. Many forms of suspicious actions can be detected by\nanalyzing logs for unexpected service starts and stops. Also, by starting to\nlog immediately after a service starts, it becomes more difficult for suspicous\nactivity to go un-logged.\n\n    On the VCSA, the vmware-vmon service starts up the JVMs for various vCenter\nprocesses, including Performance Charts, and the individual json config files\ncontrol the early jvm logging. Ensuring these json files are configured\ncorrectly enables early java stdout and stderr logging.",
        "check": "At the command prompt, execute the following command:\n\n# grep StreamRedirectFile /etc/vmware/vmware-vmon/svcCfgfiles/perfcharts.json\n\nExpected result:\n\n\"StreamRedirectFile\" :\n\"%VMWARE_LOG_DIR%/vmware/perfcharts/vmware-perfcharts-runtime.log\",\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open\n/etc/vmware/vmware-vmon/svcCfgfiles/perfcharts.json . Below the last line of\nthe 'PreStartCommandArg' block add the following line:\n\n\"StreamRedirectFile\" :\n\"%VMWARE_LOG_DIR%/vmware/perfcharts/vmware-perfcharts-runtime.log\",\n\nRestart the appliance for changes to take effect."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000089-WSR-000047",
        "gid": null,
        "rid": "VCPF-67-000006",
        "stig_id": "VCPF-67-000006",
        "cci": "CCI-000169",
        "nist": [
          "AU-12 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCPF-67-000006\" do\n  title \"Performance Charts must generate log records for system startup and\nshutdown.\"\n  desc  \"Logging must be started as soon as possible when a service starts and\nwhen a service is stopped. Many forms of suspicious actions can be detected by\nanalyzing logs for unexpected service starts and stops. Also, by starting to\nlog immediately after a service starts, it becomes more difficult for suspicous\nactivity to go un-logged.\n\n    On the VCSA, the vmware-vmon service starts up the JVMs for various vCenter\nprocesses, including Performance Charts, and the individual json config files\ncontrol the early jvm logging. Ensuring these json files are configured\ncorrectly enables early java stdout and stderr logging.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000089-WSR-000047\"\n  tag gid: nil\n  tag rid: \"VCPF-67-000006\"\n  tag stig_id: \"VCPF-67-000006\"\n  tag cci: \"CCI-000169\"\n  tag nist: [\"AU-12 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep StreamRedirectFile /etc/vmware/vmware-vmon/svcCfgfiles/perfcharts.json\n\nExpected result:\n\n\\\"StreamRedirectFile\\\" :\n\\\"%VMWARE_LOG_DIR%/vmware/perfcharts/vmware-perfcharts-runtime.log\\\",\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open\n/etc/vmware/vmware-vmon/svcCfgfiles/perfcharts.json . Below the last line of\nthe 'PreStartCommandArg' block add the following line:\n\n\\\"StreamRedirectFile\\\" :\n\\\"%VMWARE_LOG_DIR%/vmware/perfcharts/vmware-perfcharts-runtime.log\\\",\n\nRestart the appliance for changes to take effect.\"\n\n  describe json('/etc/vmware/vmware-vmon/svcCfgfiles/perfcharts.json') do\n    its('StreamRedirectFile') { should eq '%VMWARE_LOG_DIR%/vmware/perfcharts/vmware-perfcharts-runtime.log'}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000006.rb",
        "line": 1
      },
      "id": "VCPF-67-000006"
    },
    {
      "title": "Performance Charts must properly configure log sizes and rotation.",
      "desc": "In order to make certain that the logging mechanism used by the web\nserver has sufficient storage capacity in which to write the logs, the logging\nmechanism needs to be able to allocate log record storage capacity. Performance\nCharts properly sizes and configures log rotation during installation. This\ndefault configuration must be verified.",
      "descriptions": {
        "default": "In order to make certain that the logging mechanism used by the web\nserver has sufficient storage capacity in which to write the logs, the logging\nmechanism needs to be able to allocate log record storage capacity. Performance\nCharts properly sizes and configures log rotation during installation. This\ndefault configuration must be verified.",
        "check": "At the command prompt, execute the following command:\n\n# grep -i \"max\" /etc/vmware-perfcharts/log4j.properties\n\nExpected result:\n\nlog4j.appender.LOGFILE.MaxFileSize=5MB\nlog4j.appender.LOGFILE.MaxBackupIndex=10\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Open /etc/vmware-perfcharts/log4j.properties with a text\neditor and add or change the following settings\n\nlog4j.appender.LOGFILE.MaxFileSize=5MB\nlog4j.appender.LOGFILE.MaxBackupIndex=10"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000357-WSR-000150",
        "gid": null,
        "rid": "VCPF-67-000026",
        "stig_id": "VCPF-67-000026",
        "cci": "CCI-001849",
        "nist": [
          "AU-4",
          "Rev_4"
        ]
      },
      "code": "control \"VCPF-67-000026\" do\n  title \"Performance Charts must properly configure log sizes and rotation.\"\n  desc  \"In order to make certain that the logging mechanism used by the web\nserver has sufficient storage capacity in which to write the logs, the logging\nmechanism needs to be able to allocate log record storage capacity. Performance\nCharts properly sizes and configures log rotation during installation. This\ndefault configuration must be verified.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000357-WSR-000150\"\n  tag gid: nil\n  tag rid: \"VCPF-67-000026\"\n  tag stig_id: \"VCPF-67-000026\"\n  tag cci: \"CCI-001849\"\n  tag nist: [\"AU-4\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep -i \\\"max\\\" /etc/vmware-perfcharts/log4j.properties\n\nExpected result:\n\nlog4j.appender.LOGFILE.MaxFileSize=5MB\nlog4j.appender.LOGFILE.MaxBackupIndex=10\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Open /etc/vmware-perfcharts/log4j.properties with a text\neditor and add or change the following settings\n\nlog4j.appender.LOGFILE.MaxFileSize=5MB\nlog4j.appender.LOGFILE.MaxBackupIndex=10\n\"\n\n  describe parse_config_file('/etc/vmware-perfcharts/log4j.properties').params['log4j.appender.LOGFILE.MaxFileSize'] do\n    it { should eq '5MB' }\n  end\n\n  describe parse_config_file('/etc/vmware-perfcharts/log4j.properties').params['log4j.appender.LOGFILE.MaxBackupIndex'] do\n    it { should eq '10' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000026.rb",
        "line": 1
      },
      "id": "VCPF-67-000026"
    },
    {
      "title": "Performance Charts log files must only be modifiable by privileged\nusers.",
      "desc": "Log data is essential in the investigation of events. The accuracy of\nthe information is always pertinent. One of the first steps an attacker will\nundertake is the modification or deletion of log records to cover his tracks\nand prolong discovery. The web server must protect the log data from\nunauthorized modification. Performance Charts restricts all modification of log\nfiles by default but this configuration must be verified.",
      "descriptions": {
        "default": "Log data is essential in the investigation of events. The accuracy of\nthe information is always pertinent. One of the first steps an attacker will\nundertake is the modification or deletion of log records to cover his tracks\nand prolong discovery. The web server must protect the log data from\nunauthorized modification. Performance Charts restricts all modification of log\nfiles by default but this configuration must be verified.",
        "check": "At the command prompt, execute the following command:\n\n# find /storage/log/vmware/perfcharts/ -xdev -type f -a '(' -perm -o+w -o -not\n-user root -o -not -group root ')' -exec ls -ld {} \\;\n\nIf any files are returned, this is a finding.",
        "fix": "At the command prompt, execute the following commands:\n\n# chmod o-w <file>\n# chown root:root <file>\n\nNote: Subsitute <file> with the listed file"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000119-WSR-000069",
        "gid": null,
        "rid": "VCPF-67-000007",
        "stig_id": "VCPF-67-000007",
        "cci": "CCI-000163",
        "nist": [
          "AU-9",
          "Rev_4"
        ]
      },
      "code": "control \"VCPF-67-000007\" do\n  title \"Performance Charts log files must only be modifiable by privileged\nusers.\"\n  desc  \"Log data is essential in the investigation of events. The accuracy of\nthe information is always pertinent. One of the first steps an attacker will\nundertake is the modification or deletion of log records to cover his tracks\nand prolong discovery. The web server must protect the log data from\nunauthorized modification. Performance Charts restricts all modification of log\nfiles by default but this configuration must be verified.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000119-WSR-000069\"\n  tag gid: nil\n  tag rid: \"VCPF-67-000007\"\n  tag stig_id: \"VCPF-67-000007\"\n  tag cci: \"CCI-000163\"\n  tag nist: [\"AU-9\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# find /storage/log/vmware/perfcharts/ -xdev -type f -a '(' -perm -o+w -o -not\n-user root -o -not -group root ')' -exec ls -ld {} \\\\;\n\nIf any files are returned, this is a finding.\"\n  desc 'fix', \"At the command prompt, execute the following commands:\n\n# chmod o-w <file>\n# chown root:root <file>\n\nNote: Subsitute <file> with the listed file\"\n\n  command('find /storage/log/vmware/perfcharts/ -type f -xdev').stdout.split.each do | fname |\n    describe file(fname) do\n      it { should_not be_more_permissive_than('0644') }\n      its('owner') {should eq 'root'}\n      its('group') {should eq 'root'}\n    end\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000007.rb",
        "line": 1
      },
      "id": "VCPF-67-000007"
    },
    {
      "title": "Performance Charts must not have the Web Distributed Authoring\n(WebDAV) servlet installed.",
      "desc": "Web Distributed Authoring (WebDAV) is an extension to the HTTP\nprotocol that, when developed, was meant to allow users to create, change, and\nmove documents on a server, typically a web server or web share. WebDAV is not\nwidely used and has serious security concerns because it may allow clients to\nmodify unauthorized files on the web server and must therefore be disabled.\n\n    Tomcat uses the org.apache.catalina.servlets.WebdavServlet servlet to\nprovide WebDAV services. Because the WebDAV service has been found to have an\nexcessive number of vulnerabilities, this servlet must not be installed.\nPerformance Charts does not configure WebDAV by default.",
      "descriptions": {
        "default": "Web Distributed Authoring (WebDAV) is an extension to the HTTP\nprotocol that, when developed, was meant to allow users to create, change, and\nmove documents on a server, typically a web server or web share. WebDAV is not\nwidely used and has serious security concerns because it may allow clients to\nmodify unauthorized files on the web server and must therefore be disabled.\n\n    Tomcat uses the org.apache.catalina.servlets.WebdavServlet servlet to\nprovide WebDAV services. Because the WebDAV service has been found to have an\nexcessive number of vulnerabilities, this servlet must not be installed.\nPerformance Charts does not configure WebDAV by default.",
        "check": "At the command prompt, execute the following command:\n\n# grep -n 'webdav' /usr/lib/vmware-perfcharts/tc-instance/conf/web.xml\n\nIf the command produces any output, this is a finding.",
        "fix": "Open /usr/lib/vmware-perfcharts/tc-instance/conf/web.xml in a text\neditor.\n\nFind the <servlet-name>webdav</servlet-name> node and remove the entire parent\n<servlet> block.\n\nFind the <servlet-name>webdav</servlet-name> node and remove the entire parent\n<servlet-mapping> block."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000141-WSR-000085",
        "gid": null,
        "rid": "VCPF-67-000013",
        "stig_id": "VCPF-67-000013",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCPF-67-000013\" do\n  title \"Performance Charts must not have the Web Distributed Authoring\n(WebDAV) servlet installed.\"\n  desc  \"Web Distributed Authoring (WebDAV) is an extension to the HTTP\nprotocol that, when developed, was meant to allow users to create, change, and\nmove documents on a server, typically a web server or web share. WebDAV is not\nwidely used and has serious security concerns because it may allow clients to\nmodify unauthorized files on the web server and must therefore be disabled.\n\n    Tomcat uses the org.apache.catalina.servlets.WebdavServlet servlet to\nprovide WebDAV services. Because the WebDAV service has been found to have an\nexcessive number of vulnerabilities, this servlet must not be installed.\nPerformance Charts does not configure WebDAV by default.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000141-WSR-000085\"\n  tag gid: nil\n  tag rid: \"VCPF-67-000013\"\n  tag stig_id: \"VCPF-67-000013\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep -n 'webdav' /usr/lib/vmware-perfcharts/tc-instance/conf/web.xml\n\nIf the command produces any output, this is a finding.\"\n  desc 'fix', \"Open /usr/lib/vmware-perfcharts/tc-instance/conf/web.xml in a text\neditor.\n\nFind the <servlet-name>webdav</servlet-name> node and remove the entire parent\n<servlet> block.\n\nFind the <servlet-name>webdav</servlet-name> node and remove the entire parent\n<servlet-mapping> block.\"\n\n  describe xml('//usr/lib/vmware-perfcharts/tc-instance/conf/web.xml') do\n    its('/web-app/servlet-mapping[servlet-name=\"webdav\"]') { should eq [] }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000013.rb",
        "line": 1
      },
      "id": "VCPF-67-000013"
    },
    {
      "title": "Performance Charts must must be configured with the appropriate ports.",
      "desc": "Web servers provide numerous processes, features, and functionalities\nthat utilize TCP/IP ports. Some of these processes may be deemed unnecessary or\ntoo unsecure to run on a production system. The ports that the Performance\nCharts listens on are configured in the catalina.properties file and must be\nveriified as accurate to their shipping state.",
      "descriptions": {
        "default": "Web servers provide numerous processes, features, and functionalities\nthat utilize TCP/IP ports. Some of these processes may be deemed unnecessary or\ntoo unsecure to run on a production system. The ports that the Performance\nCharts listens on are configured in the catalina.properties file and must be\nveriified as accurate to their shipping state.",
        "check": "At the command prompt, execute the following command:\n\n# grep '^bio\\.' /usr/lib/vmware-perfcharts/tc-instance/conf/catalina.properties\n\nExpected result:\n\nbio.http.port=13080\nbio.https.port=8443\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open /etc/vmware-eam/catalina.properties\n\nNavigate to the ports specification section.\n\nAdd or modify the following lines:\n\nbio.http.port=13080\nbio.https.port=8443"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000383-WSR-000175",
        "gid": null,
        "rid": "VCPF-67-000028",
        "stig_id": "VCPF-67-000028",
        "cci": "CCI-001762",
        "nist": [
          "CM-7 (1) (b)",
          "Rev_4"
        ]
      },
      "code": "control \"VCPF-67-000028\" do\n  title \"Performance Charts must must be configured with the appropriate ports.\"\n  desc  \"Web servers provide numerous processes, features, and functionalities\nthat utilize TCP/IP ports. Some of these processes may be deemed unnecessary or\ntoo unsecure to run on a production system. The ports that the Performance\nCharts listens on are configured in the catalina.properties file and must be\nveriified as accurate to their shipping state.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000383-WSR-000175\"\n  tag gid: nil\n  tag rid: \"VCPF-67-000028\"\n  tag stig_id: \"VCPF-67-000028\"\n  tag cci: \"CCI-001762\"\n  tag nist: [\"CM-7 (1) (b)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep '^bio\\\\.' /usr/lib/vmware-perfcharts/tc-instance/conf/catalina.properties\n\nExpected result:\n\nbio.http.port=13080\nbio.https.port=8443\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open /etc/vmware-eam/catalina.properties\n\nNavigate to the ports specification section.\n\nAdd or modify the following lines:\n\nbio.http.port=13080\nbio.https.port=8443\n\"\n\n  describe parse_config_file('/usr/lib/vmware-perfcharts/tc-instance/conf/catalina.properties').params['bio.http.port'] do\n    it { should eq '13080' }\n  end\n\n  describe parse_config_file('/usr/lib/vmware-perfcharts/tc-instance/conf/catalina.properties').params['bio.https.port'] do\n    it { should eq '8443' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000028.rb",
        "line": 1
      },
      "id": "VCPF-67-000028"
    },
    {
      "title": "Performance Charts must set the secure flag for cookies.",
      "desc": "The secure flag is an option that can be set by the application server\nwhen sending a new cookie to the user within an HTTP Response. The purpose of\nthe secure flag is to prevent cookies from being observed by unauthorized\nparties due to the transmission of a the cookie in clear text. By setting the\nsecure flag, the browser will prevent the transmission of a cookie over an\nunencrypted channel. The Performance Charts is configured to only be accessible\nover a TLS tunnel but this cookie flag is still a recommended best practice.",
      "descriptions": {
        "default": "The secure flag is an option that can be set by the application server\nwhen sending a new cookie to the user within an HTTP Response. The purpose of\nthe secure flag is to prevent cookies from being observed by unauthorized\nparties due to the transmission of a the cookie in clear text. By setting the\nsecure flag, the browser will prevent the transmission of a cookie over an\nunencrypted channel. The Performance Charts is configured to only be accessible\nover a TLS tunnel but this cookie flag is still a recommended best practice.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format\n/usr/lib/vmware-perfcharts/tc-instance/webapps/statsreport/WEB-INF/web.xml |\nsed '2 s/xmlns=\".*\"//g' | xmllint --xpath\n'/web-app/session-config/cookie-config/secure' -\n\nExpected result:\n\n<secure>true</secure>\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/webapps/statsreport/WEB-INF/web.xml\n\nNavigate to the <session-config> node and configure it as follows.\n\n<session-config>\n    <cookie-config>\n      <http-only>true</http-only>\n      <secure>true</secure>\n    </cookie-config>\n    <session-timeout>6</session-timeout>\n  </session-config>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000439-WSR-000155",
        "gid": null,
        "rid": "VCPF-67-000030",
        "stig_id": "VCPF-67-000030",
        "cci": "CCI-002418",
        "nist": [
          "SC-8",
          "Rev_4"
        ]
      },
      "code": "control \"VCPF-67-000030\" do\n  title \"Performance Charts must set the secure flag for cookies.\"\n  desc  \"The secure flag is an option that can be set by the application server\nwhen sending a new cookie to the user within an HTTP Response. The purpose of\nthe secure flag is to prevent cookies from being observed by unauthorized\nparties due to the transmission of a the cookie in clear text. By setting the\nsecure flag, the browser will prevent the transmission of a cookie over an\nunencrypted channel. The Performance Charts is configured to only be accessible\nover a TLS tunnel but this cookie flag is still a recommended best practice.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000439-WSR-000155\"\n  tag gid: nil\n  tag rid: \"VCPF-67-000030\"\n  tag stig_id: \"VCPF-67-000030\"\n  tag cci: \"CCI-002418\"\n  tag nist: [\"SC-8\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format\n/usr/lib/vmware-perfcharts/tc-instance/webapps/statsreport/WEB-INF/web.xml |\nsed '2 s/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'/web-app/session-config/cookie-config/secure' -\n\nExpected result:\n\n<secure>true</secure>\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/webapps/statsreport/WEB-INF/web.xml\n\nNavigate to the <session-config> node and configure it as follows.\n\n<session-config>\n    <cookie-config>\n      <http-only>true</http-only>\n      <secure>true</secure>\n    </cookie-config>\n    <session-timeout>6</session-timeout>\n  </session-config>\"\n\n  describe xml('/usr/lib/vmware-perfcharts/tc-instance/webapps/statsreport/WEB-INF/web.xml') do\n    its('/web-app/session-config/cookie-config/secure') { should cmp 'true' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000030.rb",
        "line": 1
      },
      "id": "VCPF-67-000030"
    },
    {
      "title": "Rsyslog must be configured to monitor and ship Performance Charts log\nfiles.",
      "desc": "The Performance Charts produces a handful of logs that must be\noffloaded from the originating system. This information can then be used for\ndiagnostic purposes, forensics purposes, or other purposes relevant to ensuring\nthe availability and integrity of the hosted application.",
      "descriptions": {
        "default": "The Performance Charts produces a handful of logs that must be\noffloaded from the originating system. This information can then be used for\ndiagnostic purposes, forensics purposes, or other purposes relevant to ensuring\nthe availability and integrity of the hosted application.",
        "check": "At the command prompt, execute the following command:\n\n# grep -v \"^#\" /etc/vmware-syslog/stig-services-perfcharts.conf\n\nExpected result:\n\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/perfcharts/localhost_access_log.*.txt\"\n      Tag=\"perfcharts-localhost_access\"\n      Severity=\"info\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/perfcharts/vmware-perfcharts-runtime.log.std*\"\n      Tag=\"perfcharts-runtime\"\n      Severity=\"info\"\n      Facility=\"local0\")\n\nIf the file does not exist, this is a finding.\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open\n/etc/vmware-syslog/stig-services-perfcharts.conf , creating the file if it does\nnot exist.\n\nSet the contents of the file as follows:\n\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/perfcharts/localhost_access_log.*.txt\"\n      Tag=\"perfcharts-localhost_access\"\n      Severity=\"info\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/perfcharts/vmware-perfcharts-runtime.log.std*\"\n      Tag=\"perfcharts-runtime\"\n      Severity=\"info\"\n      Facility=\"local0\")"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000358-WSR-000163",
        "gid": null,
        "rid": "VCPF-67-000027",
        "stig_id": "VCPF-67-000027",
        "cci": "CCI-001851",
        "nist": [
          "AU-4 (1)",
          "Rev_4"
        ]
      },
      "code": "control \"VCPF-67-000027\" do\n  title \"Rsyslog must be configured to monitor and ship Performance Charts log\nfiles.\"\n  desc  \"The Performance Charts produces a handful of logs that must be\noffloaded from the originating system. This information can then be used for\ndiagnostic purposes, forensics purposes, or other purposes relevant to ensuring\nthe availability and integrity of the hosted application.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000358-WSR-000163\"\n  tag gid: nil\n  tag rid: \"VCPF-67-000027\"\n  tag stig_id: \"VCPF-67-000027\"\n  tag cci: \"CCI-001851\"\n  tag nist: [\"AU-4 (1)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep -v \\\"^#\\\" /etc/vmware-syslog/stig-services-perfcharts.conf\n\nExpected result:\n\ninput(type=\\\"imfile\\\"\n      File=\\\"/var/log/vmware/perfcharts/localhost_access_log.*.txt\\\"\n      Tag=\\\"perfcharts-localhost_access\\\"\n      Severity=\\\"info\\\"\n      Facility=\\\"local0\\\")\ninput(type=\\\"imfile\\\"\n      File=\\\"/var/log/vmware/perfcharts/vmware-perfcharts-runtime.log.std*\\\"\n      Tag=\\\"perfcharts-runtime\\\"\n      Severity=\\\"info\\\"\n      Facility=\\\"local0\\\")\n\nIf the file does not exist, this is a finding.\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open\n/etc/vmware-syslog/stig-services-perfcharts.conf , creating the file if it does\nnot exist.\n\nSet the contents of the file as follows:\n\ninput(type=\\\"imfile\\\"\n      File=\\\"/var/log/vmware/perfcharts/localhost_access_log.*.txt\\\"\n      Tag=\\\"perfcharts-localhost_access\\\"\n      Severity=\\\"info\\\"\n      Facility=\\\"local0\\\")\ninput(type=\\\"imfile\\\"\n      File=\\\"/var/log/vmware/perfcharts/vmware-perfcharts-runtime.log.std*\\\"\n      Tag=\\\"perfcharts-runtime\\\"\n      Severity=\\\"info\\\"\n      Facility=\\\"local0\\\")\"\n\n  describe file('/etc/vmware-syslog/stig-services-perfcharts.conf') do\n    it { should exist }\n  end\n  describe command('grep -v \"^#\" /etc/vmware-syslog/stig-services-perfcharts.conf') do\n    its ('stdout') { should match \"input(type=\\\"imfile\\\"\\n      File=\\\"/var/log/vmware/perfcharts/localhost_access_log.*.txt\\\"\\n      Tag=\\\"perfcharts-localhost_access\\\"\\n      Severity=\\\"info\\\"\\n      Facility=\\\"local0\\\")\\ninput(type=\\\"imfile\\\"\\n      File=\\\"/var/log/vmware/perfcharts/vmware-perfcharts-runtime.log.std*\\\"\\n      Tag=\\\"perfcharts-runtime\\\"\\n      Severity=\\\"info\\\"\\n      Facility=\\\"local0\\\")\\n\" }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000027.rb",
        "line": 1
      },
      "id": "VCPF-67-000027"
    },
    {
      "title": "Performance Charts must limit the number of concurrent connections\npermitted.",
      "desc": "Resource exhaustion can occur when an unlimited number of concurrent\nrequests are allowed on a web site, facilitating a denial of service attack.\nUnless the number of requests is controlled, the web server can consume enough\nsystem resources to cause a system crash.\n\n    Mitigating this kind of attack will include limiting the number of\nconcurrent HTTP/HTTPS requests. In Tomcat, each incoming request requires a\nthread for the duration of that request. If more simultaneous requests are\nreceived than can be handled by the currently available request processing\nthreads, additional threads will be created up to the value of the maxThreads\nattribute.",
      "descriptions": {
        "default": "Resource exhaustion can occur when an unlimited number of concurrent\nrequests are allowed on a web site, facilitating a denial of service attack.\nUnless the number of requests is controlled, the web server can consume enough\nsystem resources to cause a system crash.\n\n    Mitigating this kind of attack will include limiting the number of\nconcurrent HTTP/HTTPS requests. In Tomcat, each incoming request requires a\nthread for the duration of that request. If more simultaneous requests are\nreceived than can be handled by the currently available request processing\nthreads, additional threads will be created up to the value of the maxThreads\nattribute.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --xpath '/Server/Service/Executor/@maxThreads'\n/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nExpected result:\n\nmaxThreads=\"300\"\n\nIf the output does not match the expected result, this is a finding",
        "fix": "Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nNavigate to the <Executor> mode with the name of tomcatThreadPool and configure\nwith the value 'maxThreads=\"300\"'\n\nNote: The <Executor> node should be configured per the below:\n\n<Executor maxThreads=\"300\" minSpareThreads=\"50\" name=\"tomcatThreadPool\"\nnamePrefix=\"tomcat-http--\"/>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000001-WSR-000001",
        "gid": null,
        "rid": "VCPF-67-000002",
        "stig_id": "VCPF-67-000002",
        "cci": "CCI-000054",
        "nist": [
          "AC-10",
          "Rev_4"
        ]
      },
      "code": "control \"VCPF-67-000002\" do\n  title \"Performance Charts must limit the number of concurrent connections\npermitted.\"\n  desc  \"Resource exhaustion can occur when an unlimited number of concurrent\nrequests are allowed on a web site, facilitating a denial of service attack.\nUnless the number of requests is controlled, the web server can consume enough\nsystem resources to cause a system crash.\n\n    Mitigating this kind of attack will include limiting the number of\nconcurrent HTTP/HTTPS requests. In Tomcat, each incoming request requires a\nthread for the duration of that request. If more simultaneous requests are\nreceived than can be handled by the currently available request processing\nthreads, additional threads will be created up to the value of the maxThreads\nattribute.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000001-WSR-000001\"\n  tag gid: nil\n  tag rid: \"VCPF-67-000002\"\n  tag stig_id: \"VCPF-67-000002\"\n  tag cci: \"CCI-000054\"\n  tag nist: [\"AC-10\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --xpath '/Server/Service/Executor/@maxThreads'\n/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nExpected result:\n\nmaxThreads=\\\"300\\\"\n\nIf the output does not match the expected result, this is a finding\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nNavigate to the <Executor> mode with the name of tomcatThreadPool and configure\nwith the value 'maxThreads=\\\"300\\\"'\n\nNote: The <Executor> node should be configured per the below:\n\n<Executor maxThreads=\\\"300\\\" minSpareThreads=\\\"50\\\" name=\\\"tomcatThreadPool\\\"\nnamePrefix=\\\"tomcat-http--\\\"/>\n\"\n\n  describe xml('/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml') do\n    its(['/Server/Service/Executor[@name=\"tomcatThreadPool\"]/@maxThreads']) { should cmp '300' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000002.rb",
        "line": 1
      },
      "id": "VCPF-67-000002"
    },
    {
      "title": "Performance Charts must set the welcome-file node to a default web\npage.",
      "desc": "Enumeration techniques, such as URL parameter manipulation, rely upon\nbeing able to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. By having a default hosted application web page, the anonymous web\nuser will not obtain directory browsing information or an error message that\nreveals the server type and version. Ensuring that every document directory has\nan index.jsp (or equivalent) file is one approach to mitigating the\nvulnerability.",
      "descriptions": {
        "default": "Enumeration techniques, such as URL parameter manipulation, rely upon\nbeing able to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. By having a default hosted application web page, the anonymous web\nuser will not obtain directory browsing information or an error message that\nreveals the server type and version. Ensuring that every document directory has\nan index.jsp (or equivalent) file is one approach to mitigating the\nvulnerability.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-perfcharts/tc-instance/conf/web.xml | sed '2\ns/xmlns=\".*\"//g' | xmllint --xpath '/web-app/welcome-file-list' -\n\nExpected result:\n\n<welcome-file-list>\n    <welcome-file>index.html</welcome-file>\n    <welcome-file>index.htm</welcome-file>\n    <welcome-file>index.jsp</welcome-file>\n  </welcome-file-list>\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/conf/web.xml\n\nAdd the following section under the <web-apps> node:\n\n<welcome-file-list>\n    <welcome-file>index.html</welcome-file>\n    <welcome-file>index.htm</welcome-file>\n    <welcome-file>index.jsp</welcome-file>\n  </welcome-file-list>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000266-WSR-000142",
        "gid": null,
        "rid": "VCPF-67-000021",
        "stig_id": "VCPF-67-000021",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCPF-67-000021\" do\n  title \"Performance Charts must set the welcome-file node to a default web\npage.\"\n  desc  \"Enumeration techniques, such as URL parameter manipulation, rely upon\nbeing able to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. By having a default hosted application web page, the anonymous web\nuser will not obtain directory browsing information or an error message that\nreveals the server type and version. Ensuring that every document directory has\nan index.jsp (or equivalent) file is one approach to mitigating the\nvulnerability.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000266-WSR-000142\"\n  tag gid: nil\n  tag rid: \"VCPF-67-000021\"\n  tag stig_id: \"VCPF-67-000021\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-perfcharts/tc-instance/conf/web.xml | sed '2\ns/xmlns=\\\".*\\\"//g' | xmllint --xpath '/web-app/welcome-file-list' -\n\nExpected result:\n\n<welcome-file-list>\n    <welcome-file>index.html</welcome-file>\n    <welcome-file>index.htm</welcome-file>\n    <welcome-file>index.jsp</welcome-file>\n  </welcome-file-list>\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/conf/web.xml\n\nAdd the following section under the <web-apps> node:\n\n<welcome-file-list>\n    <welcome-file>index.html</welcome-file>\n    <welcome-file>index.htm</welcome-file>\n    <welcome-file>index.jsp</welcome-file>\n  </welcome-file-list>\n\"\n\n  list = [\"index.jsp\", \"index.html\", \"index.htm\"]\n  describe xml('/usr/lib/vmware-perfcharts/tc-instance/conf/web.xml') do\n    its('/web-app/welcome-file-list/welcome-file') { should be_in list }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000021.rb",
        "line": 1
      },
      "id": "VCPF-67-000021"
    },
    {
      "title": "Performance Charts must not show directory listings.",
      "desc": "Enumeration techniques, such as URL parameter manipulation, rely upon\nbeing able to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. Ensuring that directory listing is disabled is one approach to\nmitigating the vulnerability.",
      "descriptions": {
        "default": "Enumeration techniques, such as URL parameter manipulation, rely upon\nbeing able to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. Ensuring that directory listing is disabled is one approach to\nmitigating the vulnerability.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-perfcharts/tc-instance/conf/web.xml | sed '2\ns/xmlns=\".*\"//g' | xmllint --xpath\n'//param-name[text()=\"listings\"]/parent::init-param' -\n\nExpected result:\n\n<init-param>\n      <param-name>listings</param-name>\n      <param-value>false</param-value>\n    </init-param>\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/conf/web.xml\n\nSet the <param-value> to \"false\" in all <param-name>listing</param-name>\nnodes.\n\nNote: The setting should look like the below:\n\n<init-param>\n      <param-name>listings</param-name>\n      <param-value>false</param-value>\n</init-param>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000266-WSR-000142",
        "gid": null,
        "rid": "VCPF-67-000022",
        "stig_id": "VCPF-67-000022",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCPF-67-000022\" do\n  title \"Performance Charts must not show directory listings.\"\n  desc  \"Enumeration techniques, such as URL parameter manipulation, rely upon\nbeing able to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. Ensuring that directory listing is disabled is one approach to\nmitigating the vulnerability.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000266-WSR-000142\"\n  tag gid: nil\n  tag rid: \"VCPF-67-000022\"\n  tag stig_id: \"VCPF-67-000022\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-perfcharts/tc-instance/conf/web.xml | sed '2\ns/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'//param-name[text()=\\\"listings\\\"]/parent::init-param' -\n\nExpected result:\n\n<init-param>\n      <param-name>listings</param-name>\n      <param-value>false</param-value>\n    </init-param>\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/conf/web.xml\n\nSet the <param-value> to \\\"false\\\" in all <param-name>listing</param-name>\nnodes.\n\nNote: The setting should look like the below:\n\n<init-param>\n      <param-name>listings</param-name>\n      <param-value>false</param-value>\n</init-param>\"\n\n  describe.one do\n\n  describe xml('/usr/lib/vmware-perfcharts/tc-instance/conf/web.xml') do\n    its('/web-app/servlet/init-param[param-name=\"listings\"]/param-value') { should eq [] }\n  end\n\n  describe xml('/usr/lib/vmware-perfcharts/tc-instance/conf/web.xml') do\n    its('/web-app/servlet/init-param[param-name=\"listings\"]/param-value') { should cmp \"false\" }\n  end\n\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000022.rb",
        "line": 1
      },
      "id": "VCPF-67-000022"
    },
    {
      "title": "Performance Charts must not enable support for TRACE requests.",
      "desc": "\"Trace\" is a technique for a user to request internal information\nabout Tomcat. This is useful during product development, but should not be\nenabled in production.  Allowing a attacker to conduct a Trace operation\nagainst Performance Charts will expose information that would be useful to\nperform a more targeted attack. Performance Chartse provides the allowTrace\nparameter as means to disable responding to Trace requests.",
      "descriptions": {
        "default": "\"Trace\" is a technique for a user to request internal information\nabout Tomcat. This is useful during product development, but should not be\nenabled in production.  Allowing a attacker to conduct a Trace operation\nagainst Performance Charts will expose information that would be useful to\nperform a more targeted attack. Performance Chartse provides the allowTrace\nparameter as means to disable responding to Trace requests.",
        "check": "At the command prompt, execute the following command:\n\n# grep allowTrace /usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nIf allowTrace is set to \"true\", this is a finding. If no line is returned\nthis is NOT a finding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nNavigate to and locate 'allowTrace=\"true\"'\n\nRemove the 'allowTrace=\"true\"' setting."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000266-WSR-000160",
        "gid": null,
        "rid": "VCPF-67-000024",
        "stig_id": "VCPF-67-000024",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCPF-67-000024\" do\n  title \"Performance Charts must not enable support for TRACE requests.\"\n  desc  \"\\\"Trace\\\" is a technique for a user to request internal information\nabout Tomcat. This is useful during product development, but should not be\nenabled in production.  Allowing a attacker to conduct a Trace operation\nagainst Performance Charts will expose information that would be useful to\nperform a more targeted attack. Performance Chartse provides the allowTrace\nparameter as means to disable responding to Trace requests.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000266-WSR-000160\"\n  tag gid: nil\n  tag rid: \"VCPF-67-000024\"\n  tag stig_id: \"VCPF-67-000024\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep allowTrace /usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nIf allowTrace is set to \\\"true\\\", this is a finding. If no line is returned\nthis is NOT a finding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nNavigate to and locate 'allowTrace=\\\"true\\\"'\n\nRemove the 'allowTrace=\\\"true\\\"' setting.\"\n\n  describe.one do\n    describe xml('/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml') do\n      its(['Server/Service/Connector/attribute::allowTrace']) { should eq [] }\n    end\n\n    describe xml('/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml') do\n      its(['Server/Service/Connector/attribute::allowTrace']) { should cmp \"false\" }\n    end\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000024.rb",
        "line": 1
      },
      "id": "VCPF-67-000024"
    },
    {
      "title": "Performance Charts must limit the amount of time that each TCP\nconnection is kept alive.",
      "desc": "Denial of Service is one threat against web servers.  Many DoS attacks\nattempt to consume web server resources in such a way that no more resources\nare available to satisfy legitimate requests.\n\n    In Tomcat, the 'connectionTimeout' attribute sets the number of\nmilliseconds the server will wait after accepting a connection for the request\nURI line to be presented. This timeout will also be used when reading the\nrequest body (if any). This prevents idle sockets that are not sending HTTP\nrequests from consuming system resources and potentially denying new\nconnections.",
      "descriptions": {
        "default": "Denial of Service is one threat against web servers.  Many DoS attacks\nattempt to consume web server resources in such a way that no more resources\nare available to satisfy legitimate requests.\n\n    In Tomcat, the 'connectionTimeout' attribute sets the number of\nmilliseconds the server will wait after accepting a connection for the request\nURI line to be presented. This timeout will also be used when reading the\nrequest body (if any). This prevents idle sockets that are not sending HTTP\nrequests from consuming system resources and potentially denying new\nconnections.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --xpath '/Server/Service/Connector/@connectionTimeout'\n/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nExpected result:\n\nconnectionTimeout=\"20000\"\n\nIf the output does not match the expected result, this is a finding",
        "fix": "Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nNavigate to each of the <Connector> nodes.\n\nConfigure each <Connector> node with the value:\n\nconnectionTimeout=\"20000\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000001-WSR-000001",
        "gid": null,
        "rid": "VCPF-67-000001",
        "stig_id": "VCPF-67-000001",
        "cci": "CCI-000054",
        "nist": [
          "AC-10",
          "Rev_4"
        ]
      },
      "code": "control \"VCPF-67-000001\" do\n  title \"Performance Charts must limit the amount of time that each TCP\nconnection is kept alive.\"\n  desc  \"Denial of Service is one threat against web servers.  Many DoS attacks\nattempt to consume web server resources in such a way that no more resources\nare available to satisfy legitimate requests.\n\n    In Tomcat, the 'connectionTimeout' attribute sets the number of\nmilliseconds the server will wait after accepting a connection for the request\nURI line to be presented. This timeout will also be used when reading the\nrequest body (if any). This prevents idle sockets that are not sending HTTP\nrequests from consuming system resources and potentially denying new\nconnections.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000001-WSR-000001\"\n  tag gid: nil\n  tag rid: \"VCPF-67-000001\"\n  tag stig_id: \"VCPF-67-000001\"\n  tag cci: \"CCI-000054\"\n  tag nist: [\"AC-10\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --xpath '/Server/Service/Connector/@connectionTimeout'\n/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nExpected result:\n\nconnectionTimeout=\\\"20000\\\"\n\nIf the output does not match the expected result, this is a finding\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nNavigate to each of the <Connector> nodes.\n\nConfigure each <Connector> node with the value:\n\nconnectionTimeout=\\\"20000\\\"\"\n\n  begin\n    vcui_conf = xml('/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml')\n\n      if vcui_conf['Server/Service/Connector/attribute::connectionTimeout'].is_a?(Array)\n        vcui_conf['Server/Service/Connector/attribute::connectionTimeout'].each do |x|\n          describe x do\n            it { should eq \"20000\" }\n          end\n        end\n      else\n        describe xml(vcui_conf['Server/Service/Connector/attribute::connectionTimeout']) do\n          it { should eq \"20000\" }\n        end\n      end\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000001.rb",
        "line": 1
      },
      "id": "VCPF-67-000001"
    },
    {
      "title": "Performance Charts must not be configured with unsupported realms.",
      "desc": "Performance Chartse performs user authentication at the application\nlevel and not through Tomcat. Depending on the VCSa version, Performance Charts\nmay come configured with a UserDatabaseRealm. This should be removed in the\nname of eliminating unnecessary features.",
      "descriptions": {
        "default": "Performance Chartse performs user authentication at the application\nlevel and not through Tomcat. Depending on the VCSa version, Performance Charts\nmay come configured with a UserDatabaseRealm. This should be removed in the\nname of eliminating unnecessary features.",
        "check": "At the command prompt, execute the following command:\n\n# grep UserDatabaseRealm /usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nIf the command produces any output, this is a finding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nRemove the <Realm> node returned in the check."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000141-WSR-000015",
        "gid": null,
        "rid": "VCPF-67-000010",
        "stig_id": "VCPF-67-000010",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCPF-67-000010\" do\n  title \"Performance Charts must not be configured with unsupported realms.\"\n  desc  \"Performance Chartse performs user authentication at the application\nlevel and not through Tomcat. Depending on the VCSa version, Performance Charts\nmay come configured with a UserDatabaseRealm. This should be removed in the\nname of eliminating unnecessary features.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000141-WSR-000015\"\n  tag gid: nil\n  tag rid: \"VCPF-67-000010\"\n  tag stig_id: \"VCPF-67-000010\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep UserDatabaseRealm /usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nIf the command produces any output, this is a finding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/conf/server.xml\n\nRemove the <Realm> node returned in the check.\"\n\n  describe command('grep UserDatabaseRealm /usr/lib/vmware-perfcharts/tc-instance/conf/server.xml') do\n    its ('stdout.strip') { should eq '' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000010.rb",
        "line": 1
      },
      "id": "VCPF-67-000010"
    },
    {
      "title": "Performance Charts must protect cookies from XSS.",
      "desc": "Cookies are a common way to save session state over the HTTP(S)\nprotocol. If an attacker can compromise session data stored in a cookie, they\nare better able to launch an attack against the server and its applications.\nWhen you tag a cookie with the HttpOnly flag, it tells the browser that this\nparticular cookie should only be accessed by the originating server. Any\nattempt to access the cookie from client script is strictly forbidden.",
      "descriptions": {
        "default": "Cookies are a common way to save session state over the HTTP(S)\nprotocol. If an attacker can compromise session data stored in a cookie, they\nare better able to launch an attack against the server and its applications.\nWhen you tag a cookie with the HttpOnly flag, it tells the browser that this\nparticular cookie should only be accessed by the originating server. Any\nattempt to access the cookie from client script is strictly forbidden.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format\n/usr/lib/vmware-perfcharts/tc-instance/webapps/statsreport/WEB-INF/web.xml |\nsed '2 s/xmlns=\".*\"//g' | xmllint --xpath\n'/web-app/session-config/cookie-config/http-only' -\n\nExpected result:\n\n<http-only>true</http-only>\n\nIf the output does not match the expected result, this is a finding",
        "fix": "Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/webapps/statsreport/WEB-INF/web.xml\n\nNavigate to the <session-config> node and configure it as follows.\n\n<session-config>\n <cookie-config>\n <http-only>true</http-only>\n <secure>true</secure>\n </cookie-config>\n <session-timeout>30</session-timeout>\n</session-config>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000001-WSR-000002",
        "gid": null,
        "rid": "VCPF-67-000004",
        "stig_id": "VCPF-67-000004",
        "cci": "CCI-000054",
        "nist": [
          "AC-10",
          "Rev_4"
        ]
      },
      "code": "control \"VCPF-67-000004\" do\n  title \"Performance Charts must protect cookies from XSS.\"\n  desc  \"Cookies are a common way to save session state over the HTTP(S)\nprotocol. If an attacker can compromise session data stored in a cookie, they\nare better able to launch an attack against the server and its applications.\nWhen you tag a cookie with the HttpOnly flag, it tells the browser that this\nparticular cookie should only be accessed by the originating server. Any\nattempt to access the cookie from client script is strictly forbidden.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000001-WSR-000002\"\n  tag gid: nil\n  tag rid: \"VCPF-67-000004\"\n  tag stig_id: \"VCPF-67-000004\"\n  tag cci: \"CCI-000054\"\n  tag nist: [\"AC-10\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format\n/usr/lib/vmware-perfcharts/tc-instance/webapps/statsreport/WEB-INF/web.xml |\nsed '2 s/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'/web-app/session-config/cookie-config/http-only' -\n\nExpected result:\n\n<http-only>true</http-only>\n\nIf the output does not match the expected result, this is a finding\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-perfcharts/tc-instance/webapps/statsreport/WEB-INF/web.xml\n\nNavigate to the <session-config> node and configure it as follows.\n\n<session-config>\n <cookie-config>\n <http-only>true</http-only>\n <secure>true</secure>\n </cookie-config>\n <session-timeout>30</session-timeout>\n</session-config>\"\n\n  describe xml('/usr/lib/vmware-perfcharts/tc-instance/webapps/statsreport/WEB-INF/web.xml') do\n    its(['/web-app/session-config/cookie-config/http-only']) { should cmp 'true' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000004.rb",
        "line": 1
      },
      "id": "VCPF-67-000004"
    },
    {
      "title": "The Photon operating system must be configured to protect the SSH\npublic host key from unauthorized modification.",
      "desc": "If a public host key file is modified by an unauthorized user, the SSH\nservice may be compromised.",
      "descriptions": {
        "default": "If a public host key file is modified by an unauthorized user, the SSH\nservice may be compromised.",
        "check": "At the command line, execute the following command:\n\n# stat -c \"%n permissions are %a and owned by %U:%G\" /etc/ssh/*key.pub\n\nExpected result:\n\n/etc/ssh/ssh_host_dsa_key.pub permissions are 644 and owned by root:root\n/etc/ssh/ssh_host_ecdsa_key.pub permissions are 644 and owned by root:root\n/etc/ssh/ssh_host_ed25519_key.pub permissions are 644 and owned by root:root\n/etc/ssh/ssh_host_rsa_key.pub permissions are 644 and owned by root:root\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "At the command line, execute the following commands for each\nreturned file:\n\n# chmod 644 <file>\n# chown root:root <file>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000115",
        "stig_id": "PHTN-10-000115",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000115\" do\n  title \"The Photon operating system must be configured to protect the SSH\npublic host key from unauthorized modification.\"\n  desc  \"If a public host key file is modified by an unauthorized user, the SSH\nservice may be compromised.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000115\"\n  tag stig_id: \"PHTN-10-000115\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# stat -c \\\"%n permissions are %a and owned by %U:%G\\\" /etc/ssh/*key.pub\n\nExpected result:\n\n/etc/ssh/ssh_host_dsa_key.pub permissions are 644 and owned by root:root\n/etc/ssh/ssh_host_ecdsa_key.pub permissions are 644 and owned by root:root\n/etc/ssh/ssh_host_ed25519_key.pub permissions are 644 and owned by root:root\n/etc/ssh/ssh_host_rsa_key.pub permissions are 644 and owned by root:root\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following commands for each\nreturned file:\n\n# chmod 644 <file>\n# chown root:root <file>\"\n\n  command('find /etc/ssh/ -maxdepth 1 -name \"*key.pub\"').stdout.split.each do | fname |\n      describe file(fname) do\n        its('owner') { should cmp 'root' }\n        its('group') { should cmp 'root' }\n        its('mode') { should cmp '0644' }\n      end\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000115.rb",
        "line": 1
      },
      "id": "PHTN-10-000115"
    },
    {
      "title": "The Photon operating system audit log must be group-owned by root.",
      "desc": "Audit information includes all information (e.g., audit records, audit\nsettings, audit reports) needed to successfully audit operating system activity.\n\n    Unauthorized disclosure of audit records can reveal system and\nconfiguration data to attackers, thus compromising its confidentiality.",
      "descriptions": {
        "default": "Audit information includes all information (e.g., audit records, audit\nsettings, audit reports) needed to successfully audit operating system activity.\n\n    Unauthorized disclosure of audit records can reveal system and\nconfiguration data to attackers, thus compromising its confidentiality.",
        "check": "At the command line, execute the following command:\n\n# (audit_log_file=$(grep \"^log_file\" /etc/audit/auditd.conf|sed s/^[^\\/]*//)\n&& if [ -f \"${audit_log_file}\" ] ; then printf \"Log(s) found in\n\"${audit_log_file%/*}\":\"; stat -c \"%n is group owned by %G\" ${audit_log_file%}*; else printf\n\"audit log file(s) not found\"; fi)\n\nIf any audit log file is not group-owned by root, this is a finding.",
        "fix": "At the command line, execute the following command:\n\n#  chown root:root <audit log file>\n\nReplace <audit log file> with the log files not group owned by root."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000059-GPOS-00029",
        "gid": null,
        "rid": "PHTN-10-000017",
        "stig_id": "PHTN-10-000017",
        "cci": "CCI-000164",
        "nist": [
          "AU-9",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000017\" do\n  title \"The Photon operating system audit log must be group-owned by root.\"\n  desc  \"Audit information includes all information (e.g., audit records, audit\nsettings, audit reports) needed to successfully audit operating system activity.\n\n    Unauthorized disclosure of audit records can reveal system and\nconfiguration data to attackers, thus compromising its confidentiality.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000059-GPOS-00029\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000017\"\n  tag stig_id: \"PHTN-10-000017\"\n  tag cci: \"CCI-000164\"\n  tag nist: [\"AU-9\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# (audit_log_file=$(grep \\\"^log_file\\\" /etc/audit/auditd.conf|sed s/^[^\\\\/]*//)\n&& if [ -f \\\"${audit_log_file}\\\" ] ; then printf \\\"Log(s) found in\n\\\"${audit_log_file%/*}\\\":\\\n\\\"; stat -c \\\"%n is group owned by %G\\\" ${audit_log_file%}*; else printf\n\\\"audit log file(s) not found\\\n\\\"; fi)\n\nIf any audit log file is not group-owned by root, this is a finding.\n\"\n  desc 'fix', \"At the command line, execute the following command:\n\n#  chown root:root <audit log file>\n\nReplace <audit log file> with the log files not group owned by root.\"\n\n  command('find /var/log/audit/ -maxdepth 1 -name \"audit*.*\"').stdout.split.each do | fname |\n    describe file(fname) do\n      its('group') { should cmp 'root' }\n    end\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000017.rb",
        "line": 1
      },
      "id": "PHTN-10-000017"
    },
    {
      "title": "The Photon operating system must enforce password complexity by\nrequiring that at least one upper-case character be used.",
      "desc": "Use of a complex password helps to increase the time and resources\nrequired to compromise the password. Password complexity, or strength, is a\nmeasure of the effectiveness of a password in resisting attempts at guessing\nand brute-force attacks.",
      "descriptions": {
        "default": "Use of a complex password helps to increase the time and resources\nrequired to compromise the password. Password complexity, or strength, is a\nmeasure of the effectiveness of a password in resisting attempts at guessing\nand brute-force attacks.",
        "check": "At the command line, execute the following command:\n\n# grep pam_cracklib /etc/pam.d/system-password|grep --color=always\n\"ucredit=..\"\n\nExpected result:\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1\nminlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/pam.d/system-password with a text editor.\n\nAdd the following, replacing any existing 'pam_cracklib.so' line :\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1\nminlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000069-GPOS-00037",
        "gid": null,
        "rid": "PHTN-10-00002",
        "stig_id": "PHTN-10-000021",
        "cci": "CCI-000192",
        "nist": [
          "IA-5 (1) (a)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000021\" do\n  title \"The Photon operating system must enforce password complexity by\nrequiring that at least one upper-case character be used.\"\n  desc  \"Use of a complex password helps to increase the time and resources\nrequired to compromise the password. Password complexity, or strength, is a\nmeasure of the effectiveness of a password in resisting attempts at guessing\nand brute-force attacks.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000069-GPOS-00037\"\n  tag gid: nil\n  tag rid: \"PHTN-10-00002\"\n  tag stig_id: \"PHTN-10-000021\"\n  tag cci: \"CCI-000192\"\n  tag nist: [\"IA-5 (1) (a)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep pam_cracklib /etc/pam.d/system-password|grep --color=always\n\\\"ucredit=..\\\"\n\nExpected result:\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1\nminlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/pam.d/system-password with a text editor.\n\nAdd the following, replacing any existing 'pam_cracklib.so' line :\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1\nminlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root\"\n\n  describe file ('/etc/pam.d/system-password') do\n    its ('content'){should match /^(?=.*?\\bpassword\\b)(?=.*?\\brequisite\\b)(?=.*?\\bucredit=-1\\b).*$/}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000021.rb",
        "line": 1
      },
      "id": "PHTN-10-000021"
    },
    {
      "title": "The Photon operating system must configure sshd to disallow Kerberos\nauthentication.",
      "desc": "If Kerberos is enabled through SSH, sshd provides a means of access to\nthe system's Kerberos implementation. Vulnerabilities in the system's Kerberos\nimplementation may then be subject to exploitation. To reduce the attack\nsurface of the system, the Kerberos authentication mechanism within SSH must be\ndisabled.",
      "descriptions": {
        "default": "If Kerberos is enabled through SSH, sshd provides a means of access to\nthe system's Kerberos implementation. Vulnerabilities in the system's Kerberos\nimplementation may then be subject to exploitation. To reduce the attack\nsurface of the system, the Kerberos authentication mechanism within SSH must be\ndisabled.",
        "check": "At the command line, execute the following command:\n\n# sshd -T|&grep -i KerberosAuthentication\n\nExpected result:\n\nKerberosAuthentication no\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/ssh/sshd_config with a text editor and ensure that the\n\"KerberosAuthentication\" line is uncommented and set to the following:\n\nKerberosAuthentication no\n\nAt the command line, execute the following command:\n\n# service sshd reload"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000087",
        "stig_id": "PHTN-10-000087",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000087\" do\n  title \"The Photon operating system must configure sshd to disallow Kerberos\nauthentication.\"\n  desc  \"If Kerberos is enabled through SSH, sshd provides a means of access to\nthe system's Kerberos implementation. Vulnerabilities in the system's Kerberos\nimplementation may then be subject to exploitation. To reduce the attack\nsurface of the system, the Kerberos authentication mechanism within SSH must be\ndisabled.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000087\"\n  tag stig_id: \"PHTN-10-000087\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# sshd -T|&grep -i KerberosAuthentication\n\nExpected result:\n\nKerberosAuthentication no\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/ssh/sshd_config with a text editor and ensure that the\n\\\"KerberosAuthentication\\\" line is uncommented and set to the following:\n\nKerberosAuthentication no\n\nAt the command line, execute the following command:\n\n# service sshd reload\"\n\n  describe command('sshd -T|&grep -i KerberosAuthentication') do\n    its ('stdout.strip') { should cmp 'KerberosAuthentication no' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000087.rb",
        "line": 1
      },
      "id": "PHTN-10-000087"
    },
    {
      "title": "The Photon operating system must ensure that root $PATH entries are\nappropriate.",
      "desc": "The $PATH variable contains semi-colon delimited set of directories\nthat allows root to not specify the full path for a limited set of binaries.\nHaving unexpected directories in $PATH can lead to root running a binary other\nthan the one intended.",
      "descriptions": {
        "default": "The $PATH variable contains semi-colon delimited set of directories\nthat allows root to not specify the full path for a limited set of binaries.\nHaving unexpected directories in $PATH can lead to root running a binary other\nthan the one intended.",
        "check": "At the command line, execute the following command:\n\n# echo $PATH\n\nExpected result:\n\n/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/java/jre-vmware/bin:/opt/vmware/bin\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "At the command line, execute the following command:\n\n# export\nPATH=/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/java/jre-vmware/bin:/opt/vmware/bin"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000079",
        "stig_id": "PHTN-10-000079",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000079\" do\n  title \"The Photon operating system must ensure that root $PATH entries are\nappropriate.\"\n  desc  \"The $PATH variable contains semi-colon delimited set of directories\nthat allows root to not specify the full path for a limited set of binaries.\nHaving unexpected directories in $PATH can lead to root running a binary other\nthan the one intended.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000079\"\n  tag stig_id: \"PHTN-10-000079\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# echo $PATH\n\nExpected result:\n\n/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/java/jre-vmware/bin:/opt/vmware/bin\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following command:\n\n# export\nPATH=/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/java/jre-vmware/bin:/opt/vmware/bin\"\n\n  describe command('echo $PATH') do\n      its ('stdout.strip') { should cmp '/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/java/jre-vmware/bin:/opt/vmware/bin' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000079.rb",
        "line": 1
      },
      "id": "PHTN-10-000079"
    },
    {
      "title": "The Photon operating system must automatically lock an account when\nthree unsuccessful logon attempts occur.",
      "desc": "By limiting the number of failed logon attempts, the risk of\nunauthorized system access via user password guessing, otherwise known as\nbrute-force attacks, is reduced. Limits are imposed by locking the account.",
      "descriptions": {
        "default": "By limiting the number of failed logon attempts, the risk of\nunauthorized system access via user password guessing, otherwise known as\nbrute-force attacks, is reduced. Limits are imposed by locking the account.",
        "check": "At the command line, execute the following command:\n\n# grep pam_tally2 /etc/pam.d/system-auth|grep --color=always \"deny=.\"\n\nExpected result:\n\nauth required pam_tally2.so file=/var/log/tallylog\ndeny=3 onerr=fail even_deny_root unlock_time=86400 root_unlock_time=300\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/pam.d/system-auth with a text editor\n\nAdd the following line after the last auth statement:\n\nauth required pam_tally2.so file=/var/log/tallylog\ndeny=3 onerr=fail even_deny_root unlock_time=86400 root_unlock_time=300"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000021-GPOS-00005",
        "gid": null,
        "rid": "PHTN-10-000002",
        "stig_id": "PHTN-10-000002",
        "cci": "CCI-000044",
        "nist": [
          "AC-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000002\" do\n  title \"The Photon operating system must automatically lock an account when\nthree unsuccessful logon attempts occur.\"\n  desc  \"By limiting the number of failed logon attempts, the risk of\nunauthorized system access via user password guessing, otherwise known as\nbrute-force attacks, is reduced. Limits are imposed by locking the account.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000021-GPOS-00005\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000002\"\n  tag stig_id: \"PHTN-10-000002\"\n  tag cci: \"CCI-000044\"\n  tag nist: [\"AC-7 a\", \"Rev_4\"]\ndesc 'check', \"At the command line, execute the following command:\n\n# grep pam_tally2 /etc/pam.d/system-auth|grep --color=always \\\"deny=.\\\"\n\nExpected result:\n\nauth required pam_tally2.so file=/var/log/tallylog\ndeny=3 onerr=fail even_deny_root unlock_time=86400 root_unlock_time=300\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/pam.d/system-auth with a text editor\n\nAdd the following line after the last auth statement:\n\nauth required pam_tally2.so file=/var/log/tallylog\ndeny=3 onerr=fail even_deny_root unlock_time=86400 root_unlock_time=300\"\n\n  describe file ('/etc/pam.d/system-auth') do\n    its ('content'){should match /^(?=.*?\\bauth\\b)(?=.*?\\brequired\\b)(?=.*?\\bdeny=3\\b).*$/}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000002.rb",
        "line": 1
      },
      "id": "PHTN-10-000002"
    },
    {
      "title": "The Photon operating system must protect audit tools from unauthorized\nmodification.",
      "desc": "Protecting audit information also includes identifying and protecting\nthe tools used to view and manipulate log data. Therefore, protecting audit\ntools is necessary to prevent unauthorized operation on audit information.",
      "descriptions": {
        "default": "Protecting audit information also includes identifying and protecting\nthe tools used to view and manipulate log data. Therefore, protecting audit\ntools is necessary to prevent unauthorized operation on audit information.",
        "check": "At the command line, execute the following command:\n\n# stat -c \"%n permissions are %a\" /usr/sbin/auditctl /usr/sbin/auditd\n/usr/sbin/aureport /usr/sbin/ausearch /usr/sbin/autrace\n\nIf any fileis more permissive than 750, this is a finding.",
        "fix": "At the command line, execute the following command for each file\nreturned:\n\n# chmod 750 <file>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000257-GPOS-00098",
        "gid": null,
        "rid": "PHTN-10-000051",
        "stig_id": "PHTN-10-000051",
        "cci": "CCI-001494",
        "nist": [
          "AU-9",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000051\" do\n  title \"The Photon operating system must protect audit tools from unauthorized\nmodification.\"\n  desc  \"Protecting audit information also includes identifying and protecting\nthe tools used to view and manipulate log data. Therefore, protecting audit\ntools is necessary to prevent unauthorized operation on audit information.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000257-GPOS-00098\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000051\"\n  tag stig_id: \"PHTN-10-000051\"\n  tag cci: \"CCI-001494\"\n  tag nist: [\"AU-9\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# stat -c \\\"%n permissions are %a\\\" /usr/sbin/auditctl /usr/sbin/auditd\n/usr/sbin/aureport /usr/sbin/ausearch /usr/sbin/autrace\n\nIf any fileis more permissive than 750, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following command for each file\nreturned:\n\n# chmod 750 <file>\"\n\n  describe file('/usr/sbin/auditctl') do\n      it { should_not be_more_permissive_than('0750') }\n  end\n\n  describe file('/usr/sbin/auditd') do\n      it { should_not be_more_permissive_than('0750') }\n  end\n\n  describe file('/usr/sbin/aureport') do\n      it { should_not be_more_permissive_than('0750') }\n  end\n\n  describe file('/usr/sbin/ausearch') do\n      it { should_not be_more_permissive_than('0750') }\n  end\n\n  describe file('/usr/sbin/autrace') do\n      it { should_not be_more_permissive_than('0750') }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000051.rb",
        "line": 1
      },
      "id": "PHTN-10-000051"
    },
    {
      "title": "The Photon operating system must have sshd authentication logging\nenabled.",
      "desc": "Automated monitoring of remote access sessions allows organizations to\ndetect cyber attacks and ensure ongoing compliance with remote access policies\nby auditing connection activities.\n\n    Shipping sshd authentication events to syslog allows organizations to use\ntheir log aggregators to correlate forensic activities among multiple systems.",
      "descriptions": {
        "default": "Automated monitoring of remote access sessions allows organizations to\ndetect cyber attacks and ensure ongoing compliance with remote access policies\nby auditing connection activities.\n\n    Shipping sshd authentication events to syslog allows organizations to use\ntheir log aggregators to correlate forensic activities among multiple systems.",
        "check": "At the command line, execute the following command:\n\n# grep \"^authpriv\" /etc/rsyslog.conf\n\nExpected result:\n\nauthpriv.*   /var/log/audit/sshinfo.log\n\nIf the command does not return any output, this is a finding.",
        "fix": "Open /etc/rsyslog.conf with a text editor and locate the\nfollowing line:\n\n$IncludeConfig /etc/vmware-syslog/syslog.conf\n\nEnsure that the following entry is put beneath the stated line and before the\n\"# vmware services\" line.\n\nauthpriv.*   /var/log/audit/sshinfo.log\n\nIf the following line is at the end of the file it must be removed or commented\nout:\n\nauth.* /var/log/auth.log\n\nAt the command line, execute the following command:\n\n# systemctl restart syslog\n# service sshd reload"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000032-GPOS-00013",
        "gid": null,
        "rid": "PHTN-10-000007",
        "stig_id": "PHTN-10-000007",
        "cci": "CCI-000067",
        "nist": [
          "AC-17 (1)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000007\" do\n  title \"The Photon operating system must have sshd authentication logging\nenabled.\"\n  desc  \"Automated monitoring of remote access sessions allows organizations to\ndetect cyber attacks and ensure ongoing compliance with remote access policies\nby auditing connection activities.\n\n    Shipping sshd authentication events to syslog allows organizations to use\ntheir log aggregators to correlate forensic activities among multiple systems.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000032-GPOS-00013\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000007\"\n  tag stig_id: \"PHTN-10-000007\"\n  tag cci: \"CCI-000067\"\n  tag nist: [\"AC-17 (1)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep \\\"^authpriv\\\" /etc/rsyslog.conf\n\nExpected result:\n\nauthpriv.*   /var/log/audit/sshinfo.log\n\nIf the command does not return any output, this is a finding.\n\"\n  desc 'fix', \"Open /etc/rsyslog.conf with a text editor and locate the\nfollowing line:\n\n$IncludeConfig /etc/vmware-syslog/syslog.conf\n\nEnsure that the following entry is put beneath the stated line and before the\n\\\"# vmware services\\\" line.\n\nauthpriv.*   /var/log/audit/sshinfo.log\n\nIf the following line is at the end of the file it must be removed or commented\nout:\n\nauth.* /var/log/auth.log\n\nAt the command line, execute the following command:\n\n# systemctl restart syslog\n# service sshd reload\"\n\n  describe command('grep \"authpriv\" /etc/rsyslog.conf') do\n    its ('stdout.strip') { should cmp 'authpriv.*   /var/log/audit/sshinfo.log' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000007.rb",
        "line": 1
      },
      "id": "PHTN-10-000007"
    },
    {
      "title": "The Photon operating system must be configured so that the x86\nCtrl-Alt-Delete key sequence is disabled on the command line.",
      "desc": "When the Ctrl-Alt-Del target is enabled, locally logged-on user who\npresses Ctrl-Alt-Delete, when at the console, can reboot the system. If\naccidentally pressed, as could happen in the case of a mixed OS environment,\nthis can create the risk of short-term loss of availability of systems due to\nunintentional reboot.",
      "descriptions": {
        "default": "When the Ctrl-Alt-Del target is enabled, locally logged-on user who\npresses Ctrl-Alt-Delete, when at the console, can reboot the system. If\naccidentally pressed, as could happen in the case of a mixed OS environment,\nthis can create the risk of short-term loss of availability of systems due to\nunintentional reboot.",
        "check": "At the command line, execute the following command:\n\n# systemctl status ctrl-alt-del.target\n\nExpected result:\n\nctrl-alt-del.target\nLoaded: masked (/dev/null; bad)\nActive: inactive (dead)\n\nIf the output does not match the expected result, this is a finding",
        "fix": "At the command line, execute the following command:\n\n# systemctl mask ctrl-alt-del.target"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000095",
        "stig_id": "PHTN-10-000095",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000095\" do\n  title \"The Photon operating system must be configured so that the x86\nCtrl-Alt-Delete key sequence is disabled on the command line.\"\n  desc  \"When the Ctrl-Alt-Del target is enabled, locally logged-on user who\npresses Ctrl-Alt-Delete, when at the console, can reboot the system. If\naccidentally pressed, as could happen in the case of a mixed OS environment,\nthis can create the risk of short-term loss of availability of systems due to\nunintentional reboot. \"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000095\"\n  tag stig_id: \"PHTN-10-000095\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# systemctl status ctrl-alt-del.target\n\nExpected result:\n\nctrl-alt-del.target\nLoaded: masked (/dev/null; bad)\nActive: inactive (dead)\n\nIf the output does not match the expected result, this is a finding\"\n  desc 'fix', \"At the command line, execute the following command:\n\n# systemctl mask ctrl-alt-del.target\"\n\n  describe systemd_service('ctrl-alt-del.target') do\n    it { should_not be_enabled}\n    it { should_not be_running}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000095.rb",
        "line": 1
      },
      "id": "PHTN-10-000095"
    },
    {
      "title": "The Photon operating system must configure sshd to use privilege\nseparation.",
      "desc": "Privilege separation in sshd causes the process to drop root\nprivileges when not needed, which would decrease the impact of software\nvulnerabilities in the unprivileged section.",
      "descriptions": {
        "default": "Privilege separation in sshd causes the process to drop root\nprivileges when not needed, which would decrease the impact of software\nvulnerabilities in the unprivileged section.",
        "check": "At the command line, execute the following command:\n\n# sshd -T|&grep -i UsePrivilegeSeparation\n\nExpected result:\n\nUsePrivilegeSeparation yes\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/ssh/sshd_config with a text editor and ensure that the\n\"UsePrivilegeSeparation\" line is uncommented and set to the following:\n\nUsePrivilegeSeparation yes\n\nAt the command line, execute the following command:\n\n# service sshd reload"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000088",
        "stig_id": "PHTN-10-000088",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000088\" do\n  title \"The Photon operating system must configure sshd to use privilege\nseparation.\"\n  desc  \"Privilege separation in sshd causes the process to drop root\nprivileges when not needed, which would decrease the impact of software\nvulnerabilities in the unprivileged section.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000088\"\n  tag stig_id: \"PHTN-10-000088\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# sshd -T|&grep -i UsePrivilegeSeparation\n\nExpected result:\n\nUsePrivilegeSeparation yes\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/ssh/sshd_config with a text editor and ensure that the\n\\\"UsePrivilegeSeparation\\\" line is uncommented and set to the following:\n\nUsePrivilegeSeparation yes\n\nAt the command line, execute the following command:\n\n# service sshd reload\"\n\n  describe command('sshd -T|&grep -i UsePrivilegeSeparation') do\n    its ('stdout.strip') { should cmp 'UsePrivilegeSeparation yes' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000088.rb",
        "line": 1
      },
      "id": "PHTN-10-000088"
    },
    {
      "title": "The Photon operating system must store only encrypted representations\nof passwords.",
      "desc": "Passwords must be protected at all times via strong, one way\nencryption. If passwords are not encrypted, they can be plainly read (i.e.,\nclear text) and easily compromised. If they are encrypted with a weak cipher,\nthose password are much more vulnerability to offline bute forcing attacks.",
      "descriptions": {
        "default": "Passwords must be protected at all times via strong, one way\nencryption. If passwords are not encrypted, they can be plainly read (i.e.,\nclear text) and easily compromised. If they are encrypted with a weak cipher,\nthose password are much more vulnerability to offline bute forcing attacks.",
        "check": "At the command line, execute the following command:\n\n# grep password /etc/pam.d/system-password|grep --color=always \"sha512\"\n\nIf the output does not include \"sha512\", this is a finding.",
        "fix": "Open /etc/pam.d/system-password with a text editor.\n\nAdd the following argument (sha512) to the password line:\npassword required pam_unix.so sha512 shadow try_first_pass"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000073-GPOS-00041",
        "gid": null,
        "rid": "PHTN-10-000025",
        "stig_id": "PHTN-10-000025",
        "cci": "CCI-000196",
        "nist": [
          "IA-5 (1) (c)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000025\" do\n  title \"The Photon operating system must store only encrypted representations\nof passwords.\"\n  desc  \"Passwords must be protected at all times via strong, one way\nencryption. If passwords are not encrypted, they can be plainly read (i.e.,\nclear text) and easily compromised. If they are encrypted with a weak cipher,\nthose password are much more vulnerability to offline bute forcing attacks.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000073-GPOS-00041\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000025\"\n  tag stig_id: \"PHTN-10-000025\"\n  tag cci: \"CCI-000196\"\n  tag nist: [\"IA-5 (1) (c)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep password /etc/pam.d/system-password|grep --color=always \\\"sha512\\\"\n\nIf the output does not include \\\"sha512\\\", this is a finding.\"\n  desc 'fix', \"Open /etc/pam.d/system-password with a text editor.\n\nAdd the following argument (sha512) to the password line:\npassword required pam_unix.so sha512 shadow try_first_pass\n\"\n\n  describe file ('/etc/pam.d/system-password') do\n      its ('content'){should match /^(?=.*?\\bpassword\\b)(?=.*?\\brequired\\b)(?=.*?\\bsha512\\b).*$/}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000025.rb",
        "line": 1
      },
      "id": "PHTN-10-000025"
    },
    {
      "title": "The Photon operating system must configure sshd to display the last\nlogin immeidately after authentication.",
      "desc": "Providing users with feedback on the alst time they logged on via SSH\nfacilitates user recognition and reporting of unauthorized account use.",
      "descriptions": {
        "default": "Providing users with feedback on the alst time they logged on via SSH\nfacilitates user recognition and reporting of unauthorized account use.",
        "check": "At the command line, execute the following command:\n\n# sshd -T|&grep -i PrintLastLog\n\nExpected result:\n\nPrintLastLog yes\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/ssh/sshd_config with a text editor and ensure that the\n\"PrintLastLog\" line is uncommented and set to the following:\n\nPrintLastLog yes\n\nAt the command line, execute the following command:\n\n# service sshd reload"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000091",
        "stig_id": "PHTN-10-000091",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000091\" do\n  title \"The Photon operating system must configure sshd to display the last\nlogin immeidately after authentication.\"\n  desc  \"Providing users with feedback on the alst time they logged on via SSH\nfacilitates user recognition and reporting of unauthorized account use.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000091\"\n  tag stig_id: \"PHTN-10-000091\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# sshd -T|&grep -i PrintLastLog\n\nExpected result:\n\nPrintLastLog yes\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/ssh/sshd_config with a text editor and ensure that the\n\\\"PrintLastLog\\\" line is uncommented and set to the following:\n\nPrintLastLog yes\n\nAt the command line, execute the following command:\n\n# service sshd reload\"\n\n  describe command('sshd -T|&grep -i PrintLastLog') do\n    its ('stdout.strip') { should cmp 'PrintLastLog yes' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000091.rb",
        "line": 1
      },
      "id": "PHTN-10-000091"
    },
    {
      "title": "The Photon operating system must configure rsyslog to offload system\nlogs to a central server.",
      "desc": "Information stored in one location is vulnerable to accidental or\nincidental deletion or alteration. Proper configuration of rsyslog ensures that\ninformation critical to forensic analysis of security events is available for\nfuture action without any manual offloading or cron jobs.",
      "descriptions": {
        "default": "Information stored in one location is vulnerable to accidental or\nincidental deletion or alteration. Proper configuration of rsyslog ensures that\ninformation critical to forensic analysis of security events is available for\nfuture action without any manual offloading or cron jobs.",
        "check": "At the command line, execute the following command:\n\n# cat /etc/vmware-syslog/syslog.conf\n\nThe output should be similar to the following:\n\n*.* @<syslog server>:port;RSYSLOG_syslogProtocol23Format\n\nIf no line is returned, if the line is commented or no valid syslog server is\nspecified, this is a finding.\n\nOR\n\nNavigate to https://<hostname>:5480 to access the Virtual Appliance Management\nInferface (VAMI). Authenticate and navigate to \"Syslog Configuration\". If\nthere is no site-specific syslog server is configured, this is a finding.",
        "fix": "Open /etc/vmware-syslog/syslog.conf with a text editor. Remove any\nexisting content and create a new remote server configuration line:\n\nFor UDP\n\n*.* @<syslog server>:port;RSYSLOG_syslogProtocol23Format\n\nFor TCP\n\n*.* @@<syslog server>:port;RSYSLOG_syslogProtocol23Format\n\nOR\n\nNavigate to https://<hostname>:5480 to access the Virtual Appliance Management\nInferface (VAMI). Authenticate and navigate to \"Syslog Configuration\". Click\n\"Edit\" in the top right. Configure a remote syslog server and click \"OK\"."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000205-GPOS-00083",
        "gid": null,
        "rid": "PHTN-10-000040",
        "stig_id": "PHTN-10-000040",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000040\" do\n  title \"The Photon operating system must configure rsyslog to offload system\nlogs to a central server.\"\n  desc  \"Information stored in one location is vulnerable to accidental or\nincidental deletion or alteration. Proper configuration of rsyslog ensures that\ninformation critical to forensic analysis of security events is available for\nfuture action without any manual offloading or cron jobs.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000205-GPOS-00083\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000040\"\n  tag stig_id: \"PHTN-10-000040\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# cat /etc/vmware-syslog/syslog.conf\n\nThe output should be similar to the following:\n\n*.* @<syslog server>:port;RSYSLOG_syslogProtocol23Format\n\nIf no line is returned, if the line is commented or no valid syslog server is\nspecified, this is a finding.\n\nOR\n\nNavigate to https://<hostname>:5480 to access the Virtual Appliance Management\nInferface (VAMI). Authenticate and navigate to \\\"Syslog Configuration\\\". If\nthere is no site-specific syslog server is configured, this is a finding.\"\n  desc 'fix', \"Open /etc/vmware-syslog/syslog.conf with a text editor. Remove any\nexisting content and create a new remote server configuration line:\n\nFor UDP\n\n*.* @<syslog server>:port;RSYSLOG_syslogProtocol23Format\n\nFor TCP\n\n*.* @@<syslog server>:port;RSYSLOG_syslogProtocol23Format\n\nOR\n\nNavigate to https://<hostname>:5480 to access the Virtual Appliance Management\nInferface (VAMI). Authenticate and navigate to \\\"Syslog Configuration\\\". Click\n\\\"Edit\\\" in the top right. Configure a remote syslog server and click \\\"OK\\\".\"\n\n  describe file ('/etc/vmware-syslog/syslog.conf') do\n    its ('content') { should match /^.*#{input('syslogServer')}.*$/ }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000040.rb",
        "line": 1
      },
      "id": "PHTN-10-000040"
    },
    {
      "title": "The Photon operating system must have the auditd service running.",
      "desc": "Without the capability to generate audit records, it would be\ndifficult to establish, correlate, and investigate the events relating to an\nincident or identify those responsible for one. To that end, the auditd service\nmust be configured to start automatically and be running at all times.",
      "descriptions": {
        "default": "Without the capability to generate audit records, it would be\ndifficult to establish, correlate, and investigate the events relating to an\nincident or identify those responsible for one. To that end, the auditd service\nmust be configured to start automatically and be running at all times.",
        "check": "At the command line, execute the following command:\n\n# service auditd status | grep running\n\nIf the service is not running this is a finding.",
        "fix": "At the command line, execute the following command:\n\n# systemctl enable auditd.service\n# service auditd start"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000062-GPOS-00031",
        "gid": null,
        "rid": "PHTN-10-000018",
        "stig_id": "PHTN-10-000018",
        "cci": "CCI-000169",
        "nist": [
          "AU-12 a",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000018\" do\n  title \"The Photon operating system must have the auditd service running.\"\n  desc  \"Without the capability to generate audit records, it would be\ndifficult to establish, correlate, and investigate the events relating to an\nincident or identify those responsible for one. To that end, the auditd service\nmust be configured to start automatically and be running at all times.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000062-GPOS-00031\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000018\"\n  tag stig_id: \"PHTN-10-000018\"\n  tag cci: \"CCI-000169\"\n  tag nist: [\"AU-12 a\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# service auditd status | grep running\n\nIf the service is not running this is a finding.\"\n  desc 'fix', \"At the command line, execute the following command:\n\n# systemctl enable auditd.service\n# service auditd start\"\n\n  describe systemd_service('auditd') do\n    it { should be_installed}\n    it { should be_enabled}\n    it { should be_running}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000018.rb",
        "line": 1
      },
      "id": "PHTN-10-000018"
    },
    {
      "title": "The Photon operating system must prevent IPv4 Internet Control Message\nProtocol (ICMP) redirect messages from being accepted.",
      "desc": "ICMP redirect messages are used by routers to inform hosts that a more\ndirect route exists for a particular destination. These messages modify the\nhost's route table and are unauthenticated. An illicit ICMP redirect message\ncould result in a man-in-the-middle attack.",
      "descriptions": {
        "default": "ICMP redirect messages are used by routers to inform hosts that a more\ndirect route exists for a particular destination. These messages modify the\nhost's route table and are unauthenticated. An illicit ICMP redirect message\ncould result in a man-in-the-middle attack.",
        "check": "At the command line, execute the following command:\n\n# /sbin/sysctl -a --pattern\n\"net.ipv4.conf.(all|default|eth.*).accept_redirects\"\n\nExpected result:\n\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\nnet.ipv4.conf.eth0.accept_redirects = 0\n\nIf the output does not match the expected result, this is a finding.\n\nNote: The number of ethx lines returned is dependant on the number of\ninterfaces. Every ethx entry must be set to 0.",
        "fix": "At the command line, execute the following command:\n\n# for SETTING in $(/sbin/sysctl -aN --pattern\n\"net.ipv4.conf.(all|default|eth.*).accept_redirects\"); do sed -i -e\n\"/^${SETTING}/d\" /etc/sysctl.conf;echo $SETTING=0>>/etc/sysctl.conf; done"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000106",
        "stig_id": "PHTN-10-000106",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000106\" do\n  title \"The Photon operating system must prevent IPv4 Internet Control Message\nProtocol (ICMP) redirect messages from being accepted.\"\n  desc  \"ICMP redirect messages are used by routers to inform hosts that a more\ndirect route exists for a particular destination. These messages modify the\nhost's route table and are unauthenticated. An illicit ICMP redirect message\ncould result in a man-in-the-middle attack.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000106\"\n  tag stig_id: \"PHTN-10-000106\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# /sbin/sysctl -a --pattern\n\\\"net.ipv4.conf.(all|default|eth.*).accept_redirects\\\"\n\nExpected result:\n\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\nnet.ipv4.conf.eth0.accept_redirects = 0\n\nIf the output does not match the expected result, this is a finding.\n\nNote: The number of ethx lines returned is dependant on the number of\ninterfaces. Every ethx entry must be set to 0.\"\n  desc 'fix', \"At the command line, execute the following command:\n\n# for SETTING in $(/sbin/sysctl -aN --pattern\n\\\"net.ipv4.conf.(all|default|eth.*).accept_redirects\\\"); do sed -i -e\n\\\"/^${SETTING}/d\\\" /etc/sysctl.conf;echo $SETTING=0>>/etc/sysctl.conf; done\"\n\n  describe kernel_parameter('net.ipv4.conf.all.accept_redirects') do\n    its('value') { should eq 0 }\n  end\n\n  describe kernel_parameter('net.ipv4.conf.default.accept_redirects') do\n    its('value') { should eq 0 }\n  end\n\n  describe kernel_parameter('net.ipv4.conf.eth0.accept_redirects') do\n    its('value') { should eq 0 }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000106.rb",
        "line": 1
      },
      "id": "PHTN-10-000106"
    },
    {
      "title": "The Photon operating system must be configured so that the /root path\nis protected from unauthorized access.",
      "desc": "If the /root path is accessible from users other than root,\nunauthorized users could change the root partitions files.",
      "descriptions": {
        "default": "If the /root path is accessible from users other than root,\nunauthorized users could change the root partitions files.",
        "check": "At the command line, execute the following command:\n\n# stat -c \"%n permissions are %a and owned by %U:%G\" /root\n\nExpected result:\n\n/root permissions are 700 and owned by root:root\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "At the command line, execute the following commands:\n\n# chmod 700 /root\n# chown root:root /root"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000097",
        "stig_id": "PHTN-10-000097",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000097\" do\n  title \"The Photon operating system must be configured so that the /root path\nis protected from unauthorized access.\"\n  desc  \"If the /root path is accessible from users other than root,\nunauthorized users could change the root partitions files.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000097\"\n  tag stig_id: \"PHTN-10-000097\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# stat -c \\\"%n permissions are %a and owned by %U:%G\\\" /root\n\nExpected result:\n\n/root permissions are 700 and owned by root:root\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following commands:\n\n# chmod 700 /root\n# chown root:root /root\"\n\n  describe directory('/root') do\n      its('owner') { should cmp 'root' }\n      its('group') { should cmp 'root' }\n      its('mode') { should cmp '0700' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000097.rb",
        "line": 1
      },
      "id": "PHTN-10-000097"
    },
    {
      "title": "The Photon operating system must enforce a delay of at least 4 seconds\nbetween logon prompts following a failed logon attempt.",
      "desc": "Limiting the number of logon attempts over a certain time interval\nreduces the chances that an unauthorized user may gain access to an account.",
      "descriptions": {
        "default": "Limiting the number of logon attempts over a certain time interval\nreduces the chances that an unauthorized user may gain access to an account.",
        "check": "At the command line, execute the following command:\n\n# grep pam_faildelay /etc/pam.d/system-auth|grep --color=always \"delay=\"\n\nExpected result:\n\nauth optional pam_faildelay.so delay=4000000\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/pam.d/system-auth with a text editor.\n\nRemove any existing pam_faildelay line and add the follwing line at the end of\nthe file:\n\nauth optional pam_faildelay.so delay=4000000"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00226",
        "gid": null,
        "rid": "PHTN-10-000077",
        "stig_id": "PHTN-10-000077",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000077\" do\n  title \"The Photon operating system must enforce a delay of at least 4 seconds\nbetween logon prompts following a failed logon attempt.\"\n  desc  \"Limiting the number of logon attempts over a certain time interval\nreduces the chances that an unauthorized user may gain access to an account.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00226\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000077\"\n  tag stig_id: \"PHTN-10-000077\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep pam_faildelay /etc/pam.d/system-auth|grep --color=always \\\"delay=\\\"\n\nExpected result:\n\nauth optional pam_faildelay.so delay=4000000\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/pam.d/system-auth with a text editor.\n\nRemove any existing pam_faildelay line and add the follwing line at the end of\nthe file:\n\nauth optional pam_faildelay.so delay=4000000\"\n\n  describe file ('/etc/pam.d/system-auth') do\n      its ('content'){should match /^(?=.*?\\bauth\\b)(?=.*?\\boptional\\b)(?=.*?\\bpam_faildelay.so\\b)(?=.*?\\bdelay=4000000\\b).*$/}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000077.rb",
        "line": 1
      },
      "id": "PHTN-10-000077"
    },
    {
      "title": "The Photon operating system must audit all account removal actions.",
      "desc": "When operating system accounts are removed, user accessibility is\naffected. Accounts are utilized for identifying individual users or for\nidentifying the operating system processes themselves. In order to detect and\nrespond to events affecting user accessibility and system processing, operating\nsystems must audit account removal actions.",
      "descriptions": {
        "default": "When operating system accounts are removed, user accessibility is\naffected. Accounts are utilized for identifying individual users or for\nidentifying the operating system processes themselves. In order to detect and\nrespond to events affecting user accessibility and system processing, operating\nsystems must audit account removal actions.",
        "check": "At the command line, execute the following command:\n\n# auditctl -l | grep -E \"(userdel|groupdel)\"\n\nExpected result:\n\n-w /usr/sbin/userdel -p x -k userdel\n-w /usr/sbin/groupdel -p x -k groupdel\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "At the command line, execute the following commands:\n\n# echo '-w /usr/sbin/userdel -p x -k userdel' >>\n/etc/audit/rules.d/audit.STIG.rules\n# echo '-w /usr/sbin/groupdel -p x -k groupdel' >>\n/etc/audit/rules.d/audit.STIG.rules\n# /sbin/augenrules --load"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000241-GPOS-00091",
        "gid": null,
        "rid": "PHTN-10-00004",
        "stig_id": "PHTN-10-000047",
        "cci": "CCI-001405",
        "nist": [
          "AC-2 (4)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000047\" do\n  title \"The Photon operating system must audit all account removal actions.\"\n  desc  \"When operating system accounts are removed, user accessibility is\naffected. Accounts are utilized for identifying individual users or for\nidentifying the operating system processes themselves. In order to detect and\nrespond to events affecting user accessibility and system processing, operating\nsystems must audit account removal actions.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000241-GPOS-00091\"\n  tag gid: nil\n  tag rid: \"PHTN-10-00004\"\n  tag stig_id: \"PHTN-10-000047\"\n  tag cci: \"CCI-001405\"\n  tag nist: [\"AC-2 (4)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# auditctl -l | grep -E \\\"(userdel|groupdel)\\\"\n\nExpected result:\n\n-w /usr/sbin/userdel -p x -k userdel\n-w /usr/sbin/groupdel -p x -k groupdel\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following commands:\n\n# echo '-w /usr/sbin/userdel -p x -k userdel' >>\n/etc/audit/rules.d/audit.STIG.rules\n# echo '-w /usr/sbin/groupdel -p x -k groupdel' >>\n/etc/audit/rules.d/audit.STIG.rules\n# /sbin/augenrules --load\"\n\n  describe auditd do\n    its(\"lines\") { should include %r{-w /usr/sbin/userdel -p x -k userdel} }\n    its(\"lines\") { should include %r{-w /usr/sbin/groupdel -p x -k groupdel} }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000047.rb",
        "line": 1
      },
      "id": "PHTN-10-000047"
    },
    {
      "title": "The Photon operating system must disable new accounts immediately upon\npassword expiration.",
      "desc": "Inactive identifiers pose a risk to systems and applications because\nattackers may exploit an inactive identifier and potentially obtain undetected\naccess to the system. Owners of inactive accounts will not notice if\nunauthorized access to their user account has been obtained.\n\n    Disabling inactive accounts ensures that accounts which may not have been\nresponsibly removed are not available to attackers who may have compromised\ntheir credentials.",
      "descriptions": {
        "default": "Inactive identifiers pose a risk to systems and applications because\nattackers may exploit an inactive identifier and potentially obtain undetected\naccess to the system. Owners of inactive accounts will not notice if\nunauthorized access to their user account has been obtained.\n\n    Disabling inactive accounts ensures that accounts which may not have been\nresponsibly removed are not available to attackers who may have compromised\ntheir credentials.",
        "check": "At the command line, execute the following command:\n\n# grep INACTIVE /etc/default/useradd\n\nExpected result:\n\nINACTIVE=0\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/default/useradd with a text editor. Remove and existing\n\"INACTIVE\" line and add the following line:\n\nINACTIVE=0"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000118-GPOS-00060",
        "gid": null,
        "rid": "PHTN-10-000036",
        "stig_id": "PHTN-10-000036",
        "cci": "CCI-000795",
        "nist": [
          "IA-4 e",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000036\" do\n  title \"The Photon operating system must disable new accounts immediately upon\npassword expiration.\"\n  desc  \"Inactive identifiers pose a risk to systems and applications because\nattackers may exploit an inactive identifier and potentially obtain undetected\naccess to the system. Owners of inactive accounts will not notice if\nunauthorized access to their user account has been obtained.\n\n    Disabling inactive accounts ensures that accounts which may not have been\nresponsibly removed are not available to attackers who may have compromised\ntheir credentials.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000118-GPOS-00060\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000036\"\n  tag stig_id: \"PHTN-10-000036\"\n  tag cci: \"CCI-000795\"\n  tag nist: [\"IA-4 e\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep INACTIVE /etc/default/useradd\n\nExpected result:\n\nINACTIVE=0\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/default/useradd with a text editor. Remove and existing\n\\\"INACTIVE\\\" line and add the following line:\n\nINACTIVE=0\"\n\n  describe parse_config_file(\"/etc/default/useradd\") do\n      its('INACTIVE') { should eq '0'}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000036.rb",
        "line": 1
      },
      "id": "PHTN-10-000036"
    },
    {
      "title": "The Photon operating system package files must not be modified.",
      "desc": "Protecting the integrity of the tools used for auditing purposes is a\ncritical step toward ensuring the integrity of audit information. Audit\ninformation includes all information (e.g., audit records, audit settings, and\naudit reports) needed to successfully audit information system activity.\nWithout confidence in the integrity of the auditing system and tools, the\ninformation it provides cannot be trusted.",
      "descriptions": {
        "default": "Protecting the integrity of the tools used for auditing purposes is a\ncritical step toward ensuring the integrity of audit information. Audit\ninformation includes all information (e.g., audit records, audit settings, and\naudit reports) needed to successfully audit information system activity.\nWithout confidence in the integrity of the auditing system and tools, the\ninformation it provides cannot be trusted.",
        "check": "Use the verification capability of rpm to check the MD5 hashes of\nthe audit files on disk versus the expected ones from the installation package.\nAt the command line, execute the following command:\n\n# rpm -V audit | grep \"^..5\" | grep -v \"^...........c\"\n\nIf there is output, this is a finding.",
        "fix": "If the audit system binaries have been altered the system must be\ntaken offline and your ISSM must be notified immediately. Reinstalling the\naudit tools is not supported. The appliance should be restored from a backup, a\nsnapshot or redeployed once the root cause is remediated."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000278-GPOS-00108",
        "gid": null,
        "rid": "PHTN-10-000053",
        "stig_id": "PHTN-10-000053",
        "cci": "CCI-001496",
        "nist": [
          "AU-9 (3)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000053\" do\n  title \"The Photon operating system package files must not be modified.\"\n  desc  \"Protecting the integrity of the tools used for auditing purposes is a\ncritical step toward ensuring the integrity of audit information. Audit\ninformation includes all information (e.g., audit records, audit settings, and\naudit reports) needed to successfully audit information system activity.\nWithout confidence in the integrity of the auditing system and tools, the\ninformation it provides cannot be trusted.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000278-GPOS-00108\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000053\"\n  tag stig_id: \"PHTN-10-000053\"\n  tag cci: \"CCI-001496\"\n  tag nist: [\"AU-9 (3)\", \"Rev_4\"]\n  desc 'check', \"Use the verification capability of rpm to check the MD5 hashes of\nthe audit files on disk versus the expected ones from the installation package.\nAt the command line, execute the following command:\n\n# rpm -V audit | grep \\\"^..5\\\" | grep -v \\\"^...........c\\\"\n\nIf there is output, this is a finding.\"\n  desc 'fix', \"If the audit system binaries have been altered the system must be\ntaken offline and your ISSM must be notified immediately. Reinstalling the\naudit tools is not supported. The appliance should be restored from a backup, a\nsnapshot or redeployed once the root cause is remediated.\"\n\n  describe command('rpm -V audit | grep \"^..5\" | grep -v \"^...........c\"') do\n      its ('stdout') { should eq '' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000053.rb",
        "line": 1
      },
      "id": "PHTN-10-000053"
    },
    {
      "title": "The Photon operating system must display the Standard Mandatory DoD\nNotice and Consent Banner before granting SSH access.",
      "desc": "Display of a standardized and approved use notification before\ngranting access to the operating system ensures privacy and security\nnotification verbiage used is consistent with applicable federal laws,\nExecutive Orders, directives, policies, regulations, standards, and guidance.",
      "descriptions": {
        "default": "Display of a standardized and approved use notification before\ngranting access to the operating system ensures privacy and security\nnotification verbiage used is consistent with applicable federal laws,\nExecutive Orders, directives, policies, regulations, standards, and guidance.",
        "check": "At the command line, execute the following command:\n\n# sshd -T|&grep -i Banner\n\nExpected result:\n\nbanner /etc/issue\n\nIf the output does not match the expected result, this is a finding.\n\nNext, open /etc/issue with a text editor. If the file does not contain the\nStandard Mandatory DoD Notice and Consent Banner, this is a finding.",
        "fix": "At the command line, execute the following commands:\n\n# cp /etc/issue.DoD /etc/issue\n\nOpen /etc/ssh/sshd_config with a text editor and ensure that the \"Banner\"\nline is uncommented and set to the following:\n\nBanner /etc/issue\n\nOpen /etc/issue with a text editor.\n\nEnsure that the file contains the Standard Mandatory DoD Notice and Consent\nBanner.\n\nYou are accessing a U.S. Government (USG) Information System (IS) that is\nprovided for USG-authorized use only. By using this IS (which includes any\ndevice attached to this IS), you consent to the following conditions:\n-The USG routinely intercepts and monitors communications on this IS for\npurposes including, but not limited to, penetration testing, COMSEC monitoring,\nnetwork operations and defense, personnel misconduct (PM), law enforcement\n(LE), and counterintelligence (CI) investigations.\n-At any time, the USG may inspect and seize data stored on this IS.\n-Communications using, or data stored on, this IS are not private, are subject\nto routine monitoring, interception, and search, and may be disclosed or used\nfor any USG authorized purpose.\n-This IS includes security measures (e.g., authentication and access controls)\nto protect USG interests--not for your personal benefit or privacy.\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE\nor CI investigative searching or monitoring of the content of privileged\ncommunications, or work product, related to personal representation or services\nby attorneys, psychotherapists, or clergy, and their assistants. Such\ncommunications and work product are private and confidential. See User\nAgreement for details.\n\nAt the command line, execute the following command:\n\n# service sshd reload"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000023-GPOS-00006",
        "gid": null,
        "rid": "PHTN-10-000003",
        "stig_id": "PHTN-10-000003",
        "cci": "CCI-000048",
        "nist": [
          "AC-8 a",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000003\" do\n  title \"The Photon operating system must display the Standard Mandatory DoD\nNotice and Consent Banner before granting SSH access.\"\n  desc  \"Display of a standardized and approved use notification before\ngranting access to the operating system ensures privacy and security\nnotification verbiage used is consistent with applicable federal laws,\nExecutive Orders, directives, policies, regulations, standards, and guidance.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000023-GPOS-00006\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000003\"\n  tag stig_id: \"PHTN-10-000003\"\n  tag cci: \"CCI-000048\"\n  tag nist: [\"AC-8 a\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# sshd -T|&grep -i Banner\n\nExpected result:\n\nbanner /etc/issue\n\nIf the output does not match the expected result, this is a finding.\n\nNext, open /etc/issue with a text editor. If the file does not contain the\nStandard Mandatory DoD Notice and Consent Banner, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following commands:\n\n# cp /etc/issue.DoD /etc/issue\n\nOpen /etc/ssh/sshd_config with a text editor and ensure that the \\\"Banner\\\"\nline is uncommented and set to the following:\n\nBanner /etc/issue\n\nOpen /etc/issue with a text editor.\n\nEnsure that the file contains the Standard Mandatory DoD Notice and Consent\nBanner.\n\nYou are accessing a U.S. Government (USG) Information System (IS) that is\nprovided for USG-authorized use only. By using this IS (which includes any\ndevice attached to this IS), you consent to the following conditions:\n-The USG routinely intercepts and monitors communications on this IS for\npurposes including, but not limited to, penetration testing, COMSEC monitoring,\nnetwork operations and defense, personnel misconduct (PM), law enforcement\n(LE), and counterintelligence (CI) investigations.\n-At any time, the USG may inspect and seize data stored on this IS.\n-Communications using, or data stored on, this IS are not private, are subject\nto routine monitoring, interception, and search, and may be disclosed or used\nfor any USG authorized purpose.\n-This IS includes security measures (e.g., authentication and access controls)\nto protect USG interests--not for your personal benefit or privacy.\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE\nor CI investigative searching or monitoring of the content of privileged\ncommunications, or work product, related to personal representation or services\nby attorneys, psychotherapists, or clergy, and their assistants. Such\ncommunications and work product are private and confidential. See User\nAgreement for details.\n\nAt the command line, execute the following command:\n\n# service sshd reload\"\n\n  describe command('sshd -T|&grep -i Banner') do\n    its ('stdout.strip') { should cmp 'Banner /etc/issue' }\n  end\n\n  describe file('/etc/issue') do\n    its ('content') {should match /You are accessing a U\\.S\\. Government/}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000003.rb",
        "line": 1
      },
      "id": "PHTN-10-000003"
    },
    {
      "title": "The Photon operating system must set a session inactivity timeout of\n15 minutes or less.",
      "desc": "A session time-out is an action taken when a session goes idle for any\nreason. Rather than relying on the user to manually disconnect their session\nprior to going idle, the Photon operating system must be able to identify when\na session has idled and take action to terminate the session.",
      "descriptions": {
        "default": "A session time-out is an action taken when a session goes idle for any\nreason. Rather than relying on the user to manually disconnect their session\nprior to going idle, the Photon operating system must be able to identify when\na session has idled and take action to terminate the session.",
        "check": "At the command line, execute the following command:\n\n# cat /etc/profile.d/tmout.sh\n\nExpected result:\n\nTMOUT=900\nreadonly TMOUT\nexport TMOUT\nmesg n 2>/dev/null\n\nIf the file tmout.sh does not exist or the output does not look like the\nexpected result, this is a finding.",
        "fix": "Open /etc/profile.d/tmout.sh with a text editor and set it's\ncontent to the following:\n\nTMOUT=900\nreadonly TMOUT\nexport TMOUT\nmesg n 2>/dev/null"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000029-GPOS-00010",
        "gid": null,
        "rid": "PHTN-10-000005",
        "stig_id": "PHTN-10-000005",
        "cci": "CCI-000057",
        "nist": [
          "AC-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000005\" do\n  title \"The Photon operating system must set a session inactivity timeout of\n15 minutes or less.\"\n  desc  \"A session time-out is an action taken when a session goes idle for any\nreason. Rather than relying on the user to manually disconnect their session\nprior to going idle, the Photon operating system must be able to identify when\na session has idled and take action to terminate the session.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000029-GPOS-00010\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000005\"\n  tag stig_id: \"PHTN-10-000005\"\n  tag cci: \"CCI-000057\"\n  tag nist: [\"AC-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# cat /etc/profile.d/tmout.sh\n\nExpected result:\n\nTMOUT=900\nreadonly TMOUT\nexport TMOUT\nmesg n 2>/dev/null\n\nIf the file tmout.sh does not exist or the output does not look like the\nexpected result, this is a finding.\"\n  desc 'fix', \"Open /etc/profile.d/tmout.sh with a text editor and set it's\ncontent to the following:\n\nTMOUT=900\nreadonly TMOUT\nexport TMOUT\nmesg n 2>/dev/null\"\n\n  describe file('/etc/profile.d/tmout.sh') do\n    it { should exist }\n    its('content') { should match %r{TMOUT=900} }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000005.rb",
        "line": 1
      },
      "id": "PHTN-10-000005"
    },
    {
      "title": "The Photon operating system must create a home directory for all new\nlocal interactive user accounts.",
      "desc": "If local interactive users are not assigned a valid home directory,\nthere is no place for the storage and control of files they should own.",
      "descriptions": {
        "default": "If local interactive users are not assigned a valid home directory,\nthere is no place for the storage and control of files they should own.",
        "check": "At the command line, execute the following command:\n\n# grep -i \"^create_home\" /etc/login.defs\n\nIf there is no output or the output does not equal \"CREATE_HOME     yes\",\nthis is a finding.",
        "fix": "Open /etc/login.defs with a text editor.\n\nEnsure that the following is present and any exising CREATE_HOME line is\nremoved.\n\nCREATE_HOME     yes"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000080",
        "stig_id": "PHTN-10-000080",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000080\" do\n  title \"The Photon operating system must create a home directory for all new\nlocal interactive user accounts.\"\n  desc  \"If local interactive users are not assigned a valid home directory,\nthere is no place for the storage and control of files they should own.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000080\"\n  tag stig_id: \"PHTN-10-000080\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep -i \\\"^create_home\\\" /etc/login.defs\n\nIf there is no output or the output does not equal \\\"CREATE_HOME     yes\\\",\nthis is a finding.\"\n  desc 'fix', \"Open /etc/login.defs with a text editor.\n\nEnsure that the following is present and any exising CREATE_HOME line is\nremoved.\n\nCREATE_HOME     yes\"\n\n  describe login_defs do\n    its('CREATE_HOME') { should cmp 'yes' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000080.rb",
        "line": 1
      },
      "id": "PHTN-10-000080"
    },
    {
      "title": "The Photon operating system audit files and directories must have\ncorrect permissions.",
      "desc": "Protecting audit information also includes identifying and protecting\nthe tools used to view and manipulate log data. Therefore, protecting audit\ntools is necessary to prevent unauthorized operation on audit information.",
      "descriptions": {
        "default": "Protecting audit information also includes identifying and protecting\nthe tools used to view and manipulate log data. Therefore, protecting audit\ntools is necessary to prevent unauthorized operation on audit information.",
        "check": "At the command line, execute the following command:\n\n# stat -c \"%n is owned by %U and group owned by %G\" /usr/sbin/auditctl\n/usr/sbin/auditd /usr/sbin/aureport /usr/sbin/ausearch /usr/sbin/autrace\n\nIf any file is not owned by root and group owned by root, this is a finding.",
        "fix": "At the command line, execute the following command for each file\nreturned:\n\n# chown root:root <file>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000256-GPOS-00097",
        "gid": null,
        "rid": "PHTN-10-000050",
        "stig_id": "PHTN-10-000050",
        "cci": "CCI-001493",
        "nist": [
          "AU-9",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000050\" do\n  title \"The Photon operating system audit files and directories must have\ncorrect permissions.\"\n  desc  \"Protecting audit information also includes identifying and protecting\nthe tools used to view and manipulate log data. Therefore, protecting audit\ntools is necessary to prevent unauthorized operation on audit information.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000256-GPOS-00097\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000050\"\n  tag stig_id: \"PHTN-10-000050\"\n  tag cci: \"CCI-001493\"\n  tag nist: [\"AU-9\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# stat -c \\\"%n is owned by %U and group owned by %G\\\" /usr/sbin/auditctl\n/usr/sbin/auditd /usr/sbin/aureport /usr/sbin/ausearch /usr/sbin/autrace\n\nIf any file is not owned by root and group owned by root, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following command for each file\nreturned:\n\n# chown root:root <file>\"\n\n  describe file('/usr/sbin/auditctl') do\n      its('owner') { should cmp 'root' }\n      its('group') { should cmp 'root' }\n  end\n\n  describe file('/usr/sbin/auditd') do\n      its('owner') { should cmp 'root' }\n      its('group') { should cmp 'root' }\n  end\n\n  describe file('/usr/sbin/aureport') do\n      its('owner') { should cmp 'root' }\n      its('group') { should cmp 'root' }\n  end\n\n  describe file('/usr/sbin/ausearch') do\n      its('owner') { should cmp 'root' }\n      its('group') { should cmp 'root' }\n  end\n\n  describe file('/usr/sbin/autrace') do\n      its('owner') { should cmp 'root' }\n      its('group') { should cmp 'root' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000050.rb",
        "line": 1
      },
      "id": "PHTN-10-000050"
    },
    {
      "title": "The Photon operating system must be configured to synchronize with an\napproved DoD time source.",
      "desc": "Inaccurate time stamps make it more difficult to correlate events and\ncan lead to an inaccurate analysis. Determining the correct time a particular\nevent occurred on a system is critical when conducting forensic analysis and\ninvestigating system events. Sources outside the configured acceptable\nallowance (drift) may be inaccurate.\n\n    Synchronizing internal information system clocks provides uniformity of\ntime stamps for information systems with multiple system clocks and systems\nconnected over a network.\n\n    Organizations should consider endpoints that may not have regular access to\nthe authoritative time server (e.g., mobile, teleworking, and tactical\nendpoints).",
      "descriptions": {
        "default": "Inaccurate time stamps make it more difficult to correlate events and\ncan lead to an inaccurate analysis. Determining the correct time a particular\nevent occurred on a system is critical when conducting forensic analysis and\ninvestigating system events. Sources outside the configured acceptable\nallowance (drift) may be inaccurate.\n\n    Synchronizing internal information system clocks provides uniformity of\ntime stamps for information systems with multiple system clocks and systems\nconnected over a network.\n\n    Organizations should consider endpoints that may not have regular access to\nthe authoritative time server (e.g., mobile, teleworking, and tactical\nendpoints).",
        "check": "At the command line, execute the following command:\n\n# grep -E '^\\s*(server|peer|multicastclient)' /etc/ntp.conf\n\nConfirm the servers and peers or multicastclient (as applicable) are local or\nan authoritative U.S. DoD source.\n\nIf no lines are returned or a non-local/non-authoritative time-server is used,\nthis is a finding.\n\nOR\n\nNavigate to https://<hostname>:5480 to access the Virtual Appliance Management\nInferface (VAMI). Authenticate and navigate to \"Time\". If no appropriate time\nserver is specified, this is a finding.",
        "fix": "Open /etc/ntp.conf with a text editor and set it's contents to the\nfollowing:\n\ntinker panic 0\nrestrict default kod nomodify notrap nopeer\nrestrict 127.0.0.1\nrestrict -6 ::1\ndriftfile /var/lib/ntp/drift/ntp.drift\nserver <site-specific-time-source-IP>\n\nAt the command line, execute the following commands:\n\n# chkconfig ntpd on\n# systemctl start ntp\n\nOR\n\nNavigate to https://<hostname>:5480 to access the Virtual Appliance Management\nInferface (VAMI). Authenticate and navigate to \"Time\". Click \"Edit\" in the\ntop right and configure at least one appropriate NTP server. Click \"OK\"."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000355-GPOS-00143",
        "gid": null,
        "rid": "PHTN-10-000061",
        "stig_id": "PHTN-10-000061",
        "cci": "CCI-001891",
        "nist": [
          "AU-8 (1) (a)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000061\" do\n  title \"The Photon operating system must be configured to synchronize with an\napproved DoD time source.\"\n  desc  \"Inaccurate time stamps make it more difficult to correlate events and\ncan lead to an inaccurate analysis. Determining the correct time a particular\nevent occurred on a system is critical when conducting forensic analysis and\ninvestigating system events. Sources outside the configured acceptable\nallowance (drift) may be inaccurate.\n\n    Synchronizing internal information system clocks provides uniformity of\ntime stamps for information systems with multiple system clocks and systems\nconnected over a network.\n\n    Organizations should consider endpoints that may not have regular access to\nthe authoritative time server (e.g., mobile, teleworking, and tactical\nendpoints).\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000355-GPOS-00143\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000061\"\n  tag stig_id: \"PHTN-10-000061\"\n  tag cci: \"CCI-001891\"\n  tag nist: [\"AU-8 (1) (a)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep -E '^\\\\s*(server|peer|multicastclient)' /etc/ntp.conf\n\nConfirm the servers and peers or multicastclient (as applicable) are local or\nan authoritative U.S. DoD source.\n\nIf no lines are returned or a non-local/non-authoritative time-server is used,\nthis is a finding.\n\nOR\n\nNavigate to https://<hostname>:5480 to access the Virtual Appliance Management\nInferface (VAMI). Authenticate and navigate to \\\"Time\\\". If no appropriate time\nserver is specified, this is a finding.\"\n  desc 'fix', \"Open /etc/ntp.conf with a text editor and set it's contents to the\nfollowing:\n\ntinker panic 0\nrestrict default kod nomodify notrap nopeer\nrestrict 127.0.0.1\nrestrict -6 ::1\ndriftfile /var/lib/ntp/drift/ntp.drift\nserver <site-specific-time-source-IP>\n\nAt the command line, execute the following commands:\n\n# chkconfig ntpd on\n# systemctl start ntp\n\nOR\n\nNavigate to https://<hostname>:5480 to access the Virtual Appliance Management\nInferface (VAMI). Authenticate and navigate to \\\"Time\\\". Click \\\"Edit\\\" in the\ntop right and configure at least one appropriate NTP server. Click \\\"OK\\\".\"\n\n  describe ntp_conf do\n    its ('server') { should_not eq nil }\n  end\n\n  describe ntp_conf do\n    its ('server') { should be_in [\"#{input('ntpServer1')}\",\"#{input('ntpServer2')}\"] }\n  end\n\n  describe systemd_service('ntpd') do\n    it { should be_installed}\n    it { should be_enabled}\n    it { should be_running}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000061.rb",
        "line": 1
      },
      "id": "PHTN-10-000061"
    },
    {
      "title": "The Photon operating system must configure a secure umask for all\nshells.",
      "desc": "A user's umask influences the permissions assigned to files that a\nuser creates. Setting an appropriate umask is important to make sure that\ninformation is not exposed to unprivileged users.",
      "descriptions": {
        "default": "A user's umask influences the permissions assigned to files that a\nuser creates. Setting an appropriate umask is important to make sure that\ninformation is not exposed to unprivileged users.",
        "check": "At the command line, execute the following command:\n\n# cat /etc/profile.d/umask.sh\n\nExpected result:\n\n# By default, the umask should be set.\nif [ \"$(id -gn)\" = \"$(id -un)\" -a $EUID -gt 99 ] ; then\n  umask 002\nelse\n  umask 027\nfi\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/profile.d/umask.sh with a text editor.\n\nSet the contents as follows:\n\n# By default, the umask should be set.\nif [ \"$(id -gn)\" = \"$(id -un)\" -a $EUID -gt 99 ] ; then\n  umask 002\nelse\n  umask 027\nfi"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000082",
        "stig_id": "PHTN-10-000082",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000082\" do\n  title \"The Photon operating system must configure a secure umask for all\nshells.\"\n  desc  \"A user's umask influences the permissions assigned to files that a\nuser creates. Setting an appropriate umask is important to make sure that\ninformation is not exposed to unprivileged users.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000082\"\n  tag stig_id: \"PHTN-10-000082\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# cat /etc/profile.d/umask.sh\n\nExpected result:\n\n# By default, the umask should be set.\nif [ \\\"$(id -gn)\\\" = \\\"$(id -un)\\\" -a $EUID -gt 99 ] ; then\n  umask 002\nelse\n  umask 027\nfi\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/profile.d/umask.sh with a text editor.\n\nSet the contents as follows:\n\n# By default, the umask should be set.\nif [ \\\"$(id -gn)\\\" = \\\"$(id -un)\\\" -a $EUID -gt 99 ] ; then\n  umask 002\nelse\n  umask 027\nfi\"\n\n  describe file('/etc/profile.d/umask.sh') do\n    its('content') { should match \"# By default, the umask should be set.\\nif [ \\\"$(id -gn)\\\" = \\\"$(id -un)\\\" -a $EUID -gt 99 ] ; then\\n  umask 002\\nelse\\n  umask 027\\nfi\\n\" }\n    its('content') { should match 'umask 002' }\n    its('content') { should match 'umask 027' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000082.rb",
        "line": 1
      },
      "id": "PHTN-10-000082"
    },
    {
      "title": "The Photon operating system must disabled the debug-shell service.",
      "desc": "The debug-shell service is intended to diagnose systemd related boot\nissues with various systemctl commands. Once enabled and following a system\nreboot, the root shell will be available on tty9. This service must remain\ndisabled until and unless otherwise directed by VMware support.",
      "descriptions": {
        "default": "The debug-shell service is intended to diagnose systemd related boot\nissues with various systemctl commands. Once enabled and following a system\nreboot, the root shell will be available on tty9. This service must remain\ndisabled until and unless otherwise directed by VMware support.",
        "check": "At the command line, execute the following command:\n\n# systemctl status debug-shell.service|grep -E --color=always disabled\n\nIf the debug-shell service is not disabled, this is a finding.",
        "fix": "At the command line, execute the following commands:\n\n# systemctl stop debug-shell.service\n# systemctl disable debug-shell.service\n\nReboot for changes to take effect."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000081",
        "stig_id": "PHTN-10-000081",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000081\" do\n  title \"The Photon operating system must disabled the debug-shell service.\"\n  desc  \"The debug-shell service is intended to diagnose systemd related boot\nissues with various systemctl commands. Once enabled and following a system\nreboot, the root shell will be available on tty9. This service must remain\ndisabled until and unless otherwise directed by VMware support.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000081\"\n  tag stig_id: \"PHTN-10-000081\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# systemctl status debug-shell.service|grep -E --color=always disabled\n\nIf the debug-shell service is not disabled, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following commands:\n\n# systemctl stop debug-shell.service\n# systemctl disable debug-shell.service\n\nReboot for changes to take effect.\"\n\n  describe systemd_service('debug-shell.service') do\n    it { should_not be_enabled}\n    it { should_not be_running}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000081.rb",
        "line": 1
      },
      "id": "PHTN-10-000081"
    },
    {
      "title": "The Photon operating system RPM package management tool must\ncryptographically verify the authenticity of all software packages during\ninstallation.",
      "desc": "Installation of any non-trusted software, patches, service packs,\ndevice drivers or operating system components can significantly affect the\noverall security of the operating system. This requirement ensures the software\nhas not been tampered and has been provided by a trusted vendor.",
      "descriptions": {
        "default": "Installation of any non-trusted software, patches, service packs,\ndevice drivers or operating system components can significantly affect the\noverall security of the operating system. This requirement ensures the software\nhas not been tampered and has been provided by a trusted vendor.",
        "check": "At the command line, execute the following command:\n\n# grep gpgcheck /etc/yum.repos.d/*\n\nIf \"gpgcheck\" is not set to \"1\" in any returned file, this is a finding.",
        "fix": "Open the file where gpgcheck is not set to 1 with a text editor.\nRemove any existing gpgcheck setting and add the following line at the end of\nthe file:\n\ngpgcheck=1"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000366-GPOS-00153",
        "gid": null,
        "rid": "PHTN-10-000064",
        "stig_id": "PHTN-10-000064",
        "cci": "CCI-001749",
        "nist": [
          "CM-5 (3)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000064\" do\n  title \"The Photon operating system RPM package management tool must\ncryptographically verify the authenticity of all software packages during\ninstallation.\"\n  desc  \"Installation of any non-trusted software, patches, service packs,\ndevice drivers or operating system components can significantly affect the\noverall security of the operating system. This requirement ensures the software\nhas not been tampered and has been provided by a trusted vendor. \"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000366-GPOS-00153\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000064\"\n  tag stig_id: \"PHTN-10-000064\"\n  tag cci: \"CCI-001749\"\n  tag nist: [\"CM-5 (3)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep gpgcheck /etc/yum.repos.d/*\n\nIf \\\"gpgcheck\\\" is not set to \\\"1\\\" in any returned file, this is a finding.\"\n  desc 'fix', \"Open the file where gpgcheck is not set to 1 with a text editor.\nRemove any existing gpgcheck setting and add the following line at the end of\nthe file:\n\ngpgcheck=1\"\n\n  command('find /etc/yum.repos.d/ -type f').stdout.split.each do | repofile |\n    describe file (repofile) do\n      its ('content'){should match /^(?=.*?\\bgpgcheck=1\\b).*$/}\n    end\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000064.rb",
        "line": 1
      },
      "id": "PHTN-10-000064"
    },
    {
      "title": "The Photon operating system must be configured so that all cron paths\nare protected from unauthorized modification.",
      "desc": "If cron files and folders are accessible to unauthorized users then\nmalicious jobs may be created.",
      "descriptions": {
        "default": "If cron files and folders are accessible to unauthorized users then\nmalicious jobs may be created.",
        "check": "At the command line, execute the following command:\n\n# stat -c \"%n permissions are %a and owned by %U:%G\" /etc/cron.d\n/etc/cron.daily /etc/cron.hourly /etc/cron.monthly /etc/cron.weekly\n\nExpected result:\n\n/etc/cron.d permissions are 755 and owned by root:root\n/etc/cron.daily permissions are 755 and owned by root:root\n/etc/cron.hourly permissions are 755 and owned by root:root\n/etc/cron.monthly permissions are 755 and owned by root:root\n/etc/cron.weekly permissions are 755 and owned by root:root\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "At the command line, execute the following commands for each\nreturned file:\n\n# chmod 755 <path>\n# chown root:root <path>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000103",
        "stig_id": "PHTN-10-000103",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000103\" do\n  title \"The Photon operating system must be configured so that all cron paths\nare protected from unauthorized modification.\"\n  desc  \"If cron files and folders are accessible to unauthorized users then\nmalicious jobs may be created.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000103\"\n  tag stig_id: \"PHTN-10-000103\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# stat -c \\\"%n permissions are %a and owned by %U:%G\\\" /etc/cron.d\n/etc/cron.daily /etc/cron.hourly /etc/cron.monthly /etc/cron.weekly\n\nExpected result:\n\n/etc/cron.d permissions are 755 and owned by root:root\n/etc/cron.daily permissions are 755 and owned by root:root\n/etc/cron.hourly permissions are 755 and owned by root:root\n/etc/cron.monthly permissions are 755 and owned by root:root\n/etc/cron.weekly permissions are 755 and owned by root:root\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following commands for each\nreturned file:\n\n# chmod 755 <path>\n# chown root:root <path>\"\n\n  describe file('/etc/cron.d') do\n      its('owner') { should cmp 'root' }\n      its('group') { should cmp 'root' }\n      its('mode') { should cmp '0755' }\n  end\n\n  describe file('/etc/cron.daily') do\n      its('owner') { should cmp 'root' }\n      its('group') { should cmp 'root' }\n      its('mode') { should cmp '0755' }\n  end\n\n  describe file('/etc/cron.hourly') do\n      its('owner') { should cmp 'root' }\n      its('group') { should cmp 'root' }\n      its('mode') { should cmp '0755' }\n  end\n\n  describe file('/etc/cron.daily') do\n      its('owner') { should cmp 'root' }\n      its('group') { should cmp 'root' }\n      its('mode') { should cmp '0755' }\n  end\n\n  describe file('/etc/cron.weekly') do\n      its('owner') { should cmp 'root' }\n      its('group') { should cmp 'root' }\n      its('mode') { should cmp '0755' }\n  end\n\n  describe file('/etc/cron.monthly') do\n      its('owner') { should cmp 'root' }\n      its('group') { should cmp 'root' }\n      its('mode') { should cmp '0755' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000103.rb",
        "line": 1
      },
      "id": "PHTN-10-000103"
    },
    {
      "title": "The Photon operating system must require users to re-authenticate for\nprivilege escalation.",
      "desc": "Without re-authentication, users may access resources or perform tasks\nfor which they do not have authorization.\n\n    When operating systems provide the capability to escalate a functional\ncapability, it is critical the user re-authenticate.",
      "descriptions": {
        "default": "Without re-authentication, users may access resources or perform tasks\nfor which they do not have authorization.\n\n    When operating systems provide the capability to escalate a functional\ncapability, it is critical the user re-authenticate.",
        "check": "Check the configuration of the \"/etc/sudoers\" and\n\"/etc/sudoers.d/*\" files with the following command:\n\n# grep -i nopasswd /etc/sudoers /etc/sudoers.d/*\n\nIf any account listed in the output has a password hash in /etc/shadow, this is\na finding.",
        "fix": "Check the configuration of the \"/etc/sudoers\" and\n\"/etc/sudoers.d/*\" files with the following command:\n\n# visudo\nOR\n# visudo -f /etc/sudoers.d/<file name>\n\nRemove any occurrences of \"NOPASSWD\" tags associated with user accounts with\na password hash."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000373-GPOS-00156",
        "gid": null,
        "rid": "PHTN-10-000065",
        "stig_id": "PHTN-10-000065",
        "cci": "CCI-002038",
        "nist": [
          "IA-11",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000065\" do\n  title \"The Photon operating system must require users to re-authenticate for\nprivilege escalation.\"\n  desc  \"Without re-authentication, users may access resources or perform tasks\nfor which they do not have authorization.\n\n    When operating systems provide the capability to escalate a functional\ncapability, it is critical the user re-authenticate.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000373-GPOS-00156\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000065\"\n  tag stig_id: \"PHTN-10-000065\"\n  tag cci: \"CCI-002038\"\n  tag nist: [\"IA-11\", \"Rev_4\"]\n  desc 'check', \"Check the configuration of the \\\"/etc/sudoers\\\" and\n\\\"/etc/sudoers.d/*\\\" files with the following command:\n\n# grep -i nopasswd /etc/sudoers /etc/sudoers.d/*\n\nIf any account listed in the output has a password hash in /etc/shadow, this is\na finding.\"\n  desc 'fix', \"Check the configuration of the \\\"/etc/sudoers\\\" and\n\\\"/etc/sudoers.d/*\\\" files with the following command:\n\n# visudo\nOR\n# visudo -f /etc/sudoers.d/<file name>\n\nRemove any occurrences of \\\"NOPASSWD\\\" tags associated with user accounts with\na password hash.\"\n\n  #Find users in sudoers with NOPASSWD flag and extract username\n  results = command(\"awk '/NOPASSWD/ && /^[^#%].*/ {print $1}' /etc/sudoers\").stdout.split(\"\\n\")\n  \n  #Compare results to shadow file to verify their password is set to !\n  results.each do | result |\n    describe shadow.where(password: '!') do\n      its('users') { should include (result) }\n    end\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000065.rb",
        "line": 1
      },
      "id": "PHTN-10-000065"
    },
    {
      "title": "The Photon operating system must be configured so that all system\nstartup scripts are protected from unauthorized modification.",
      "desc": "If system startup scripts are accessible to unauthorized modification\nthis could compromise the system on startup.",
      "descriptions": {
        "default": "If system startup scripts are accessible to unauthorized modification\nthis could compromise the system on startup.",
        "check": "At the command line, execute the following command:\n\n# find /etc/rc.d/* -xdev -type f -a '(' -perm -002 -o -not -user root -o -not\n-group root ')' -exec ls -ld {} \\;\n\nIf any files are returned, this is a finding.",
        "fix": "At the command line, execute the following commands for each\nreturned file:\n\n# chmod o-w <file>\n# chown root:root <file>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000099",
        "stig_id": "PHTN-10-000099",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000099\" do\n  title \"The Photon operating system must be configured so that all system\nstartup scripts are protected from unauthorized modification.\"\n  desc  \"If system startup scripts are accessible to unauthorized modification\nthis could compromise the system on startup.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000099\"\n  tag stig_id: \"PHTN-10-000099\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# find /etc/rc.d/* -xdev -type f -a '(' -perm -002 -o -not -user root -o -not\n-group root ')' -exec ls -ld {} \\\\;\n\nIf any files are returned, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following commands for each\nreturned file:\n\n# chmod o-w <file>\n# chown root:root <file>\"\n\n  describe command(\"find /etc/rc.d/* -xdev -type f -a '(' -perm -002 -o -not -user root -o -not -group root ')' -exec ls -ld {} \\;\") do\n     its ('stdout') { should eq '' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000099.rb",
        "line": 1
      },
      "id": "PHTN-10-000099"
    },
    {
      "title": "The Photon operating system /var/log directory must be owned by root.",
      "desc": "Only authorized personnel should be aware of errors and the details of\nthe errors. Error messages are an indicator of an organization's operational\nstate and can provide sensitive information to an unprivileged attacker.",
      "descriptions": {
        "default": "Only authorized personnel should be aware of errors and the details of\nthe errors. Error messages are an indicator of an organization's operational\nstate and can provide sensitive information to an unprivileged attacker.",
        "check": "At the command line, execute the following command:\n\n# stat -c \"%n is owned by %U and group owned by %G\" /var/log\n\nIf the /var/log is not owned by root, this is a finding.",
        "fix": "At the command line, execute the following command:\n\n# chown root:root /var/log"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000206-GPOS-00084",
        "gid": null,
        "rid": "PHTN-10-000041",
        "stig_id": "PHTN-10-000041",
        "cci": "CCI-001314",
        "nist": [
          "SI-11 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000041\" do\n  title \"The Photon operating system /var/log directory must be owned by root.\"\n  desc  \"Only authorized personnel should be aware of errors and the details of\nthe errors. Error messages are an indicator of an organization's operational\nstate and can provide sensitive information to an unprivileged attacker.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000206-GPOS-00084\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000041\"\n  tag stig_id: \"PHTN-10-000041\"\n  tag cci: \"CCI-001314\"\n  tag nist: [\"SI-11 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# stat -c \\\"%n is owned by %U and group owned by %G\\\" /var/log\n\nIf the /var/log is not owned by root, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following command:\n\n# chown root:root /var/log\"\n\n  describe directory('/var/log') do\n      its('owner') { should cmp 'root' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000041.rb",
        "line": 1
      },
      "id": "PHTN-10-000041"
    },
    {
      "title": "The Photon operating system must protect sshd configuration from\nunauthorized access.",
      "desc": "The sshd_config file contains all the configuration items for sshd.\nIncorrect or malicious configuration of sshd can allow unauthorized access to\nthe system, insecure communication, limited forensic trail, etc.",
      "descriptions": {
        "default": "The sshd_config file contains all the configuration items for sshd.\nIncorrect or malicious configuration of sshd can allow unauthorized access to\nthe system, insecure communication, limited forensic trail, etc.",
        "check": "At the command line, execute the following command:\n\n# stat -c \"%n permissions are %a and owned by %U:%G\" /etc/ssh/sshd_config\n\nExpected result:\n\n/etc/ssh/sshd_config permissions are 600 and owned by root:root\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "At the command line, execute the following commands:\n\n# chmod 600 /etc/ssh/sshd_config\n# chown root:root /etc/ssh/sshd_config"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000119",
        "stig_id": "PHTN-10-000119",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000119\" do\n  title \"The Photon operating system must protect sshd configuration from\nunauthorized access.\"\n  desc  \"The sshd_config file contains all the configuration items for sshd.\nIncorrect or malicious configuration of sshd can allow unauthorized access to\nthe system, insecure communication, limited forensic trail, etc. \"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000119\"\n  tag stig_id: \"PHTN-10-000119\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# stat -c \\\"%n permissions are %a and owned by %U:%G\\\" /etc/ssh/sshd_config\n\nExpected result:\n\n/etc/ssh/sshd_config permissions are 600 and owned by root:root\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following commands:\n\n# chmod 600 /etc/ssh/sshd_config\n# chown root:root /etc/ssh/sshd_config\"\n\n  describe file('/etc/ssh/sshd_config') do\n      its('owner') { should cmp 'root' }\n      its('group') { should cmp 'root' }\n      its('mode') { should cmp '0600' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000119.rb",
        "line": 1
      },
      "id": "PHTN-10-000119"
    },
    {
      "title": "The Photon operating system must employ a deny-all, allow-by-exception\nfirewall policy for allowing connections to other systems.",
      "desc": "Failure to restrict network connectivity only to authorized systems\npermits inbound connections from malicious systems. It also permits outbound\nconnections that may facilitate exfiltration of DoD data.",
      "descriptions": {
        "default": "Failure to restrict network connectivity only to authorized systems\npermits inbound connections from malicious systems. It also permits outbound\nconnections that may facilitate exfiltration of DoD data.",
        "check": "At the command line, execute the following command:\n\n# iptables -S| grep -E '\\-P'\n\nExpected Result:\n\n-P INPUT   DROP\n-P FORWARD DROP\n-P OUTPUT  ACCEPT\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Inside vCenter, remove any manually configured firewall rules. At\nthe command line, execute the following command to revert the firewall rules\nback to the default state which has the appropriate policies configured:\n\n/usr/lib/applmgmt/networking/bin/firewall-reload.py"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00231",
        "gid": null,
        "rid": "PHTN-10-000123",
        "stig_id": "PHTN-10-000123",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000123\" do\n  title \"The Photon operating system must employ a deny-all, allow-by-exception\nfirewall policy for allowing connections to other systems.\"\n  desc  \"Failure to restrict network connectivity only to authorized systems\npermits inbound connections from malicious systems. It also permits outbound\nconnections that may facilitate exfiltration of DoD data.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00231\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000123\"\n  tag stig_id: \"PHTN-10-000123\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# iptables -S| grep -E '\\\\-P'\n\nExpected Result:\n\n-P INPUT   DROP\n-P FORWARD DROP\n-P OUTPUT  ACCEPT\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Inside vCenter, remove any manually configured firewall rules. At\nthe command line, execute the following command to revert the firewall rules\nback to the default state which has the appropriate policies configured:\n\n/usr/lib/applmgmt/networking/bin/firewall-reload.py\"\n\n  describe iptables do\n    it { should have_rule('-P INPUT DROP') }\n    it { should have_rule('-P FORWARD DROP') }\n    it { should have_rule('-P OUTPUT ACCEPT') }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000123.rb",
        "line": 1
      },
      "id": "PHTN-10-000123"
    },
    {
      "title": "The Photon operating system must limit the number of concurrent\nsessions to ten for all accounts and/or account types.",
      "desc": "Operating system management includes the ability to control the number\nof users and user sessions that utilize an operating system. Limiting the\nnumber of allowed users and sessions per user is helpful in reducing the risks\nrelated to DoS attacks.",
      "descriptions": {
        "default": "Operating system management includes the ability to control the number\nof users and user sessions that utilize an operating system. Limiting the\nnumber of allowed users and sessions per user is helpful in reducing the risks\nrelated to DoS attacks.",
        "check": "At the command line, execute the following command:\n\n#  grep \"^[^#].*maxlogins.*\" /etc/security/limits.conf\n\nExpected result:\n\n* hard maxlogins 10\n\nIf the output does not match the expected result, this is a finding.\n\nNote: The expected result may be repeated multiple times.",
        "fix": "At the command line, execute the following command:\n\n# echo '* hard maxlogins \n10' >> /etc/security/limits.conf"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000027-GPOS-00008",
        "gid": null,
        "rid": "PHTN-10-000004",
        "stig_id": "PHTN-10-000004",
        "cci": "CCI-000054",
        "nist": [
          "AC-10",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000004\" do\n  title \"The Photon operating system must limit the number of concurrent\nsessions to ten for all accounts and/or account types.\"\n  desc  \"Operating system management includes the ability to control the number\nof users and user sessions that utilize an operating system. Limiting the\nnumber of allowed users and sessions per user is helpful in reducing the risks\nrelated to DoS attacks.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000027-GPOS-00008\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000004\"\n  tag stig_id: \"PHTN-10-000004\"\n  tag cci: \"CCI-000054\"\n  tag nist: [\"AC-10\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n#  grep \\\"^[^#].*maxlogins.*\\\" /etc/security/limits.conf\n\nExpected result:\n\n* hard maxlogins 10\n\nIf the output does not match the expected result, this is a finding.\n\nNote: The expected result may be repeated multiple times.\"\n  desc 'fix', \"At the command line, execute the following command:\n\n# echo '* hard maxlogins \n10' >> /etc/security/limits.conf\"\n\n  describe limits_conf('/etc/security/limits.conf') do\n    its('*') { should include ['hard', 'maxlogins', '10'] }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000004.rb",
        "line": 1
      },
      "id": "PHTN-10-000004"
    },
    {
      "title": "The Photon operating system must configure auditd to use the correct\nlog format.",
      "desc": "In order to compile an accurate risk assessment and provide forensic\nanalysis, it is essential for security personnel to know know exact, unfiltered\ndetails of the event in question.",
      "descriptions": {
        "default": "In order to compile an accurate risk assessment and provide forensic\nanalysis, it is essential for security personnel to know know exact, unfiltered\ndetails of the event in question.",
        "check": "At the command line, execute the following command:\n\n# grep \"^log_format\" /etc/audit/auditd.conf\n\nExpected result:\n\nlog_format = RAW\n\nIf there is no output, this is not a finding.\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/audit/auditd.conf with a text editor and ensure that the\n\"log_format\" line is uncommented and set to the following:\n\nlog_format = RAW\n\nAt the command line, execute the following command:\n\n# service auditd reload"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000038-GPOS-00016",
        "gid": null,
        "rid": "PHTN-10-000011",
        "stig_id": "PHTN-10-000011",
        "cci": "CCI-000131",
        "nist": [
          "AU-3",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000011\" do\n  title \"The Photon operating system must configure auditd to use the correct\nlog format.\"\n  desc  \"In order to compile an accurate risk assessment and provide forensic\nanalysis, it is essential for security personnel to know know exact, unfiltered\ndetails of the event in question.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000038-GPOS-00016\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000011\"\n  tag stig_id: \"PHTN-10-000011\"\n  tag cci: \"CCI-000131\"\n  tag nist: [\"AU-3\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep \\\"^log_format\\\" /etc/audit/auditd.conf\n\nExpected result:\n\nlog_format = RAW\n\nIf there is no output, this is not a finding.\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/audit/auditd.conf with a text editor and ensure that the\n\\\"log_format\\\" line is uncommented and set to the following:\n\nlog_format = RAW\n\nAt the command line, execute the following command:\n\n# service auditd reload\"\n\n  describe auditd_conf do\n    its(\"log_format\") { should cmp 'RAW'}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000011.rb",
        "line": 1
      },
      "id": "PHTN-10-000011"
    },
    {
      "title": "The Photon operating system must configure sshd to disallow root\nlogins.",
      "desc": "Logging on with a user-specific account provides individual\naccountability for actions performed on the system. Users must log in with\ntheir individual accounts and elevate to root as necessary. Disallowing root\nSSH login also reduces the distruibution of the root password to users who may\nnot otherwise need that level of privilege.",
      "descriptions": {
        "default": "Logging on with a user-specific account provides individual\naccountability for actions performed on the system. Users must log in with\ntheir individual accounts and elevate to root as necessary. Disallowing root\nSSH login also reduces the distruibution of the root password to users who may\nnot otherwise need that level of privilege.",
        "check": "At the command line, execute the following command:\n\n# sshd -T|&grep -i PermitRootLogin\n\nExpected result:\n\npermitrootlogin no\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/ssh/sshd_config with a text editor and ensure that the\n\"PermitRootLogin\" line is uncommented and set to the following:\n\nPermitRootLogin no\n\nAt the command line, execute the following command:\n\n# service sshd reload"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000109-GPOS-00056",
        "gid": null,
        "rid": "PHTN-10-000035",
        "stig_id": "PHTN-10-000035",
        "cci": "CCI-000770",
        "nist": [
          "IA-2 (5)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000035\" do\n  title \"The Photon operating system must configure sshd to disallow root\nlogins.\"\n  desc  \"Logging on with a user-specific account provides individual\naccountability for actions performed on the system. Users must log in with\ntheir individual accounts and elevate to root as necessary. Disallowing root\nSSH login also reduces the distruibution of the root password to users who may\nnot otherwise need that level of privilege.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000109-GPOS-00056\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000035\"\n  tag stig_id: \"PHTN-10-000035\"\n  tag cci: \"CCI-000770\"\n  tag nist: [\"IA-2 (5)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# sshd -T|&grep -i PermitRootLogin\n\nExpected result:\n\npermitrootlogin no\n\nIf the output does not match the expected result, this is a finding.\n\n\"\n  desc 'fix', \"Open /etc/ssh/sshd_config with a text editor and ensure that the\n\\\"PermitRootLogin\\\" line is uncommented and set to the following:\n\nPermitRootLogin no\n\nAt the command line, execute the following command:\n\n# service sshd reload\"\n\n  describe command('sshd -T|&grep -i PermitRootLogin') do\n    its ('stdout.strip') { should cmp 'PermitRootLogin no' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000035.rb",
        "line": 1
      },
      "id": "PHTN-10-000035"
    },
    {
      "title": "The Photon operating system must audit all account creations.",
      "desc": "Once an attacker establishes access to a system, the attacker often\nattempts to create a persistent method of reestablishing access. One way to\naccomplish this is for the attacker to create an account. Auditing account\ncreation actions provides logging that can be used for forensic purposes.",
      "descriptions": {
        "default": "Once an attacker establishes access to a system, the attacker often\nattempts to create a persistent method of reestablishing access. One way to\naccomplish this is for the attacker to create an account. Auditing account\ncreation actions provides logging that can be used for forensic purposes.",
        "check": "At the command line, execute the following command:\n\n# auditctl -l | grep -E \"(useradd|groupadd)\"\n\nExpected result:\n\n-w /usr/sbin/useradd -p x -k useradd\n-w /usr/sbin/groupadd -p x -k groupadd\n\nIf either useradd or groupadd are not listed with a permissions filter of at\nleast 'x', this is a finding.",
        "fix": "At the command line, execute the following commands:\n\n# echo '-w /usr/sbin/useradd -p x -k useradd' >>\n/etc/audit/rules.d/audit.STIG.rules\n# echo '-w /usr/sbin/groupadd -p x -k groupadd' >>\n/etc/audit/rules.d/audit.STIG.rules\n# /sbin/augenrules --load"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000004-GPOS-00004",
        "gid": null,
        "rid": "PHTN-10-000001",
        "stig_id": "PHTN-10-000001",
        "cci": "CCI-000018",
        "nist": [
          "AC-2 (4)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000001\" do\n  title \"The Photon operating system must audit all account creations.\"\n  desc  \"Once an attacker establishes access to a system, the attacker often\nattempts to create a persistent method of reestablishing access. One way to\naccomplish this is for the attacker to create an account. Auditing account\ncreation actions provides logging that can be used for forensic purposes.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000004-GPOS-00004\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000001\"\n  tag stig_id: \"PHTN-10-000001\"\n  tag cci: \"CCI-000018\"\n  tag nist: [\"AC-2 (4)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# auditctl -l | grep -E \\\"(useradd|groupadd)\\\"\n\nExpected result:\n\n-w /usr/sbin/useradd -p x -k useradd\n-w /usr/sbin/groupadd -p x -k groupadd\n\nIf either useradd or groupadd are not listed with a permissions filter of at\nleast 'x', this is a finding.\"\n  desc 'fix', \"At the command line, execute the following commands:\n\n# echo '-w /usr/sbin/useradd -p x -k useradd' >>\n/etc/audit/rules.d/audit.STIG.rules\n# echo '-w /usr/sbin/groupadd -p x -k groupadd' >>\n/etc/audit/rules.d/audit.STIG.rules\n# /sbin/augenrules --load\"\n\n  describe auditd do\n    its(\"lines\") { should include %r{-w /usr/sbin/useradd -p x -k useradd} }\n    its(\"lines\") { should include %r{-w /usr/sbin/groupadd -p x -k groupadd} }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000001.rb",
        "line": 1
      },
      "id": "PHTN-10-000001"
    },
    {
      "title": "The Photon operating system must audit all account modifications.",
      "desc": "Once an attacker establishes access to a system, the attacker often\nattempts to create a persistent method of reestablishing access.  One way to\naccomplish this is for the attacker to modify an existing account.  Auditing\naccount modification actions provides logging that can be used for forensic\npurposes.",
      "descriptions": {
        "default": "Once an attacker establishes access to a system, the attacker often\nattempts to create a persistent method of reestablishing access.  One way to\naccomplish this is for the attacker to modify an existing account.  Auditing\naccount modification actions provides logging that can be used for forensic\npurposes.",
        "check": "At the command line, execute the following command:\n\n# auditctl -l | grep -E \"(/etc/passwd|/etc/shadow|/etc/group|/etc/gshadow)\"\n\nExpected result:\n\n-w /etc/passwd -p wa -k passwd\n-w /etc/shadow -p wa -k shadow\n-w /etc/group -p wa -k group\n-w /etc/gshadow -p wa -k gshadow\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "At the command line, execute the following commands:\n\n# echo '-w /etc/passwd -p w -k passwd' >> /etc/audit/rules.d/audit.STIG.rules\n# echo '-w /etc/shadow -p w -k shadow' >> /etc/audit/rules.d/audit.STIG.rules\n# echo '-w /etc/group -p w -k group' >> /etc/audit/rules.d/audit.STIG.rules\n# echo '-w /etc/gshadow -p w -k gshadow' >> /etc/audit/rules.d/audit.STIG.rules\n# /sbin/augenrules --load"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000239-GPOS-00089",
        "gid": null,
        "rid": "PHTN-10-000045",
        "stig_id": "PHTN-10-000045",
        "cci": "CCI-001403",
        "nist": [
          "AC-2 (4)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000045\" do\n  title \"The Photon operating system must audit all account modifications.\"\n  desc  \"Once an attacker establishes access to a system, the attacker often\nattempts to create a persistent method of reestablishing access.  One way to\naccomplish this is for the attacker to modify an existing account.  Auditing\naccount modification actions provides logging that can be used for forensic\npurposes.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000239-GPOS-00089\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000045\"\n  tag stig_id: \"PHTN-10-000045\"\n  tag cci: \"CCI-001403\"\n  tag nist: [\"AC-2 (4)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# auditctl -l | grep -E \\\"(/etc/passwd|/etc/shadow|/etc/group|/etc/gshadow)\\\"\n\nExpected result:\n\n-w /etc/passwd -p wa -k passwd\n-w /etc/shadow -p wa -k shadow\n-w /etc/group -p wa -k group\n-w /etc/gshadow -p wa -k gshadow\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following commands:\n\n# echo '-w /etc/passwd -p w -k passwd' >> /etc/audit/rules.d/audit.STIG.rules\n# echo '-w /etc/shadow -p w -k shadow' >> /etc/audit/rules.d/audit.STIG.rules\n# echo '-w /etc/group -p w -k group' >> /etc/audit/rules.d/audit.STIG.rules\n# echo '-w /etc/gshadow -p w -k gshadow' >> /etc/audit/rules.d/audit.STIG.rules\n# /sbin/augenrules --load\"\n\n  describe auditd do\n    its(\"lines\") { should include %r{-w /usr/sbin/usermod -p x -k usermod} }\n    its(\"lines\") { should include %r{-w /usr/sbin/groupmod -p x -k groupmod} }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000045.rb",
        "line": 1
      },
      "id": "PHTN-10-000045"
    },
    {
      "title": "The Photon operating system must set the UMASK parameter correctly.",
      "desc": "The umask value influences the permissions assigned to files when they\nare created. The umask setting in login.defs controls the permissions for a new\nuser's home directory. By setting the proper umask, home directories will only\nallow the new user to read and write file there.",
      "descriptions": {
        "default": "The umask value influences the permissions assigned to files when they\nare created. The umask setting in login.defs controls the permissions for a new\nuser's home directory. By setting the proper umask, home directories will only\nallow the new user to read and write file there.",
        "check": "At the command line, execute the following command:\n\n# grep UMASK /etc/login.defs\n\nExpected result:\n\nUMASK 077\n\nIf the output does not match the expected result, this a finding.",
        "fix": "Open /etc/login.defs with a text editor and ensure that the\n\"UMASK\" line is uncommented and set to the following:\n\nUMASK 077"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00228",
        "gid": null,
        "rid": "PHTN-10-000121",
        "stig_id": "PHTN-10-000121",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000121\" do\n  title \"The Photon operating system must set the UMASK parameter correctly.\"\n  desc  \"The umask value influences the permissions assigned to files when they\nare created. The umask setting in login.defs controls the permissions for a new\nuser's home directory. By setting the proper umask, home directories will only\nallow the new user to read and write file there.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00228\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000121\"\n  tag stig_id: \"PHTN-10-000121\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep UMASK /etc/login.defs\n\nExpected result:\n\nUMASK 077\n\nIf the output does not match the expected result, this a finding.\"\n  desc 'fix', \"Open /etc/login.defs with a text editor and ensure that the\n\\\"UMASK\\\" line is uncommented and set to the following:\n\nUMASK 077\"\n\n  describe login_defs do\n    its('UMASK') { should cmp '077' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000121.rb",
        "line": 1
      },
      "id": "PHTN-10-000121"
    },
    {
      "title": "The Photon operating system must prevent IPv4 Internet Control Message\nProtocol (ICMP) secure redirect messages from being accepted.",
      "desc": "ICMP redirect messages are used by routers to inform hosts that a more\ndirect route exists for a particular destination. These messages modify the\nhost's route table and are unauthenticated. An illicit ICMP redirect message\ncould result in a man-in-the-middle attack.",
      "descriptions": {
        "default": "ICMP redirect messages are used by routers to inform hosts that a more\ndirect route exists for a particular destination. These messages modify the\nhost's route table and are unauthenticated. An illicit ICMP redirect message\ncould result in a man-in-the-middle attack.",
        "check": "At the command line, execute the following command:\n\n# /sbin/sysctl -a --pattern\n\"net.ipv4.conf.(all|default|eth.*).secure_redirects\"\n\nExpected result:\n\nnet.ipv4.conf.all.secure_redirects = 0\nnet.ipv4.conf.default.secure_redirects = 0\nnet.ipv4.conf.eth0.secure_redirects = 0\n\nIf the output does not match the expected result, this is a finding.\n\nNote: The number of ethx lines returned is dependant on the number of\ninterfaces. Every ethx entry must be set to 0.",
        "fix": "At the command line, execute the following command:\n\n# for SETTING in $(/sbin/sysctl -aN --pattern\n\"net.ipv4.conf.(all|default|eth.*).secure_redirects\"); do sed -i -e\n\"/^${SETTING}/d\" /etc/sysctl.conf;echo $SETTING=0>>/etc/sysctl.conf; done"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000107",
        "stig_id": "PHTN-10-000107",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000107\" do\n  title \"The Photon operating system must prevent IPv4 Internet Control Message\nProtocol (ICMP) secure redirect messages from being accepted.\"\n  desc  \"ICMP redirect messages are used by routers to inform hosts that a more\ndirect route exists for a particular destination. These messages modify the\nhost's route table and are unauthenticated. An illicit ICMP redirect message\ncould result in a man-in-the-middle attack.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000107\"\n  tag stig_id: \"PHTN-10-000107\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# /sbin/sysctl -a --pattern\n\\\"net.ipv4.conf.(all|default|eth.*).secure_redirects\\\"\n\nExpected result:\n\nnet.ipv4.conf.all.secure_redirects = 0\nnet.ipv4.conf.default.secure_redirects = 0\nnet.ipv4.conf.eth0.secure_redirects = 0\n\nIf the output does not match the expected result, this is a finding.\n\nNote: The number of ethx lines returned is dependant on the number of\ninterfaces. Every ethx entry must be set to 0.\"\n  desc 'fix', \"At the command line, execute the following command:\n\n# for SETTING in $(/sbin/sysctl -aN --pattern\n\\\"net.ipv4.conf.(all|default|eth.*).secure_redirects\\\"); do sed -i -e\n\\\"/^${SETTING}/d\\\" /etc/sysctl.conf;echo $SETTING=0>>/etc/sysctl.conf; done\"\n\n  describe kernel_parameter('net.ipv4.conf.all.secure_redirects') do\n    its('value') { should eq 0 }\n  end\n\n  describe kernel_parameter('net.ipv4.conf.default.secure_redirects') do\n    its('value') { should eq 0 }\n  end\n\n  describe kernel_parameter('net.ipv4.conf.eth0.secure_redirects') do\n    its('value') { should eq 0 }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000107.rb",
        "line": 1
      },
      "id": "PHTN-10-000107"
    },
    {
      "title": "The Photon operating system must use the pam_cracklib module.",
      "desc": "If the operating system allows the user to select passwords based on\ndictionary words, then this increases the chances of password compromise by\nincreasing the opportunity for successful guesses and brute-force attacks.",
      "descriptions": {
        "default": "If the operating system allows the user to select passwords based on\ndictionary words, then this increases the chances of password compromise by\nincreasing the opportunity for successful guesses and brute-force attacks.",
        "check": "At the command line, execute the following command:\n\n# grep pam_cracklib /etc/pam.d/system-password\n\nIf the output does not return at least \"password  requisite\npam_cracklib.so\", this is a finding.",
        "fix": "Open /etc/pam.d/system-password with a text editor.\n\nAdd the following, replacing any existing 'pam_cracklib.so' line :\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1\nminlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00225",
        "gid": null,
        "rid": "PHTN-10-000075",
        "stig_id": "PHTN-10-000075",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000075\" do\n  title \"The Photon operating system must use the pam_cracklib module.\"\n  desc  \"If the operating system allows the user to select passwords based on\ndictionary words, then this increases the chances of password compromise by\nincreasing the opportunity for successful guesses and brute-force attacks.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00225\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000075\"\n  tag stig_id: \"PHTN-10-000075\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep pam_cracklib /etc/pam.d/system-password\n\nIf the output does not return at least \\\"password  requisite\npam_cracklib.so\\\", this is a finding.\"\n  desc 'fix', \"Open /etc/pam.d/system-password with a text editor.\n\nAdd the following, replacing any existing 'pam_cracklib.so' line :\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1\nminlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root\"\n\n  describe file ('/etc/pam.d/system-password') do\n      its ('content'){should match /^(?=.*?\\bpassword\\b)(?=.*?\\brequisite\\b)(?=.*?\\bpam_cracklib.so\\b).*$/}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000075.rb",
        "line": 1
      },
      "id": "PHTN-10-000075"
    },
    {
      "title": "The Photon operating system must store only encrypted representations\nof passwords.",
      "desc": "Passwords must be protected at all times via strong, one way\nencryption. If passwords are not encrypted, they can be plainly read (i.e.,\nclear text) and easily compromised. If they are encrypted with a weak cipher,\nthose password are much more vulnerability to offline bute forcing attacks",
      "descriptions": {
        "default": "Passwords must be protected at all times via strong, one way\nencryption. If passwords are not encrypted, they can be plainly read (i.e.,\nclear text) and easily compromised. If they are encrypted with a weak cipher,\nthose password are much more vulnerability to offline bute forcing attacks",
        "check": "At the command line, execute the following command:\n\n# grep SHA512 /etc/login.defs|grep -v \"#\"\n\nExpected result :\n\nENCRYPT_METHOD SHA512\n\nIf there is no output or if the output does match the expected result, this is\na finding.",
        "fix": "Open /etc/login.defs with a text editor. Add or replace the\nENCRYPT_METHOD line as follows:\n\nENCRYPT_METHOD SHA512"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000073-GPOS-00041",
        "gid": null,
        "rid": "PHTN-10-000026",
        "stig_id": "PHTN-10-000026",
        "cci": "CCI-000196",
        "nist": [
          "IA-5 (1) (c)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000026\" do\n  title \"The Photon operating system must store only encrypted representations\nof passwords.\"\n  desc  \"Passwords must be protected at all times via strong, one way\nencryption. If passwords are not encrypted, they can be plainly read (i.e.,\nclear text) and easily compromised. If they are encrypted with a weak cipher,\nthose password are much more vulnerability to offline bute forcing attacks\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000073-GPOS-00041\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000026\"\n  tag stig_id: \"PHTN-10-000026\"\n  tag cci: \"CCI-000196\"\n  tag nist: [\"IA-5 (1) (c)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep SHA512 /etc/login.defs|grep -v \\\"#\\\"\n\nExpected result :\n\nENCRYPT_METHOD SHA512\n\nIf there is no output or if the output does match the expected result, this is\na finding.\"\n  desc 'fix', \"Open /etc/login.defs with a text editor. Add or replace the\nENCRYPT_METHOD line as follows:\n\nENCRYPT_METHOD SHA512\n\"\n\n  describe login_defs do\n    its('ENCRYPT_METHOD') { should cmp 'SHA512' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000026.rb",
        "line": 1
      },
      "id": "PHTN-10-000026"
    },
    {
      "title": "The Photon operating system must be configured so that the\n/etc/cron.allow file is protected from unauthorized modification.",
      "desc": "If cron files and folders are accessible to unauthorized users then\nmalicious jobs may be created.",
      "descriptions": {
        "default": "If cron files and folders are accessible to unauthorized users then\nmalicious jobs may be created.",
        "check": "At the command line, execute the following command:\n\n# stat -c \"%n permissions are %a and owned by %U:%G\" /etc/cron.allow\n\nExpected result:\n\n/etc/cron.allow permissions are 600 and owned by root:root\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "At the command line, execute the following commands:\n\n# chmod 600 /etc/cron.allow\n# chown root:root /etc/cron.allow"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000101",
        "stig_id": "PHTN-10-000101",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000101\" do\n  title \"The Photon operating system must be configured so that the\n/etc/cron.allow file is protected from unauthorized modification.\"\n  desc  \"If cron files and folders are accessible to unauthorized users then\nmalicious jobs may be created.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000101\"\n  tag stig_id: \"PHTN-10-000101\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# stat -c \\\"%n permissions are %a and owned by %U:%G\\\" /etc/cron.allow\n\nExpected result:\n\n/etc/cron.allow permissions are 600 and owned by root:root\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following commands:\n\n# chmod 600 /etc/cron.allow\n# chown root:root /etc/cron.allow\"\n\n  describe file('/etc/cron.allow') do\n      its('owner') { should cmp 'root' }\n      its('group') { should cmp 'root' }\n      its('mode') { should cmp '0600' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000101.rb",
        "line": 1
      },
      "id": "PHTN-10-000101"
    },
    {
      "title": "The Photon operating system must prohibit password reuse for a minimum\nof five generations.",
      "desc": "Password complexity, or strength, is a measure of the effectiveness of\na password in resisting attempts at guessing and brute-force attacks. If the\ninformation system or application allows the user to consecutively reuse their\npassword when that password has exceeded its defined lifetime, the end result\nis a password that is not changed as per policy requirements.",
      "descriptions": {
        "default": "Password complexity, or strength, is a measure of the effectiveness of\na password in resisting attempts at guessing and brute-force attacks. If the\ninformation system or application allows the user to consecutively reuse their\npassword when that password has exceeded its defined lifetime, the end result\nis a password that is not changed as per policy requirements.",
        "check": "At the command line, execute the following command:\n\n# grep pam_pwhistory /etc/pam.d/system-password|grep --color=always\n\"remember=.\"\n\nExpected result:\n\npassword required pam_pwhistory.so enforce_for_root use_authtok remember=5\nretry=3\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/pam.d/system-password with a text editor.\n\nAdd the following line after the last auth statement:\n\npassword required pam_pwhistory.so enforce_for_root use_authtok remember=5\nretry=3"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000077-GPOS-00045",
        "gid": null,
        "rid": "PHTN-10-000029",
        "stig_id": "PHTN-10-000029",
        "cci": "CCI-000200",
        "nist": [
          "IA-5 (1) (e)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000029\" do\n  title \"The Photon operating system must prohibit password reuse for a minimum\nof five generations.\"\n  desc  \"Password complexity, or strength, is a measure of the effectiveness of\na password in resisting attempts at guessing and brute-force attacks. If the\ninformation system or application allows the user to consecutively reuse their\npassword when that password has exceeded its defined lifetime, the end result\nis a password that is not changed as per policy requirements.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000077-GPOS-00045\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000029\"\n  tag stig_id: \"PHTN-10-000029\"\n  tag cci: \"CCI-000200\"\n  tag nist: [\"IA-5 (1) (e)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep pam_pwhistory /etc/pam.d/system-password|grep --color=always\n\\\"remember=.\\\"\n\nExpected result:\n\npassword required pam_pwhistory.so enforce_for_root use_authtok remember=5\nretry=3\n\nIf the output does not match the expected result, this is a finding.\n\"\n  desc 'fix', \"Open /etc/pam.d/system-password with a text editor.\n\nAdd the following line after the last auth statement:\n\npassword required pam_pwhistory.so enforce_for_root use_authtok remember=5\nretry=3\n\n\"\n\n  describe file ('/etc/pam.d/system-password') do\n      its ('content'){should match /^(?=.*?\\bpassword\\b)(?=.*?\\brequired\\b)(?=.*?\\bpam_pwhistory.so\\b)(?=.*?\\bremember=5\\b).*$/}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000029.rb",
        "line": 1
      },
      "id": "PHTN-10-000029"
    },
    {
      "title": "The Photon operating system must use OpenSSH for remote maintenance\nsessions.",
      "desc": "If the remote connection is not closed and verified as closed, the\nsession may remain open and be exploited by an attacker; this is referred to as\na zombie session. Remote connections must be disconnected and verified as\ndisconnected when nonlocal maintenance sessions have been terminated and are no\nlonger available for use.",
      "descriptions": {
        "default": "If the remote connection is not closed and verified as closed, the\nsession may remain open and be exploited by an attacker; this is referred to as\na zombie session. Remote connections must be disconnected and verified as\ndisconnected when nonlocal maintenance sessions have been terminated and are no\nlonger available for use.",
        "check": "At the command line, execute the following command:\n\n# rpm -qa|grep openssh\n\nIf there is no output, this is a finding.",
        "fix": "Installing openssh manually is not supported by VMware. Revert to a\nprevious backup or redeploy the VCSA."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000395-GPOS-00175",
        "gid": null,
        "rid": "PHTN-10-000068",
        "stig_id": "PHTN-10-000068",
        "cci": "CCI-002891",
        "nist": [
          "MA-4 (7)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000068\" do\n  title \"The Photon operating system must use OpenSSH for remote maintenance\nsessions.\"\n  desc  \"If the remote connection is not closed and verified as closed, the\nsession may remain open and be exploited by an attacker; this is referred to as\na zombie session. Remote connections must be disconnected and verified as\ndisconnected when nonlocal maintenance sessions have been terminated and are no\nlonger available for use.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000395-GPOS-00175\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000068\"\n  tag stig_id: \"PHTN-10-000068\"\n  tag cci: \"CCI-002891\"\n  tag nist: [\"MA-4 (7)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# rpm -qa|grep openssh\n\nIf there is no output, this is a finding.\"\n  desc 'fix', \"Installing openssh manually is not supported by VMware. Revert to a\nprevious backup or redeploy the VCSA.\"\n\n  describe command('rpm -qa|grep openssh') do\n    its ('stdout') { should_not eq '' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000068.rb",
        "line": 1
      },
      "id": "PHTN-10-000068"
    },
    {
      "title": "The Photon operating system must configure sshd to limit the number of\nallowed login attempts per connection.",
      "desc": "By setting the login attempt limit to a low value, an attacker will be\nforced to reconnect frequently which severely limits the speed and\neffectiveness of brute-force attacks.",
      "descriptions": {
        "default": "By setting the login attempt limit to a low value, an attacker will be\nforced to reconnect frequently which severely limits the speed and\neffectiveness of brute-force attacks.",
        "check": "At the command line, execute the following command:\n\n# sshd -T|&grep -i MaxAuthTries\n\nExpected result:\n\nMaxAuthTries 2\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/ssh/sshd_config with a text editor and ensure that the\n\"MaxAuthTries\" line is uncommented and set to the following:\n\nMaxAuthTries 2\n\nAt the command line, execute the following command:\n\n# service sshd reload"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000094",
        "stig_id": "PHTN-10-000094",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000094\" do\n  title \"The Photon operating system must configure sshd to limit the number of\nallowed login attempts per connection.\"\n  desc  \"By setting the login attempt limit to a low value, an attacker will be\nforced to reconnect frequently which severely limits the speed and\neffectiveness of brute-force attacks. \"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000094\"\n  tag stig_id: \"PHTN-10-000094\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# sshd -T|&grep -i MaxAuthTries\n\nExpected result:\n\nMaxAuthTries 2\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/ssh/sshd_config with a text editor and ensure that the\n\\\"MaxAuthTries\\\" line is uncommented and set to the following:\n\nMaxAuthTries 2\n\nAt the command line, execute the following command:\n\n# service sshd reload\"\n\n  describe command('sshd -T|&grep -i MaxAuthTries') do\n    its ('stdout.strip') { should cmp 'MaxAuthTries 2' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000094.rb",
        "line": 1
      },
      "id": "PHTN-10-000094"
    },
    {
      "title": "The Photon operating system must use TCP syncookies.",
      "desc": "A TCP SYN flood attack can cause a denial of service by filling a\nsystem's TCP connection table with connections in the SYN_RCVD state.\nSyncookies can be used to track a connection when a subsequent ACK is received,\nverifying the initiator is attempting a valid connection and is not a flood\nsource. This feature is activated when a flood condition is detected, and\nenables the system to continue servicing valid connection requests.",
      "descriptions": {
        "default": "A TCP SYN flood attack can cause a denial of service by filling a\nsystem's TCP connection table with connections in the SYN_RCVD state.\nSyncookies can be used to track a connection when a subsequent ACK is received,\nverifying the initiator is attempting a valid connection and is not a flood\nsource. This feature is activated when a flood condition is detected, and\nenables the system to continue servicing valid connection requests.",
        "check": "At the command line, execute the following command:\n\n# /sbin/sysctl -a --pattern /tcp_syncookies\n\nExpected result:\n\nnet.ipv4.tcp_syncookies = 1\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "At the command line, execute the following commands:\n\n# sed -i -e \"/^net.ipv4.tcp_syncookies/d\" /etc/sysctl.conf\n# echo net.ipv4.tcp_syncookies=1>>/etc/sysctl.conf"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000142-GPOS-00071",
        "gid": null,
        "rid": "PHTN-10-000037",
        "stig_id": "PHTN-10-000037",
        "cci": "CCI-001095",
        "nist": [
          "SC-5 (2)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000037\" do\n  title \"The Photon operating system must use TCP syncookies.\"\n  desc  \"A TCP SYN flood attack can cause a denial of service by filling a\nsystem's TCP connection table with connections in the SYN_RCVD state.\nSyncookies can be used to track a connection when a subsequent ACK is received,\nverifying the initiator is attempting a valid connection and is not a flood\nsource. This feature is activated when a flood condition is detected, and\nenables the system to continue servicing valid connection requests.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000142-GPOS-00071\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000037\"\n  tag stig_id: \"PHTN-10-000037\"\n  tag cci: \"CCI-001095\"\n  tag nist: [\"SC-5 (2)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# /sbin/sysctl -a --pattern /tcp_syncookies\n\nExpected result:\n\nnet.ipv4.tcp_syncookies = 1\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following commands:\n\n# sed -i -e \\\"/^net.ipv4.tcp_syncookies/d\\\" /etc/sysctl.conf\n# echo net.ipv4.tcp_syncookies=1>>/etc/sysctl.conf\n\"\n\n  describe kernel_parameter('net.ipv4.tcp_syncookies') do\n    its('value') { should eq 1 }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000037.rb",
        "line": 1
      },
      "id": "PHTN-10-000037"
    },
    {
      "title": "The Photon operating system must configure sshd to ignore\nuser-specific known_host files.",
      "desc": "SSH trust relationships enable trivial lateral spread after a host\ncompromise and therefore must be explicitly disabled. Individual users can have\na local list of trusted remote machines which must also be ignored while\ndisabling host-based authentication generally.",
      "descriptions": {
        "default": "SSH trust relationships enable trivial lateral spread after a host\ncompromise and therefore must be explicitly disabled. Individual users can have\na local list of trusted remote machines which must also be ignored while\ndisabling host-based authentication generally.",
        "check": "At the command line, execute the following command:\n\n# sshd -T|&grep -i IgnoreUserKnownHosts\n\nExpected result:\n\nIgnoreUserKnownHosts yes\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/ssh/sshd_config with a text editor and ensure that the\n\"IgnoreUserKnownHosts\" line is uncommented and set to the following:\n\nIgnoreUserKnownHosts yes\n\nAt the command line, execute the following command:\n\n# service sshd reload"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000093",
        "stig_id": "PHTN-10-000093",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000093\" do\n  title \"The Photon operating system must configure sshd to ignore\nuser-specific known_host files.\"\n  desc  \"SSH trust relationships enable trivial lateral spread after a host\ncompromise and therefore must be explicitly disabled. Individual users can have\na local list of trusted remote machines which must also be ignored while\ndisabling host-based authentication generally.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000093\"\n  tag stig_id: \"PHTN-10-000093\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# sshd -T|&grep -i IgnoreUserKnownHosts\n\nExpected result:\n\nIgnoreUserKnownHosts yes\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/ssh/sshd_config with a text editor and ensure that the\n\\\"IgnoreUserKnownHosts\\\" line is uncommented and set to the following:\n\nIgnoreUserKnownHosts yes\n\nAt the command line, execute the following command:\n\n# service sshd reload\"\n\n  describe command('sshd -T|&grep -i IgnoreUserKnownHosts') do\n    its ('stdout.strip') { should cmp 'IgnoreUserKnownHosts yes' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000093.rb",
        "line": 1
      },
      "id": "PHTN-10-000093"
    },
    {
      "title": "The Photon operating system audit log must be owned by root.",
      "desc": "Audit information includes all information (e.g., audit records, audit\nsettings, audit reports) needed to successfully audit operating system activity.\n\n    Unauthorized disclosure of audit records can reveal system and\nconfiguration data to attackers, thus compromising its confidentiality.",
      "descriptions": {
        "default": "Audit information includes all information (e.g., audit records, audit\nsettings, audit reports) needed to successfully audit operating system activity.\n\n    Unauthorized disclosure of audit records can reveal system and\nconfiguration data to attackers, thus compromising its confidentiality.",
        "check": "At the command line, execute the following command:\n\n# (audit_log_file=$(grep \"^log_file\" /etc/audit/auditd.conf|sed s/^[^\\/]*//)\n&& if [ -f \"${audit_log_file}\" ] ; then printf \"Log(s) found in\n\"${audit_log_file%/*}\":\"; stat -c \"%n is owned by %U\" ${audit_log_file%}*; else printf \"audit log\nfile(s) not found\"; fi)\n\nIf any audit log file is not owned by root, this is a finding.",
        "fix": "At the command line, execute the following command:\n\n#  chown root:root <audit log file>\n\nReplace <audit log file> with the log files not owned by root."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000058-GPOS-00028",
        "gid": null,
        "rid": "PHTN-10-000016",
        "stig_id": "PHTN-10-000016",
        "cci": "CCI-000163",
        "nist": [
          "AU-9",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000016\" do\n  title \"The Photon operating system audit log must be owned by root.\"\n  desc  \"Audit information includes all information (e.g., audit records, audit\nsettings, audit reports) needed to successfully audit operating system activity.\n\n    Unauthorized disclosure of audit records can reveal system and\nconfiguration data to attackers, thus compromising its confidentiality.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000058-GPOS-00028\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000016\"\n  tag stig_id: \"PHTN-10-000016\"\n  tag cci: \"CCI-000163\"\n  tag nist: [\"AU-9\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# (audit_log_file=$(grep \\\"^log_file\\\" /etc/audit/auditd.conf|sed s/^[^\\\\/]*//)\n&& if [ -f \\\"${audit_log_file}\\\" ] ; then printf \\\"Log(s) found in\n\\\"${audit_log_file%/*}\\\":\\\n\\\"; stat -c \\\"%n is owned by %U\\\" ${audit_log_file%}*; else printf \\\"audit log\nfile(s) not found\\\n\\\"; fi)\n\nIf any audit log file is not owned by root, this is a finding.\n\"\n  desc 'fix', \"At the command line, execute the following command:\n\n#  chown root:root <audit log file>\n\nReplace <audit log file> with the log files not owned by root.\"\n\n  command('find /var/log/audit/ -maxdepth 1 -name \"audit*.*\"').stdout.split.each do | fname |\n    describe file(fname) do\n      its('owner') { should cmp 'root' }\n    end\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000016.rb",
        "line": 1
      },
      "id": "PHTN-10-000016"
    },
    {
      "title": "The Photon operating system must be configured to audit the execution\nof privileged functions.",
      "desc": "Misuse of privileged functions, either intentionally or\nunintentionally by authorized users, or by unauthorized external entities that\nhave compromised information system accounts, is a serious and ongoing concern\nand can have significant adverse impacts on organizations. Auditing all actions\nby superusers is one way to detect such misuse and identify the risk from\ninsider threats and the advanced persistent threat.",
      "descriptions": {
        "default": "Misuse of privileged functions, either intentionally or\nunintentionally by authorized users, or by unauthorized external entities that\nhave compromised information system accounts, is a serious and ongoing concern\nand can have significant adverse impacts on organizations. Auditing all actions\nby superusers is one way to detect such misuse and identify the risk from\ninsider threats and the advanced persistent threat.",
        "check": "At the command line, execute the following command:\n\n# auditctl -l | grep execve\n\nExpected result:\n\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k execpriv\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k execpriv\n-a always,exit -F arch=b32 -S execve -C gid!=egid -F egid=0 -k execpriv\n-a always,exit -F arch=b64 -S execve -C gid!=egid -F egid=0 -k execpriv\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "At the command line, execute the following commands:\n\n# echo -a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k\nexecpriv>>/etc/audit/rules.d/audit.STIG.rules\n# echo -a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k\nexecpriv>>/etc/audit/rules.d/audit.STIG.rules\n# echo -a always,exit -F arch=b32 -S execve -C gid!=egid -F egid=0 -k\nexecpriv>>/etc/audit/rules.d/audit.STIG.rules\n# echo -a always,exit -F arch=b64 -S execve -C gid!=egid -F egid=0 -k\nexecpriv>>/etc/audit/rules.d/audit.STIG.rules\n# /sbin/augenrules --load"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000042-GPOS-00020",
        "gid": null,
        "rid": "PHTN-10-000012",
        "stig_id": "PHTN-10-000012",
        "cci": "CCI-000135",
        "nist": [
          "AU-3 (1)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000012\" do\n  title \"The Photon operating system must be configured to audit the execution\nof privileged functions.\"\n  desc  \"Misuse of privileged functions, either intentionally or\nunintentionally by authorized users, or by unauthorized external entities that\nhave compromised information system accounts, is a serious and ongoing concern\nand can have significant adverse impacts on organizations. Auditing all actions\nby superusers is one way to detect such misuse and identify the risk from\ninsider threats and the advanced persistent threat.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000042-GPOS-00020\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000012\"\n  tag stig_id: \"PHTN-10-000012\"\n  tag cci: \"CCI-000135\"\n  tag nist: [\"AU-3 (1)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# auditctl -l | grep execve\n\nExpected result:\n\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k execpriv\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k execpriv\n-a always,exit -F arch=b32 -S execve -C gid!=egid -F egid=0 -k execpriv\n-a always,exit -F arch=b64 -S execve -C gid!=egid -F egid=0 -k execpriv\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following commands:\n\n# echo -a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k\nexecpriv>>/etc/audit/rules.d/audit.STIG.rules\n# echo -a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k\nexecpriv>>/etc/audit/rules.d/audit.STIG.rules\n# echo -a always,exit -F arch=b32 -S execve -C gid!=egid -F egid=0 -k\nexecpriv>>/etc/audit/rules.d/audit.STIG.rules\n# echo -a always,exit -F arch=b64 -S execve -C gid!=egid -F egid=0 -k\nexecpriv>>/etc/audit/rules.d/audit.STIG.rules\n# /sbin/augenrules --load\"\n\n  describe.one do\n    describe auditd do\n      its(\"lines\") { should include %r{-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0} }\n    end\n    describe auditd do\n      its(\"lines\") { should include %r{-a exit,always -F arch=b32 -S execve -C uid!=euid -F euid=0} }\n    end\n  end\n  describe.one do\n    describe auditd do\n      its(\"lines\") { should include %r{-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0} }\n    end\n    describe auditd do\n      its(\"lines\") { should include %r{-a exit,always -F arch=b64 -S execve -C uid!=euid -F euid=0} }\n    end\n  end\n  describe.one do\n    describe auditd do\n      its(\"lines\") { should include %r{-a always,exit -F arch=b32 -S execve -C gid!=egid -F egid=0} }\n    end\n    describe auditd do\n      its(\"lines\") { should include %r{-a exit,always -F arch=b32 -S execve -C gid!=egid -F egid=0} }\n    end\n  end\n  describe.one do\n    describe auditd do\n      its(\"lines\") { should include %r{-a always,exit -F arch=b64 -S execve -C gid!=egid -F egid=0} }\n    end\n    describe auditd do\n      its(\"lines\") { should include %r{-a exit,always -F arch=b64 -S execve -C gid!=egid -F egid=0} }\n    end\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000012.rb",
        "line": 1
      },
      "id": "PHTN-10-000012"
    },
    {
      "title": "The Photon operating system must not have Duplicate User IDs (UIDs).",
      "desc": "To assure accountability and prevent unauthenticated access,\norganizational users must be uniquely identified and authenticated to prevent\npotential misuse and provide for non-repudiation.",
      "descriptions": {
        "default": "To assure accountability and prevent unauthenticated access,\norganizational users must be uniquely identified and authenticated to prevent\npotential misuse and provide for non-repudiation.",
        "check": "At the command line, execute the following command:\n\n# awk -F \":\" 'list[$3]++{print $1, $3}' /etc/passwd\n\nIf any lines are returned, this is a finding.",
        "fix": "Open /etc/passwd with a text editor.  Configure each user account\nthat has a duplicate UID with a unique UID."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000104-GPOS-00051",
        "gid": null,
        "rid": "PHTN-10-000034",
        "stig_id": "PHTN-10-000034",
        "cci": "CCI-000764",
        "nist": [
          "IA-2",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000034\" do\n  title \"The Photon operating system must not have Duplicate User IDs (UIDs).\"\n  desc  \"To assure accountability and prevent unauthenticated access,\norganizational users must be uniquely identified and authenticated to prevent\npotential misuse and provide for non-repudiation.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000104-GPOS-00051\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000034\"\n  tag stig_id: \"PHTN-10-000034\"\n  tag cci: \"CCI-000764\"\n  tag nist: [\"IA-2\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# awk -F \\\":\\\" 'list[$3]++{print $1, $3}' /etc/passwd\n\nIf any lines are returned, this is a finding.\"\n  desc 'fix', \"Open /etc/passwd with a text editor.  Configure each user account\nthat has a duplicate UID with a unique UID.\"\n\n  describe command('awk -F \":\" \\'list[$3]++{print $1, $3}\\' /etc/passwd') do\n      its ('stdout') { should eq '' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000034.rb",
        "line": 1
      },
      "id": "PHTN-10-000034"
    },
    {
      "title": "The Photon operating system must configure auditd to keep five rotated\nlog files.",
      "desc": "Audit logs are most useful when accessible by date, rather than size.\nThis can be acomplished through a combination of an audit log rotation cron\njob, setting a reasonable number of logs to keep and configuring auditd to not\nrotate the logs on it's own. This ensures that audit logs are accessible to the\nISSO in the event of a central log processing failure.",
      "descriptions": {
        "default": "Audit logs are most useful when accessible by date, rather than size.\nThis can be acomplished through a combination of an audit log rotation cron\njob, setting a reasonable number of logs to keep and configuring auditd to not\nrotate the logs on it's own. This ensures that audit logs are accessible to the\nISSO in the event of a central log processing failure.",
        "check": "At the command line, execute the following command:\n\n# grep \"^num_logs\" /etc/audit/auditd.conf\n\nExpected result:\n\nnum_logs = 5\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Open /etc/audit/auditd.conf with a text editor. Add or change the\n\"num_logs\" line as follows:\n\nnum_logs = 5\n\nAt the command line, execute the following command:\n\n# service auditd reload"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000341-GPOS-00132",
        "gid": null,
        "rid": "PHTN-10-000057",
        "stig_id": "PHTN-10-000057",
        "cci": "CCI-001849",
        "nist": [
          "AU-4",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000057\" do\n  title \"The Photon operating system must configure auditd to keep five rotated\nlog files.\"\n  desc  \"Audit logs are most useful when accessible by date, rather than size.\nThis can be acomplished through a combination of an audit log rotation cron\njob, setting a reasonable number of logs to keep and configuring auditd to not\nrotate the logs on it's own. This ensures that audit logs are accessible to the\nISSO in the event of a central log processing failure.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000341-GPOS-00132\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000057\"\n  tag stig_id: \"PHTN-10-000057\"\n  tag cci: \"CCI-001849\"\n  tag nist: [\"AU-4\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep \\\"^num_logs\\\" /etc/audit/auditd.conf\n\nExpected result:\n\nnum_logs = 5\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Open /etc/audit/auditd.conf with a text editor. Add or change the\n\\\"num_logs\\\" line as follows:\n\nnum_logs = 5\n\nAt the command line, execute the following command:\n\n# service auditd reload\"\n\n  describe auditd_conf do\n    its(\"num_logs\") { should cmp '5'}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000057.rb",
        "line": 1
      },
      "id": "PHTN-10-000057"
    },
    {
      "title": "The Photon operating system RPM package management tool must\ncryptographically verify the authenticity of all software packages during\ninstallation.",
      "desc": "Installation of any non-trusted software, patches, service packs,\ndevice drivers or operating system components can significantly affect the\noverall security of the operating system. Ensuring all packages' cryptographic\nsignatures are valid prior to installation ensures the provenance of the\nsoftware and protects against malicious tampering.",
      "descriptions": {
        "default": "Installation of any non-trusted software, patches, service packs,\ndevice drivers or operating system components can significantly affect the\noverall security of the operating system. Ensuring all packages' cryptographic\nsignatures are valid prior to installation ensures the provenance of the\nsoftware and protects against malicious tampering.",
        "check": "At the command line, execute the following command:\n\n# grep -s nosignature /usr/lib/rpm/rpmrc /etc/rpmrc ~root/.rpmrc\n\nIf the command returns any output, this is a finding.",
        "fix": "Open the file containing 'nosignature' with a text editor and\nremove the option."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000366-GPOS-00153",
        "gid": null,
        "rid": "PHTN-10-000062",
        "stig_id": "PHTN-10-000062",
        "cci": "CCI-001749",
        "nist": [
          "CM-5 (3)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000062\" do\n  title \"The Photon operating system RPM package management tool must\ncryptographically verify the authenticity of all software packages during\ninstallation.\"\n  desc  \"Installation of any non-trusted software, patches, service packs,\ndevice drivers or operating system components can significantly affect the\noverall security of the operating system. Ensuring all packages' cryptographic\nsignatures are valid prior to installation ensures the provenance of the\nsoftware and protects against malicious tampering.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000366-GPOS-00153\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000062\"\n  tag stig_id: \"PHTN-10-000062\"\n  tag cci: \"CCI-001749\"\n  tag nist: [\"CM-5 (3)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep -s nosignature /usr/lib/rpm/rpmrc /etc/rpmrc ~root/.rpmrc\n\nIf the command returns any output, this is a finding.\"\n  desc 'fix', \"Open the file containing 'nosignature' with a text editor and\nremove the option.\"\n\n  describe command('grep -s nosignature /usr/lib/rpm/rpmrc /etc/rpmrc ~root/.rpmrc') do\n      its ('stdout') { should eq '' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000062.rb",
        "line": 1
      },
      "id": "PHTN-10-000062"
    },
    {
      "title": "The Photon operating system must configure sshd to ignore\nuser-specific trusted hosts lists.",
      "desc": "SSH trust relationships enable trivial lateral spread after a host\ncompromise and therefore must be explicitly disabled. Individual users can have\na local list of trusted remote machines which must also be ignored while\ndisabling host-based authentication generally.",
      "descriptions": {
        "default": "SSH trust relationships enable trivial lateral spread after a host\ncompromise and therefore must be explicitly disabled. Individual users can have\na local list of trusted remote machines which must also be ignored while\ndisabling host-based authentication generally.",
        "check": "At the command line, execute the following command:\n\n# sshd -T|&grep -i IgnoreRhosts\n\nExpected result:\n\nIgnoreRhosts yes\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/ssh/sshd_config with a text editor and ensure that the\n\"IgnoreRhosts\" line is uncommented and set to the following:\n\nIgnoreRhosts yes\n\nAt the command line, execute the following command:\n\n# service sshd reload"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000092",
        "stig_id": "PHTN-10-000092",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000092\" do\n  title \"The Photon operating system must configure sshd to ignore\nuser-specific trusted hosts lists.\"\n  desc  \"SSH trust relationships enable trivial lateral spread after a host\ncompromise and therefore must be explicitly disabled. Individual users can have\na local list of trusted remote machines which must also be ignored while\ndisabling host-based authentication generally.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000092\"\n  tag stig_id: \"PHTN-10-000092\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# sshd -T|&grep -i IgnoreRhosts\n\nExpected result:\n\nIgnoreRhosts yes\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/ssh/sshd_config with a text editor and ensure that the\n\\\"IgnoreRhosts\\\" line is uncommented and set to the following:\n\nIgnoreRhosts yes\n\nAt the command line, execute the following command:\n\n# service sshd reload\"\n\n  describe command('sshd -T|&grep -i IgnoreRhosts') do\n    its ('stdout.strip') { should cmp 'IgnoreRhosts yes' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000092.rb",
        "line": 1
      },
      "id": "PHTN-10-000092"
    },
    {
      "title": "The Photon operating system must be configured so that passwords for\nnew users are restricted to a 24 hour minimum lifetime.",
      "desc": "Enforcing a minimum password lifetime helps to prevent repeated\npassword changes to defeat the password reuse or history enforcement\nrequirement. If users are allowed to immediately and continually change their\npassword, the password could be repeatedly changed in a short period of time to\ndefeat the organization's policy regarding password reuse.",
      "descriptions": {
        "default": "Enforcing a minimum password lifetime helps to prevent repeated\npassword changes to defeat the password reuse or history enforcement\nrequirement. If users are allowed to immediately and continually change their\npassword, the password could be repeatedly changed in a short period of time to\ndefeat the organization's policy regarding password reuse.",
        "check": "At the command line, execute the following command:\n\n# grep \"^PASS_MIN_DAYS\" /etc/login.defs\n\nIf PASS_MIN_DAYS is not set to 1, this is a finding",
        "fix": "Open /etc/login.defs with a text editor.Modify the\nPASS_MIN_DAYS line to the following:\n\nPASS_MIN_DAYS   1"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000075-GPOS-00043",
        "gid": null,
        "rid": "PHTN-10-000027",
        "stig_id": "PHTN-10-000027",
        "cci": "CCI-000198",
        "nist": [
          "IA-5 (1) (d)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000027\" do\n  title \"The Photon operating system must be configured so that passwords for\nnew users are restricted to a 24 hour minimum lifetime.\"\n  desc  \"Enforcing a minimum password lifetime helps to prevent repeated\npassword changes to defeat the password reuse or history enforcement\nrequirement. If users are allowed to immediately and continually change their\npassword, the password could be repeatedly changed in a short period of time to\ndefeat the organization's policy regarding password reuse.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000075-GPOS-00043\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000027\"\n  tag stig_id: \"PHTN-10-000027\"\n  tag cci: \"CCI-000198\"\n  tag nist: [\"IA-5 (1) (d)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep \\\"^PASS_MIN_DAYS\\\" /etc/login.defs\n\nIf PASS_MIN_DAYS is not set to 1, this is a finding\n\n\"\n  desc 'fix', \"Open /etc/login.defs with a text editor.Modify the\nPASS_MIN_DAYS line to the following:\n\nPASS_MIN_DAYS   1\"\n\n  describe login_defs do\n    its('PASS_MIN_DAYS') { should cmp '1' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000027.rb",
        "line": 1
      },
      "id": "PHTN-10-000027"
    },
    {
      "title": "The Photon operating system must not send IPv4 Internet Control\nMessage Protocol (ICMP) redirects.",
      "desc": "ICMP redirect messages are used by routers to inform hosts that a more\ndirect route exists for a particular destination. These messages contain\ninformation from the system's route table, possibly revealing portions of the\nnetwork topology.",
      "descriptions": {
        "default": "ICMP redirect messages are used by routers to inform hosts that a more\ndirect route exists for a particular destination. These messages contain\ninformation from the system's route table, possibly revealing portions of the\nnetwork topology.",
        "check": "At the command line, execute the following command:\n\n# /sbin/sysctl -a --pattern \"net.ipv4.conf.(all|default|eth.*).send_redirects\"\n\nExpected result:\n\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\nnet.ipv4.conf.eth0.send_redirects = 0\n\nIf the output does not match the expected result, this is a finding.\n\nNote: The number of ethx lines returned is dependant on the number of\ninterfaces. Every ethx entry must be set to 0.",
        "fix": "At the command line, execute the following command:\n\n# for SETTING in $(/sbin/sysctl -aN --pattern\n\"net.ipv4.conf.(all|default|eth.*).send_redirects\"); do sed -i -e\n\"/^${SETTING}/d\" /etc/sysctl.conf;echo $SETTING=0>>/etc/sysctl.conf; done"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000108",
        "stig_id": "PHTN-10-000108",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000108\" do\n  title \"The Photon operating system must not send IPv4 Internet Control\nMessage Protocol (ICMP) redirects.\"\n  desc  \"ICMP redirect messages are used by routers to inform hosts that a more\ndirect route exists for a particular destination. These messages contain\ninformation from the system's route table, possibly revealing portions of the\nnetwork topology.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000108\"\n  tag stig_id: \"PHTN-10-000108\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# /sbin/sysctl -a --pattern \\\"net.ipv4.conf.(all|default|eth.*).send_redirects\\\"\n\nExpected result:\n\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\nnet.ipv4.conf.eth0.send_redirects = 0\n\nIf the output does not match the expected result, this is a finding.\n\nNote: The number of ethx lines returned is dependant on the number of\ninterfaces. Every ethx entry must be set to 0.\"\n  desc 'fix', \"At the command line, execute the following command:\n\n# for SETTING in $(/sbin/sysctl -aN --pattern\n\\\"net.ipv4.conf.(all|default|eth.*).send_redirects\\\"); do sed -i -e\n\\\"/^${SETTING}/d\\\" /etc/sysctl.conf;echo $SETTING=0>>/etc/sysctl.conf; done\"\n\n  describe kernel_parameter('net.ipv4.conf.all.send_redirects') do\n    its('value') { should eq 0 }\n  end\n\n  describe kernel_parameter('net.ipv4.conf.default.send_redirects') do\n    its('value') { should eq 0 }\n  end\n\n  describe kernel_parameter('net.ipv4.conf.eth0.send_redirects') do\n    its('value') { should eq 0 }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000108.rb",
        "line": 1
      },
      "id": "PHTN-10-000108"
    },
    {
      "title": "The Photon operating system must configure sshd to disable X11\nforwarding.",
      "desc": "X11 is an older, insecure graphics forwarding protocol. It is not used\nby Photon and should be disabled as a general best practice to limit attack\nsurface area and communication channels.",
      "descriptions": {
        "default": "X11 is an older, insecure graphics forwarding protocol. It is not used\nby Photon and should be disabled as a general best practice to limit attack\nsurface area and communication channels.",
        "check": "At the command line, execute the following command:\n\n# sshd -T|&grep -i X11Forwarding\n\nExpected result:\n\nX11Forwarding no\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/ssh/sshd_config with a text editor and ensure that the\n\"X11Forwarding\" line is uncommented and set to the following:\n\nX11Forwarding no\n\nAt the command line, execute the following command:\n\n# service sshd reload"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000085",
        "stig_id": "PHTN-10-000085",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000085\" do\n  title \"The Photon operating system must configure sshd to disable X11\nforwarding.\"\n  desc  \"X11 is an older, insecure graphics forwarding protocol. It is not used\nby Photon and should be disabled as a general best practice to limit attack\nsurface area and communication channels.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000085\"\n  tag stig_id: \"PHTN-10-000085\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# sshd -T|&grep -i X11Forwarding\n\nExpected result:\n\nX11Forwarding no\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/ssh/sshd_config with a text editor and ensure that the\n\\\"X11Forwarding\\\" line is uncommented and set to the following:\n\nX11Forwarding no\n\nAt the command line, execute the following command:\n\n# service sshd reload\"\n\n  describe command('sshd -T|&grep -i X11Forwarding') do\n    its ('stdout.strip') { should cmp 'X11Forwarding no' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000085.rb",
        "line": 1
      },
      "id": "PHTN-10-000085"
    },
    {
      "title": "The Photon operating system must be configured to protect the SSH\nprivate host key from unauthorized access.",
      "desc": "If an unauthorized user obtains the private SSH host key file, the\nhost could be impersonated.",
      "descriptions": {
        "default": "If an unauthorized user obtains the private SSH host key file, the\nhost could be impersonated.",
        "check": "At the command line, execute the following command:\n\n# stat -c \"%n permissions are %a and owned by %U:%G\" /etc/ssh/*key\n\nExpected result:\n\n/etc/ssh/ssh_host_dsa_key permissions are 600 and owned by root:root\n/etc/ssh/ssh_host_ecdsa_key permissions are 600 and owned by root:root\n/etc/ssh/ssh_host_ed25519_key permissions are 600 and owned by root:root\n/etc/ssh/ssh_host_rsa_key permissions are 600 and owned by root:root\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "At the command line, execute the following commands for each\nreturned file:\n\n# chmod 600 <file>\n# chown root:root <file>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000116",
        "stig_id": "PHTN-10-000116",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000116\" do\n  title \"The Photon operating system must be configured to protect the SSH\nprivate host key from unauthorized access.\"\n  desc  \"If an unauthorized user obtains the private SSH host key file, the\nhost could be impersonated.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000116\"\n  tag stig_id: \"PHTN-10-000116\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# stat -c \\\"%n permissions are %a and owned by %U:%G\\\" /etc/ssh/*key\n\nExpected result:\n\n/etc/ssh/ssh_host_dsa_key permissions are 600 and owned by root:root\n/etc/ssh/ssh_host_ecdsa_key permissions are 600 and owned by root:root\n/etc/ssh/ssh_host_ed25519_key permissions are 600 and owned by root:root\n/etc/ssh/ssh_host_rsa_key permissions are 600 and owned by root:root\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following commands for each\nreturned file:\n\n# chmod 600 <file>\n# chown root:root <file>\"\n\n  command('find /etc/ssh/ -maxdepth 1 -name \"*key\"').stdout.split.each do | fname |\n      describe file(fname) do\n        its('owner') { should cmp 'root' }\n        its('group') { should cmp 'root' }\n        its('mode') { should cmp '0600' }\n      end\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000116.rb",
        "line": 1
      },
      "id": "PHTN-10-000116"
    },
    {
      "title": "The Photon operating system must implement address space layout\nrandomization to protect its memory from unauthorized code execution.",
      "desc": "Address space layout randomization (ASLR) makes it more difficult for\nan attacker to predict the location of attack code he or she has introduced\ninto a process's address space during an attempt at exploitation. Additionally,\nASLR also makes it more difficult for an attacker to know the location of\nexisting code in order to repurpose it using return-oriented programming (ROP)\ntechniques.",
      "descriptions": {
        "default": "Address space layout randomization (ASLR) makes it more difficult for\nan attacker to predict the location of attack code he or she has introduced\ninto a process's address space during an attempt at exploitation. Additionally,\nASLR also makes it more difficult for an attacker to know the location of\nexisting code in order to repurpose it using return-oriented programming (ROP)\ntechniques.",
        "check": "At the command line, execute the following command:\n\n# cat /proc/sys/kernel/randomize_va_space\n\nIf the value of randomize_va_space is not 2, this is a finding.",
        "fix": "Open /etc/sysctl.d/50-security-hardening.conf with a text editor\nand ensure that the \"randomize_va_space\" is uncommented and set to the\nfollowing:\n\nkernel.randomize_va_space=2\n\nAt the command line, execute the following command:\n\n# sysctl --system"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000433-GPOS-00193",
        "gid": null,
        "rid": "PHTN-10-000069",
        "stig_id": "PHTN-10-000069",
        "cci": "CCI-002824",
        "nist": [
          "SI-16",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000069\" do\n  title \"The Photon operating system must implement address space layout\nrandomization to protect its memory from unauthorized code execution.\"\n  desc  \"Address space layout randomization (ASLR) makes it more difficult for\nan attacker to predict the location of attack code he or she has introduced\ninto a process's address space during an attempt at exploitation. Additionally,\nASLR also makes it more difficult for an attacker to know the location of\nexisting code in order to repurpose it using return-oriented programming (ROP)\ntechniques.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000433-GPOS-00193\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000069\"\n  tag stig_id: \"PHTN-10-000069\"\n  tag cci: \"CCI-002824\"\n  tag nist: [\"SI-16\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# cat /proc/sys/kernel/randomize_va_space\n\nIf the value of randomize_va_space is not 2, this is a finding.\"\n  desc 'fix', \"Open /etc/sysctl.d/50-security-hardening.conf with a text editor\nand ensure that the \\\"randomize_va_space\\\" is uncommented and set to the\nfollowing:\n\nkernel.randomize_va_space=2\n\nAt the command line, execute the following command:\n\n# sysctl --system\"\n\n  describe kernel_parameter('kernel.randomize_va_space') do\n    its('value') { should eq 2 }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000069.rb",
        "line": 1
      },
      "id": "PHTN-10-000069"
    },
    {
      "title": "The Photon operating system must audit the insmod module.",
      "desc": "Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).",
      "descriptions": {
        "default": "Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).",
        "check": "At the command line, execute the following command:\n\n# auditctl -l | grep \"/sbin/insmod\"\n\nExpected result:\n\n-w /sbin/insmod -p x\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "At the command line, execute the following commands:\n\n# echo '-w /sbin/insmod -p x' >> /etc/audit/rules.d/audit.STIG.rules\n# /sbin/augenrules --load"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000471-GPOS-00216",
        "gid": null,
        "rid": "PHTN-10-000073",
        "stig_id": "PHTN-10-000073",
        "cci": "CCI-000172",
        "nist": [
          "AU-12 c",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000073\" do\n  title \"The Photon operating system must audit the insmod module.\"\n  desc  \"Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000471-GPOS-00216\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000073\"\n  tag stig_id: \"PHTN-10-000073\"\n  tag cci: \"CCI-000172\"\n  tag nist: [\"AU-12 c\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# auditctl -l | grep \\\"/sbin/insmod\\\"\n\nExpected result:\n\n-w /sbin/insmod -p x\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following commands:\n\n# echo '-w /sbin/insmod -p x' >> /etc/audit/rules.d/audit.STIG.rules\n# /sbin/augenrules --load\"\n\n  describe auditd do\n    its(\"lines\") { should include %r{-w /sbin/insmod -p x} }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000073.rb",
        "line": 1
      },
      "id": "PHTN-10-000073"
    },
    {
      "title": "The Photon operating system must remove all software components after\nupdated versions have been installed.",
      "desc": "Previous versions of software components that are not removed from the\ninformation system after updates have been installed may be exploited by\nadversaries. Some information technology products may remove older versions of\nsoftware automatically from the information system.",
      "descriptions": {
        "default": "Previous versions of software components that are not removed from the\ninformation system after updates have been installed may be exploited by\nadversaries. Some information technology products may remove older versions of\nsoftware automatically from the information system.",
        "check": "At the command line, execute the following command:\n\n# grep -i \"^clean_requirements_on_remove\" /etc/tdnf/tdnf.conf\n\nExpected result:\n\nclean_requirements_on_remove=true\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/tdnf/tdnf.conf with a text editor. Remove any existing\n\"clean_requirements_on_remove\" line and ensure the following line is present:\n\nclean_requirements_on_remove=true"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000437-GPOS-00194",
        "gid": null,
        "rid": "PHTN-10-000070",
        "stig_id": "PHTN-10-000070",
        "cci": "CCI-002617",
        "nist": [
          "SI-2 (6)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000070\" do\n  title \"The Photon operating system must remove all software components after\nupdated versions have been installed.\"\n  desc  \"Previous versions of software components that are not removed from the\ninformation system after updates have been installed may be exploited by\nadversaries. Some information technology products may remove older versions of\nsoftware automatically from the information system.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000437-GPOS-00194\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000070\"\n  tag stig_id: \"PHTN-10-000070\"\n  tag cci: \"CCI-002617\"\n  tag nist: [\"SI-2 (6)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep -i \\\"^clean_requirements_on_remove\\\" /etc/tdnf/tdnf.conf\n\nExpected result:\n\nclean_requirements_on_remove=true\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/tdnf/tdnf.conf with a text editor. Remove any existing\n\\\"clean_requirements_on_remove\\\" line and ensure the following line is present:\n\nclean_requirements_on_remove=true\"\n\n  describe command('grep -i \"^clean_requirements_on_remove\" /etc/tdnf/tdnf.conf') do\n      its ('stdout.strip') { should cmp 'clean_requirements_on_remove=true' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000070.rb",
        "line": 1
      },
      "id": "PHTN-10-000070"
    },
    {
      "title": "The Photon operating system must configure sshd to perform strict mode\nchecking of home directory configuration files.",
      "desc": "If other users have access to modify user-specific SSH configuration\nfiles, they may be able to log on to the system as another user.",
      "descriptions": {
        "default": "If other users have access to modify user-specific SSH configuration\nfiles, they may be able to log on to the system as another user.",
        "check": "At the command line, execute the following command:\n\n# sshd -T|&grep -i StrictModes\n\nExpected result:\n\n StrictModes yes\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/ssh/sshd_config with a text editor and ensure that the\n\"StrictModes\" line is uncommented and set to the following:\n\nStrictModes yes\n\nAt the command line, execute the following command:\n\n# service sshd reload"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000086",
        "stig_id": "PHTN-10-000086",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000086\" do\n  title \"The Photon operating system must configure sshd to perform strict mode\nchecking of home directory configuration files.\"\n  desc  \"If other users have access to modify user-specific SSH configuration\nfiles, they may be able to log on to the system as another user.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000086\"\n  tag stig_id: \"PHTN-10-000086\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# sshd -T|&grep -i StrictModes\n\nExpected result:\n\n StrictModes yes\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/ssh/sshd_config with a text editor and ensure that the\n\\\"StrictModes\\\" line is uncommented and set to the following:\n\nStrictModes yes\n\nAt the command line, execute the following command:\n\n# service sshd reload\"\n\n  describe command('sshd -T|&grep -i StrictModes') do\n    its ('stdout.strip') { should cmp 'StrictModes yes' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000086.rb",
        "line": 1
      },
      "id": "PHTN-10-000086"
    },
    {
      "title": "The Photon operating system messages file must be owned by root.",
      "desc": "Only authorized personnel should be aware of errors and the details of\nthe errors. Error messages are an indicator of an organization's operational\nstate and can provide sensitive information to an unprivileged attacker.",
      "descriptions": {
        "default": "Only authorized personnel should be aware of errors and the details of\nthe errors. Error messages are an indicator of an organization's operational\nstate and can provide sensitive information to an unprivileged attacker.",
        "check": "At the command line, execute the following command:\n\n# stat -c \"%n is owned by %U and group owned by %G\" /var/log/vmware/messages\n\nIf the /var/log/vmware/messages is not owned by root or not group owned by\nroot, this is a finding.",
        "fix": "At the command line, execute the following command:\n\n# chown root:root /var/log/vmware/messages"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000206-GPOS-00084",
        "gid": null,
        "rid": "PHTN-10-000042",
        "stig_id": "PHTN-10-000042",
        "cci": "CCI-001314",
        "nist": [
          "SI-11 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000042\" do\n  title \"The Photon operating system messages file must be owned by root.\"\n  desc  \"Only authorized personnel should be aware of errors and the details of\nthe errors. Error messages are an indicator of an organization's operational\nstate and can provide sensitive information to an unprivileged attacker.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000206-GPOS-00084\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000042\"\n  tag stig_id: \"PHTN-10-000042\"\n  tag cci: \"CCI-001314\"\n  tag nist: [\"SI-11 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# stat -c \\\"%n is owned by %U and group owned by %G\\\" /var/log/vmware/messages\n\nIf the /var/log/vmware/messages is not owned by root or not group owned by\nroot, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following command:\n\n# chown root:root /var/log/vmware/messages\"\n\n  describe file('/var/log/vmware/messages') do\n      its('owner') { should cmp 'root' }\n      its('group') { should cmp 'root' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000042.rb",
        "line": 1
      },
      "id": "PHTN-10-000042"
    },
    {
      "title": "The Photon operating system messages file must have mode 0640 or less\npermissive.",
      "desc": "Only authorized personnel should be aware of errors and the details of\nthe errors. Error messages are an indicator of an organization's operational\nstate and can provide sensitive information to an unprivileged attacker.",
      "descriptions": {
        "default": "Only authorized personnel should be aware of errors and the details of\nthe errors. Error messages are an indicator of an organization's operational\nstate and can provide sensitive information to an unprivileged attacker.",
        "check": "At the command line, execute the following command:\n\n# stat -c \"%n permissions are %a\" /var/log/vmware/messages\n\nIf the permissions on the file are more permissive than 0640, this is a\nfinding.",
        "fix": "At the command line, execute the following command:\n\n# chmod 0640 /var/log/vmware/messages"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000206-GPOS-00084",
        "gid": null,
        "rid": "PHTN-10-00004",
        "stig_id": "PHTN-10-000043",
        "cci": "CCI-001314",
        "nist": [
          "SI-11 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000043\" do\n  title \"The Photon operating system messages file must have mode 0640 or less\npermissive.\"\n  desc  \"Only authorized personnel should be aware of errors and the details of\nthe errors. Error messages are an indicator of an organization's operational\nstate and can provide sensitive information to an unprivileged attacker.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000206-GPOS-00084\"\n  tag gid: nil\n  tag rid: \"PHTN-10-00004\"\n  tag stig_id: \"PHTN-10-000043\"\n  tag cci: \"CCI-001314\"\n  tag nist: [\"SI-11 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# stat -c \\\"%n permissions are %a\\\" /var/log/vmware/messages\n\nIf the permissions on the file are more permissive than 0640, this is a\nfinding.\"\n  desc 'fix', \"At the command line, execute the following command:\n\n# chmod 0640 /var/log/vmware/messages\"\n\n  describe file('/var/log/vmware/messages') do\n    it { should_not be_more_permissive_than('0640') }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000043.rb",
        "line": 1
      },
      "id": "PHTN-10-000043"
    },
    {
      "title": "The Photon operating system auditd service must generate audit records\nfor all account creations, modifications, disabling, and termination events.",
      "desc": "Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).",
      "descriptions": {
        "default": "Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).",
        "check": "At the command line, execute the following command:\n\n# auditctl -l | grep -E /etc/security/opasswd\n\nIf any of these are not listed with a permissions filter of at least 'w', this\nis a finding.",
        "fix": "At the command line, execute the following command:\n\n# echo '-w /etc/security/opasswd -p wa -k opasswd' >>\n/etc/audit/rules.d/audit.STIG.rules\n# /sbin/augenrules --load"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000476-GPOS-00221",
        "gid": null,
        "rid": "PHTN-10-000074",
        "stig_id": "PHTN-10-000074",
        "cci": "CCI-000172",
        "nist": [
          "AU-12 c",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000074\" do\n  title \"The Photon operating system auditd service must generate audit records\nfor all account creations, modifications, disabling, and termination events.\"\n  desc  \"Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000476-GPOS-00221\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000074\"\n  tag stig_id: \"PHTN-10-000074\"\n  tag cci: \"CCI-000172\"\n  tag nist: [\"AU-12 c\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# auditctl -l | grep -E /etc/security/opasswd\n\nIf any of these are not listed with a permissions filter of at least 'w', this\nis a finding.\"\n  desc 'fix', \"At the command line, execute the following command:\n\n# echo '-w /etc/security/opasswd -p wa -k opasswd' >>\n/etc/audit/rules.d/audit.STIG.rules\n# /sbin/augenrules --load\"\n\n  describe auditd do\n    its(\"lines\") { should include %r{-w /etc/security/opasswd -p wa -k opasswd} }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000074.rb",
        "line": 1
      },
      "id": "PHTN-10-000074"
    },
    {
      "title": "The Photon operating system must enforce a minimum 8-character\npassword length.",
      "desc": "The shorter the password, the lower the number of possible\ncombinations that need to be tested before the password is compromised.\n\n    Password complexity, or strength, is a measure of the effectiveness of a\npassword in resisting attempts at guessing and brute-force attacks. Password\nlength is one factor of several that helps to determine strength and how long\nit takes to crack a password. Use of more characters in a password helps to\nexponentially increase the time and/or resources required to compromise the\npassword.",
      "descriptions": {
        "default": "The shorter the password, the lower the number of possible\ncombinations that need to be tested before the password is compromised.\n\n    Password complexity, or strength, is a measure of the effectiveness of a\npassword in resisting attempts at guessing and brute-force attacks. Password\nlength is one factor of several that helps to determine strength and how long\nit takes to crack a password. Use of more characters in a password helps to\nexponentially increase the time and/or resources required to compromise the\npassword.",
        "check": "At the command line, execute the following command:\n\n# grep pam_cracklib /etc/pam.d/system-password|grep --color=always \"minlen=..\"\n\nExpected result:\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1\nminlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/pam.d/system-password with a text editor.\n\nAdd the following, replacing any existing 'pam_cracklib.so' line :\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1\nminlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000078-GPOS-00046",
        "gid": null,
        "rid": "PHTN-10-000031",
        "stig_id": "PHTN-10-000031",
        "cci": "CCI-000205",
        "nist": [
          "IA-5 (1) (a)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000031\" do\n  title \"The Photon operating system must enforce a minimum 8-character\npassword length.\"\n  desc  \"The shorter the password, the lower the number of possible\ncombinations that need to be tested before the password is compromised.\n\n    Password complexity, or strength, is a measure of the effectiveness of a\npassword in resisting attempts at guessing and brute-force attacks. Password\nlength is one factor of several that helps to determine strength and how long\nit takes to crack a password. Use of more characters in a password helps to\nexponentially increase the time and/or resources required to compromise the\npassword.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000078-GPOS-00046\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000031\"\n  tag stig_id: \"PHTN-10-000031\"\n  tag cci: \"CCI-000205\"\n  tag nist: [\"IA-5 (1) (a)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep pam_cracklib /etc/pam.d/system-password|grep --color=always \\\"minlen=..\\\"\n\nExpected result:\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1\nminlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/pam.d/system-password with a text editor.\n\nAdd the following, replacing any existing 'pam_cracklib.so' line :\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1\nminlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root\"\n\n  describe file ('/etc/pam.d/system-password') do\n      its ('content'){should match /^(?=.*?\\bpassword\\b)(?=.*?\\brequisite\\b)(?=.*?\\bpam_cracklib.so\\b)(?=.*?\\bminlen=8\\b).*$/}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000031.rb",
        "line": 1
      },
      "id": "PHTN-10-000031"
    },
    {
      "title": "The Photon operating system audit log must log space limit problems to\nsyslog.",
      "desc": "It is critical for the appropriate personnel to be aware if a system\nis at risk of failing to process audit logs as required. Without this\nnotification, the security personnel may be unaware of an impending failure of\nthe audit capability, and system operation may be adversely affected.",
      "descriptions": {
        "default": "It is critical for the appropriate personnel to be aware if a system\nis at risk of failing to process audit logs as required. Without this\nnotification, the security personnel may be unaware of an impending failure of\nthe audit capability, and system operation may be adversely affected.",
        "check": "At the command line, execute the following command:\n\n# grep \"^space_left_action\" /etc/audit/auditd.conf\n\nExpected result:\n\nspace_left_action = SYSLOG\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/audit/auditd.conf with a text editor and ensure that the\n\"space_left_action\" line is uncommented and set to the following:\n\nspace_left_action = SYSLOG\n\nAt the command line, execute the following command:\n\n# service auditd reload"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000046-GPOS-00022",
        "gid": null,
        "rid": "PHTN-10-000013",
        "stig_id": "PHTN-10-000013",
        "cci": "CCI-000139",
        "nist": [
          "AU-5 a",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000013\" do\n  title \"The Photon operating system audit log must log space limit problems to\nsyslog.\"\n  desc  \"It is critical for the appropriate personnel to be aware if a system\nis at risk of failing to process audit logs as required. Without this\nnotification, the security personnel may be unaware of an impending failure of\nthe audit capability, and system operation may be adversely affected.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000046-GPOS-00022\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000013\"\n  tag stig_id: \"PHTN-10-000013\"\n  tag cci: \"CCI-000139\"\n  tag nist: [\"AU-5 a\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep \\\"^space_left_action\\\" /etc/audit/auditd.conf\n\nExpected result:\n\nspace_left_action = SYSLOG\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/audit/auditd.conf with a text editor and ensure that the\n\\\"space_left_action\\\" line is uncommented and set to the following:\n\nspace_left_action = SYSLOG\n\nAt the command line, execute the following command:\n\n# service auditd reload\"\n\n  describe auditd_conf do\n    its(\"space_left_action\") { should cmp 'SYSLOG'}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000013.rb",
        "line": 1
      },
      "id": "PHTN-10-000013"
    },
    {
      "title": "The Photon operating system must audit all account modifications.",
      "desc": "Once an attacker establishes access to a system, the attacker often\nattempts to create a persistent method of reestablishing access.  One way to\naccomplish this is for the attacker to modify an existing account.  Auditing\naccount modification actions provides logging that can be used for forensic\npurposes.",
      "descriptions": {
        "default": "Once an attacker establishes access to a system, the attacker often\nattempts to create a persistent method of reestablishing access.  One way to\naccomplish this is for the attacker to modify an existing account.  Auditing\naccount modification actions provides logging that can be used for forensic\npurposes.",
        "check": "At the command line, execute the following command:\n\n# auditctl -l | grep -E \"(usermod|groupmod)\"\n\nExpected result:\n\n-w /usr/sbin/usermod -p x -k usermod\n-w /usr/sbin/groupmod -p x -k groupmod\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "At the command line, execute the following commands:\n\n# echo '-w /usr/sbin/usermod -p x -k usermod' >>\n/etc/audit/rules.d/audit.STIG.rules\n# echo '-w /usr/sbin/groupmod -p x -k groupmod' >>\n/etc/audit/rules.d/audit.STIG.rules\n# /sbin/augenrules --load"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000239-GPOS-00089",
        "gid": null,
        "rid": "PHTN-10-000044",
        "stig_id": "PHTN-10-000044",
        "cci": "CCI-001403",
        "nist": [
          "AC-2 (4)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000044\" do\n  title \"The Photon operating system must audit all account modifications.\"\n  desc  \"Once an attacker establishes access to a system, the attacker often\nattempts to create a persistent method of reestablishing access.  One way to\naccomplish this is for the attacker to modify an existing account.  Auditing\naccount modification actions provides logging that can be used for forensic\npurposes. \"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000239-GPOS-00089\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000044\"\n  tag stig_id: \"PHTN-10-000044\"\n  tag cci: \"CCI-001403\"\n  tag nist: [\"AC-2 (4)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# auditctl -l | grep -E \\\"(usermod|groupmod)\\\"\n\nExpected result:\n\n-w /usr/sbin/usermod -p x -k usermod\n-w /usr/sbin/groupmod -p x -k groupmod\n\nIf the output does not match the expected result, this is a finding.\n\"\n  desc 'fix', \"At the command line, execute the following commands:\n\n# echo '-w /usr/sbin/usermod -p x -k usermod' >>\n/etc/audit/rules.d/audit.STIG.rules\n# echo '-w /usr/sbin/groupmod -p x -k groupmod' >>\n/etc/audit/rules.d/audit.STIG.rules\n# /sbin/augenrules --load\"\n\n  describe auditd do\n    its(\"lines\") { should include %r{-w /usr/sbin/usermod -p x -k usermod} }\n    its(\"lines\") { should include %r{-w /usr/sbin/groupmod -p x -k groupmod} }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000044.rb",
        "line": 1
      },
      "id": "PHTN-10-000044"
    },
    {
      "title": "The Photon operating system must enforce password complexity by\nrequiring that at least one numeric character be used.",
      "desc": "Use of a complex password helps to increase the time and resources\nrequired to compromise the password. Password complexity, or strength, is a\nmeasure of the effectiveness of a password in resisting attempts at guessing\nand brute-force attacks.",
      "descriptions": {
        "default": "Use of a complex password helps to increase the time and resources\nrequired to compromise the password. Password complexity, or strength, is a\nmeasure of the effectiveness of a password in resisting attempts at guessing\nand brute-force attacks.",
        "check": "At the command line, execute the following command:\n\n# grep pam_cracklib /etc/pam.d/system-password|grep --color=always\n\"dcredit=..\"\n\nExpected result:\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1\nminlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/pam.d/system-password with a text editor.\n\nAdd the following, replacing any existing 'pam_cracklib.so' line :\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1\nminlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000071-GPOS-00039",
        "gid": null,
        "rid": "PHTN-10-000023",
        "stig_id": "PHTN-10-000023",
        "cci": "CCI-000194",
        "nist": [
          "IA-5 (1) (a)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000023\" do\n  title \"The Photon operating system must enforce password complexity by\nrequiring that at least one numeric character be used.\"\n  desc  \"Use of a complex password helps to increase the time and resources\nrequired to compromise the password. Password complexity, or strength, is a\nmeasure of the effectiveness of a password in resisting attempts at guessing\nand brute-force attacks.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000071-GPOS-00039\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000023\"\n  tag stig_id: \"PHTN-10-000023\"\n  tag cci: \"CCI-000194\"\n  tag nist: [\"IA-5 (1) (a)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep pam_cracklib /etc/pam.d/system-password|grep --color=always\n\\\"dcredit=..\\\"\n\nExpected result:\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1\nminlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/pam.d/system-password with a text editor.\n\nAdd the following, replacing any existing 'pam_cracklib.so' line :\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1\nminlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root\"\n\n  describe file ('/etc/pam.d/system-password') do\n    its ('content'){should match /^(?=.*?\\bpassword\\b)(?=.*?\\brequisite\\b)(?=.*?\\bdcredit=-1\\b).*$/}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000023.rb",
        "line": 1
      },
      "id": "PHTN-10-000023"
    },
    {
      "title": "The Photon operating system must set an inactivity timeout value for\nnon-interactive sessions.",
      "desc": "A session time-out is an action taken when a session goes idle for any\nreason. Rather than relying on the user to manually disconnect their session\nprior to going idle, the Photon operating system must be able to identify when\na session has idled and take action to terminate the session.",
      "descriptions": {
        "default": "A session time-out is an action taken when a session goes idle for any\nreason. Rather than relying on the user to manually disconnect their session\nprior to going idle, the Photon operating system must be able to identify when\na session has idled and take action to terminate the session.",
        "check": "At the command line, execute the following command:\n\n# grep TMOUT /etc/bash.bashrc\n\nExpected result:\n\nTMOUT=900\nreadonly TMOUT\nexport TMOUT\n\nIf the file does not exist or the output does not match the expected result,\nthis is a finding.",
        "fix": "Open /etc/bash.bashrc with a text editor and set add the following\nto the end:\n\nTMOUT=900\nreadonly TMOUT\nexport TMOUT"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000279-GPOS-00109",
        "gid": null,
        "rid": "PHTN-10-000054",
        "stig_id": "PHTN-10-000054",
        "cci": "CCI-002361",
        "nist": [
          "AC-12",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000054\" do\n  title \"The Photon operating system must set an inactivity timeout value for\nnon-interactive sessions.\"\n  desc  \"A session time-out is an action taken when a session goes idle for any\nreason. Rather than relying on the user to manually disconnect their session\nprior to going idle, the Photon operating system must be able to identify when\na session has idled and take action to terminate the session.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000279-GPOS-00109\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000054\"\n  tag stig_id: \"PHTN-10-000054\"\n  tag cci: \"CCI-002361\"\n  tag nist: [\"AC-12\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep TMOUT /etc/bash.bashrc\n\nExpected result:\n\nTMOUT=900\nreadonly TMOUT\nexport TMOUT\n\nIf the file does not exist or the output does not match the expected result,\nthis is a finding.\n\"\n  desc 'fix', \"Open /etc/bash.bashrc with a text editor and set add the following\nto the end:\n\nTMOUT=900\nreadonly TMOUT\nexport TMOUT\"\n\n  describe file('/etc/bash.bashrc') do\n    it { should exist }\n    its('content') { should match %r{TMOUT=900} }\n    its('content') { should match %r{readonly TMOUT} }\n    its('content') { should match %r{export TMOUT} }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000054.rb",
        "line": 1
      },
      "id": "PHTN-10-000054"
    },
    {
      "title": "The Photon operating system must protect all sysctl configuration\nfiles from unauthorized access.",
      "desc": "The sysctl configuration file specify  values for kernel parameters to\nbe set on boot. Incorrect or malicious configuration of these parameters can\nhave a negative effect on system security.",
      "descriptions": {
        "default": "The sysctl configuration file specify  values for kernel parameters to\nbe set on boot. Incorrect or malicious configuration of these parameters can\nhave a negative effect on system security.",
        "check": "At the command line, execute the following command:\n\n# find /etc/sysctl.conf /etc/sysctl.d/* -xdev -type f -a '(' -not -perm 600 -o\n-not -user root -o -not -group root ')' -exec ls -ld {} \\;\n\nIf any files are returned, this is a finding.",
        "fix": "At the command line, execute the following commands for each\nreturned file:\n\n# chmod 600 <file>\n# chown root:root <file>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000120",
        "stig_id": "PHTN-10-000120",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000120\" do\n  title \"The Photon operating system must protect all sysctl configuration\nfiles from unauthorized access.\"\n  desc  \"The sysctl configuration file specify  values for kernel parameters to\nbe set on boot. Incorrect or malicious configuration of these parameters can\nhave a negative effect on system security.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000120\"\n  tag stig_id: \"PHTN-10-000120\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# find /etc/sysctl.conf /etc/sysctl.d/* -xdev -type f -a '(' -not -perm 600 -o\n-not -user root -o -not -group root ')' -exec ls -ld {} \\\\;\n\nIf any files are returned, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following commands for each\nreturned file:\n\n# chmod 600 <file>\n# chown root:root <file>\"\n\n  describe command(\"find /etc/sysctl.conf /etc/sysctl.d/* -xdev -type f -a '(' -not -perm 600 -o -not -user root -o -not -group root ')' -exec ls -ld {} \\;\") do\n     its ('stdout') { should eq '' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000120.rb",
        "line": 1
      },
      "id": "PHTN-10-000120"
    },
    {
      "title": "The Photon operating system must enforce password complexity by\nrequiring that at least one lower-case character be used.",
      "desc": "Use of a complex password helps to increase the time and resources\nrequired to compromise the password. Password complexity, or strength, is a\nmeasure of the effectiveness of a password in resisting attempts at guessing\nand brute-force attacks.",
      "descriptions": {
        "default": "Use of a complex password helps to increase the time and resources\nrequired to compromise the password. Password complexity, or strength, is a\nmeasure of the effectiveness of a password in resisting attempts at guessing\nand brute-force attacks.",
        "check": "At the command line, execute the following command:\n\n# grep pam_cracklib /etc/pam.d/system-password|grep --color=always\n\"lcredit=..\"\n\nExpected result:\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1\nminlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/pam.d/system-password with a text editor.\n\nAdd the following, replacing any existing 'pam_cracklib.so' line :\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1\nminlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000070-GPOS-00038",
        "gid": null,
        "rid": "PHTN-10-000022",
        "stig_id": "PHTN-10-000022",
        "cci": "CCI-000193",
        "nist": [
          "IA-5 (1) (a)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000022\" do\n  title \"The Photon operating system must enforce password complexity by\nrequiring that at least one lower-case character be used.\"\n  desc  \"Use of a complex password helps to increase the time and resources\nrequired to compromise the password. Password complexity, or strength, is a\nmeasure of the effectiveness of a password in resisting attempts at guessing\nand brute-force attacks.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000070-GPOS-00038\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000022\"\n  tag stig_id: \"PHTN-10-000022\"\n  tag cci: \"CCI-000193\"\n  tag nist: [\"IA-5 (1) (a)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep pam_cracklib /etc/pam.d/system-password|grep --color=always\n\\\"lcredit=..\\\"\n\nExpected result:\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1\nminlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/pam.d/system-password with a text editor.\n\nAdd the following, replacing any existing 'pam_cracklib.so' line :\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1\nminlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root\"\n\n  describe file ('/etc/pam.d/system-password') do\n    its ('content'){should match /^(?=.*?\\bpassword\\b)(?=.*?\\brequisite\\b)(?=.*?\\blcredit=-1\\b).*$/}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000022.rb",
        "line": 1
      },
      "id": "PHTN-10-000022"
    },
    {
      "title": "The Photon operating system must be configured so that passwords for\nnew users are restricted to a 90 day maximum lifetime.",
      "desc": "Any password, no matter how complex, can eventually be cracked.\nTherefore, passwords need to be changed periodically. If the operating system\ndoes not limit the lifetime of passwords and force users to change their\npasswords, there is the risk that the operating system passwords could be\ncompromised.",
      "descriptions": {
        "default": "Any password, no matter how complex, can eventually be cracked.\nTherefore, passwords need to be changed periodically. If the operating system\ndoes not limit the lifetime of passwords and force users to change their\npasswords, there is the risk that the operating system passwords could be\ncompromised.",
        "check": "At the command line, execute the following command:\n\n# grep \"^PASS_MAX_DAYS\" /etc/login.defs\n\nIf the value of PASS_MAX_DAYS is greater than 90, this is a finding",
        "fix": "Open /etc/login.defs with a text editor. Modify the PASS_MAX_DAYS\nline to the following:\n\nPASS_MAX_DAYS   90"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000076-GPOS-00044",
        "gid": null,
        "rid": "PHTN-10-000028",
        "stig_id": "PHTN-10-000028",
        "cci": "CCI-000199",
        "nist": [
          "IA-5 (1) (d)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000028\" do\n  title \"The Photon operating system must be configured so that passwords for\nnew users are restricted to a 90 day maximum lifetime.\"\n  desc  \"Any password, no matter how complex, can eventually be cracked.\nTherefore, passwords need to be changed periodically. If the operating system\ndoes not limit the lifetime of passwords and force users to change their\npasswords, there is the risk that the operating system passwords could be\ncompromised.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000076-GPOS-00044\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000028\"\n  tag stig_id: \"PHTN-10-000028\"\n  tag cci: \"CCI-000199\"\n  tag nist: [\"IA-5 (1) (d)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep \\\"^PASS_MAX_DAYS\\\" /etc/login.defs\n\nIf the value of PASS_MAX_DAYS is greater than 90, this is a finding\n\n\"\n  desc 'fix', \"Open /etc/login.defs with a text editor. Modify the PASS_MAX_DAYS\nline to the following:\n\nPASS_MAX_DAYS   90\"\n\n  describe login_defs do\n    its('PASS_MAX_DAYS') { should cmp '90' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000028.rb",
        "line": 1
      },
      "id": "PHTN-10-000028"
    },
    {
      "title": "The Photon operating system must configure sshd to disconnect idle SSH\nsessions.",
      "desc": "Terminating an idle session within a short time period reduces the\nwindow of opportunity for unauthorized personnel to take control of a\nmanagement session enabled on the console or console port that has been left\nunattended",
      "descriptions": {
        "default": "Terminating an idle session within a short time period reduces the\nwindow of opportunity for unauthorized personnel to take control of a\nmanagement session enabled on the console or console port that has been left\nunattended",
        "check": "At the command line, execute the following command:\n\n# sshd -T|&grep -i ClientAliveInterval\n\nExpected result:\n\nClientAliveInterval 900\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/ssh/sshd_config with a text editor and ensure that the\n\"ClientAliveInterval\" line is uncommented and set to the following:\n\nClientAliveInterval 900\n\nAt the command line, execute the following command:\n\n# service sshd reload"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000163-GPOS-00072",
        "gid": null,
        "rid": "PHTN-10-000038",
        "stig_id": "PHTN-10-000038",
        "cci": "CCI-001133",
        "nist": [
          "SC-10",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000038\" do\n  title \"The Photon operating system must configure sshd to disconnect idle SSH\nsessions.\"\n  desc  \"Terminating an idle session within a short time period reduces the\nwindow of opportunity for unauthorized personnel to take control of a\nmanagement session enabled on the console or console port that has been left\nunattended\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000163-GPOS-00072\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000038\"\n  tag stig_id: \"PHTN-10-000038\"\n  tag cci: \"CCI-001133\"\n  tag nist: [\"SC-10\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# sshd -T|&grep -i ClientAliveInterval\n\nExpected result:\n\nClientAliveInterval 900\n\nIf the output does not match the expected result, this is a finding.\n\n\"\n  desc 'fix', \"Open /etc/ssh/sshd_config with a text editor and ensure that the\n\\\"ClientAliveInterval\\\" line is uncommented and set to the following:\n\nClientAliveInterval 900\n\nAt the command line, execute the following command:\n\n# service sshd reload\"\n\n  describe command('sshd -T|&grep -i ClientAliveInterval') do\n    its ('stdout.strip') { should cmp 'ClientAliveInterval 900' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000038.rb",
        "line": 1
      },
      "id": "PHTN-10-000038"
    },
    {
      "title": "The Photon operating system must log IPv4 packets with impossible\naddresses.",
      "desc": "The presence of \"martian\" packets (which have impossible addresses)\nas well as spoofed packets, source-routed packets, and redirects could be a\nsign of nefarious network activity. Logging these packets enables this activity\nto be detected.",
      "descriptions": {
        "default": "The presence of \"martian\" packets (which have impossible addresses)\nas well as spoofed packets, source-routed packets, and redirects could be a\nsign of nefarious network activity. Logging these packets enables this activity\nto be detected.",
        "check": "At the command line, execute the following command:\n\n# /sbin/sysctl -a --pattern \"net.ipv4.conf.(all|default|eth.*).log_martians\"\n\nExpected result:\n\nnet.ipv4.conf.all.log_martians = 1\nnet.ipv4.conf.default.log_martians = 1\nnet.ipv4.conf.eth0.log_martians = 1\n\nIf the output does not match the expected result, this is a finding.\n\nNote: The number of ethx lines returned is dependant on the number of\ninterfaces. Every ethx entry must be set to 1.",
        "fix": "At the command line, execute the following command:\n\n# for SETTING in $(/sbin/sysctl -aN --pattern\n\"net.ipv4.conf.(all|default|eth.*).log_martians\"); do sed -i -e\n\"/^${SETTING}/d\" /etc/sysctl.conf;echo $SETTING=1>>/etc/sysctl.conf; done"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000109",
        "stig_id": "PHTN-10-000109",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000109\" do\n  title \"The Photon operating system must log IPv4 packets with impossible\naddresses.\"\n  desc  \"The presence of \\\"martian\\\" packets (which have impossible addresses)\nas well as spoofed packets, source-routed packets, and redirects could be a\nsign of nefarious network activity. Logging these packets enables this activity\nto be detected.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000109\"\n  tag stig_id: \"PHTN-10-000109\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# /sbin/sysctl -a --pattern \\\"net.ipv4.conf.(all|default|eth.*).log_martians\\\"\n\nExpected result:\n\nnet.ipv4.conf.all.log_martians = 1\nnet.ipv4.conf.default.log_martians = 1\nnet.ipv4.conf.eth0.log_martians = 1\n\nIf the output does not match the expected result, this is a finding.\n\nNote: The number of ethx lines returned is dependant on the number of\ninterfaces. Every ethx entry must be set to 1.\"\n  desc 'fix', \"At the command line, execute the following command:\n\n# for SETTING in $(/sbin/sysctl -aN --pattern\n\\\"net.ipv4.conf.(all|default|eth.*).log_martians\\\"); do sed -i -e\n\\\"/^${SETTING}/d\\\" /etc/sysctl.conf;echo $SETTING=1>>/etc/sysctl.conf; done\"\n\n  describe kernel_parameter('net.ipv4.conf.all.log_martians') do\n    its('value') { should eq 1 }\n  end\n\n  describe kernel_parameter('net.ipv4.conf.default.log_martians') do\n    its('value') { should eq 1 }\n  end\n\n  describe kernel_parameter('net.ipv4.conf.eth0.log_martians') do\n    its('value') { should eq 1 }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000109.rb",
        "line": 1
      },
      "id": "PHTN-10-000109"
    },
    {
      "title": "The Photon operating system must ensure that audit events are flushed\nto disk at proper intervals.",
      "desc": "Without setting a balance between performance and ensuring all audit\nevents are written to disk, performance of the system may suffer or the risk of\nmissing audit entries may be too high.",
      "descriptions": {
        "default": "Without setting a balance between performance and ensuring all audit\nevents are written to disk, performance of the system may suffer or the risk of\nmissing audit entries may be too high.",
        "check": "At the command line, execute the following command:\n\n# grep -E \"freq|flush\" /etc/audit/auditd.conf\n\nExpected result:\n\nflush = INCREMENTAL_ASYNC\nfreq = 50\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/audit/auditd.conf with a text editor.\n\nEnsure that the below line is present and any existing 'flush' and 'freq'\nsettings are removed.\n\nflush = INCREMENTAL_ASYNC\nfreq = 50"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000078",
        "stig_id": "PHTN-10-000078",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000078\" do\n  title \"The Photon operating system must ensure that audit events are flushed\nto disk at proper intervals.\"\n  desc  \"Without setting a balance between performance and ensuring all audit\nevents are written to disk, performance of the system may suffer or the risk of\nmissing audit entries may be too high.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000078\"\n  tag stig_id: \"PHTN-10-000078\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep -E \\\"freq|flush\\\" /etc/audit/auditd.conf\n\nExpected result:\n\nflush = INCREMENTAL_ASYNC\nfreq = 50\n\nIf the output does not match the expected result, this is a finding.\n\n\"\n  desc 'fix', \"Open /etc/audit/auditd.conf with a text editor.\n\nEnsure that the below line is present and any existing 'flush' and 'freq'\nsettings are removed.\n\nflush = INCREMENTAL_ASYNC\nfreq = 50\"\n\n  describe auditd_conf do\n    its(\"flush\") { should cmp 'INCREMENTAL_ASYNC'}\n    its(\"freq\") { should cmp '50'}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000078.rb",
        "line": 1
      },
      "id": "PHTN-10-000078"
    },
    {
      "title": "The Photon operating system must disable the loading of unnecessary\nkernel modules.",
      "desc": "To support the requirements and principles of least functionality, the\noperating system must provide only essential capabilities and limit the use of\nmodules, protocols, and/or services to only those required for the proper\nfunctioning of the product.",
      "descriptions": {
        "default": "To support the requirements and principles of least functionality, the\noperating system must provide only essential capabilities and limit the use of\nmodules, protocols, and/or services to only those required for the proper\nfunctioning of the product.",
        "check": "At the command line, execute the following command:\n\n# modprobe --showconfig | grep \"^install\" | grep \"/bin\"\n\nExpected result:\n\ninstall sctp /bin/false\ninstall dccp /bin/false\ninstall dccp_ipv4 /bin/false\ninstall dccp_ipv6 /bin/false\ninstall ipx /bin/false\ninstall appletalk /bin/false\ninstall decnet /bin/false\ninstall rds /bin/false\ninstall tipc /bin/false\ninstall bluetooth /bin/false\ninstall usb-storage /bin/false\ninstall ieee1394 /bin/false\ninstall cramfs /bin/false\ninstall freevxfs /bin/false\ninstall jffs2 /bin/false\ninstall hfs /bin/false\ninstall hfsplus /bin/false\ninstall squashfs /bin/false\ninstall udf /bin/false\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open  /etc/modprobe.d/modprobe.conf with a text editor and set the\ncontents as follows:\n\ninstall sctp /bin/false\ninstall dccp /bin/false\ninstall dccp_ipv4 /bin/false\ninstall dccp_ipv6 /bin/false\ninstall ipx /bin/false\ninstall appletalk /bin/false\ninstall decnet /bin/false\ninstall rds /bin/false\ninstall tipc /bin/false\ninstall bluetooth /bin/false\ninstall usb-storage /bin/false\ninstall ieee1394 /bin/false\ninstall cramfs /bin/false\ninstall freevxfs /bin/false\ninstall jffs2 /bin/false\ninstall hfs /bin/false\ninstall hfsplus /bin/false\ninstall squashfs /bin/false\ninstall udf /bin/false"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000096-GPOS-00050",
        "gid": null,
        "rid": "PHTN-10-000033",
        "stig_id": "PHTN-10-000033",
        "cci": "CCI-000382",
        "nist": [
          "CM-7 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000033\" do\n  title \"The Photon operating system must disable the loading of unnecessary\nkernel modules.\"\n  desc  \"To support the requirements and principles of least functionality, the\noperating system must provide only essential capabilities and limit the use of\nmodules, protocols, and/or services to only those required for the proper\nfunctioning of the product.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000096-GPOS-00050\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000033\"\n  tag stig_id: \"PHTN-10-000033\"\n  tag cci: \"CCI-000382\"\n  tag nist: [\"CM-7 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# modprobe --showconfig | grep \\\"^install\\\" | grep \\\"/bin\\\"\n\nExpected result:\n\ninstall sctp /bin/false\ninstall dccp /bin/false\ninstall dccp_ipv4 /bin/false\ninstall dccp_ipv6 /bin/false\ninstall ipx /bin/false\ninstall appletalk /bin/false\ninstall decnet /bin/false\ninstall rds /bin/false\ninstall tipc /bin/false\ninstall bluetooth /bin/false\ninstall usb-storage /bin/false\ninstall ieee1394 /bin/false\ninstall cramfs /bin/false\ninstall freevxfs /bin/false\ninstall jffs2 /bin/false\ninstall hfs /bin/false\ninstall hfsplus /bin/false\ninstall squashfs /bin/false\ninstall udf /bin/false\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open  /etc/modprobe.d/modprobe.conf with a text editor and set the\ncontents as follows:\n\ninstall sctp /bin/false\ninstall dccp /bin/false\ninstall dccp_ipv4 /bin/false\ninstall dccp_ipv6 /bin/false\ninstall ipx /bin/false\ninstall appletalk /bin/false\ninstall decnet /bin/false\ninstall rds /bin/false\ninstall tipc /bin/false\ninstall bluetooth /bin/false\ninstall usb-storage /bin/false\ninstall ieee1394 /bin/false\ninstall cramfs /bin/false\ninstall freevxfs /bin/false\ninstall jffs2 /bin/false\ninstall hfs /bin/false\ninstall hfsplus /bin/false\ninstall squashfs /bin/false\ninstall udf /bin/false\n\"\n\n  describe command('modprobe --showconfig | grep \"^install sctp \" | grep \"/bin\"') do\n    its('stdout.strip.strip') {should eq \"install sctp /bin/false\"}\n  end\n\n  describe command('modprobe --showconfig | grep \"^install dccp \" | grep \"/bin\"') do\n    its('stdout.strip') {should eq \"install dccp /bin/false\"}\n  end\n\n  describe command('modprobe --showconfig | grep \"^install dccp_ipv4\" | grep \"/bin\"') do\n    its('stdout.strip') {should eq \"install dccp_ipv4 /bin/false\"}\n  end\n\n  describe command('modprobe --showconfig | grep \"^install dccp_ipv6\" | grep \"/bin\"') do\n    its('stdout.strip') {should eq \"install dccp_ipv6 /bin/false\"}\n  end\n\n  describe command('modprobe --showconfig | grep \"^install ipx\" | grep \"/bin\"') do\n    its('stdout.strip') {should eq \"install ipx /bin/false\"}\n  end\n\n  describe command('modprobe --showconfig | grep \"^install appletalk\" | grep \"/bin\"') do\n    its('stdout.strip') {should eq \"install appletalk /bin/false\"}\n  end\n\n  describe command('modprobe --showconfig | grep \"^install decnet\" | grep \"/bin\"') do\n    its('stdout.strip') {should eq \"install decnet /bin/false\"}\n  end\n\n  describe command('modprobe --showconfig | grep \"^install rds\" | grep \"/bin\"') do\n    its('stdout.strip') {should eq \"install rds /bin/false\"}\n  end\n\n  describe command('modprobe --showconfig | grep \"^install tipc\" | grep \"/bin\"') do\n    its('stdout.strip') {should eq \"install tipc /bin/false\"}\n  end\n\n  describe command('modprobe --showconfig | grep \"^install bluetooth\" | grep \"/bin\"') do\n    its('stdout.strip') {should eq \"install bluetooth /bin/false\"}\n  end\n\n  describe command('modprobe --showconfig | grep \"^install usb_storage\" | grep \"/bin\"') do\n    its('stdout.strip') {should eq \"install usb_storage /bin/false\"}\n  end\n\n  describe command('modprobe --showconfig | grep \"^install ieee1394\" | grep \"/bin\"') do\n    its('stdout.strip') {should eq \"install ieee1394 /bin/false\"}\n  end\n\n  describe command('modprobe --showconfig | grep \"^install cramfs\" | grep \"/bin\"') do\n    its('stdout.strip') {should eq \"install cramfs /bin/false\"}\n  end\n\n  describe command('modprobe --showconfig | grep \"^install freevxfs\" | grep \"/bin\"') do\n    its('stdout.strip') {should eq \"install freevxfs /bin/false\"}\n  end\n\n  describe command('modprobe --showconfig | grep \"^install jffs2\" | grep \"/bin\"') do\n    its('stdout.strip') {should eq \"install jffs2 /bin/false\"}\n  end\n\n  describe command('modprobe --showconfig | grep \"^install hfs \" | grep \"/bin\"') do\n    its('stdout.strip') {should eq \"install hfs /bin/false\"}\n  end\n\n  describe command('modprobe --showconfig | grep \"^install hfsplus\" | grep \"/bin\"') do\n    its('stdout.strip') {should eq \"install hfsplus /bin/false\"}\n  end\n\n  describe command('modprobe --showconfig | grep \"^install squashfs\" | grep \"/bin\"') do\n    its('stdout.strip') {should eq \"install squashfs /bin/false\"}\n  end\n\n  describe command('modprobe --showconfig | grep \"^install udf\" | grep \"/bin\"') do\n    its('stdout.strip') {should eq \"install udf /bin/false\"}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000033.rb",
        "line": 1
      },
      "id": "PHTN-10-000033"
    },
    {
      "title": "The Photon operating system must configure sshd to disconnect idle SSH\nsessions.",
      "desc": "Terminating an idle session within a short time period reduces the\nwindow of opportunity for unauthorized personnel to take control of a\nmanagement session enabled on the console or console port that has been left\nunattended",
      "descriptions": {
        "default": "Terminating an idle session within a short time period reduces the\nwindow of opportunity for unauthorized personnel to take control of a\nmanagement session enabled on the console or console port that has been left\nunattended",
        "check": "At the command line, execute the following command:\n\n# sshd -T|&grep -i ClientAliveCountMax\n\nExpected result:\n\nClientAliveCountMax 0\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/ssh/sshd_config with a text editor and ensure that the\n\"ClientAliveCountMax\" line is uncommented and set to the following:\n\nClientAliveCountMax 0\n\nAt the command line, execute the following command:\n\n# service sshd reload"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000163-GPOS-00072",
        "gid": null,
        "rid": "PHTN-10-000039",
        "stig_id": "PHTN-10-000039",
        "cci": "CCI-001133",
        "nist": [
          "SC-10",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000039\" do\n  title \"The Photon operating system must configure sshd to disconnect idle SSH\nsessions.\"\n  desc  \"Terminating an idle session within a short time period reduces the\nwindow of opportunity for unauthorized personnel to take control of a\nmanagement session enabled on the console or console port that has been left\nunattended\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000163-GPOS-00072\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000039\"\n  tag stig_id: \"PHTN-10-000039\"\n  tag cci: \"CCI-001133\"\n  tag nist: [\"SC-10\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# sshd -T|&grep -i ClientAliveCountMax\n\nExpected result:\n\nClientAliveCountMax 0\n\nIf the output does not match the expected result, this is a finding.\n\n\"\n  desc 'fix', \"Open /etc/ssh/sshd_config with a text editor and ensure that the\n\\\"ClientAliveCountMax\\\" line is uncommented and set to the following:\n\nClientAliveCountMax 0\n\nAt the command line, execute the following command:\n\n# service sshd reload\"\n\n  describe command('sshd -T|&grep -i ClientAliveCountMax') do\n    its ('stdout.strip') { should cmp 'ClientAliveCountMax 0' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000039.rb",
        "line": 1
      },
      "id": "PHTN-10-000039"
    },
    {
      "title": "The Photon operating system must generate audit records when\nsuccessful/unsuccessful logon attempts occur.",
      "desc": "Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).",
      "descriptions": {
        "default": "Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).",
        "check": "At the command line, execute the following command:\n\n# auditctl -l | grep -E \"faillog|lastlog|tallylog\"\n\nExpected result:\n\n-w /var/log/faillog -p wa\n-w /var/log/lastlog -p wa\n-w /var/log/tallylog -p wa\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "At the command line, execute the following commands:\n\n# echo '-w /var/log/faillog -p wa' >> /etc/audit/rules.d/audit.STIG.rules\n# echo '-w /var/log/lastlog -p wa' >> /etc/audit/rules.d/audit.STIG.rules\n# echo '-w /var/log/tallylog -p wa' >> /etc/audit/rules.d/audit.STIG.rules\n# /sbin/augenrules --load"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000470-GPOS-00214",
        "gid": null,
        "rid": "PHTN-10-000072",
        "stig_id": "PHTN-10-000072",
        "cci": "CCI-000172",
        "nist": [
          "AU-12 c",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000072\" do\n  title \"The Photon operating system must generate audit records when\nsuccessful/unsuccessful logon attempts occur.\"\n  desc  \"Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000470-GPOS-00214\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000072\"\n  tag stig_id: \"PHTN-10-000072\"\n  tag cci: \"CCI-000172\"\n  tag nist: [\"AU-12 c\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# auditctl -l | grep -E \\\"faillog|lastlog|tallylog\\\"\n\nExpected result:\n\n-w /var/log/faillog -p wa\n-w /var/log/lastlog -p wa\n-w /var/log/tallylog -p wa\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following commands:\n\n# echo '-w /var/log/faillog -p wa' >> /etc/audit/rules.d/audit.STIG.rules\n# echo '-w /var/log/lastlog -p wa' >> /etc/audit/rules.d/audit.STIG.rules\n# echo '-w /var/log/tallylog -p wa' >> /etc/audit/rules.d/audit.STIG.rules\n# /sbin/augenrules --load\"\n\n  describe auditd do\n    its(\"lines\") { should include %r{-w /var/log/faillog -p wa} }\n    its(\"lines\") { should include %r{-w /var/log/lastlog -p wa} }\n    its(\"lines\") { should include %r{-w /var/log/tallylog -p wa} }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000072.rb",
        "line": 1
      },
      "id": "PHTN-10-000072"
    },
    {
      "title": "The Photon operating system must configure sshd with a specific\nListenAddress.",
      "desc": "Without specifying a ListenAddress, sshd will listen on all\ninterfaces. In situations with multiple interfaces this may not be intended\nbehavior and could lead to offering remote access on an unapproved network.",
      "descriptions": {
        "default": "Without specifying a ListenAddress, sshd will listen on all\ninterfaces. In situations with multiple interfaces this may not be intended\nbehavior and could lead to offering remote access on an unapproved network.",
        "check": "At the command line, execute the following command:\n\n# sshd -T|&grep -i ListenAddress\n\nIf the ListenAddress is not configured to the VCSA management IP, this is a\nfinding.",
        "fix": "Open /etc/ssh/sshd_config with a text editor and ensure that the\n\"ListenAddress\" line is uncommented and set to a valid local IP:\n\nExample:\n\nListenAddress 169.254.1.2\n\nReplace '169.254.1.2' with the management address of the VCSA.\n\nAt the command line, execute the following command:\n\n# service sshd reload"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000297-GPOS-00115",
        "gid": null,
        "rid": "PHTN-10-000055",
        "stig_id": "PHTN-10-000055",
        "cci": "CCI-002314",
        "nist": [
          "AC-17 (1)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000055\" do\n  title \"The Photon operating system must configure sshd with a specific\nListenAddress.\"\n  desc  \"Without specifying a ListenAddress, sshd will listen on all\ninterfaces. In situations with multiple interfaces this may not be intended\nbehavior and could lead to offering remote access on an unapproved network.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000297-GPOS-00115\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000055\"\n  tag stig_id: \"PHTN-10-000055\"\n  tag cci: \"CCI-002314\"\n  tag nist: [\"AC-17 (1)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# sshd -T|&grep -i ListenAddress\n\nIf the ListenAddress is not configured to the VCSA management IP, this is a\nfinding.\"\n  desc 'fix', \"Open /etc/ssh/sshd_config with a text editor and ensure that the\n\\\"ListenAddress\\\" line is uncommented and set to a valid local IP:\n\nExample:\n\nListenAddress 169.254.1.2\n\nReplace '169.254.1.2' with the management address of the VCSA.\n\nAt the command line, execute the following command:\n\n# service sshd reload\"\n\n  photonIp = command(\"ip -br addr show eth0 |&awk '{print $3}' |&cut -d'/' -f1\").stdout.strip\n  describe command(\"sshd -T|&grep -i ListenAddress|&awk '{print $2}' |&cut -d':' -f1\") do\n    its ('stdout.strip') { should match /#{photonIp}/ }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000055.rb",
        "line": 1
      },
      "id": "PHTN-10-000055"
    },
    {
      "title": "The Photon operating system must audit all account disabling actions.",
      "desc": "When operating system accounts are disabled, user accessibility is\naffected. Accounts are utilized for identifying individual users or for\nidentifying the operating system processes themselves. In order to detect and\nrespond to events affecting user accessibility and system processing, operating\nsystems must audit account disabling actions.",
      "descriptions": {
        "default": "When operating system accounts are disabled, user accessibility is\naffected. Accounts are utilized for identifying individual users or for\nidentifying the operating system processes themselves. In order to detect and\nrespond to events affecting user accessibility and system processing, operating\nsystems must audit account disabling actions.",
        "check": "At the command line, execute the following command:\n\n# auditctl -l | grep watch=/usr/bin/passwd\n\nExpected result:\n\n-w /usr/bin/passwd -p x -k passwd\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "At the command line, execute the following commands:\n\n# echo '-w /usr/bin/passwd -p x -k passwd' >>\n/etc/audit/rules.d/audit.STIG.rules\n# /sbin/augenrules --load"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000240-GPOS-00090",
        "gid": null,
        "rid": "PHTN-10-00004",
        "stig_id": "PHTN-10-000046",
        "cci": "CCI-001404",
        "nist": [
          "AC-2 (4)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000046\" do\n  title \"The Photon operating system must audit all account disabling actions.\"\n  desc  \"When operating system accounts are disabled, user accessibility is\naffected. Accounts are utilized for identifying individual users or for\nidentifying the operating system processes themselves. In order to detect and\nrespond to events affecting user accessibility and system processing, operating\nsystems must audit account disabling actions.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000240-GPOS-00090\"\n  tag gid: nil\n  tag rid: \"PHTN-10-00004\"\n  tag stig_id: \"PHTN-10-000046\"\n  tag cci: \"CCI-001404\"\n  tag nist: [\"AC-2 (4)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# auditctl -l | grep watch=/usr/bin/passwd\n\nExpected result:\n\n-w /usr/bin/passwd -p x -k passwd\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following commands:\n\n# echo '-w /usr/bin/passwd -p x -k passwd' >>\n/etc/audit/rules.d/audit.STIG.rules\n# /sbin/augenrules --load\"\n\n  describe auditd do\n    its(\"lines\") { should include %r{-w /usr/bin/passwd -p x -k passwd} }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000046.rb",
        "line": 1
      },
      "id": "PHTN-10-000046"
    },
    {
      "title": "The Photon operating system must configure a cron job to rotate auditd\nlogs daily.",
      "desc": "Audit logs are most useful when accessible by date, rather than size.\nThis can be acomplished through a combination of an audit log rotation cron\njob, setting a reasonable number of logs to keep and configuring auditd to not\nrotate the logs on it's own. This ensures that audit logs are accessible to the\nISSO in the event of a central log processing failure.",
      "descriptions": {
        "default": "Audit logs are most useful when accessible by date, rather than size.\nThis can be acomplished through a combination of an audit log rotation cron\njob, setting a reasonable number of logs to keep and configuring auditd to not\nrotate the logs on it's own. This ensures that audit logs are accessible to the\nISSO in the event of a central log processing failure.",
        "check": "At the command line, execute the following command:\n\n# cat /etc/cron.daily/audit-rotate\n\nExpected result:\n\n#!/bin/bash\nservice auditd rotate\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "If /etc/cron.daily/audit-rotate does not exist, run the following\ncommands:\n\n# touch /etc/cron.daily/audit-rotate\n# chown root:root /etc/cron.daily/audit-rotate\n# chmod 0700 /etc/cron.daily/audit-rotate\n\nOpen /etc/cron.daily/audit-rotate with a text editor. Set it's contents as\nfollows:\n\n#!/bin/bash\nservice auditd rotate"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000341-GPOS-00132",
        "gid": null,
        "rid": "PHTN-10-000059",
        "stig_id": "PHTN-10-000059",
        "cci": "CCI-001849",
        "nist": [
          "AU-4",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000059\" do\n  title \"The Photon operating system must configure a cron job to rotate auditd\nlogs daily.\"\n  desc  \"Audit logs are most useful when accessible by date, rather than size.\nThis can be acomplished through a combination of an audit log rotation cron\njob, setting a reasonable number of logs to keep and configuring auditd to not\nrotate the logs on it's own. This ensures that audit logs are accessible to the\nISSO in the event of a central log processing failure.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000341-GPOS-00132\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000059\"\n  tag stig_id: \"PHTN-10-000059\"\n  tag cci: \"CCI-001849\"\n  tag nist: [\"AU-4\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# cat /etc/cron.daily/audit-rotate\n\nExpected result:\n\n#!/bin/bash\nservice auditd rotate\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"If /etc/cron.daily/audit-rotate does not exist, run the following\ncommands:\n\n# touch /etc/cron.daily/audit-rotate\n# chown root:root /etc/cron.daily/audit-rotate\n# chmod 0700 /etc/cron.daily/audit-rotate\n\nOpen /etc/cron.daily/audit-rotate with a text editor. Set it's contents as\nfollows:\n\n#!/bin/bash\nservice auditd rotate\n\"\n\n  describe file('/etc/cron.daily/audit-rotate') do\n    it { should exist }\n    its('content') { should match %r{#!/bin/bash} }\n    its('content') { should match %r{service auditd rotate} }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000059.rb",
        "line": 1
      },
      "id": "PHTN-10-000059"
    },
    {
      "title": "The Photon operating system must be configured so that all files have\na valid owner and group owner.",
      "desc": "If files do not have valid user and group owners then unintended\naccess to files could occur.",
      "descriptions": {
        "default": "If files do not have valid user and group owners then unintended\naccess to files could occur.",
        "check": "At the command line, execute the following command:\n\n# find / -fstype ext4 -nouser -o -nogroup -exec ls -ld {} \\;\n\nIf any files are returned, this is a finding.",
        "fix": "At the command line, execute the following commands for each\nreturned file:\n\n# chown root:root <file>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000100",
        "stig_id": "PHTN-10-000100",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000100\" do\n  title \"The Photon operating system must be configured so that all files have\na valid owner and group owner.\"\n  desc  \"If files do not have valid user and group owners then unintended\naccess to files could occur.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000100\"\n  tag stig_id: \"PHTN-10-000100\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# find / -fstype ext4 -nouser -o -nogroup -exec ls -ld {} \\\\;\n\nIf any files are returned, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following commands for each\nreturned file:\n\n# chown root:root <file>\"\n\n  describe command('find / -fstype ext4 -nouser -o -nogroup -exec ls -ld {} \\;') do\n      its ('stdout') { should eq '' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000100.rb",
        "line": 1
      },
      "id": "PHTN-10-000100"
    },
    {
      "title": "The Photon operating system must audit the execution of privileged\nfunctions.",
      "desc": "Misuse of privileged functions, either intentionally or\nunintentionally by authorized users, or by unauthorized external entities that\nhave compromised information system accounts, is a serious and ongoing concern\nand can have significant adverse impacts on organizations. Auditing the use of\nprivileged functions is one way to detect such misuse and identify the risk\nfrom insider threats and the advanced persistent threat.",
      "descriptions": {
        "default": "Misuse of privileged functions, either intentionally or\nunintentionally by authorized users, or by unauthorized external entities that\nhave compromised information system accounts, is a serious and ongoing concern\nand can have significant adverse impacts on organizations. Auditing the use of\nprivileged functions is one way to detect such misuse and identify the risk\nfrom insider threats and the advanced persistent threat.",
        "check": "At the command line, execute the following command to see a list\nof setuid files:\n\n# find / -xdev -perm -4000 -type f -o -perm -2000 -type f\n\nThen, execute the following command for each setuid file found in the first\ncommand:\n\n# grep <setuid_path> /etc/audit/audit.rules\n\nReplace <setuid_path> with each path found in the first command.\n\nIf each <setuid_path> does not have a corresponding line in the audit rules,\nthis is a finding.\n\nA typical corresponding line will look like the below:\n\n-a always,exit -F path=<setuid_path> -F perm=x -F auid>=1000 -F\nauid!=4294967295 -k privileged",
        "fix": "At the command line, execute the following command to see a list of\nsetuid files:\n\n# find / -xdev -perm -4000 -type f -o -perm -2000 -type f\n\nThen, execute the following command for each setuid file found in the first\ncommand that does not have a corresponding line in the audit rules:\n\n# echo '-a always,exit -F path=<setuid_path> -F perm=x -F auid>=1000 -F\nauid!=4294967295 -k privileged' >> /etc/audit/rules.d/audit.STIG.rules\n\nReplace <setuid_path> with each path found in the first command.\n\nFinally, execute the following command to load the new rules.\n\n# /sbin/augenrules --load"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000327-GPOS-00127",
        "gid": null,
        "rid": "PHTN-10-000056",
        "stig_id": "PHTN-10-000056",
        "cci": "CCI-002234",
        "nist": [
          "AC-6 (9)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000056\" do\n  title \"The Photon operating system must audit the execution of privileged\nfunctions.\"\n  desc  \"Misuse of privileged functions, either intentionally or\nunintentionally by authorized users, or by unauthorized external entities that\nhave compromised information system accounts, is a serious and ongoing concern\nand can have significant adverse impacts on organizations. Auditing the use of\nprivileged functions is one way to detect such misuse and identify the risk\nfrom insider threats and the advanced persistent threat.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000327-GPOS-00127\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000056\"\n  tag stig_id: \"PHTN-10-000056\"\n  tag cci: \"CCI-002234\"\n  tag nist: [\"AC-6 (9)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command to see a list\nof setuid files:\n\n# find / -xdev -perm -4000 -type f -o -perm -2000 -type f\n\nThen, execute the following command for each setuid file found in the first\ncommand:\n\n# grep <setuid_path> /etc/audit/audit.rules\n\nReplace <setuid_path> with each path found in the first command.\n\nIf each <setuid_path> does not have a corresponding line in the audit rules,\nthis is a finding.\n\nA typical corresponding line will look like the below:\n\n-a always,exit -F path=<setuid_path> -F perm=x -F auid>=1000 -F\nauid!=4294967295 -k privileged\n\"\n  desc 'fix', \"At the command line, execute the following command to see a list of\nsetuid files:\n\n# find / -xdev -perm -4000 -type f -o -perm -2000 -type f\n\nThen, execute the following command for each setuid file found in the first\ncommand that does not have a corresponding line in the audit rules:\n\n# echo '-a always,exit -F path=<setuid_path> -F perm=x -F auid>=1000 -F\nauid!=4294967295 -k privileged' >> /etc/audit/rules.d/audit.STIG.rules\n\nReplace <setuid_path> with each path found in the first command.\n\nFinally, execute the following command to load the new rules.\n\n# /sbin/augenrules --load\"\n\n  results = command('find / -xdev -perm -4000 -type f -o -perm -2000 -type f').stdout.split(\"\\n\")\n  \n  results.each do | path |\n    describe.one do\n      describe command(\"grep #{path} /etc/audit/audit.rules\") do\n        its ('stdout.strip') {should match (\"-a always,exit -F path=#{path} -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\")}\n      end\n      describe command(\"grep #{path} /etc/audit/audit.rules\") do\n        its ('stdout.strip') {should match (\"-a exit,always -F path=#{path} -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\")}\n      end\n    end\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000056.rb",
        "line": 1
      },
      "id": "PHTN-10-000056"
    },
    {
      "title": "The Photon operating system audit log must have correct permissions.",
      "desc": "Audit information includes all information (e.g., audit records, audit\nsettings, audit reports) needed to successfully audit operating system activity.\n\n    Unauthorized disclosure of audit records can reveal system and\nconfiguration data to attackers, thus compromising its confidentiality.",
      "descriptions": {
        "default": "Audit information includes all information (e.g., audit records, audit\nsettings, audit reports) needed to successfully audit operating system activity.\n\n    Unauthorized disclosure of audit records can reveal system and\nconfiguration data to attackers, thus compromising its confidentiality.",
        "check": "At the command line, execute the following command:\n\n# (audit_log_file=$(grep \"^log_file\" /etc/audit/auditd.conf|sed s/^[^\\/]*//)\n&& if [ -f \"${audit_log_file}\" ] ; then printf \"Log(s) found in\n\"${audit_log_file%/*}\":\"; stat -c \"%n permissions are %a\" ${audit_log_file%}*; else printf \"audit\nlog file(s) not found\"; fi)\n\nIf the permissions on any audit log file is more permissive than 0600, this is\na finding.",
        "fix": "At the command line, execute the following command:\n\n#  chmod 0600 <audit log file>\n\nReplace <audit log file> with the log files more permissive than 0600."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000057-GPOS-00027",
        "gid": null,
        "rid": "PHTN-10-000015",
        "stig_id": "PHTN-10-000015",
        "cci": "CCI-000162",
        "nist": [
          "AU-9",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000015\" do\n  title \"The Photon operating system audit log must have correct permissions.\"\n  desc  \"Audit information includes all information (e.g., audit records, audit\nsettings, audit reports) needed to successfully audit operating system activity.\n\n    Unauthorized disclosure of audit records can reveal system and\nconfiguration data to attackers, thus compromising its confidentiality.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000057-GPOS-00027\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000015\"\n  tag stig_id: \"PHTN-10-000015\"\n  tag cci: \"CCI-000162\"\n  tag nist: [\"AU-9\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# (audit_log_file=$(grep \\\"^log_file\\\" /etc/audit/auditd.conf|sed s/^[^\\\\/]*//)\n&& if [ -f \\\"${audit_log_file}\\\" ] ; then printf \\\"Log(s) found in\n\\\"${audit_log_file%/*}\\\":\\\n\\\"; stat -c \\\"%n permissions are %a\\\" ${audit_log_file%}*; else printf \\\"audit\nlog file(s) not found\\\n\\\"; fi)\n\nIf the permissions on any audit log file is more permissive than 0600, this is\na finding.\n\"\n  desc 'fix', \"At the command line, execute the following command:\n\n#  chmod 0600 <audit log file>\n\nReplace <audit log file> with the log files more permissive than 0600.\"\n\n  command('find /var/log/audit/ -maxdepth 1 -name \"audit*.*\"').stdout.split.each do | fname |\n    describe file(fname) do\n      it { should_not be_more_permissive_than('0600') }\n    end\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000015.rb",
        "line": 1
      },
      "id": "PHTN-10-000015"
    },
    {
      "title": "The Photon operating system must generate audit records when the sudo\ncommand is used.",
      "desc": "Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).",
      "descriptions": {
        "default": "Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).",
        "check": "At the command line, execute the following command:\n\n# auditctl -l | grep sudo\n\nExpected result:\n-a always,exit -F path=/usr/bin/sudo -F perm=x -F auid>=1000 -F\nauid!=4294967295 -k privileged\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "At the command line, execute the following commands:\n\n# echo '-a always,exit -F path=/usr/bin/sudo -F perm=x -F auid>=1000 -F\nauid!=4294967295 -k privileged' >> /etc/audit/rules.d/audit.STIG.rules\n# /sbin/augenrules --load"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000458-GPOS-00203",
        "gid": null,
        "rid": "PHTN-10-000071",
        "stig_id": "PHTN-10-000071",
        "cci": "CCI-000172",
        "nist": [
          "AU-12 c",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000071\" do\n  title \"The Photon operating system must generate audit records when the sudo\ncommand is used.\"\n  desc  \"Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000458-GPOS-00203\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000071\"\n  tag stig_id: \"PHTN-10-000071\"\n  tag cci: \"CCI-000172\"\n  tag nist: [\"AU-12 c\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# auditctl -l | grep sudo\n\nExpected result:\n-a always,exit -F path=/usr/bin/sudo -F perm=x -F auid>=1000 -F\nauid!=4294967295 -k privileged\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following commands:\n\n# echo '-a always,exit -F path=/usr/bin/sudo -F perm=x -F auid>=1000 -F\nauid!=4294967295 -k privileged' >> /etc/audit/rules.d/audit.STIG.rules\n# /sbin/augenrules --load\"\n\n  describe auditd do\n    its(\"lines\") { should include %r{-a always,exit -S all -F path=/usr/bin/sudo -F perm=x -F auid>=1000 -F auid!=-1} }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000071.rb",
        "line": 1
      },
      "id": "PHTN-10-000071"
    },
    {
      "title": "The Photon operating system must allow only the ISSM (or individuals\nor roles appointed by the ISSM) to select which auditable events are to be\naudited.",
      "desc": "Without the capability to restrict which roles and individuals can\nselect which events are audited, unauthorized personnel may be able to prevent\nthe auditing of critical events. Misconfigured audits may degrade the system's\nperformance by overwhelming the audit log. Misconfigured audits may also make\nit more difficult to establish, correlate, and investigate the events relating\nto an incident or identify those responsible for one.",
      "descriptions": {
        "default": "Without the capability to restrict which roles and individuals can\nselect which events are audited, unauthorized personnel may be able to prevent\nthe auditing of critical events. Misconfigured audits may degrade the system's\nperformance by overwhelming the audit log. Misconfigured audits may also make\nit more difficult to establish, correlate, and investigate the events relating\nto an incident or identify those responsible for one.",
        "check": "At the command line, execute the following command:\n\n# find /etc/audit/* -type f -exec stat -c \"%n permissions are %a\" {} $1\\;\n\nIf the permissions of any files are more permissive than 640, then this is a\nfinding.",
        "fix": "At the command line, execute the following command:\n\n# chmod 640 <file>\n\nReplace <file> with any file with incorrect permissions."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000063-GPOS-00032",
        "gid": null,
        "rid": "PHTN-10-000019",
        "stig_id": "PHTN-10-000019",
        "cci": "CCI-000171",
        "nist": [
          "AU-12 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000019\" do\n  title \"The Photon operating system must allow only the ISSM (or individuals\nor roles appointed by the ISSM) to select which auditable events are to be\naudited.\"\n  desc  \"Without the capability to restrict which roles and individuals can\nselect which events are audited, unauthorized personnel may be able to prevent\nthe auditing of critical events. Misconfigured audits may degrade the system's\nperformance by overwhelming the audit log. Misconfigured audits may also make\nit more difficult to establish, correlate, and investigate the events relating\nto an incident or identify those responsible for one.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000063-GPOS-00032\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000019\"\n  tag stig_id: \"PHTN-10-000019\"\n  tag cci: \"CCI-000171\"\n  tag nist: [\"AU-12 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# find /etc/audit/* -type f -exec stat -c \\\"%n permissions are %a\\\" {} $1\\\\;\n\nIf the permissions of any files are more permissive than 640, then this is a\nfinding.\"\n  desc 'fix', \"At the command line, execute the following command:\n\n# chmod 640 <file>\n\nReplace <file> with any file with incorrect permissions.\"\n\n  command(' find /etc/audit/* -maxdepth 1 -type f').stdout.split.each do | fname |\n    describe file(fname) do\n      it { should_not be_more_permissive_than('0640') }\n    end\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000019.rb",
        "line": 1
      },
      "id": "PHTN-10-000019"
    },
    {
      "title": "The Photon operating system must not perform multicast packet\nforwarding.",
      "desc": "Routing protocol daemons are typically used on routers to exchange\nnetwork topology information with other routers. If this software is used when\nnot required, system network information may be unnecessarily transmitted\nacross the network.",
      "descriptions": {
        "default": "Routing protocol daemons are typically used on routers to exchange\nnetwork topology information with other routers. If this software is used when\nnot required, system network information may be unnecessarily transmitted\nacross the network.",
        "check": "At the command line, execute the following command:\n\n# /sbin/sysctl -a --pattern\n\"net.ipv[4|6].conf.(all|default|eth.*).mc_forwarding\"\n\nExpected result:\n\nnet.ipv4.conf.all.mc_forwarding = 0\nnet.ipv4.conf.default.mc_forwarding = 0\nnet.ipv4.conf.eth0.mc_forwarding = 0\nnet.ipv6.conf.all.mc_forwarding = 0\nnet.ipv6.conf.default.mc_forwarding = 0\nnet.ipv6.conf.eth0.mc_forwarding = 0\n\n\nIf the output does not match the expected result, this is a finding.\n\nNote: The number of ethx lines returned is dependant on the number of\ninterfaces. Every ethx entry must be set to 0.",
        "fix": "At the command line, execute the following command:\n\n# for SETTING in $(/sbin/sysctl -aN --pattern\n\"net.ipv[4|6].conf.(all|default|eth.*).mc_forwarding\"); do sed -i -e\n\"/^${SETTING}/d\" /etc/sysctl.conf;echo $SETTING=0>>/etc/sysctl.conf; done"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000111",
        "stig_id": "PHTN-10-000111",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000111\" do\n  title \"The Photon operating system must not perform multicast packet\nforwarding.\"\n  desc  \"Routing protocol daemons are typically used on routers to exchange\nnetwork topology information with other routers. If this software is used when\nnot required, system network information may be unnecessarily transmitted\nacross the network.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000111\"\n  tag stig_id: \"PHTN-10-000111\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# /sbin/sysctl -a --pattern\n\\\"net.ipv[4|6].conf.(all|default|eth.*).mc_forwarding\\\"\n\nExpected result:\n\nnet.ipv4.conf.all.mc_forwarding = 0\nnet.ipv4.conf.default.mc_forwarding = 0\nnet.ipv4.conf.eth0.mc_forwarding = 0\nnet.ipv6.conf.all.mc_forwarding = 0\nnet.ipv6.conf.default.mc_forwarding = 0\nnet.ipv6.conf.eth0.mc_forwarding = 0\n\n\nIf the output does not match the expected result, this is a finding.\n\nNote: The number of ethx lines returned is dependant on the number of\ninterfaces. Every ethx entry must be set to 0.\"\n  desc 'fix', \"At the command line, execute the following command:\n\n# for SETTING in $(/sbin/sysctl -aN --pattern\n\\\"net.ipv[4|6].conf.(all|default|eth.*).mc_forwarding\\\"); do sed -i -e\n\\\"/^${SETTING}/d\\\" /etc/sysctl.conf;echo $SETTING=0>>/etc/sysctl.conf; done\"\n\n  describe kernel_parameter('net.ipv4.conf.all.mc_forwarding') do\n    its('value') { should eq 0 }\n  end\n\n  describe kernel_parameter('net.ipv4.conf.default.mc_forwarding') do\n    its('value') { should eq 0 }\n  end\n\n  describe kernel_parameter('net.ipv4.conf.eth0.mc_forwarding') do\n    its('value') { should eq 0 }\n  end\n\n  describe kernel_parameter('net.ipv6.conf.all.mc_forwarding') do\n    its('value') { should eq 0 }\n  end\n\n  describe kernel_parameter('net.ipv6.conf.default.mc_forwarding') do\n    its('value') { should eq 0 }\n  end\n\n  describe kernel_parameter('net.ipv6.conf.eth0.mc_forwarding') do\n    its('value') { should eq 0 }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000111.rb",
        "line": 1
      },
      "id": "PHTN-10-000111"
    },
    {
      "title": "The Photon operating system must configure auditd to keep five rotated\nlog files.",
      "desc": "Audit logs are most useful when accessible by date, rather than size.\nThis can be acomplished through a combination of an audit log rotation cron\njob, setting a reasonable number of logs to keep and configuring auditd to not\nrotate the logs on it's own. This ensures that audit logs are accessible to the\nISSO in the event of a central log processing failure.",
      "descriptions": {
        "default": "Audit logs are most useful when accessible by date, rather than size.\nThis can be acomplished through a combination of an audit log rotation cron\njob, setting a reasonable number of logs to keep and configuring auditd to not\nrotate the logs on it's own. This ensures that audit logs are accessible to the\nISSO in the event of a central log processing failure.",
        "check": "At the command line, execute the following command:\n\n# grep \"^max_log_file_action\" /etc/audit/auditd.conf\n\nExpected result:\n\nmax_log_file_action = IGNORE\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Open /etc/audit/auditd.conf with a text editor. Add or change the\n\"max_log_file_action\" line as follows:\n\nmax_log_file_action = IGNORE\n\nAt the command line, execute the following command:\n\n# service auditd reload"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000341-GPOS-00132",
        "gid": null,
        "rid": "PHTN-10-000058",
        "stig_id": "PHTN-10-000058",
        "cci": "CCI-001849",
        "nist": [
          "AU-4",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000058\" do\n  title \"The Photon operating system must configure auditd to keep five rotated\nlog files.\"\n  desc  \"Audit logs are most useful when accessible by date, rather than size.\nThis can be acomplished through a combination of an audit log rotation cron\njob, setting a reasonable number of logs to keep and configuring auditd to not\nrotate the logs on it's own. This ensures that audit logs are accessible to the\nISSO in the event of a central log processing failure.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000341-GPOS-00132\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000058\"\n  tag stig_id: \"PHTN-10-000058\"\n  tag cci: \"CCI-001849\"\n  tag nist: [\"AU-4\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep \\\"^max_log_file_action\\\" /etc/audit/auditd.conf\n\nExpected result:\n\nmax_log_file_action = IGNORE\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Open /etc/audit/auditd.conf with a text editor. Add or change the\n\\\"max_log_file_action\\\" line as follows:\n\nmax_log_file_action = IGNORE\n\nAt the command line, execute the following command:\n\n# service auditd reload\"\n\n  describe auditd_conf do\n    its(\"max_log_file_action\") { should cmp 'IGNORE'}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000058.rb",
        "line": 1
      },
      "id": "PHTN-10-000058"
    },
    {
      "title": "The Photon operating system must not perform IPv4 packet forwarding.",
      "desc": "Routing protocol daemons are typically used on routers to exchange\nnetwork topology information with other routers. If this software is used when\nnot required, system network information may be unnecessarily transmitted\nacross the network.",
      "descriptions": {
        "default": "Routing protocol daemons are typically used on routers to exchange\nnetwork topology information with other routers. If this software is used when\nnot required, system network information may be unnecessarily transmitted\nacross the network.",
        "check": "At the command line, execute the following command:\n\n# /sbin/sysctl -a --pattern \"net.ipv4.ip_forward$\"\n\nExpected result:\n\nnet.ipv4.ip_forward = 0\n\nIf the system is intended to operate as a router, this is N/A.\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "At the command line, execute the following commands:\n\n# sed -i -e \"/^net.ipv4.ip_forward/d\" /etc/sysctl.conf\n# echo net.ipv4.ip_forward=0>>/etc/sysctl.conf"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000112",
        "stig_id": "PHTN-10-000112",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000112\" do\n  title \"The Photon operating system must not perform IPv4 packet forwarding.\"\n  desc  \"Routing protocol daemons are typically used on routers to exchange\nnetwork topology information with other routers. If this software is used when\nnot required, system network information may be unnecessarily transmitted\nacross the network.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000112\"\n  tag stig_id: \"PHTN-10-000112\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# /sbin/sysctl -a --pattern \\\"net.ipv4.ip_forward$\\\"\n\nExpected result:\n\nnet.ipv4.ip_forward = 0\n\nIf the system is intended to operate as a router, this is N/A.\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following commands:\n\n# sed -i -e \\\"/^net.ipv4.ip_forward/d\\\" /etc/sysctl.conf\n# echo net.ipv4.ip_forward=0>>/etc/sysctl.conf\"\n\n  describe kernel_parameter('net.ipv4.ip_forward') do\n    its('value') { should eq 0 }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000112.rb",
        "line": 1
      },
      "id": "PHTN-10-000112"
    },
    {
      "title": "The Photon operating system must initiate auditing as part of the boot\nprocess.",
      "desc": "Each process on the system carries an \"auditable\" flag which\nindicates whether its activities can be audited. Although auditd takes care of\nenabling this for all processes that launch after it starts, adding the kernel\nargument ensures the flag is set at boot for every process on the system. This\nincludes processes created before auditd starts.",
      "descriptions": {
        "default": "Each process on the system carries an \"auditable\" flag which\nindicates whether its activities can be audited. Although auditd takes care of\nenabling this for all processes that launch after it starts, adding the kernel\nargument ensures the flag is set at boot for every process on the system. This\nincludes processes created before auditd starts.",
        "check": "At the command line, execute the following command:\n\n# grep \"audit=1\" /proc/cmdline\n\nIf no results are returned, this is a finding.",
        "fix": "Open /boot/grub2/grub.cfg with a text editor and locate the boot command line arguments. An example is below:\n\nlinux \"/\"$photon_linux root=$rootpartition net.ifnames=0 $photon_cmdline\ncoredump_filter=0x37 consoleblank=0\n\nAdd \"audit=1\" to the end of the line so it reads as follows:\n\nlinux \"/\"$photon_linux root=$rootpartition net.ifnames=0 $photon_cmdline\ncoredump_filter=0x37 consoleblank=0 audit=1\n\nNote: Do not copy/paste in this example argument line. This may change in future releases. Find the similar line and append \"audit=1\" to it.\n\nReboot the system for the change to take effect."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000254-GPOS-00095",
        "gid": null,
        "rid": "PHTN-10-000048",
        "stig_id": "PHTN-10-000048",
        "cci": "CCI-001464",
        "nist": [
          "AU-14 (1)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000048\" do\n  title \"The Photon operating system must initiate auditing as part of the boot\nprocess.\"\n  desc  \"Each process on the system carries an \\\"auditable\\\" flag which\nindicates whether its activities can be audited. Although auditd takes care of\nenabling this for all processes that launch after it starts, adding the kernel\nargument ensures the flag is set at boot for every process on the system. This\nincludes processes created before auditd starts. \"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000254-GPOS-00095\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000048\"\n  tag stig_id: \"PHTN-10-000048\"\n  tag cci: \"CCI-001464\"\n  tag nist: [\"AU-14 (1)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep \\\"audit=1\\\" /proc/cmdline\n\nIf no results are returned, this is a finding.\"\n  desc 'fix', \"Open /boot/grub2/grub.cfg with a text editor and locate the boot command line arguments. An example is below:\n\nlinux \\\"/\\\"$photon_linux root=$rootpartition net.ifnames=0 $photon_cmdline\ncoredump_filter=0x37 consoleblank=0\n\nAdd \\\"audit=1\\\" to the end of the line so it reads as follows:\n\nlinux \\\"/\\\"$photon_linux root=$rootpartition net.ifnames=0 $photon_cmdline\ncoredump_filter=0x37 consoleblank=0 audit=1\n\nNote: Do not copy/paste in this example argument line. This may change in future releases. Find the similar line and append \\\"audit=1\\\" to it.\n\nReboot the system for the change to take effect.\"\n\n  describe file ('/boot/grub2/grub.cfg') do\n      its ('content'){should match /^(?=.*?\\blinux\\b)(?=.*?\\bphoton_linux\\b)(?=.*?\\bconsoleblank\\b)(?=.*?\\baudit=1\\b).*$/}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000048.rb",
        "line": 1
      },
      "id": "PHTN-10-000048"
    },
    {
      "title": "The Photon operating system must configure sshd to disable environment\nprocessing.",
      "desc": "Enabling environment processing may enable users to bypass access\nrestrictions in some configurations and must therefore be disabled.",
      "descriptions": {
        "default": "Enabling environment processing may enable users to bypass access\nrestrictions in some configurations and must therefore be disabled.",
        "check": "At the command line, execute the following command:\n\nsshd -T|&grep -i PermitUserEnvironment\n\nExpected result:\n\nPermitUserEnvironment no\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/ssh/sshd_config with a text editor and ensure that the\n\"PermitUserEnvironment\" line is uncommented and set to the following:\n\nPermitUserEnvironment no\n\nAt the command line, execute the following command:\n\n# service sshd reload"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000084",
        "stig_id": "PHTN-10-000084",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000084\" do\n  title \"The Photon operating system must configure sshd to disable environment\nprocessing.\"\n  desc  \"Enabling environment processing may enable users to bypass access\nrestrictions in some configurations and must therefore be disabled.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000084\"\n  tag stig_id: \"PHTN-10-000084\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\nsshd -T|&grep -i PermitUserEnvironment\n\nExpected result:\n\nPermitUserEnvironment no\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/ssh/sshd_config with a text editor and ensure that the\n\\\"PermitUserEnvironment\\\" line is uncommented and set to the following:\n\nPermitUserEnvironment no\n\nAt the command line, execute the following command:\n\n# service sshd reload\"\n\n  describe command('sshd -T|&grep -i PermitUserEnvironment') do\n    its ('stdout.strip') { should cmp 'PermitUserEnvironment no' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000084.rb",
        "line": 1
      },
      "id": "PHTN-10-000084"
    },
    {
      "title": "The Photon OS must not have the xinetd service enabled.",
      "desc": "The xinetd service is not required for normal appliance operation and\nmust be disabled.",
      "descriptions": {
        "default": "The xinetd service is not required for normal appliance operation and\nmust be disabled.",
        "check": "At the command line, execute the following command:\n\n# systemctl is-enabled xinetd.service\n\nExpected result:\n\ndisabled\n\nIf the output does not match the expected result, this is a finding",
        "fix": "At the command line, execute the following commands:\n\n# service xinetd stop\n# systemctl disable xinetd.service"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000114",
        "stig_id": "PHTN-10-000114",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000114\" do\n  title \"The Photon OS must not have the xinetd service enabled.\"\n  desc  \"The xinetd service is not required for normal appliance operation and\nmust be disabled.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000114\"\n  tag stig_id: \"PHTN-10-000114\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# systemctl is-enabled xinetd.service\n\nExpected result:\n\ndisabled\n\nIf the output does not match the expected result, this is a finding\"\n  desc 'fix', \"At the command line, execute the following commands:\n\n# service xinetd stop\n# systemctl disable xinetd.service\"\n\n  describe systemd_service('xinetd.service') do\n    it { should_not be_enabled}\n    it { should_not be_running}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000114.rb",
        "line": 1
      },
      "id": "PHTN-10-000114"
    },
    {
      "title": "The Photon operating system RPM package management tool must\ncryptographically verify the authenticity of all software packages during\ninstallation.",
      "desc": "Installation of any non-trusted software, patches, service packs,\ndevice drivers or operating system components can significantly affect the\noverall security of the operating system. This requirement ensures the software\nhas not been tampered and has been provided by a trusted vendor.",
      "descriptions": {
        "default": "Installation of any non-trusted software, patches, service packs,\ndevice drivers or operating system components can significantly affect the\noverall security of the operating system. This requirement ensures the software\nhas not been tampered and has been provided by a trusted vendor.",
        "check": "At the command line, execute the following command:\n\n# grep \"^gpgcheck\" /etc/tdnf/tdnf.conf\n\nIf \"gpgcheck\" is not set to \"1\", this is a finding.",
        "fix": "Open /etc/tdnf/tdnf.conf with a text editor. Remove any existing\ngpgcheck setting and add the following line:\n\ngpgcheck=1"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000366-GPOS-00153",
        "gid": null,
        "rid": "PHTN-10-000063",
        "stig_id": "PHTN-10-000063",
        "cci": "CCI-001749",
        "nist": [
          "CM-5 (3)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000063\" do\n  title \"The Photon operating system RPM package management tool must\ncryptographically verify the authenticity of all software packages during\ninstallation.\"\n  desc  \"Installation of any non-trusted software, patches, service packs,\ndevice drivers or operating system components can significantly affect the\noverall security of the operating system. This requirement ensures the software\nhas not been tampered and has been provided by a trusted vendor. \"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000366-GPOS-00153\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000063\"\n  tag stig_id: \"PHTN-10-000063\"\n  tag cci: \"CCI-001749\"\n  tag nist: [\"CM-5 (3)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep \\\"^gpgcheck\\\" /etc/tdnf/tdnf.conf\n\nIf \\\"gpgcheck\\\" is not set to \\\"1\\\", this is a finding.\"\n  desc 'fix', \"Open /etc/tdnf/tdnf.conf with a text editor. Remove any existing\ngpgcheck setting and add the following line:\n\ngpgcheck=1\"\n\n  describe command('grep \"^gpgcheck\" /etc/tdnf/tdnf.conf') do\n      its ('stdout.strip') { should cmp 'gpgcheck=1' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000063.rb",
        "line": 1
      },
      "id": "PHTN-10-000063"
    },
    {
      "title": "The Photon operating system must configure auditd to log space limit\nproblems to syslog.",
      "desc": "If security personnel are not notified immediately when storage volume\nreaches 75% utilization, they are unable to plan for audit record storage\ncapacity expansion.",
      "descriptions": {
        "default": "If security personnel are not notified immediately when storage volume\nreaches 75% utilization, they are unable to plan for audit record storage\ncapacity expansion.",
        "check": "At the command line, execute the following command:\n\n# grep \"^space_left \" /etc/audit/auditd.conf\n\nExpected result:\n\nspace_left = 75\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/audit/auditd.conf with a text editor and ensure that the\n\"space_left\" line is uncommented and set to the following:\n\nspace_left = 75\n\nAt the command line, execute the following command:\n\n# service auditd reload"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000343-GPOS-00134",
        "gid": null,
        "rid": "PHTN-10-000060",
        "stig_id": "PHTN-10-000060",
        "cci": "CCI-001855",
        "nist": [
          "AU-5 (1)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000060\" do\n  title \"The Photon operating system must configure auditd to log space limit\nproblems to syslog.\"\n  desc  \"If security personnel are not notified immediately when storage volume\nreaches 75% utilization, they are unable to plan for audit record storage\ncapacity expansion.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000343-GPOS-00134\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000060\"\n  tag stig_id: \"PHTN-10-000060\"\n  tag cci: \"CCI-001855\"\n  tag nist: [\"AU-5 (1)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep \\\"^space_left \\\" /etc/audit/auditd.conf\n\nExpected result:\n\nspace_left = 75\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/audit/auditd.conf with a text editor and ensure that the\n\\\"space_left\\\" line is uncommented and set to the following:\n\nspace_left = 75\n\nAt the command line, execute the following command:\n\n# service auditd reload\"\n\n  describe auditd_conf do\n    its(\"space_left\") { should cmp '75'}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000060.rb",
        "line": 1
      },
      "id": "PHTN-10-000060"
    },
    {
      "title": "The Photon operating system must configure sshd to use prefered\nciphers.",
      "desc": "Privileged access contains control and configuration information and\nis particularly sensitive, so additional protections are necessary. This is\nmaintained by using cryptographic mechanisms such as encryption to protect\nconfidentiality.\n\n    Nonlocal maintenance and diagnostic activities are those activities\nconducted by individuals communicating through a network, either an external\nnetwork (e.g., the Internet) or an internal network. Local maintenance and\ndiagnostic activities are those activities carried out by individuals\nphysically present at the information system or information system component\nand not communicating across a network connection.\n\n    This requirement applies to hardware/software diagnostic test equipment or\ntools. This requirement does not cover hardware/software components that may\nsupport information system maintenance, yet are a part of the system (e.g., the\nsoftware implementing \"ping,\" \"ls,\" \"ipconfig,\" or the hardware and\nsoftware implementing the monitoring port of an Ethernet switch).\n\n    The operating system can meet this requirement through leveraging a\ncryptographic module.",
      "descriptions": {
        "default": "Privileged access contains control and configuration information and\nis particularly sensitive, so additional protections are necessary. This is\nmaintained by using cryptographic mechanisms such as encryption to protect\nconfidentiality.\n\n    Nonlocal maintenance and diagnostic activities are those activities\nconducted by individuals communicating through a network, either an external\nnetwork (e.g., the Internet) or an internal network. Local maintenance and\ndiagnostic activities are those activities carried out by individuals\nphysically present at the information system or information system component\nand not communicating across a network connection.\n\n    This requirement applies to hardware/software diagnostic test equipment or\ntools. This requirement does not cover hardware/software components that may\nsupport information system maintenance, yet are a part of the system (e.g., the\nsoftware implementing \"ping,\" \"ls,\" \"ipconfig,\" or the hardware and\nsoftware implementing the monitoring port of an Ethernet switch).\n\n    The operating system can meet this requirement through leveraging a\ncryptographic module.",
        "check": "At the command line, execute the following command:\n\n# sshd -T|&grep -i Ciphers\n\nExpected result:\n\nciphers\naes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/ssh/sshd_config with a text editor and ensure that the\n\"Ciphers\" line is uncommented and set to the following:\n\nCiphers\naes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\n\nAt the command line, execute the following command:\n\n# service sshd reload"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000394-GPOS-00174",
        "gid": null,
        "rid": "PHTN-10-000067",
        "stig_id": "PHTN-10-000067",
        "cci": "CCI-003123",
        "nist": [
          "MA-4 (6)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000067\" do\n  title \"The Photon operating system must configure sshd to use prefered\nciphers.\"\n  desc  \"Privileged access contains control and configuration information and\nis particularly sensitive, so additional protections are necessary. This is\nmaintained by using cryptographic mechanisms such as encryption to protect\nconfidentiality.\n\n    Nonlocal maintenance and diagnostic activities are those activities\nconducted by individuals communicating through a network, either an external\nnetwork (e.g., the Internet) or an internal network. Local maintenance and\ndiagnostic activities are those activities carried out by individuals\nphysically present at the information system or information system component\nand not communicating across a network connection.\n\n    This requirement applies to hardware/software diagnostic test equipment or\ntools. This requirement does not cover hardware/software components that may\nsupport information system maintenance, yet are a part of the system (e.g., the\nsoftware implementing \\\"ping,\\\" \\\"ls,\\\" \\\"ipconfig,\\\" or the hardware and\nsoftware implementing the monitoring port of an Ethernet switch).\n\n    The operating system can meet this requirement through leveraging a\ncryptographic module.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000394-GPOS-00174\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000067\"\n  tag stig_id: \"PHTN-10-000067\"\n  tag cci: \"CCI-003123\"\n  tag nist: [\"MA-4 (6)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# sshd -T|&grep -i Ciphers\n\nExpected result:\n\nciphers\naes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\n\nIf the output does not match the expected result, this is a finding.\n\n\"\n  desc 'fix', \"Open /etc/ssh/sshd_config with a text editor and ensure that the\n\\\"Ciphers\\\" line is uncommented and set to the following:\n\nCiphers\naes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\n\nAt the command line, execute the following command:\n\n# service sshd reload\"\n\n  describe command('sshd -T|&grep -i ciphers') do\n    its ('stdout.strip') { should cmp 'ciphers aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000067.rb",
        "line": 1
      },
      "id": "PHTN-10-000067"
    },
    {
      "title": "The Photon operating system must configure sshd to disallow\nauthentication with an empty password.",
      "desc": "Blank passwords are one of the first things an attacker checks for\nwhen probing a system. Even is the user somehow has a blank password on the OS,\nsshd must not allow that user to login.",
      "descriptions": {
        "default": "Blank passwords are one of the first things an attacker checks for\nwhen probing a system. Even is the user somehow has a blank password on the OS,\nsshd must not allow that user to login.",
        "check": "At the command line, execute the following command:\n\n# sshd -T|&grep -i PermitEmptyPasswords\n\nExpected result:\n\nPermitEmptyPasswords no\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/ssh/sshd_config with a text editor and ensure that the\n\"PermitEmptyPasswords\" line is uncommented and set to the following:\n\nPermitEmptyPasswords no\n\nAt the command line, execute the following command:\n\n# service sshd reload"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000089",
        "stig_id": "PHTN-10-000089",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000089\" do\n  title \"The Photon operating system must configure sshd to disallow\nauthentication with an empty password.\"\n  desc  \"Blank passwords are one of the first things an attacker checks for\nwhen probing a system. Even is the user somehow has a blank password on the OS,\nsshd must not allow that user to login.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000089\"\n  tag stig_id: \"PHTN-10-000089\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# sshd -T|&grep -i PermitEmptyPasswords\n\nExpected result:\n\nPermitEmptyPasswords no\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/ssh/sshd_config with a text editor and ensure that the\n\\\"PermitEmptyPasswords\\\" line is uncommented and set to the following:\n\nPermitEmptyPasswords no\n\nAt the command line, execute the following command:\n\n# service sshd reload\"\n\n  describe command('sshd -T|&grep -i PermitEmptyPasswords') do\n    its ('stdout.strip') { should cmp 'PermitEmptyPasswords no' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000089.rb",
        "line": 1
      },
      "id": "PHTN-10-000089"
    },
    {
      "title": "The Photon operating system must protect all boot configuration files\nfrom unauthorized access.",
      "desc": "Boot configuration files control how the system boots including\nsingle-user mode, auditing, log levels, etc. Improper or malicious\nconfigurations can netagively affect system security and availability.",
      "descriptions": {
        "default": "Boot configuration files control how the system boots including\nsingle-user mode, auditing, log levels, etc. Improper or malicious\nconfigurations can netagively affect system security and availability.",
        "check": "At the command line, execute the following command:\n\n# find /boot/*.cfg -xdev -type f -a '(' -not -perm 600 -o -not -user root -o\n-not -group root ')' -exec ls -ld {} \\;\n\nIf any files are returned, this is a finding.",
        "fix": "At the command line, execute the following commands for each\nreturned file:\n\n# chmod 600 <file>\n# chown root:root <file>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000118",
        "stig_id": "PHTN-10-000118",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000118\" do\n  title \"The Photon operating system must protect all boot configuration files\nfrom unauthorized access.\"\n  desc  \"Boot configuration files control how the system boots including\nsingle-user mode, auditing, log levels, etc. Improper or malicious\nconfigurations can netagively affect system security and availability.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000118\"\n  tag stig_id: \"PHTN-10-000118\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# find /boot/*.cfg -xdev -type f -a '(' -not -perm 600 -o -not -user root -o\n-not -group root ')' -exec ls -ld {} \\\\;\n\nIf any files are returned, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following commands for each\nreturned file:\n\n# chmod 600 <file>\n# chown root:root <file>\"\n\n  describe command(\"find /boot/*.cfg -xdev -type f -a '(' -not -perm 600 -o -not -user root -o -not -group root ')' -exec ls -ld {} \\;\") do\n     its ('stdout') { should eq '' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000118.rb",
        "line": 1
      },
      "id": "PHTN-10-000118"
    },
    {
      "title": "The Photon operating system audit files and directories must have\ncorrect permissions.",
      "desc": "Protecting audit information also includes identifying and protecting\nthe tools used to view and manipulate log data. Therefore, protecting audit\ntools is necessary to prevent unauthorized operation on audit information.",
      "descriptions": {
        "default": "Protecting audit information also includes identifying and protecting\nthe tools used to view and manipulate log data. Therefore, protecting audit\ntools is necessary to prevent unauthorized operation on audit information.",
        "check": "At the command line, execute the following command:\n\n# stat -c \"%n is owned by %U and group owned by %G\" /etc/audit/auditd.conf\n\nIf auditd.conf is not owned by root and group owned by root, this is a finding.",
        "fix": "At the command line, execute the following command:\n\n# chown root:root /etc/audit/auditd.conf"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000256-GPOS-00097",
        "gid": null,
        "rid": "PHTN-10-00004",
        "stig_id": "PHTN-10-000049",
        "cci": "CCI-001493",
        "nist": [
          "AU-9",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000049\" do\n  title \"The Photon operating system audit files and directories must have\ncorrect permissions.\"\n  desc  \"Protecting audit information also includes identifying and protecting\nthe tools used to view and manipulate log data. Therefore, protecting audit\ntools is necessary to prevent unauthorized operation on audit information.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000256-GPOS-00097\"\n  tag gid: nil\n  tag rid: \"PHTN-10-00004\"\n  tag stig_id: \"PHTN-10-000049\"\n  tag cci: \"CCI-001493\"\n  tag nist: [\"AU-9\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# stat -c \\\"%n is owned by %U and group owned by %G\\\" /etc/audit/auditd.conf\n\nIf auditd.conf is not owned by root and group owned by root, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following command:\n\n# chown root:root /etc/audit/auditd.conf\"\n\n  describe file('/etc/audit/auditd.conf') do\n      its('owner') { should cmp 'root' }\n      its('group') { should cmp 'root' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000049.rb",
        "line": 1
      },
      "id": "PHTN-10-000049"
    },
    {
      "title": "The Photon operating system must use a reverse-path filter for IPv4\nnetwork traffic.",
      "desc": "Enabling reverse path filtering drops packets with source addresses\nthat should not have been able to be received on the interface they were\nreceived on. It should not be used on systems which are routers for complicated\nnetworks, but is helpful for end hosts and routers serving small networks.",
      "descriptions": {
        "default": "Enabling reverse path filtering drops packets with source addresses\nthat should not have been able to be received on the interface they were\nreceived on. It should not be used on systems which are routers for complicated\nnetworks, but is helpful for end hosts and routers serving small networks.",
        "check": "At the command line, execute the following command:\n\n# /sbin/sysctl -a --pattern \"net.ipv4.conf.(all|default|eth.*)\\.rp_filter\"\n\nExpected result:\n\nnet.ipv4.conf.all.rp_filter = 1\nnet.ipv4.conf.default.rp_filter = 1\nnet.ipv4.conf.eth0.rp_filter = 1\n\nIf the output does not match the expected result, this is a finding.\n\nNote: The number of ethx lines returned is dependant on the number of\ninterfaces. Every ethx entry must be set to 1.",
        "fix": "At the command line, execute the following command:\n\n# for SETTING in $(/sbin/sysctl -aN --pattern\n\"net.ipv4.conf.(all|default|eth.*)\\.rp_filter\"); do sed -i -e\n\"/^${SETTING}/d\" /etc/sysctl.conf;echo $SETTING=1>>/etc/sysctl.conf; done"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000110",
        "stig_id": "PHTN-10-000110",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000110\" do\n  title \"The Photon operating system must use a reverse-path filter for IPv4\nnetwork traffic.\"\n  desc  \"Enabling reverse path filtering drops packets with source addresses\nthat should not have been able to be received on the interface they were\nreceived on. It should not be used on systems which are routers for complicated\nnetworks, but is helpful for end hosts and routers serving small networks.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000110\"\n  tag stig_id: \"PHTN-10-000110\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# /sbin/sysctl -a --pattern \\\"net.ipv4.conf.(all|default|eth.*)\\\\.rp_filter\\\"\n\nExpected result:\n\nnet.ipv4.conf.all.rp_filter = 1\nnet.ipv4.conf.default.rp_filter = 1\nnet.ipv4.conf.eth0.rp_filter = 1\n\nIf the output does not match the expected result, this is a finding.\n\nNote: The number of ethx lines returned is dependant on the number of\ninterfaces. Every ethx entry must be set to 1.\"\n  desc 'fix', \"At the command line, execute the following command:\n\n# for SETTING in $(/sbin/sysctl -aN --pattern\n\\\"net.ipv4.conf.(all|default|eth.*)\\\\.rp_filter\\\"); do sed -i -e\n\\\"/^${SETTING}/d\\\" /etc/sysctl.conf;echo $SETTING=1>>/etc/sysctl.conf; done\"\n\n  describe kernel_parameter('net.ipv4.conf.all.rp_filter') do\n    its('value') { should eq 1 }\n  end\n\n  describe kernel_parameter('net.ipv4.conf.default.rp_filter') do\n    its('value') { should eq 1 }\n  end\n\n  describe kernel_parameter('net.ipv4.conf.eth0.rp_filter') do\n    its('value') { should eq 1 }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000110.rb",
        "line": 1
      },
      "id": "PHTN-10-000110"
    },
    {
      "title": "The Photon operating system must generate audit records when\nsuccessful/unsuccessful attempts to access privileges occur.",
      "desc": "The changing of file permissions could indicate that a user is\nattempting to gain access to information that would otherwise be disallowed.\nAuditing DAC modifications can facilitate the identification of patterns of\nabuse among both authorized and unauthorized users.",
      "descriptions": {
        "default": "The changing of file permissions could indicate that a user is\nattempting to gain access to information that would otherwise be disallowed.\nAuditing DAC modifications can facilitate the identification of patterns of\nabuse among both authorized and unauthorized users.",
        "check": "At the command line, execute the following command:\n\n# auditctl -l | grep chmod\n\nExpected result:\n\n-a always,exit -F arch=b64 -S chmod,fchmod,chown,fchown,fchownat,fchmodat -F\nauid>=1000 -F auid!=4294967295 -k perm_mod\n\n-a always,exit -F arch=b64 -S\nchmod,fchmod,chown,fchown,lchown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat\n-k perm_mod\n\n-a always,exit -F arch=b32 -S chmod,fchmod,fchown,chown,fchownat,fchmodat -F\nauid>=1000 -F auid!=4294967295 -k perm_mod\n\n-a always,exit -F arch=b32 -S\nchmod,lchown,fchmod,fchown,chown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat\n-k perm_mod\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/audit/rules.d/audit.STIG.rules with a text editor and add\nthe following lines:\n\n-a always,exit -F arch=b64 -S chmod,fchmod,chown,fchown,fchownat,fchmodat -F\nauid>=1000 -F auid!=4294967295 -k perm_mod\n-a always,exit -F arch=b64 -S\nchmod,fchmod,chown,fchown,lchown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat\n-k perm_mod\n-a always,exit -F arch=b32 -S chmod,fchmod,fchown,chown,fchownat,fchmodat -F\nauid>=1000 -F auid!=4294967295 -k perm_mod\n-a always,exit -F arch=b32 -S\nchmod,lchown,fchmod,fchown,chown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat\n-k perm_mod\n\nAt the command line, execute the following commands:\n\n#/sbin/augenrules --load"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000064-GPOS-00033",
        "gid": null,
        "rid": "PHTN-10-000020",
        "stig_id": "PHTN-10-000020",
        "cci": "CCI-000172",
        "nist": [
          "AU-12 c",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000020\" do\n  title \"The Photon operating system must generate audit records when\nsuccessful/unsuccessful attempts to access privileges occur.\"\n  desc  \"The changing of file permissions could indicate that a user is\nattempting to gain access to information that would otherwise be disallowed.\nAuditing DAC modifications can facilitate the identification of patterns of\nabuse among both authorized and unauthorized users.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000064-GPOS-00033\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000020\"\n  tag stig_id: \"PHTN-10-000020\"\n  tag cci: \"CCI-000172\"\n  tag nist: [\"AU-12 c\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# auditctl -l | grep chmod\n\nExpected result:\n\n-a always,exit -F arch=b64 -S chmod,fchmod,chown,fchown,fchownat,fchmodat -F\nauid>=1000 -F auid!=4294967295 -k perm_mod\n\n-a always,exit -F arch=b64 -S\nchmod,fchmod,chown,fchown,lchown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat\n-k perm_mod\n\n-a always,exit -F arch=b32 -S chmod,fchmod,fchown,chown,fchownat,fchmodat -F\nauid>=1000 -F auid!=4294967295 -k perm_mod\n\n-a always,exit -F arch=b32 -S\nchmod,lchown,fchmod,fchown,chown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat\n-k perm_mod\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/audit/rules.d/audit.STIG.rules with a text editor and add\nthe following lines:\n\n-a always,exit -F arch=b64 -S chmod,fchmod,chown,fchown,fchownat,fchmodat -F\nauid>=1000 -F auid!=4294967295 -k perm_mod\n-a always,exit -F arch=b64 -S\nchmod,fchmod,chown,fchown,lchown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat\n-k perm_mod\n-a always,exit -F arch=b32 -S chmod,fchmod,fchown,chown,fchownat,fchmodat -F\nauid>=1000 -F auid!=4294967295 -k perm_mod\n-a always,exit -F arch=b32 -S\nchmod,lchown,fchmod,fchown,chown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat\n-k perm_mod\n\nAt the command line, execute the following commands:\n\n#/sbin/augenrules --load\"\n\n  describe auditd do\n    its(\"lines\") { should include %r{-a always,exit -F arch=b64 -S chmod,fchmod,chown,fchown,fchownat,fchmodat -F auid>=1000 -F auid!=-1} }\n    its(\"lines\") { should include %r{-a always,exit -F arch=b64 -S chmod,fchmod,chown,fchown,lchown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat} }\n    its(\"lines\") { should include %r{-a always,exit -F arch=b32 -S chmod,fchmod,fchown,chown,fchownat,fchmodat -F auid>=1000 -F auid!=-1} }\n    its(\"lines\") { should include %r{-a always,exit -F arch=b32 -S chmod,lchown,fchmod,fchown,chown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat} }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000020.rb",
        "line": 1
      },
      "id": "PHTN-10-000020"
    },
    {
      "title": "The Photon operating system must not forward IPv4 or IPv6\nsource-routed packets.",
      "desc": "Source routing is an Internet Protocol mechanism that allows an IP\npacket to carry information, a list of addresses, that tells a router the path\nthe packet must take. There is also an option to record the hops as the route\nis traversed. The list of hops taken, the \"route record\", provides the\ndestination with a return path to the source. This allows the source (the\nsending host) to specify the route, loosely or strictly, ignoring the routing\ntables of some or all of the routers. It can allow a user to redirect network\ntraffic for malicious purposes and should therefore be disabled.",
      "descriptions": {
        "default": "Source routing is an Internet Protocol mechanism that allows an IP\npacket to carry information, a list of addresses, that tells a router the path\nthe packet must take. There is also an option to record the hops as the route\nis traversed. The list of hops taken, the \"route record\", provides the\ndestination with a return path to the source. This allows the source (the\nsending host) to specify the route, loosely or strictly, ignoring the routing\ntables of some or all of the routers. It can allow a user to redirect network\ntraffic for malicious purposes and should therefore be disabled.",
        "check": "At the command line, execute the following command:\n\n# /sbin/sysctl -a --pattern\n\"net.ipv[4|6].conf.(all|default|eth.*).accept_source_route\"\n\nExpected result:\n\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv4.conf.eth0.accept_source_route = 0\nnet.ipv6.conf.all.accept_source_route = 0\nnet.ipv6.conf.default.accept_source_route = 0\nnet.ipv6.conf.eth0.accept_source_route = 0\n\nIf the output does not match the expected result, this is a finding.\n\nNote: The number of ethx lines returned is dependant on the number of\ninterfaces. Every ethx entry must be set to 0.",
        "fix": "At the command line, execute the following command:\n\n# for SETTING in $(/sbin/sysctl -aN --pattern\n\"net.ipv[4|6].conf.(all|default|eth.*).accept_source_route\"); do sed -i -e\n\"/^${SETTING}/d\" /etc/sysctl.conf;echo $SETTING=0>>/etc/sysctl.conf; done"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000104",
        "stig_id": "PHTN-10-000104",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000104\" do\n  title \"The Photon operating system must not forward IPv4 or IPv6\nsource-routed packets.\"\n  desc  \"Source routing is an Internet Protocol mechanism that allows an IP\npacket to carry information, a list of addresses, that tells a router the path\nthe packet must take. There is also an option to record the hops as the route\nis traversed. The list of hops taken, the \\\"route record\\\", provides the\ndestination with a return path to the source. This allows the source (the\nsending host) to specify the route, loosely or strictly, ignoring the routing\ntables of some or all of the routers. It can allow a user to redirect network\ntraffic for malicious purposes and should therefore be disabled.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000104\"\n  tag stig_id: \"PHTN-10-000104\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# /sbin/sysctl -a --pattern\n\\\"net.ipv[4|6].conf.(all|default|eth.*).accept_source_route\\\"\n\nExpected result:\n\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv4.conf.eth0.accept_source_route = 0\nnet.ipv6.conf.all.accept_source_route = 0\nnet.ipv6.conf.default.accept_source_route = 0\nnet.ipv6.conf.eth0.accept_source_route = 0\n\nIf the output does not match the expected result, this is a finding.\n\nNote: The number of ethx lines returned is dependant on the number of\ninterfaces. Every ethx entry must be set to 0.\"\n  desc 'fix', \"At the command line, execute the following command:\n\n# for SETTING in $(/sbin/sysctl -aN --pattern\n\\\"net.ipv[4|6].conf.(all|default|eth.*).accept_source_route\\\"); do sed -i -e\n\\\"/^${SETTING}/d\\\" /etc/sysctl.conf;echo $SETTING=0>>/etc/sysctl.conf; done\"\n\n  describe kernel_parameter('net.ipv4.conf.all.accept_source_route') do\n    its('value') { should eq 0 }\n  end\n\n  describe kernel_parameter('net.ipv4.conf.default.accept_source_route') do\n    its('value') { should eq 0 }\n  end\n\n  describe kernel_parameter('net.ipv4.conf.eth0.accept_source_route') do\n    its('value') { should eq 0 }\n  end\n\n  describe kernel_parameter('net.ipv6.conf.all.accept_source_route') do\n    its('value') { should eq 0 }\n  end\n\n  describe kernel_parameter('net.ipv6.conf.default.accept_source_route') do\n    its('value') { should eq 0 }\n  end\n\n  describe kernel_parameter('net.ipv6.conf.eth0.accept_source_route') do\n    its('value') { should eq 0 }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000104.rb",
        "line": 1
      },
      "id": "PHTN-10-000104"
    },
    {
      "title": "The Photon operating system must enforce password complexity by\nrequiring that at least one special character be used.",
      "desc": "Use of a complex password helps to increase the time and resources\nrequired to compromise the password. Password complexity, or strength, is a\nmeasure of the effectiveness of a password in resisting attempts at guessing\nand brute-force attacks.",
      "descriptions": {
        "default": "Use of a complex password helps to increase the time and resources\nrequired to compromise the password. Password complexity, or strength, is a\nmeasure of the effectiveness of a password in resisting attempts at guessing\nand brute-force attacks.",
        "check": "At the command line, execute the following command:\n\n# grep pam_cracklib /etc/pam.d/system-password|grep --color=always\n\"ocredit=..\"\n\nExpected result:\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1\nminlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/pam.d/system-password with a text editor.\n\nAdd the following, replacing any existing 'pam_cracklib.so' line :\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1\nminlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000266-GPOS-00101",
        "gid": null,
        "rid": "PHTN-10-000052",
        "stig_id": "PHTN-10-000052",
        "cci": "CCI-001619",
        "nist": [
          "IA-5 (1) (a)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000052\" do\n  title \"The Photon operating system must enforce password complexity by\nrequiring that at least one special character be used.\"\n  desc  \"Use of a complex password helps to increase the time and resources\nrequired to compromise the password. Password complexity, or strength, is a\nmeasure of the effectiveness of a password in resisting attempts at guessing\nand brute-force attacks.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000266-GPOS-00101\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000052\"\n  tag stig_id: \"PHTN-10-000052\"\n  tag cci: \"CCI-001619\"\n  tag nist: [\"IA-5 (1) (a)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep pam_cracklib /etc/pam.d/system-password|grep --color=always\n\\\"ocredit=..\\\"\n\nExpected result:\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1\nminlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/pam.d/system-password with a text editor.\n\nAdd the following, replacing any existing 'pam_cracklib.so' line :\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1\nminlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root\"\n\n  describe file ('/etc/pam.d/system-password') do\n    its ('content'){should match /^(?=.*?\\bpassword\\b)(?=.*?\\brequisite\\b)(?=.*?\\bocredit=-1\\b).*$/}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000052.rb",
        "line": 1
      },
      "id": "PHTN-10-000052"
    },
    {
      "title": "The Photon operating system must configure auditd to log to disk.",
      "desc": "Without establishing what type of events occurred, it would be\ndifficult to establish, correlate, and investigate the events leading up to an\noutage or attack.\n\n    Audit record content must be shipped to a central location but it must also\nbe logged locally.",
      "descriptions": {
        "default": "Without establishing what type of events occurred, it would be\ndifficult to establish, correlate, and investigate the events leading up to an\noutage or attack.\n\n    Audit record content must be shipped to a central location but it must also\nbe logged locally.",
        "check": "At the command line, execute the following command:\n\n# grep \"^write_logs\" /etc/audit/auditd.conf\n\nExpected result:\n\nwrite_logs = yes\n\nIf there is no output, this is not a finding.\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/audit/auditd.conf with a text editor and ensure that the\n\"write_logs\" line is uncommented and set to the following:\n\nwrite_logs = yes\n\nAt the command line, execute the following command:\n\n# service auditd reload"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000037-GPOS-00015",
        "gid": null,
        "rid": "PHTN-10-000010",
        "stig_id": "PHTN-10-000010",
        "cci": "CCI-000130",
        "nist": [
          "AU-3",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000010\" do\n  title \"The Photon operating system must configure auditd to log to disk.\"\n  desc  \"Without establishing what type of events occurred, it would be\ndifficult to establish, correlate, and investigate the events leading up to an\noutage or attack.\n\n    Audit record content must be shipped to a central location but it must also\nbe logged locally.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000037-GPOS-00015\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000010\"\n  tag stig_id: \"PHTN-10-000010\"\n  tag cci: \"CCI-000130\"\n  tag nist: [\"AU-3\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep \\\"^write_logs\\\" /etc/audit/auditd.conf\n\nExpected result:\n\nwrite_logs = yes\n\nIf there is no output, this is not a finding.\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/audit/auditd.conf with a text editor and ensure that the\n\\\"write_logs\\\" line is uncommented and set to the following:\n\nwrite_logs = yes\n\nAt the command line, execute the following command:\n\n# service auditd reload\"\n\n  describe.one do\n\n    describe auditd_conf do\n      its(\"write_logs\") { should eq nil }\n    end\n\n    describe auditd_conf do\n      its(\"write_logs\") { should cmp 'yes'}\n    end\n\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000010.rb",
        "line": 1
      },
      "id": "PHTN-10-000010"
    },
    {
      "title": "The Photon operating system must configure sshd to disallow\nHostbasedAuthentication.",
      "desc": "SSH trust relationships enable trivial lateral spread after a host\ncompromise and therefore must be explicitly disabled.",
      "descriptions": {
        "default": "SSH trust relationships enable trivial lateral spread after a host\ncompromise and therefore must be explicitly disabled.",
        "check": "At the command line, execute the following command:\n\n# sshd -T|&grep -i HostbasedAuthentication\n\nExpected result:\n\nhostbasedauthentication no\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/ssh/sshd_config with a text editor and ensure that the\n\"HostbasedAuthentication\" line is uncommented and set to the following:\n\nHostbasedAuthentication no\n\nAt the command line, execute the following command:\n\n# service sshd reload"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00229",
        "gid": null,
        "rid": "PHTN-10-000122.",
        "stig_id": "PHTN-10-000122",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000122\" do\n  title \"The Photon operating system must configure sshd to disallow\nHostbasedAuthentication.\"\n  desc  \"SSH trust relationships enable trivial lateral spread after a host\ncompromise and therefore must be explicitly disabled.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00229\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000122.\"\n  tag stig_id: \"PHTN-10-000122\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# sshd -T|&grep -i HostbasedAuthentication\n\nExpected result:\n\nhostbasedauthentication no\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/ssh/sshd_config with a text editor and ensure that the\n\\\"HostbasedAuthentication\\\" line is uncommented and set to the following:\n\nHostbasedAuthentication no\n\nAt the command line, execute the following command:\n\n# service sshd reload\"\n\n  describe command('sshd -T|&grep -i HostbasedAuthentication') do\n      its ('stdout.strip') { should cmp 'HostbasedAuthentication no' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000122.rb",
        "line": 1
      },
      "id": "PHTN-10-000122"
    },
    {
      "title": "The Photon operating system must set the FAIL_DELAY parameter.",
      "desc": "Limiting the number of logon attempts over a certain time interval\nreduces the chances that an unauthorized user may gain access to an account.",
      "descriptions": {
        "default": "Limiting the number of logon attempts over a certain time interval\nreduces the chances that an unauthorized user may gain access to an account.",
        "check": "At the command line, execute the following command:\n\n# grep FAIL_DELAY /etc/login.defs\n\nExpected result:\n\nFAIL_DELAY 4\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/login.defs with a text editor.\n\nAdd the following line after the last auth statement:\nFAIL_DELAY 4"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00226",
        "gid": null,
        "rid": "PHTN-10-000076",
        "stig_id": "PHTN-10-000076",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000076\" do\n  title \"The Photon operating system must set the FAIL_DELAY parameter.\"\n  desc  \"Limiting the number of logon attempts over a certain time interval\nreduces the chances that an unauthorized user may gain access to an account.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00226\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000076\"\n  tag stig_id: \"PHTN-10-000076\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep FAIL_DELAY /etc/login.defs\n\nExpected result:\n\nFAIL_DELAY 4\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/login.defs with a text editor.\n\nAdd the following line after the last auth statement:\nFAIL_DELAY 4\"\n\n  describe login_defs do\n    its('FAIL_DELAY') { should cmp '4' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000076.rb",
        "line": 1
      },
      "id": "PHTN-10-000076"
    },
    {
      "title": "The Photon operating system audit log must attempt to log audit\nfailures to syslog.",
      "desc": "It is critical for the appropriate personnel to be aware if a system\nis at risk of failing to process audit logs as required. Without this\nnotification, the security personnel may be unaware of an impending failure of\nthe audit capability, and system operation may be adversely affected.",
      "descriptions": {
        "default": "It is critical for the appropriate personnel to be aware if a system\nis at risk of failing to process audit logs as required. Without this\nnotification, the security personnel may be unaware of an impending failure of\nthe audit capability, and system operation may be adversely affected.",
        "check": "At the command line, execute the following commands:\n\n# grep -E \"^disk_full_action|^disk_error_action|^admin_space_left_action\"\n/etc/audit/auditd.conf\n\nIf any of the above parameters are not set to SYSLOG or are missing, this is a\nfinding.",
        "fix": "Open /etc/audit/auditd.conf with a text editor and ensure that the\nfollowing lines are present, not duplicated and not commented:\n\ndisk_full_action = SYSLOG\ndisk_error_action = SYSLOG\nadmin_space_left_action = SYSLOG\n\nAt the command line, execute the following command:\n\n# service auditd reload"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000047-GPOS-00023",
        "gid": null,
        "rid": "PHTN-10-000014",
        "stig_id": "PHTN-10-000014",
        "cci": "CCI-000140",
        "nist": [
          "AU-5 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000014\" do\n  title \"The Photon operating system audit log must attempt to log audit\nfailures to syslog.\"\n  desc  \"It is critical for the appropriate personnel to be aware if a system\nis at risk of failing to process audit logs as required. Without this\nnotification, the security personnel may be unaware of an impending failure of\nthe audit capability, and system operation may be adversely affected.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000047-GPOS-00023\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000014\"\n  tag stig_id: \"PHTN-10-000014\"\n  tag cci: \"CCI-000140\"\n  tag nist: [\"AU-5 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following commands:\n\n# grep -E \\\"^disk_full_action|^disk_error_action|^admin_space_left_action\\\"\n/etc/audit/auditd.conf\n\nIf any of the above parameters are not set to SYSLOG or are missing, this is a\nfinding.\"\n  desc 'fix', \"Open /etc/audit/auditd.conf with a text editor and ensure that the\nfollowing lines are present, not duplicated and not commented:\n\ndisk_full_action = SYSLOG\ndisk_error_action = SYSLOG\nadmin_space_left_action = SYSLOG\n\nAt the command line, execute the following command:\n\n# service auditd reload\"\n\n  describe auditd_conf do\n    its(\"disk_full_action\") { should cmp 'SYSLOG'}\n    its(\"disk_error_action\") { should cmp 'SYSLOG'}\n    its(\"admin_space_left_action\") { should cmp 'SYSLOG'}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000014.rb",
        "line": 1
      },
      "id": "PHTN-10-000014"
    },
    {
      "title": "The Photon operating system must have the sshd LogLevel set to INFO.",
      "desc": "Automated monitoring of remote access sessions allows organizations to\ndetect cyber attacks and ensure ongoing compliance with remote access policies\nby auditing connection activities.\n\n    The INFO LogLevel is required, at least, to ensure the capturing of failed\nlogin events.",
      "descriptions": {
        "default": "Automated monitoring of remote access sessions allows organizations to\ndetect cyber attacks and ensure ongoing compliance with remote access policies\nby auditing connection activities.\n\n    The INFO LogLevel is required, at least, to ensure the capturing of failed\nlogin events.",
        "check": "At the command line, execute the following command:\n\n# sshd -T|&grep -i LogLevel\n\nExpected result:\n\n LogLevel INFO\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/ssh/sshd_config with a text editor and ensure that the\n\"LogLevel\" line is uncommented and set to the following:\n\nLogLevel INFO\n\nAt the command line, execute the following command:\n\n# service sshd reload"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000032-GPOS-00013",
        "gid": null,
        "rid": "PHTN-10-000008",
        "stig_id": "PHTN-10-000008",
        "cci": "CCI-000067",
        "nist": [
          "AC-17 (1)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000008\" do\n  title \"The Photon operating system must have the sshd LogLevel set to INFO.\"\n  desc  \"Automated monitoring of remote access sessions allows organizations to\ndetect cyber attacks and ensure ongoing compliance with remote access policies\nby auditing connection activities.\n\n    The INFO LogLevel is required, at least, to ensure the capturing of failed\nlogin events.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000032-GPOS-00013\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000008\"\n  tag stig_id: \"PHTN-10-000008\"\n  tag cci: \"CCI-000067\"\n  tag nist: [\"AC-17 (1)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# sshd -T|&grep -i LogLevel\n\nExpected result:\n\n LogLevel INFO\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/ssh/sshd_config with a text editor and ensure that the\n\\\"LogLevel\\\" line is uncommented and set to the following:\n\nLogLevel INFO\n\nAt the command line, execute the following command:\n\n# service sshd reload\"\n\n  describe command('sshd -T|&grep -i loglevel') do\n    its ('stdout.strip') { should cmp 'loglevel INFO' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000008.rb",
        "line": 1
      },
      "id": "PHTN-10-000008"
    },
    {
      "title": "The Photon operating system must configure sshd to disallow Generic\nSecurity Service Application Program Interface (GSSAPI) authentication.",
      "desc": "GSSAPI authentication is used to provide additional authentication\nmechanisms to applications. Allowing GSSAPI authentication through SSH exposes\nthe systems GSSAPI to remote hosts, increasing the attack surface of the\nsystem.",
      "descriptions": {
        "default": "GSSAPI authentication is used to provide additional authentication\nmechanisms to applications. Allowing GSSAPI authentication through SSH exposes\nthe systems GSSAPI to remote hosts, increasing the attack surface of the\nsystem.",
        "check": "At the command line, execute the following command:\n\n# sshd -T|&grep -i GSSAPIAuthentication\n\nExpected result:\n\nGSSAPIAuthentication no\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/ssh/sshd_config with a text editor and ensure that the\n\"GSSAPIAuthentication\" line is uncommented and set to the following:\n\nGSSAPIAuthentication no\n\nAt the command line, execute the following command:\n\n# service sshd reload"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000083",
        "stig_id": "PHTN-10-000083",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000083\" do\n  title \"The Photon operating system must configure sshd to disallow Generic\nSecurity Service Application Program Interface (GSSAPI) authentication.\"\n  desc  \"GSSAPI authentication is used to provide additional authentication\nmechanisms to applications. Allowing GSSAPI authentication through SSH exposes\nthe systems GSSAPI to remote hosts, increasing the attack surface of the\nsystem.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000083\"\n  tag stig_id: \"PHTN-10-000083\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# sshd -T|&grep -i GSSAPIAuthentication\n\nExpected result:\n\nGSSAPIAuthentication no\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/ssh/sshd_config with a text editor and ensure that the\n\\\"GSSAPIAuthentication\\\" line is uncommented and set to the following:\n\nGSSAPIAuthentication no\n\nAt the command line, execute the following command:\n\n# service sshd reload\"\n\n  describe command('sshd -T|&grep -i GSSAPIAuthentication') do\n    its ('stdout.strip') { should cmp 'GSSAPIAuthentication no' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000083.rb",
        "line": 1
      },
      "id": "PHTN-10-000083"
    },
    {
      "title": "The Photon operating system must enforce password complexity on the\nroot account.",
      "desc": "Password complexity rules must apply to all accounts on the system,\nincluding root. Without specifying the enforce_for_root flag, pam_cracklib does\nnot apply complexity rules to the root user. While root users can find way\naround this requirement, given it's superuser power, it is necessary to attempt\nto force compliance.",
      "descriptions": {
        "default": "Password complexity rules must apply to all accounts on the system,\nincluding root. Without specifying the enforce_for_root flag, pam_cracklib does\nnot apply complexity rules to the root user. While root users can find way\naround this requirement, given it's superuser power, it is necessary to attempt\nto force compliance.",
        "check": "At the command line, execute the following command:\n\n# grep pam_cracklib /etc/pam.d/system-password|grep --color=always\n\"enforce_for_root\"\n\nExpected result:\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1\nminlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/pam.d/system-password with a text editor.\n\nAdd the following, replacing any existing 'pam_cracklib.so' line :\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1\nminlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000117",
        "stig_id": "PHTN-10-000117",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000117\" do\n  title \"The Photon operating system must enforce password complexity on the\nroot account.\"\n  desc  \"Password complexity rules must apply to all accounts on the system,\nincluding root. Without specifying the enforce_for_root flag, pam_cracklib does\nnot apply complexity rules to the root user. While root users can find way\naround this requirement, given it's superuser power, it is necessary to attempt\nto force compliance.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000117\"\n  tag stig_id: \"PHTN-10-000117\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep pam_cracklib /etc/pam.d/system-password|grep --color=always\n\\\"enforce_for_root\\\"\n\nExpected result:\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1\nminlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/pam.d/system-password with a text editor.\n\nAdd the following, replacing any existing 'pam_cracklib.so' line :\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1\nminlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root\"\n\n  describe file ('/etc/pam.d/system-password') do\n      its ('content'){should match /^(?=.*?\\bpassword\\b)(?=.*?\\brequisite\\b)(?=.*?\\benforce_for_root\\b).*$/}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000117.rb",
        "line": 1
      },
      "id": "PHTN-10-000117"
    },
    {
      "title": "The Photon operating system must send TCP timestamps.",
      "desc": "TCP timestamps are used to provide protection against wrapped sequence\nnumbers. It is possible to calculate system uptime (and boot time) by analyzing\nTCP timestamps. These calculated uptimes can help a bad actor in determining\nlikely patch levels for vulnerabilities.",
      "descriptions": {
        "default": "TCP timestamps are used to provide protection against wrapped sequence\nnumbers. It is possible to calculate system uptime (and boot time) by analyzing\nTCP timestamps. These calculated uptimes can help a bad actor in determining\nlikely patch levels for vulnerabilities.",
        "check": "At the command line, execute the following command:\n\n# /sbin/sysctl -a --pattern \"net.ipv4.tcp_timestamps$\"\n\nExpected result:\n\nnet.ipv4.tcp_timestamps = 1\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "At the command line, execute the following commands:\n\n# sed -i -e \"/^net.ipv4.tcp_timestamps/d\" /etc/sysctl.conf\n# echo net.ipv4.tcp_timestamps=1>>/etc/sysctl.conf"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000113",
        "stig_id": "PHTN-10-000113",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000113\" do\n  title \"The Photon operating system must send TCP timestamps.\"\n  desc  \"TCP timestamps are used to provide protection against wrapped sequence\nnumbers. It is possible to calculate system uptime (and boot time) by analyzing\nTCP timestamps. These calculated uptimes can help a bad actor in determining\nlikely patch levels for vulnerabilities.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000113\"\n  tag stig_id: \"PHTN-10-000113\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n\n  desc 'check', \"At the command line, execute the following command:\n\n# /sbin/sysctl -a --pattern \\\"net.ipv4.tcp_timestamps$\\\"\n\nExpected result:\n\nnet.ipv4.tcp_timestamps = 1\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following commands:\n\n# sed -i -e \\\"/^net.ipv4.tcp_timestamps/d\\\" /etc/sysctl.conf\n# echo net.ipv4.tcp_timestamps=1>>/etc/sysctl.conf\"\n\n  describe kernel_parameter('net.ipv4.tcp_timestamps') do\n    its('value') { should eq 1 }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000113.rb",
        "line": 1
      },
      "id": "PHTN-10-000113"
    },
    {
      "title": "The Photon operating system must enforce approved authorizations for\nlogical access to information and system resources in accordance with\napplicable access control policies.",
      "desc": "If the system does not require authentication before it boots into\nsingle-user mode, anyone with vCenter console rights to the VCSA can trivially\naccess all files on the system. GRUB2 is the boot loader for Photon OS and is\ncan be configured to require a password to boot into single-user mode or make\nmodifications to the boot menu.\n\n    Note: The VCSA does not support building grub changes via grub2-mkconfig.",
      "descriptions": {
        "default": "If the system does not require authentication before it boots into\nsingle-user mode, anyone with vCenter console rights to the VCSA can trivially\naccess all files on the system. GRUB2 is the boot loader for Photon OS and is\ncan be configured to require a password to boot into single-user mode or make\nmodifications to the boot menu.\n\n    Note: The VCSA does not support building grub changes via grub2-mkconfig.",
        "check": "At the command line, execute the following command:\n\n# grep -i ^password_pbkdf2 /boot/grub2/grub.cfg\n\nIf there is not output, this is a finding.\n\nIf the output does not begin with \"password_pbkdf2 root\", this is a finding.",
        "fix": "At the command line, execute the following command:\n\n# grub2-mkpasswd-pbkdf2\n\nEnter a secure password and ensure this password is stored for break-glass\nsituations. You will not be able to recover the vCenter root account without\nknowing this separate password. Copy the resulting encrypted string. An example\nstring is below:\n\ngrub.pbkdf2.sha512.10000.983A13DF3C51BB2B5130F0B86DDBF0DEA1AAF766BD1F16B7840F79CE3E35494C4B99F505C99C150071E563DF1D7FE1F45456D5960C4C79DAB6C49298B02A5558.5B2C49E12D43CC5A876F6738462DE4EFC24939D4BE486CDB72CFBCD87FDE93FBAFCB817E01B90F23E53C2502C3230502BC3113BE4F80B0AFC0EE956E735F7F86\n\nOpen /boot/grub2/grub.cfg with a text editor. Find the line that begins with\n\"set rootpartition\". Below this line, paste the following on its own line:\n\nset superusers=\"root\"\n\nBelow this paste the following, substituting your own encrypted string from the\nsteps above:\n\npassword_pbkdf2 root <YOUR-LONG-STRING-FROM-ABOVE>\n\nThe VCSA ships with one menuentry block by default. Copy that entire block and\npaste it right below itself.\n\nExample:\nmenuentry \"Photon\" {\n    linux \"/\"$photon_linux root=$rootpartition net.ifnames=0 $photon_cmdline\ncoredump_filter=0x37 consoleblank=0\n    if [ \"$photon_initrd\" ]; then\n        initrd \"/\"$photon_initrd\n    fi\n}\nmenuentry \"Photon\" {\n    linux \"/\"$photon_linux root=$rootpartition net.ifnames=0 $photon_cmdline\ncoredump_filter=0x37 consoleblank=0\n    if [ \"$photon_initrd\" ]; then\n        initrd \"/\"$photon_initrd\n    fi\n}\n\nModify the first menuentry block to add the \"--unrestricted\" option as\nfollows:\n\nmenuentry \"Photon\" --unrestricted {\n\nModify the second menuentry block to add the allowed user as follows\n\nmenuentry \"Recover Photon\" --users root {\n\nThis concludes the fix. To verify, here is an example grub.cfg snippet.\n\n...\nset rootpartition=PARTUUID=326e5b0f-42fb-471a-8209-18964c4a2ed3\nset superusers=\"root\"\npassword_pbkdf2 root\ngrub.pbkdf2.sha512.10000.983A13DF3C51BB2B5130F0B86DDBF0DEA1AAF766BD1F16B7840F79CE3E35494C4B99F505C99C150071E563DF1D7FE1F45456D5960C4C79DAB6C49298B02A5558.5B2C49E12D43CC5A876F6738462DE4EFC24939D4BE486CDB72CFBCD87FDE93FBAFCB817E01B90F23E53C2502C3230502BC3113BE4F80B0AFC0EE956E735F7F86\n\nmenuentry \"Photon\" --unrestricted {\n    linux \"/\"$photon_linux root=$rootpartition net.ifnames=0 $photon_cmdline\ncoredump_filter=0x37 consoleblank=0\n    if [ \"$photon_initrd\" ]; then\n        initrd \"/\"$photon_initrd\n    fi\n}\n\nmenuentry \"Recover Photon\" --users root {\n    linux \"/\"$photon_linux root=$rootpartition net.ifnames=0 $photon_cmdline\ncoredump_filter=0x37 consoleblank=0\n    if [ \"$photon_initrd\" ]; then\n        initrd \"/\"$photon_initrd\n    fi\n}"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000080-GPOS-00048",
        "gid": null,
        "rid": "PHTN-10-000124",
        "stig_id": "PHTN-10-000124",
        "cci": "CCI-000213",
        "nist": [
          "AC-3",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000124\" do\n  title \"The Photon operating system must enforce approved authorizations for\nlogical access to information and system resources in accordance with\napplicable access control policies.\"\n  desc  \"If the system does not require authentication before it boots into\nsingle-user mode, anyone with vCenter console rights to the VCSA can trivially\naccess all files on the system. GRUB2 is the boot loader for Photon OS and is\ncan be configured to require a password to boot into single-user mode or make\nmodifications to the boot menu.\n\n    Note: The VCSA does not support building grub changes via grub2-mkconfig.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000080-GPOS-00048\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000124\"\n  tag stig_id: \"PHTN-10-000124\"\n  tag cci: \"CCI-000213\"\n  tag nist: [\"AC-3\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep -i ^password_pbkdf2 /boot/grub2/grub.cfg\n\nIf there is not output, this is a finding.\n\nIf the output does not begin with \\\"password_pbkdf2 root\\\", this is a finding.\"\n  desc 'fix', \"At the command line, execute the following command:\n\n# grub2-mkpasswd-pbkdf2\n\nEnter a secure password and ensure this password is stored for break-glass\nsituations. You will not be able to recover the vCenter root account without\nknowing this separate password. Copy the resulting encrypted string. An example\nstring is below:\n\ngrub.pbkdf2.sha512.10000.983A13DF3C51BB2B5130F0B86DDBF0DEA1AAF766BD1F16B7840F79CE3E35494C4B99F505C99C150071E563DF1D7FE1F45456D5960C4C79DAB6C49298B02A5558.5B2C49E12D43CC5A876F6738462DE4EFC24939D4BE486CDB72CFBCD87FDE93FBAFCB817E01B90F23E53C2502C3230502BC3113BE4F80B0AFC0EE956E735F7F86\n\nOpen /boot/grub2/grub.cfg with a text editor. Find the line that begins with\n\\\"set rootpartition\\\". Below this line, paste the following on its own line:\n\nset superusers=\\\"root\\\"\n\nBelow this paste the following, substituting your own encrypted string from the\nsteps above:\n\npassword_pbkdf2 root <YOUR-LONG-STRING-FROM-ABOVE>\n\nThe VCSA ships with one menuentry block by default. Copy that entire block and\npaste it right below itself.\n\nExample:\nmenuentry \\\"Photon\\\" {\n    linux \\\"/\\\"$photon_linux root=$rootpartition net.ifnames=0 $photon_cmdline\ncoredump_filter=0x37 consoleblank=0\n    if [ \\\"$photon_initrd\\\" ]; then\n        initrd \\\"/\\\"$photon_initrd\n    fi\n}\nmenuentry \\\"Photon\\\" {\n    linux \\\"/\\\"$photon_linux root=$rootpartition net.ifnames=0 $photon_cmdline\ncoredump_filter=0x37 consoleblank=0\n    if [ \\\"$photon_initrd\\\" ]; then\n        initrd \\\"/\\\"$photon_initrd\n    fi\n}\n\nModify the first menuentry block to add the \\\"--unrestricted\\\" option as\nfollows:\n\nmenuentry \\\"Photon\\\" --unrestricted {\n\nModify the second menuentry block to add the allowed user as follows\n\nmenuentry \\\"Recover Photon\\\" --users root {\n\nThis concludes the fix. To verify, here is an example grub.cfg snippet.\n\n...\nset rootpartition=PARTUUID=326e5b0f-42fb-471a-8209-18964c4a2ed3\nset superusers=\\\"root\\\"\npassword_pbkdf2 root\ngrub.pbkdf2.sha512.10000.983A13DF3C51BB2B5130F0B86DDBF0DEA1AAF766BD1F16B7840F79CE3E35494C4B99F505C99C150071E563DF1D7FE1F45456D5960C4C79DAB6C49298B02A5558.5B2C49E12D43CC5A876F6738462DE4EFC24939D4BE486CDB72CFBCD87FDE93FBAFCB817E01B90F23E53C2502C3230502BC3113BE4F80B0AFC0EE956E735F7F86\n\nmenuentry \\\"Photon\\\" --unrestricted {\n    linux \\\"/\\\"$photon_linux root=$rootpartition net.ifnames=0 $photon_cmdline\ncoredump_filter=0x37 consoleblank=0\n    if [ \\\"$photon_initrd\\\" ]; then\n        initrd \\\"/\\\"$photon_initrd\n    fi\n}\n\nmenuentry \\\"Recover Photon\\\" --users root {\n    linux \\\"/\\\"$photon_linux root=$rootpartition net.ifnames=0 $photon_cmdline\ncoredump_filter=0x37 consoleblank=0\n    if [ \\\"$photon_initrd\\\" ]; then\n        initrd \\\"/\\\"$photon_initrd\n    fi\n}\"\n\n  describe command('grep -i ^password_pbkdf2 /boot/grub2/grub.cfg') do\n      its ('stdout.strip') { should match /.*password_pbkdf2 root.*/ }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000124.rb",
        "line": 1
      },
      "id": "PHTN-10-000124"
    },
    {
      "title": "The Photon operating system must configure sshd to use approved\nencryption algorithms.",
      "desc": "Without confidentiality protection mechanisms, unauthorized\nindividuals may gain access to sensitive information via a remote access\nsession.\n\n    OpenSSH on the Photon operating system is compiled with a FIPS validated\ncryptographic module. The 'FipsMode' setting controls whether this module is\ninitialaized and used in FIPS 140-2 mode or not.",
      "descriptions": {
        "default": "Without confidentiality protection mechanisms, unauthorized\nindividuals may gain access to sensitive information via a remote access\nsession.\n\n    OpenSSH on the Photon operating system is compiled with a FIPS validated\ncryptographic module. The 'FipsMode' setting controls whether this module is\ninitialaized and used in FIPS 140-2 mode or not.",
        "check": "At the command line, execute the following command:\n\n# sshd -T|&grep -i FipsMode\n\nExpected result:\n\nFipsMode yes\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/ssh/sshd_config with a text editor and ensure that the\n\"FipsMode\" line is uncommented and set to the following:\n\nFipsMode yes\n\nAt the command line, execute the following command:\n\n# service sshd reload"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000033-GPOS-00014",
        "gid": null,
        "rid": "PHTN-10-000009",
        "stig_id": "PHTN-10-000009",
        "cci": "CCI-000068",
        "nist": [
          "AC-17 (2)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000009\" do\n  title \"The Photon operating system must configure sshd to use approved\nencryption algorithms.\"\n  desc  \"Without confidentiality protection mechanisms, unauthorized\nindividuals may gain access to sensitive information via a remote access\nsession.\n\n    OpenSSH on the Photon operating system is compiled with a FIPS validated\ncryptographic module. The 'FipsMode' setting controls whether this module is\ninitialaized and used in FIPS 140-2 mode or not.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000033-GPOS-00014\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000009\"\n  tag stig_id: \"PHTN-10-000009\"\n  tag cci: \"CCI-000068\"\n  tag nist: [\"AC-17 (2)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# sshd -T|&grep -i FipsMode\n\nExpected result:\n\nFipsMode yes\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/ssh/sshd_config with a text editor and ensure that the\n\\\"FipsMode\\\" line is uncommented and set to the following:\n\nFipsMode yes\n\nAt the command line, execute the following command:\n\n# service sshd reload\"\n\n  describe command('sshd -T|&grep -i FipsMode') do\n    its ('stdout.strip') { should cmp 'FipsMode yes' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000009.rb",
        "line": 1
      },
      "id": "PHTN-10-000009"
    },
    {
      "title": "The Photon operating system must have the sshd SyslogFacility set to\nauthpriv.",
      "desc": "Automated monitoring of remote access sessions allows organizations to\ndetect cyber attacks and ensure ongoing compliance with remote access policies\nby auditing connection activities.",
      "descriptions": {
        "default": "Automated monitoring of remote access sessions allows organizations to\ndetect cyber attacks and ensure ongoing compliance with remote access policies\nby auditing connection activities.",
        "check": "At the command line, execute the following command:\n\n# sshd -T|&grep -i SyslogFacility\n\nExpected result:\n\nsyslogfacility AUTHPRIV\n\nIf there is no output or if the output does not match expected result, this is\na finding.",
        "fix": "Open /etc/ssh/sshd_config with a text editor and ensure that the\n\"SyslogFacility\" line is uncommented and set to the following:\n\nSyslogFacility AUTHPRIV\n\nAt the command line, execute the following command:\n\n# service sshd reload"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000032-GPOS-00013",
        "gid": null,
        "rid": "PHTN-10-000006",
        "stig_id": "PHTN-10-000006",
        "cci": "CCI-000067",
        "nist": [
          "AC-17 (1)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000006\" do\n  title \"The Photon operating system must have the sshd SyslogFacility set to\nauthpriv.\"\n  desc  \"Automated monitoring of remote access sessions allows organizations to\ndetect cyber attacks and ensure ongoing compliance with remote access policies\nby auditing connection activities.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000032-GPOS-00013\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000006\"\n  tag stig_id: \"PHTN-10-000006\"\n  tag cci: \"CCI-000067\"\n  tag nist: [\"AC-17 (1)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# sshd -T|&grep -i SyslogFacility\n\nExpected result:\n\nsyslogfacility AUTHPRIV\n\nIf there is no output or if the output does not match expected result, this is\na finding.\n\"\n  desc 'fix', \"Open /etc/ssh/sshd_config with a text editor and ensure that the\n\\\"SyslogFacility\\\" line is uncommented and set to the following:\n\nSyslogFacility AUTHPRIV\n\nAt the command line, execute the following command:\n\n# service sshd reload\"\n\n  describe command('sshd -T|&grep -i syslogfacility') do\n    its ('stdout.strip') { should cmp 'syslogfacility AUTHPRIV' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000006.rb",
        "line": 1
      },
      "id": "PHTN-10-000006"
    },
    {
      "title": "The Photon operating system must not respond to IPv4 Internet Control\nMessage Protocol (ICMP) echoes sent to a broadcast address.",
      "desc": "Responding to broadcast (ICMP) echoes facilitates network mapping and\nprovides a vector for amplification attacks.",
      "descriptions": {
        "default": "Responding to broadcast (ICMP) echoes facilitates network mapping and\nprovides a vector for amplification attacks.",
        "check": "At the command line, execute the following command:\n\n# /sbin/sysctl -a --pattern ignore_broadcasts\n\nExpected result:\n\nnet.ipv4.icmp_echo_ignore_broadcasts = 1\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "At the command line, execute the following commands:\n\n# sed -i -e \"/^net.ipv4.icmp_echo_ignore_broadcasts/d\" /etc/sysctl.conf\n# echo net.ipv4.icmp_echo_ignore_broadcasts=1>>/etc/sysctl.conf"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000105",
        "stig_id": "PHTN-10-000105",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000105\" do\n  title \"The Photon operating system must not respond to IPv4 Internet Control\nMessage Protocol (ICMP) echoes sent to a broadcast address.\"\n  desc  \"Responding to broadcast (ICMP) echoes facilitates network mapping and\nprovides a vector for amplification attacks.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000105\"\n  tag stig_id: \"PHTN-10-000105\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# /sbin/sysctl -a --pattern ignore_broadcasts\n\nExpected result:\n\nnet.ipv4.icmp_echo_ignore_broadcasts = 1\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following commands:\n\n# sed -i -e \\\"/^net.ipv4.icmp_echo_ignore_broadcasts/d\\\" /etc/sysctl.conf\n# echo net.ipv4.icmp_echo_ignore_broadcasts=1>>/etc/sysctl.conf\"\n\n  describe kernel_parameter('net.ipv4.icmp_echo_ignore_broadcasts') do\n    its('value') { should eq 1 }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000105.rb",
        "line": 1
      },
      "id": "PHTN-10-000105"
    },
    {
      "title": "The Photon operating system must prohibit the use of cached\nauthenticators after one day.",
      "desc": "If cached authentication information is out-of-date, the validity of\nthe authentication information may be questionable.",
      "descriptions": {
        "default": "If cached authentication information is out-of-date, the validity of\nthe authentication information may be questionable.",
        "check": "At the command line, execute the following command:\n\n# /opt/likewise/bin/lwregshell list_values\n\"HKEY_THIS_MACHINE\\Services\\lsass\\Parameters\\Providers\\ActiveDirectory\"|grep\n\"CacheEntryExpiry\"\n\nIf the value returned is not 14400 or less, this is a finding.",
        "fix": "At the command line, execute the following command:\n\n# /opt/likewise/bin/lwregshell set_value\n\"[HKEY_THIS_MACHINE\\Services\\lsass\\Parameters\\Providers\\ActiveDirectory]\"\nCacheEntryExpiry 14400"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000383-GPOS-00166",
        "gid": null,
        "rid": "PHTN-10-000066",
        "stig_id": "PHTN-10-000066",
        "cci": "CCI-002007",
        "nist": [
          "IA-5 (13)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000066\" do\n  title \"The Photon operating system must prohibit the use of cached\nauthenticators after one day.\"\n  desc  \"If cached authentication information is out-of-date, the validity of\nthe authentication information may be questionable.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000383-GPOS-00166\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000066\"\n  tag stig_id: \"PHTN-10-000066\"\n  tag cci: \"CCI-002007\"\n  tag nist: [\"IA-5 (13)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# /opt/likewise/bin/lwregshell list_values\n\\\"HKEY_THIS_MACHINE\\\\Services\\\\lsass\\\\Parameters\\\\Providers\\\\ActiveDirectory\\\"|grep\n\\\"CacheEntryExpiry\\\"\n\nIf the value returned is not 14400 or less, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following command:\n\n# /opt/likewise/bin/lwregshell set_value\n\\\"[HKEY_THIS_MACHINE\\\\Services\\\\lsass\\\\Parameters\\\\Providers\\\\ActiveDirectory]\\\"\nCacheEntryExpiry 14400\"\n\n  describe command('/opt/likewise/bin/lwregshell list_values \"HKEY_THIS_MACHINE\\Services\\lsass\\Parameters\\Providers\\ActiveDirectory\"|grep \"CacheEntryExpiry\"') do\n      its ('stdout') { should match /^(?=.*?\\bCacheEntryExpiry\\b)(?=.*?\\bREG_DWORD\\b)(?=.*?\\b14400\\b).*$/ }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000066.rb",
        "line": 1
      },
      "id": "PHTN-10-000066"
    },
    {
      "title": "The Photon operating system must be configured so that the /etc/skel\ndefault scripts are protected from unauthorized modification.",
      "desc": "If the skeleton files are not protected, unauthorized personnel could\nchange user startup parameters and possibly jeopardize user files.",
      "descriptions": {
        "default": "If the skeleton files are not protected, unauthorized personnel could\nchange user startup parameters and possibly jeopardize user files.",
        "check": "At the command line, execute the following command:\n\n# stat -c \"%n permissions are %a and owned by %U:%G\" /etc/skel/.[^.]*\n\nExpected result:\n\n/etc/skel/.bash_logout permissions are 750 and owned by root:root\n/etc/skel/.bash_profile permissions are 644 and owned by root:root\n/etc/skel/.bashrc permissions are 750 and owned by root:root\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "At the command line, execute the following commands:\n\n# chmod 750 /etc/skel/.bash_logout\n# chmod 644 /etc/skel/.bash_profile\n# chmod 750 /etc/skel/.bashrc\n# chown root:root /etc/skel/.bash_logout\n# chown root:root /etc/skel/.bash_profile\n# chown root:root /etc/skel/.bashrc"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000096",
        "stig_id": "PHTN-10-000096",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000096\" do\n  title \"The Photon operating system must be configured so that the /etc/skel\ndefault scripts are protected from unauthorized modification.\"\n  desc  \"If the skeleton files are not protected, unauthorized personnel could\nchange user startup parameters and possibly jeopardize user files.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000096\"\n  tag stig_id: \"PHTN-10-000096\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# stat -c \\\"%n permissions are %a and owned by %U:%G\\\" /etc/skel/.[^.]*\n\nExpected result:\n\n/etc/skel/.bash_logout permissions are 750 and owned by root:root\n/etc/skel/.bash_profile permissions are 644 and owned by root:root\n/etc/skel/.bashrc permissions are 750 and owned by root:root\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following commands:\n\n# chmod 750 /etc/skel/.bash_logout\n# chmod 644 /etc/skel/.bash_profile\n# chmod 750 /etc/skel/.bashrc\n# chown root:root /etc/skel/.bash_logout\n# chown root:root /etc/skel/.bash_profile\n# chown root:root /etc/skel/.bashrc\"\n\n  describe file('/etc/skel/.bash_logout') do\n      its('owner') { should cmp 'root' }\n      its('group') { should cmp 'root' }\n      its('mode') { should cmp '0750' }\n  end\n\n  describe file('/etc/skel/.bash_profile') do\n      its('owner') { should cmp 'root' }\n      its('group') { should cmp 'root' }\n      its('mode') { should cmp '0644' }\n  end\n\n  describe file('/etc/skel/.bashrc') do\n      its('owner') { should cmp 'root' }\n      its('group') { should cmp 'root' }\n      its('mode') { should cmp '0750' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000096.rb",
        "line": 1
      },
      "id": "PHTN-10-000096"
    },
    {
      "title": "The Photon operating system must only allow installation of packages\nsigned by VMware.",
      "desc": "Installation of any non-trusted software, patches, service packs,\ndevice drivers or operating system components can significantly affect the\noverall security of the operating system. This requirement ensures the software\nhas not been tampered and has been provided by VMware.",
      "descriptions": {
        "default": "Installation of any non-trusted software, patches, service packs,\ndevice drivers or operating system components can significantly affect the\noverall security of the operating system. This requirement ensures the software\nhas not been tampered and has been provided by VMware.",
        "check": "At the command line, execute the following command:\n\n# rpm -qa gpg-pubkey --qf \"%{version}-%{release} %{summary}\"|grep -v \"66fd4949-4803fe57\"\n\nIf there is any output, an unsupported package has been installed, this is a\nfinding",
        "fix": "Confirm with VMware support that this package is not supported (for\npotential package additions after STIG publication) then At the command line,\nexecute the following command:\n\n# rpm -e <package-name-from-check>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000095-GPOS-00049",
        "gid": null,
        "rid": "PHTN-10-000032",
        "stig_id": "PHTN-10-000032",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000032\" do\n  title \"The Photon operating system must only allow installation of packages\nsigned by VMware.\"\n  desc  \"Installation of any non-trusted software, patches, service packs,\ndevice drivers or operating system components can significantly affect the\noverall security of the operating system. This requirement ensures the software\nhas not been tampered and has been provided by VMware. \"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000095-GPOS-00049\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000032\"\n  tag stig_id: \"PHTN-10-000032\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# rpm -qa gpg-pubkey --qf \\\"%{version}-%{release} %{summary}\\\n\\\"|grep -v \\\"66fd4949-4803fe57\\\"\n\nIf there is any output, an unsupported package has been installed, this is a\nfinding\"\n  desc 'fix', \"Confirm with VMware support that this package is not supported (for\npotential package additions after STIG publication) then At the command line,\nexecute the following command:\n\n# rpm -e <package-name-from-check>\"\n\n  describe command('rpm -qa gpg-pubkey --qf \"%{version}-%{release} %{summary}\\n\"|grep -v \"66fd4949-4803fe57\"') do\n      its ('stdout') { should eq '' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000032.rb",
        "line": 1
      },
      "id": "PHTN-10-000032"
    },
    {
      "title": "The Photon operating system must configure sshd to disallow\ncompression of the encrypted session stream.",
      "desc": "If compression is allowed in an SSH connection prior to\nauthentication, vulnerabilities in the compression software could result in\ncompromise of the system from an unauthenticated connection.",
      "descriptions": {
        "default": "If compression is allowed in an SSH connection prior to\nauthentication, vulnerabilities in the compression software could result in\ncompromise of the system from an unauthenticated connection.",
        "check": "At the command line, execute the following command:\n\n# sshd -T|&grep -i Compression\n\nExpected result:\n\nCompression no\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/ssh/sshd_config with a text editor and ensure that the\n\"Compression\" line is uncommented and set to the following:\n\nCompression no\n\nAt the command line, execute the following command:\n\n# service sshd reload"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000090",
        "stig_id": "PHTN-10-000090",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000090\" do\n  title \"The Photon operating system must configure sshd to disallow\ncompression of the encrypted session stream.\"\n  desc  \"If compression is allowed in an SSH connection prior to\nauthentication, vulnerabilities in the compression software could result in\ncompromise of the system from an unauthenticated connection.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000090\"\n  tag stig_id: \"PHTN-10-000090\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# sshd -T|&grep -i Compression\n\nExpected result:\n\nCompression no\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/ssh/sshd_config with a text editor and ensure that the\n\\\"Compression\\\" line is uncommented and set to the following:\n\nCompression no\n\nAt the command line, execute the following command:\n\n# service sshd reload\"\n\n  describe command('sshd -T|&grep -i Compression') do\n    its ('stdout.strip') { should cmp 'Compression no' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000090.rb",
        "line": 1
      },
      "id": "PHTN-10-000090"
    },
    {
      "title": "The Photon operating system must require that new passwords are at\nleast four characters different from the old password.",
      "desc": "Use of a complex password helps to increase the time and resources\nrequired to compromise the password. Password complexity, or strength, is a\nmeasure of the effectiveness of a password in resisting attempts at guessing\nand brute-force attacks.",
      "descriptions": {
        "default": "Use of a complex password helps to increase the time and resources\nrequired to compromise the password. Password complexity, or strength, is a\nmeasure of the effectiveness of a password in resisting attempts at guessing\nand brute-force attacks.",
        "check": "At the command line, execute the following command:\n\n# grep pam_cracklib /etc/pam.d/system-password|grep --color=always \"difok=.\"\n\nExpected result:\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1\nminlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Open /etc/pam.d/system-password with a text editor.\n\nAdd the following, replacing any existing 'pam_cracklib.so' line :\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1\nminlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000072-GPOS-00040",
        "gid": null,
        "rid": "PHTN-10-000024",
        "stig_id": "PHTN-10-000024",
        "cci": "CCI-000195",
        "nist": [
          "IA-5 (1) (b)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000024\" do\n  title \"The Photon operating system must require that new passwords are at\nleast four characters different from the old password.\"\n  desc  \"Use of a complex password helps to increase the time and resources\nrequired to compromise the password. Password complexity, or strength, is a\nmeasure of the effectiveness of a password in resisting attempts at guessing\nand brute-force attacks.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000072-GPOS-00040\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000024\"\n  tag stig_id: \"PHTN-10-000024\"\n  tag cci: \"CCI-000195\"\n  tag nist: [\"IA-5 (1) (b)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep pam_cracklib /etc/pam.d/system-password|grep --color=always \\\"difok=.\\\"\n\nExpected result:\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1\nminlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Open /etc/pam.d/system-password with a text editor.\n\nAdd the following, replacing any existing 'pam_cracklib.so' line :\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1\nminlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root\"\n\n  describe file ('/etc/pam.d/system-password') do\n    its ('content'){should match /^(?=.*?\\bpassword\\b)(?=.*?\\brequisite\\b)(?=.*?\\bdifok=4\\b).*$/}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000024.rb",
        "line": 1
      },
      "id": "PHTN-10-000024"
    },
    {
      "title": "The Photon operating system must ensure that the old passwords are\nbeing stored.",
      "desc": "Password complexity, or strength, is a measure of the effectiveness of\na password in resisting attempts at guessing and brute-force attacks. If the\ninformation system or application allows the user to consecutively reuse their\npassword when that password has exceeded its defined lifetime, the end result\nis a password that is not changed as per policy requirements.",
      "descriptions": {
        "default": "Password complexity, or strength, is a measure of the effectiveness of\na password in resisting attempts at guessing and brute-force attacks. If the\ninformation system or application allows the user to consecutively reuse their\npassword when that password has exceeded its defined lifetime, the end result\nis a password that is not changed as per policy requirements.",
        "check": "At the command line, execute the following command:\n\n# ls -al /etc/security/opasswd\n\nIf /etc/security/opasswd does not exist, this is a finding.",
        "fix": "At the command line, execute the following commands:\n\n# touch /etc/security/opasswd\n# chown root:root /etc/security/opasswd\n# chmod 0600 /etc/security/opasswd"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000077-GPOS-00045",
        "gid": null,
        "rid": "PHTN-10-000030",
        "stig_id": "PHTN-10-000030",
        "cci": "CCI-000200",
        "nist": [
          "IA-5 (1) (e)",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000030\" do\n  title \"The Photon operating system must ensure that the old passwords are\nbeing stored.\"\n  desc  \"Password complexity, or strength, is a measure of the effectiveness of\na password in resisting attempts at guessing and brute-force attacks. If the\ninformation system or application allows the user to consecutively reuse their\npassword when that password has exceeded its defined lifetime, the end result\nis a password that is not changed as per policy requirements.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000077-GPOS-00045\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000030\"\n  tag stig_id: \"PHTN-10-000030\"\n  tag cci: \"CCI-000200\"\n  tag nist: [\"IA-5 (1) (e)\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# ls -al /etc/security/opasswd\n\nIf /etc/security/opasswd does not exist, this is a finding.\n\n\"\n  desc 'fix', \"At the command line, execute the following commands:\n\n# touch /etc/security/opasswd\n# chown root:root /etc/security/opasswd\n# chmod 0600 /etc/security/opasswd\"\n\n  describe file('/etc/security/opasswd') do\n    it { should exist }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000030.rb",
        "line": 1
      },
      "id": "PHTN-10-000030"
    },
    {
      "title": "The Photon operating system must be configured so that all global\ninitialization scripts are protected from unauthorized modification.",
      "desc": "Local initialization files are used to configure the user's shell\nenvironment upon login. Malicious modification of these files could compromise\naccounts upon logon.",
      "descriptions": {
        "default": "Local initialization files are used to configure the user's shell\nenvironment upon login. Malicious modification of these files could compromise\naccounts upon logon.",
        "check": "At the command line, execute the following command:\n\n# find /etc/bash.bashrc /etc/profile /etc/profile.d/ -xdev -type f -a '(' -perm\n-002 -o -not -user root -o -not -group root ')' -exec ls -ld {} \\;\n\nIf any files are returned, this is a finding.",
        "fix": "At the command line, execute the following commands for each\nreturned file:\n\n# chmod o-w <file>\n# chown root:root <file>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000098",
        "stig_id": "PHTN-10-000098",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000098\" do\n  title \"The Photon operating system must be configured so that all global\ninitialization scripts are protected from unauthorized modification.\"\n  desc  \"Local initialization files are used to configure the user's shell\nenvironment upon login. Malicious modification of these files could compromise\naccounts upon logon.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000098\"\n  tag stig_id: \"PHTN-10-000098\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# find /etc/bash.bashrc /etc/profile /etc/profile.d/ -xdev -type f -a '(' -perm\n-002 -o -not -user root -o -not -group root ')' -exec ls -ld {} \\\\;\n\nIf any files are returned, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following commands for each\nreturned file:\n\n# chmod o-w <file>\n# chown root:root <file>\"\n\n  describe command (\"find /etc/bash.bashrc /etc/profile /etc/profile.d/ -xdev -type f -a '(' -perm -002 -o -not -user root -o -not -group root ')' -exec ls -ld {} \\;\") do\n     its ('stdout') { should eq '' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000098.rb",
        "line": 1
      },
      "id": "PHTN-10-000098"
    },
    {
      "title": "The Photon operating system must be configured so that all cron jobs\nare protected from unauthorized modification.",
      "desc": "If cron files and folders are accessible to unauthorized users then\nmalicious jobs may be created.",
      "descriptions": {
        "default": "If cron files and folders are accessible to unauthorized users then\nmalicious jobs may be created.",
        "check": "At the command line, execute the following command:\n\n# find /etc/cron.d/ /etc/cron.daily/ /etc/cron.hourly/ /etc/cron.monthly/\n/etc/cron.weekly/ -xdev -type f -a '(' -perm -002 -o -not -user root -o -not\n-group root ')' -exec ls -ld {} \\;\n\nIf any files are returned, this is a finding.",
        "fix": "At the command line, execute the following commands for each\nreturned file:\n\n# chmod o-w <file>\n# chown root:root <file>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-OS-000480-GPOS-00227",
        "gid": null,
        "rid": "PHTN-10-000102",
        "stig_id": "PHTN-10-000102",
        "cci": "CCI-000366",
        "nist": [
          "CM-6 b",
          "Rev_4"
        ]
      },
      "code": "control \"PHTN-10-000102\" do\n  title \"The Photon operating system must be configured so that all cron jobs\nare protected from unauthorized modification.\"\n  desc  \"If cron files and folders are accessible to unauthorized users then\nmalicious jobs may be created.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-OS-000480-GPOS-00227\"\n  tag gid: nil\n  tag rid: \"PHTN-10-000102\"\n  tag stig_id: \"PHTN-10-000102\"\n  tag cci: \"CCI-000366\"\n  tag nist: [\"CM-6 b\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# find /etc/cron.d/ /etc/cron.daily/ /etc/cron.hourly/ /etc/cron.monthly/\n/etc/cron.weekly/ -xdev -type f -a '(' -perm -002 -o -not -user root -o -not\n-group root ')' -exec ls -ld {} \\\\;\n\nIf any files are returned, this is a finding.\"\n  desc 'fix', \"At the command line, execute the following commands for each\nreturned file:\n\n# chmod o-w <file>\n# chown root:root <file>\"\n\n  describe command(\"find /etc/cron.d/ /etc/cron.daily/ /etc/cron.hourly/ /etc/cron.monthly/ /etc/cron.weekly/ -xdev -type f -a '(' -perm -002 -o -not -user root -o -not -group root ')' -exec ls -ld {} \\;\") do\n     its ('stdout') { should eq '' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000102.rb",
        "line": 1
      },
      "id": "PHTN-10-000102"
    },
    {
      "title": "Rsyslog must be configured to monitor vPostgres logs.",
      "desc": "For performance reasons, rsyslog file monitoring is preferred over\nconfiguring vPostgres to send events to a syslog facility. Without ensuring\nthat logs are created, that rsyslog configs are create and that those configs\nare loaded, the log file monitoring and shipping will not be effective.",
      "descriptions": {
        "default": "For performance reasons, rsyslog file monitoring is preferred over\nconfiguring vPostgres to send events to a syslog facility. Without ensuring\nthat logs are created, that rsyslog configs are create and that those configs\nare loaded, the log file monitoring and shipping will not be effective.",
        "check": "At the command prompt, execute the following command:\n\n# cat /etc/vmware-syslog/stig-services-vpostgres.conf\n\nExpected result:\n\ninput(type=\"imfile\"\nFile=\"/var/log/vmware/vpostgres/serverlog.std*\"\nTag=\"vpostgres-first\"\nSeverity=\"info\"\nFacility=\"local0\")\n\ninput(type=\"imfile\"\nFile=\"/var/log/vmware/vpostgres/postgresql-*.log\"\nTag=\"vpostgres\"\nSeverity=\"info\"\nFacility=\"local0\")\n\n\nIf the file does not exist, this is a finding.\n\nIf the output of the command does not match the expected result above, this is\na finding.\n\nIf there is no output from the command, vPostgres will default to \"stderr\",\nthis is not a finding.",
        "fix": "Navigate to and open\n/etc/vmware-syslog/stig-services-vpostgres.conf, creating the file if it does\nnot exist.\n\nSet the contents of the file as follows:\n\ninput(type=\"imfile\"\nFile=\"/var/log/vmware/vpostgres/serverlog.std*\"\nTag=\"vpostgres-first\"\nSeverity=\"info\"\nFacility=\"local0\")\n\ninput(type=\"imfile\"\nFile=\"/var/log/vmware/vpostgres/postgresql-*.log\"\nTag=\"vpostgres\"\nSeverity=\"info\"\nFacility=\"local0\")"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "postgres",
        "gtitle": "SRG-APP-000359-DB-000319",
        "gid": null,
        "rid": "VCPG-67-000022",
        "stig_id": "VCPG-67-000022",
        "cci": "CCI-001855",
        "nist": [
          "AU-5 (1)",
          "Rev_4"
        ]
      },
      "code": "control \"VCPG-67-000022\" do\n  title \"Rsyslog must be configured to monitor vPostgres logs.\"\n  desc  \"For performance reasons, rsyslog file monitoring is preferred over\nconfiguring vPostgres to send events to a syslog facility. Without ensuring\nthat logs are created, that rsyslog configs are create and that those configs\nare loaded, the log file monitoring and shipping will not be effective.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"postgres\"\n  tag gtitle: \"SRG-APP-000359-DB-000319\"\n  tag gid: nil\n  tag rid: \"VCPG-67-000022\"\n  tag stig_id: \"VCPG-67-000022\"\n  tag cci: \"CCI-001855\"\n  tag nist: [\"AU-5 (1)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# cat /etc/vmware-syslog/stig-services-vpostgres.conf\n\nExpected result:\n\ninput(type=\\\"imfile\\\"\nFile=\\\"/var/log/vmware/vpostgres/serverlog.std*\\\"\nTag=\\\"vpostgres-first\\\"\nSeverity=\\\"info\\\"\nFacility=\\\"local0\\\")\n\ninput(type=\\\"imfile\\\"\nFile=\\\"/var/log/vmware/vpostgres/postgresql-*.log\\\"\nTag=\\\"vpostgres\\\"\nSeverity=\\\"info\\\"\nFacility=\\\"local0\\\")\n\n\nIf the file does not exist, this is a finding.\n\nIf the output of the command does not match the expected result above, this is\na finding.\n\nIf there is no output from the command, vPostgres will default to \\\"stderr\\\",\nthis is not a finding.\"\n  desc 'fix', \"Navigate to and open\n/etc/vmware-syslog/stig-services-vpostgres.conf, creating the file if it does\nnot exist.\n\nSet the contents of the file as follows:\n\ninput(type=\\\"imfile\\\"\nFile=\\\"/var/log/vmware/vpostgres/serverlog.std*\\\"\nTag=\\\"vpostgres-first\\\"\nSeverity=\\\"info\\\"\nFacility=\\\"local0\\\")\n\ninput(type=\\\"imfile\\\"\nFile=\\\"/var/log/vmware/vpostgres/postgresql-*.log\\\"\nTag=\\\"vpostgres\\\"\nSeverity=\\\"info\\\"\nFacility=\\\"local0\\\")\n\n\"\n\n  describe file('/etc/vmware-syslog/stig-services-vpostgres.conf') do\n    it { should exist }\n  end\n  describe command('grep -v \"^#\" /etc/vmware-syslog/stig-services-vpostgres.conf') do\n    its ('stdout') { should match \"input(type=\\\"imfile\\\"\\nFile=\\\"/var/log/vmware/vpostgres/serverlog.std*\\\"\\nTag=\\\"vpostgres-first\\\"\\nSeverity=\\\"info\\\"\\nFacility=\\\"local0\\\")\\n\\ninput(type=\\\"imfile\\\"\\nFile=\\\"/var/log/vmware/vpostgres/postgresql-*.log\\\"\\nTag=\\\"vpostgres\\\"\\nSeverity=\\\"info\\\"\\nFacility=\\\"local0\\\")\\n\" }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000022.rb",
        "line": 1
      },
      "id": "VCPG-67-000022"
    },
    {
      "title": "The vPostgres database must use UTC for log timestamps.",
      "desc": "If time stamps are not consistently applied and there is no common\ntime reference, it is difficult to perform forensic analysis.\n\n    Time stamps generated by the DBMS must include date and time. Time is\ncommonly expressed in Coordinated Universal Time (UTC), a modern continuation\nof Greenwich Mean Time (GMT), or local time with an offset from UTC.\n\n    Some DBMS products offer a data type called TIMESTAMP that is not a\nrepresentation of date and time. Rather, it is a database state counter and\ndoes not correspond to calendar and clock time. This requirement does not refer\nto that meaning of TIMESTAMP.",
      "descriptions": {
        "default": "If time stamps are not consistently applied and there is no common\ntime reference, it is difficult to perform forensic analysis.\n\n    Time stamps generated by the DBMS must include date and time. Time is\ncommonly expressed in Coordinated Universal Time (UTC), a modern continuation\nof Greenwich Mean Time (GMT), or local time with an offset from UTC.\n\n    Some DBMS products offer a data type called TIMESTAMP that is not a\nrepresentation of date and time. Rather, it is a database state counter and\ndoes not correspond to calendar and clock time. This requirement does not refer\nto that meaning of TIMESTAMP.",
        "check": "At the command prompt, execute the following command:\n\n# grep '^\\s*log_timezone\\b' /storage/db/vpostgres/postgresql.conf\n\nIf \"log_timezone\" is not \"utc\", this is a finding.",
        "fix": "At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET\nlog_timezone TO 'UTC';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT\npg_reload_conf();\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "postgres",
        "gtitle": "SRG-APP-000374-DB-000322",
        "gid": null,
        "rid": "VCPG-67-000023",
        "stig_id": "VCPG-67-000023",
        "cci": "CCI-001890",
        "nist": [
          "AU-8 b",
          "Rev_4"
        ]
      },
      "code": "control \"VCPG-67-000023\" do\n  title \"The vPostgres database must use UTC for log timestamps.\"\n  desc  \"If time stamps are not consistently applied and there is no common\ntime reference, it is difficult to perform forensic analysis.\n\n    Time stamps generated by the DBMS must include date and time. Time is\ncommonly expressed in Coordinated Universal Time (UTC), a modern continuation\nof Greenwich Mean Time (GMT), or local time with an offset from UTC.\n\n    Some DBMS products offer a data type called TIMESTAMP that is not a\nrepresentation of date and time. Rather, it is a database state counter and\ndoes not correspond to calendar and clock time. This requirement does not refer\nto that meaning of TIMESTAMP.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"postgres\"\n  tag gtitle: \"SRG-APP-000374-DB-000322\"\n  tag gid: nil\n  tag rid: \"VCPG-67-000023\"\n  tag stig_id: \"VCPG-67-000023\"\n  tag cci: \"CCI-001890\"\n  tag nist: [\"AU-8 b\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep '^\\\\s*log_timezone\\\\b' /storage/db/vpostgres/postgresql.conf\n\nIf \\\"log_timezone\\\" is not \\\"utc\\\", this is a finding.\"\n  desc 'fix', \"At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"ALTER SYSTEM SET\nlog_timezone TO 'UTC';\\\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"SELECT\npg_reload_conf();\\\"\"\n\n  describe parse_config_file('/storage/db/vpostgres/postgresql.conf') do\n    its('log_timezone') { should cmp \"'UTC'\" }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000023.rb",
        "line": 1
      },
      "id": "VCPG-67-000023"
    },
    {
      "title": "vPostgres must be configured to use the correct port.",
      "desc": "In order to prevent unauthorized connection of devices, unauthorized\ntransfer of information, or unauthorized tunneling (i.e., embedding of data\ntypes within data types), organizations must disable or restrict unused or\nunnecessary physical and logical ports/protocols/services on information\nsystems.\n\n    Applications are capable of providing a wide variety of functions and\nservices. Some of the functions and services provided by default may not be\nnecessary to support essential organizational operations. Additionally, it is\nsometimes convenient to provide multiple services from a single component\n(e.g., email and web services); however, doing so increases risk over limiting\nthe services provided by any one component.\n\n    To support the requirements and principles of least functionality, the\napplication must support the organizational requirements providing only\nessential capabilities and limiting the use of ports, protocols, and/or\nservices to only those required, authorized, and approved to conduct official\nbusiness or to address authorized quality of life issues.\n\n    Database Management Systems using ports, protocols, and services deemed\nunsafe are open to attack through those ports, protocols, and services. This\ncan allow unauthorized access to the database and through the database to other\ncomponents of the information system.",
      "descriptions": {
        "default": "In order to prevent unauthorized connection of devices, unauthorized\ntransfer of information, or unauthorized tunneling (i.e., embedding of data\ntypes within data types), organizations must disable or restrict unused or\nunnecessary physical and logical ports/protocols/services on information\nsystems.\n\n    Applications are capable of providing a wide variety of functions and\nservices. Some of the functions and services provided by default may not be\nnecessary to support essential organizational operations. Additionally, it is\nsometimes convenient to provide multiple services from a single component\n(e.g., email and web services); however, doing so increases risk over limiting\nthe services provided by any one component.\n\n    To support the requirements and principles of least functionality, the\napplication must support the organizational requirements providing only\nessential capabilities and limiting the use of ports, protocols, and/or\nservices to only those required, authorized, and approved to conduct official\nbusiness or to address authorized quality of life issues.\n\n    Database Management Systems using ports, protocols, and services deemed\nunsafe are open to attack through those ports, protocols, and services. This\ncan allow unauthorized access to the database and through the database to other\ncomponents of the information system.",
        "check": "At the command prompt, execute the following command:\n\n# grep '^\\s*port\\b' /storage/db/vpostgres/postgresql.conf\n\nIf the port is set to \"5432\", this is NOT a finding.\n\nIf the port is not set to \"5432\" and if the ISSO does not have documentation\nof an approved variance for using a non-standard port, this is a finding.",
        "fix": "At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET port\nTO '5432';\"\n\n/opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT\npg_reload_conf();\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "postgres",
        "gtitle": "SRG-APP-000142-DB-000094",
        "gid": null,
        "rid": "VCPG-67-000011",
        "stig_id": "VCPG-67-000011",
        "cci": "CCI-000382",
        "nist": [
          "CM-7 b",
          "Rev_4"
        ]
      },
      "code": "control \"VCPG-67-000011\" do\n  title \"vPostgres must be configured to use the correct port.\"\n  desc  \"In order to prevent unauthorized connection of devices, unauthorized\ntransfer of information, or unauthorized tunneling (i.e., embedding of data\ntypes within data types), organizations must disable or restrict unused or\nunnecessary physical and logical ports/protocols/services on information\nsystems.\n\n    Applications are capable of providing a wide variety of functions and\nservices. Some of the functions and services provided by default may not be\nnecessary to support essential organizational operations. Additionally, it is\nsometimes convenient to provide multiple services from a single component\n(e.g., email and web services); however, doing so increases risk over limiting\nthe services provided by any one component.\n\n    To support the requirements and principles of least functionality, the\napplication must support the organizational requirements providing only\nessential capabilities and limiting the use of ports, protocols, and/or\nservices to only those required, authorized, and approved to conduct official\nbusiness or to address authorized quality of life issues.\n\n    Database Management Systems using ports, protocols, and services deemed\nunsafe are open to attack through those ports, protocols, and services. This\ncan allow unauthorized access to the database and through the database to other\ncomponents of the information system.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"postgres\"\n  tag gtitle: \"SRG-APP-000142-DB-000094\"\n  tag gid: nil\n  tag rid: \"VCPG-67-000011\"\n  tag stig_id: \"VCPG-67-000011\"\n  tag cci: \"CCI-000382\"\n  tag nist: [\"CM-7 b\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep '^\\\\s*port\\\\b' /storage/db/vpostgres/postgresql.conf\n\nIf the port is set to \\\"5432\\\", this is NOT a finding.\n\nIf the port is not set to \\\"5432\\\" and if the ISSO does not have documentation\nof an approved variance for using a non-standard port, this is a finding.\"\n  desc 'fix', \"At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"ALTER SYSTEM SET port\nTO '5432';\\\"\n\n/opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"SELECT\npg_reload_conf();\\\"\"\n\n  describe parse_config_file('/storage/db/vpostgres/postgresql.conf') do\n    its('port') { should eq \"5432\" }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000011.rb",
        "line": 1
      },
      "id": "VCPG-67-000011"
    },
    {
      "title": "vPostgres database log file data must contain required data elements.",
      "desc": "Without the capability to generate audit records, it would be\ndifficult to establish, correlate, and investigate the events relating to an\nincident or identify those responsible for one.\n\n    Audit records can be generated from various components within the DBMS\n(e.g., process, module). Certain specific application functionalities may be\naudited as well. The list of audited events is the set of events for which\naudits are to be generated. This set of events is typically a subset of the\nlist of all events for which the system is capable of generating audit records.\n\n    DoD has defined the list of events for which the DBMS will provide an audit\nrecord generation capability as the following:\n\n    (i) Successful and unsuccessful attempts to access, modify, or delete\nprivileges, security objects, security levels, or categories of information\n(e.g., classification levels);\n\n    (ii) Access actions, such as successful and unsuccessful logon attempts,\nprivileged activities, or other system-level access, starting and ending time\nfor user access to the system, concurrent logons from different workstations,\nsuccessful and unsuccessful accesses to objects, all program initiations, and\nall direct access to the information system; and\n\n    (iii) All account creation, modification, disabling, and termination\nactions.\n\n    Organizations may define additional events requiring continuous or ad hoc\nauditing.",
      "descriptions": {
        "default": "Without the capability to generate audit records, it would be\ndifficult to establish, correlate, and investigate the events relating to an\nincident or identify those responsible for one.\n\n    Audit records can be generated from various components within the DBMS\n(e.g., process, module). Certain specific application functionalities may be\naudited as well. The list of audited events is the set of events for which\naudits are to be generated. This set of events is typically a subset of the\nlist of all events for which the system is capable of generating audit records.\n\n    DoD has defined the list of events for which the DBMS will provide an audit\nrecord generation capability as the following:\n\n    (i) Successful and unsuccessful attempts to access, modify, or delete\nprivileges, security objects, security levels, or categories of information\n(e.g., classification levels);\n\n    (ii) Access actions, such as successful and unsuccessful logon attempts,\nprivileged activities, or other system-level access, starting and ending time\nfor user access to the system, concurrent logons from different workstations,\nsuccessful and unsuccessful accesses to objects, all program initiations, and\nall direct access to the information system; and\n\n    (iii) All account creation, modification, disabling, and termination\nactions.\n\n    Organizations may define additional events requiring continuous or ad hoc\nauditing.",
        "check": "At the command prompt, execute the following command:\n\n# grep '^\\s*log_line_prefix\\b' /storage/db/vpostgres/postgresql.conf\n\nIf \"log_line_prefix\" is not set to \"%m %d %u %r %p %l %c \", this is a\nfinding:",
        "fix": "At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET\nlog_line_prefix TO '%m %d %u %r %p %l %c ';\"\n\n/opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT\npg_reload_conf();\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "postgres",
        "gtitle": "SRG-APP-000089-DB-000064",
        "gid": null,
        "rid": "VCPG-67-000002",
        "stig_id": "VCPG-67-000002",
        "cci": "CCI-000169",
        "nist": [
          "AU-12 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCPG-67-000002\" do\n  title \"vPostgres database log file data must contain required data elements.\"\n  desc  \"Without the capability to generate audit records, it would be\ndifficult to establish, correlate, and investigate the events relating to an\nincident or identify those responsible for one.\n\n    Audit records can be generated from various components within the DBMS\n(e.g., process, module). Certain specific application functionalities may be\naudited as well. The list of audited events is the set of events for which\naudits are to be generated. This set of events is typically a subset of the\nlist of all events for which the system is capable of generating audit records.\n\n    DoD has defined the list of events for which the DBMS will provide an audit\nrecord generation capability as the following:\n\n    (i) Successful and unsuccessful attempts to access, modify, or delete\nprivileges, security objects, security levels, or categories of information\n(e.g., classification levels);\n\n    (ii) Access actions, such as successful and unsuccessful logon attempts,\nprivileged activities, or other system-level access, starting and ending time\nfor user access to the system, concurrent logons from different workstations,\nsuccessful and unsuccessful accesses to objects, all program initiations, and\nall direct access to the information system; and\n\n    (iii) All account creation, modification, disabling, and termination\nactions.\n\n    Organizations may define additional events requiring continuous or ad hoc\nauditing.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"postgres\"\n  tag gtitle: \"SRG-APP-000089-DB-000064\"\n  tag gid: nil\n  tag rid: \"VCPG-67-000002\"\n  tag stig_id: \"VCPG-67-000002\"\n  tag cci: \"CCI-000169\"\n  tag nist: [\"AU-12 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep '^\\\\s*log_line_prefix\\\\b' /storage/db/vpostgres/postgresql.conf\n\nIf \\\"log_line_prefix\\\" is not set to \\\"%m %d %u %r %p %l %c \\\", this is a\nfinding:\n \"\n  desc 'fix', \"At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"ALTER SYSTEM SET\nlog_line_prefix TO '%m %d %u %r %p %l %c ';\\\"\n\n/opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"SELECT\npg_reload_conf();\\\"\n\"\n\n  describe parse_config_file('/storage/db/vpostgres/postgresql.conf') do\n    its('log_line_prefix') { should eq \"'%m %d %u %r %p %l %c '\" }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000002.rb",
        "line": 1
      },
      "id": "VCPG-67-000002"
    },
    {
      "title": "vPostgres database must have log_truncate_on_rotation enabled.",
      "desc": "It is critical that when the DBMS is at risk of failing to process\naudit logs as required, it take action to mitigate the failure. Audit\nprocessing failures include: software/hardware errors; failures in the audit\ncapturing mechanisms; and audit storage capacity being reached or exceeded.\nResponses to audit failure depend upon the nature of the failure mode.\n\n    When availability is an overriding concern, approved actions in response to\nan audit failure are as follows:\n\n    (i) If the failure was caused by the lack of audit record storage capacity,\nthe DBMS must continue generating audit records, if possible (automatically\nrestarting the audit service if necessary), overwriting the oldest audit\nrecords in a first-in-first-out manner.\n\n    (ii) If audit records are sent to a centralized collection server and\ncommunication with this server is lost or the server fails, the DBMS must queue\naudit records locally until communication is restored or until the audit\nrecords are retrieved manually. Upon restoration of the connection to the\ncentralized collection server, action should be taken to synchronize the local\naudit data with the collection server.\n\n    Systems where availability is paramount will most likely be MAC I; the\nfinal determination is the prerogative of the application owner, subject to\nAuthorizing Official concurrence. In any case, sufficient auditing resources\nmust be allocated to avoid audit data loss in all but the most extreme\nsituations.",
      "descriptions": {
        "default": "It is critical that when the DBMS is at risk of failing to process\naudit logs as required, it take action to mitigate the failure. Audit\nprocessing failures include: software/hardware errors; failures in the audit\ncapturing mechanisms; and audit storage capacity being reached or exceeded.\nResponses to audit failure depend upon the nature of the failure mode.\n\n    When availability is an overriding concern, approved actions in response to\nan audit failure are as follows:\n\n    (i) If the failure was caused by the lack of audit record storage capacity,\nthe DBMS must continue generating audit records, if possible (automatically\nrestarting the audit service if necessary), overwriting the oldest audit\nrecords in a first-in-first-out manner.\n\n    (ii) If audit records are sent to a centralized collection server and\ncommunication with this server is lost or the server fails, the DBMS must queue\naudit records locally until communication is restored or until the audit\nrecords are retrieved manually. Upon restoration of the connection to the\ncentralized collection server, action should be taken to synchronize the local\naudit data with the collection server.\n\n    Systems where availability is paramount will most likely be MAC I; the\nfinal determination is the prerogative of the application owner, subject to\nAuthorizing Official concurrence. In any case, sufficient auditing resources\nmust be allocated to avoid audit data loss in all but the most extreme\nsituations.",
        "check": "At the command prompt, execute the following command:\n\n# grep '^\\s*log_truncate_on_rotation\\b' /storage/db/vpostgres/postgresql.conf\n\nIf \"log_truncate_on_rotation\" is not set to \"on\", this is a finding.",
        "fix": "At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET\nlog_truncate_on_rotation TO 'on';\"\n\n/opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT\npg_reload_conf();\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "postgres",
        "gtitle": "SRG-APP-000109-DB-000321",
        "gid": null,
        "rid": "VCPG-67-000004",
        "stig_id": "VCPG-67-000004",
        "cci": "CCI-000140",
        "nist": [
          "AU-5 b",
          "Rev_4"
        ]
      },
      "code": "control \"VCPG-67-000004\" do\n  title \"vPostgres database must have log_truncate_on_rotation enabled.\"\n  desc  \"It is critical that when the DBMS is at risk of failing to process\naudit logs as required, it take action to mitigate the failure. Audit\nprocessing failures include: software/hardware errors; failures in the audit\ncapturing mechanisms; and audit storage capacity being reached or exceeded.\nResponses to audit failure depend upon the nature of the failure mode.\n\n    When availability is an overriding concern, approved actions in response to\nan audit failure are as follows:\n\n    (i) If the failure was caused by the lack of audit record storage capacity,\nthe DBMS must continue generating audit records, if possible (automatically\nrestarting the audit service if necessary), overwriting the oldest audit\nrecords in a first-in-first-out manner.\n\n    (ii) If audit records are sent to a centralized collection server and\ncommunication with this server is lost or the server fails, the DBMS must queue\naudit records locally until communication is restored or until the audit\nrecords are retrieved manually. Upon restoration of the connection to the\ncentralized collection server, action should be taken to synchronize the local\naudit data with the collection server.\n\n    Systems where availability is paramount will most likely be MAC I; the\nfinal determination is the prerogative of the application owner, subject to\nAuthorizing Official concurrence. In any case, sufficient auditing resources\nmust be allocated to avoid audit data loss in all but the most extreme\nsituations.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"postgres\"\n  tag gtitle: \"SRG-APP-000109-DB-000321\"\n  tag gid: nil\n  tag rid: \"VCPG-67-000004\"\n  tag stig_id: \"VCPG-67-000004\"\n  tag cci: \"CCI-000140\"\n  tag nist: [\"AU-5 b\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep '^\\\\s*log_truncate_on_rotation\\\\b' /storage/db/vpostgres/postgresql.conf\n\nIf \\\"log_truncate_on_rotation\\\" is not set to \\\"on\\\", this is a finding.\"\n  desc 'fix', \"At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"ALTER SYSTEM SET\nlog_truncate_on_rotation TO 'on';\\\"\n\n/opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"SELECT\npg_reload_conf();\\\"\"\n\n  describe parse_config_file('/storage/db/vpostgres/postgresql.conf') do\n    its('log_truncate_on_rotation') { should eq \"on\" }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000004.rb",
        "line": 1
      },
      "id": "VCPG-67-000004"
    },
    {
      "title": "The vPostgres database must set log_connections to on.",
      "desc": "For completeness of forensic analysis, it is necessary to track\nwho/what (a user or other principal) logs on to the DBMS.",
      "descriptions": {
        "default": "For completeness of forensic analysis, it is necessary to track\nwho/what (a user or other principal) logs on to the DBMS.",
        "check": "At the command prompt, execute the following command:\n\n# grep '^log_connections' /storage/db/vpostgres/postgresql.conf\n\nIf log_connections is not on, this is a finding.",
        "fix": "At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET\nlog_connections TO 'on';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT\npg_reload_conf();\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "postgres",
        "gtitle": "SRG-APP-000503-DB-000350",
        "gid": null,
        "rid": "VCPG-67-000026",
        "stig_id": "VCPG-67-000026",
        "cci": "CCI-000172",
        "nist": [
          "AU-12 c",
          "Rev_4"
        ]
      },
      "code": "control \"VCPG-67-000026\" do\n  title \"The vPostgres database must set log_connections to on.\"\n  desc  \"For completeness of forensic analysis, it is necessary to track\nwho/what (a user or other principal) logs on to the DBMS.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"postgres\"\n  tag gtitle: \"SRG-APP-000503-DB-000350\"\n  tag gid: nil\n  tag rid: \"VCPG-67-000026\"\n  tag stig_id: \"VCPG-67-000026\"\n  tag cci: \"CCI-000172\"\n  tag nist: [\"AU-12 c\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep '^log_connections' /storage/db/vpostgres/postgresql.conf\n\nIf log_connections is not on, this is a finding.\"\n  desc 'fix', \"At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"ALTER SYSTEM SET\nlog_connections TO 'on';\\\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"SELECT\npg_reload_conf();\\\"\"\n\n  describe parse_config_file('/storage/db/vpostgres/postgresql.conf') do\n    its('log_connections') { should cmp \"on\" }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000026.rb",
        "line": 1
      },
      "id": "VCPG-67-000026"
    },
    {
      "title": "The vPostgres database must limit modify privileges to authorized\naccounts.",
      "desc": "If the DBMS were to allow any user to make changes to database\nstructure or logic, then those changes might be implemented without undergoing\nthe appropriate testing and approvals that are part of a robust change\nmanagement process.\n\n    Accordingly, only qualified and authorized individuals shall be allowed to\nobtain access to information system components for purposes of initiating\nchanges, including upgrades and modifications.\n\n    Unmanaged changes that occur to the database software libraries or\nconfiguration can lead to unauthorized or compromised installations.",
      "descriptions": {
        "default": "If the DBMS were to allow any user to make changes to database\nstructure or logic, then those changes might be implemented without undergoing\nthe appropriate testing and approvals that are part of a robust change\nmanagement process.\n\n    Accordingly, only qualified and authorized individuals shall be allowed to\nobtain access to information system components for purposes of initiating\nchanges, including upgrades and modifications.\n\n    Unmanaged changes that occur to the database software libraries or\nconfiguration can lead to unauthorized or compromised installations.",
        "check": "At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"\\du;\"|grep\n\"Create\"\n\nIf the accounts other than \"postgres\" and \"vc\" have \"create\" privileges,\nthis is a finding.",
        "fix": "At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"REVOKE ALL PRIVILEGES\nFROM <user>;\"\n\nReplace <user> with the account discovered during the check."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "postgres",
        "gtitle": "SRG-APP-000133-DB-000362",
        "gid": null,
        "rid": "VCPG-67-000009",
        "stig_id": "VCPG-67-000009",
        "cci": "CCI-001499",
        "nist": [
          "CM-5 (6)",
          "Rev_4"
        ]
      },
      "code": "control \"VCPG-67-000009\" do\n  title \"The vPostgres database must limit modify privileges to authorized\naccounts.\"\n  desc  \"If the DBMS were to allow any user to make changes to database\nstructure or logic, then those changes might be implemented without undergoing\nthe appropriate testing and approvals that are part of a robust change\nmanagement process.\n\n    Accordingly, only qualified and authorized individuals shall be allowed to\nobtain access to information system components for purposes of initiating\nchanges, including upgrades and modifications.\n\n    Unmanaged changes that occur to the database software libraries or\nconfiguration can lead to unauthorized or compromised installations.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"postgres\"\n  tag gtitle: \"SRG-APP-000133-DB-000362\"\n  tag gid: nil\n  tag rid: \"VCPG-67-000009\"\n  tag stig_id: \"VCPG-67-000009\"\n  tag cci: \"CCI-001499\"\n  tag nist: [\"CM-5 (6)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"\\\\du;\\\"|grep\n\\\"Create\\\"\n\nIf the accounts other than \\\"postgres\\\" and \\\"vc\\\" have \\\"create\\\" privileges,\nthis is a finding.\"\n  desc 'fix', \"At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"REVOKE ALL PRIVILEGES\nFROM <user>;\\\"\n\nReplace <user> with the account discovered during the check.\"\n\n  describe postgres_session('postgres','','localhost').query(\"SELECT * FROM pg_roles WHERE rolcreatedb = \\'t\\' or rolcreaterole = \\'t\\';\") do\n    its('output.strip') { should match /^postgres.*$/ }\n    its('output.strip') { should match /^vc.*$/ }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000009.rb",
        "line": 1
      },
      "id": "VCPG-67-000009"
    },
    {
      "title": "The vPostgres database must have log collection enabled.",
      "desc": "Without the ability to centrally manage the content captured in the\naudit records, identification, troubleshooting, and correlation of suspicious\nbehavior would be difficult and could lead to a delayed or incomplete analysis\nof an ongoing attack.\n\n    The content captured in audit records must be managed from a central\nlocation (necessitating automation). Centralized management of audit records\nand logs provides for efficiency in maintenance and management of records, as\nwell as the backup and archiving of those records.\n\n    The DBMS may write audit records to database tables, to files in the file\nsystem, to other kinds of local repository, or directly to a centralized log\nmanagement system. Whatever the method used, it must be compatible with\noff-loading the records to the centralized system.",
      "descriptions": {
        "default": "Without the ability to centrally manage the content captured in the\naudit records, identification, troubleshooting, and correlation of suspicious\nbehavior would be difficult and could lead to a delayed or incomplete analysis\nof an ongoing attack.\n\n    The content captured in audit records must be managed from a central\nlocation (necessitating automation). Centralized management of audit records\nand logs provides for efficiency in maintenance and management of records, as\nwell as the backup and archiving of those records.\n\n    The DBMS may write audit records to database tables, to files in the file\nsystem, to other kinds of local repository, or directly to a centralized log\nmanagement system. Whatever the method used, it must be compatible with\noff-loading the records to the centralized system.",
        "check": "At the command prompt, execute the following command:\n\n# grep '^\\s*logging_collector\\b' /storage/db/vpostgres/postgresql.conf\n\nIf \"logging_collector\" is not \"on\", this is a finding.",
        "fix": "At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET\nlogging_collector TO 'on';\"\n\n/opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT\npg_reload_conf();\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "postgres",
        "gtitle": "SRG-APP-000356-DB-000314",
        "gid": null,
        "rid": "VCPG-67-000020",
        "stig_id": "VCPG-67-000020",
        "cci": "CCI-001844",
        "nist": [
          "AU-3 (2)",
          "Rev_4"
        ]
      },
      "code": "control \"VCPG-67-000020\" do\n  title \"The vPostgres database must have log collection enabled.\"\n  desc  \"Without the ability to centrally manage the content captured in the\naudit records, identification, troubleshooting, and correlation of suspicious\nbehavior would be difficult and could lead to a delayed or incomplete analysis\nof an ongoing attack.\n\n    The content captured in audit records must be managed from a central\nlocation (necessitating automation). Centralized management of audit records\nand logs provides for efficiency in maintenance and management of records, as\nwell as the backup and archiving of those records.\n\n    The DBMS may write audit records to database tables, to files in the file\nsystem, to other kinds of local repository, or directly to a centralized log\nmanagement system. Whatever the method used, it must be compatible with\noff-loading the records to the centralized system.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"postgres\"\n  tag gtitle: \"SRG-APP-000356-DB-000314\"\n  tag gid: nil\n  tag rid: \"VCPG-67-000020\"\n  tag stig_id: \"VCPG-67-000020\"\n  tag cci: \"CCI-001844\"\n  tag nist: [\"AU-3 (2)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep '^\\\\s*logging_collector\\\\b' /storage/db/vpostgres/postgresql.conf\n\nIf \\\"logging_collector\\\" is not \\\"on\\\", this is a finding.\"\n  desc 'fix', \"At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"ALTER SYSTEM SET\nlogging_collector TO 'on';\\\"\n\n/opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"SELECT\npg_reload_conf();\\\"\"\n\n  describe parse_config_file('/storage/db/vpostgres/postgresql.conf') do\n    its('logging_collector') { should cmp \"on\" }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000020.rb",
        "line": 1
      },
      "id": "VCPG-67-000020"
    },
    {
      "title": "The vPostgres configuration file must not be accessible by\nunauthorized users.",
      "desc": "Without the capability to restrict which roles and individuals can\nselect which events are audited, unauthorized personnel may be able to prevent\nor interfere with the auditing of critical events.\n\n    Suppression of auditing could permit an adversary to evade detection.\n\n    Misconfigured audits can degrade the system's performance by overwhelming\nthe audit log. Misconfigured audits may also make it more difficult to\nestablish, correlate, and investigate the events relating to an incident or\nidentify those responsible for one.",
      "descriptions": {
        "default": "Without the capability to restrict which roles and individuals can\nselect which events are audited, unauthorized personnel may be able to prevent\nor interfere with the auditing of critical events.\n\n    Suppression of auditing could permit an adversary to evade detection.\n\n    Misconfigured audits can degrade the system's performance by overwhelming\nthe audit log. Misconfigured audits may also make it more difficult to\nestablish, correlate, and investigate the events relating to an incident or\nidentify those responsible for one.",
        "check": "At the command prompt, enter the following command:\n\n# stat -c \"%n permissions are %a\" /storage/db/vpostgres/*conf*\n\nIf the permissions on any of the listed files are not \"600\", this is a\nfinding.",
        "fix": "At the command prompt, enter the following command:\n\n# chmod 600 <file>\n\nNote: Replace <file> with the file with incorrect permissions."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "postgres",
        "gtitle": "SRG-APP-000090-DB-000065",
        "gid": null,
        "rid": "VCPG-67-000003",
        "stig_id": "VCPG-67-000003",
        "cci": "CCI-000171",
        "nist": [
          "AU-12 b",
          "Rev_4"
        ]
      },
      "code": "control \"VCPG-67-000003\" do\n  title \"The vPostgres configuration file must not be accessible by\nunauthorized users.\"\n  desc  \"Without the capability to restrict which roles and individuals can\nselect which events are audited, unauthorized personnel may be able to prevent\nor interfere with the auditing of critical events.\n\n    Suppression of auditing could permit an adversary to evade detection.\n\n    Misconfigured audits can degrade the system's performance by overwhelming\nthe audit log. Misconfigured audits may also make it more difficult to\nestablish, correlate, and investigate the events relating to an incident or\nidentify those responsible for one.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"postgres\"\n  tag gtitle: \"SRG-APP-000090-DB-000065\"\n  tag gid: nil\n  tag rid: \"VCPG-67-000003\"\n  tag stig_id: \"VCPG-67-000003\"\n  tag cci: \"CCI-000171\"\n  tag nist: [\"AU-12 b\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, enter the following command:\n\n# stat -c \\\"%n permissions are %a\\\" /storage/db/vpostgres/*conf*\n\nIf the permissions on any of the listed files are not \\\"600\\\", this is a\nfinding.\"\n  desc 'fix', \"At the command prompt, enter the following command:\n\n# chmod 600 <file>\n\nNote: Replace <file> with the file with incorrect permissions.\"\n\n  command('find /storage/db/vpostgres/ -type f -maxdepth 1 -name \"*conf*\"').stdout.split.each do | fname |\n    describe file(fname) do\n      its('mode') { should cmp '0600' }\n    end\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000003.rb",
        "line": 1
      },
      "id": "VCPG-67-000003"
    },
    {
      "title": "The vPostgres database must be configured to log to stderr.",
      "desc": "In order for vPostgres logs to be successfully sent to a remote log\nmanagement system, the vPostgres deployment must log events to stderr. Those\nevents will be caputred and logged to disk where they will be picked up by\nrsyslog for shipping.",
      "descriptions": {
        "default": "In order for vPostgres logs to be successfully sent to a remote log\nmanagement system, the vPostgres deployment must log events to stderr. Those\nevents will be caputred and logged to disk where they will be picked up by\nrsyslog for shipping.",
        "check": "At the command prompt, execute the following command:\n\n# grep \"^log_destination\"  /storage/db/vpostgres/postgresql.conf\n\nIf 'log_destination' is not set to at least 'stderr', this is a finding.\n\nIf there is no output, vPostgres will default to \"stderr\", this is not a\nfinding.",
        "fix": "Navigate to and open /storage/db/vpostgres/postgresql.conf.\n\nFind and replace 'log_destination', if it exists, with the below configuration:\n\nlog_destination = 'stderr'"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "postgres",
        "gtitle": "SRG-APP-000359-DB-000319",
        "gid": null,
        "rid": "VCPG-67-000021",
        "stig_id": "VCPG-67-000021",
        "cci": "CCI-001855",
        "nist": [
          "AU-5 (1)",
          "Rev_4"
        ]
      },
      "code": "control \"VCPG-67-000021\" do\n  title \"The vPostgres database must be configured to log to stderr.\"\n  desc  \"In order for vPostgres logs to be successfully sent to a remote log\nmanagement system, the vPostgres deployment must log events to stderr. Those\nevents will be caputred and logged to disk where they will be picked up by\nrsyslog for shipping.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"postgres\"\n  tag gtitle: \"SRG-APP-000359-DB-000319\"\n  tag gid: nil\n  tag rid: \"VCPG-67-000021\"\n  tag stig_id: \"VCPG-67-000021\"\n  tag cci: \"CCI-001855\"\n  tag nist: [\"AU-5 (1)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep \\\"^log_destination\\\"  /storage/db/vpostgres/postgresql.conf\n\nIf 'log_destination' is not set to at least 'stderr', this is a finding.\n\nIf there is no output, vPostgres will default to \\\"stderr\\\", this is not a\nfinding.\"\n  desc 'fix', \"Navigate to and open /storage/db/vpostgres/postgresql.conf.\n\nFind and replace 'log_destination', if it exists, with the below configuration:\n\nlog_destination = 'stderr'\"\n\n  describe.one do\n    describe parse_config_file('/storage/db/vpostgres/postgresql.conf') do\n      its('log_destination') { should cmp nil }\n    end\n    describe parse_config_file('/storage/db/vpostgres/postgresql.conf') do\n      its('log_destination') { should cmp \"stderr\" }\n    end\n    describe parse_config_file('/storage/db/vpostgres/postgresql.conf') do\n      its('log_destination') { should cmp \"'stderr'\" }\n    end\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000021.rb",
        "line": 1
      },
      "id": "VCPG-67-000021"
    },
    {
      "title": "The vPostgres database must have the correct ownership on the log\nfiles.",
      "desc": "If audit data were to become compromised, then competent forensic\nanalysis and discovery of the true source of potentially malicious system\nactivity is impossible to achieve.\n\n    To ensure the veracity of audit data the information system and/or the\napplication must protect audit information from unauthorized modification.\n\n    This requirement can be achieved through multiple methods that will depend\nupon system architecture and design. Some commonly employed methods include\nensuring log files enjoy the proper file system permissions and limiting log\ndata locations.\n\n    Applications providing a user interface to audit data will leverage user\npermissions and roles identifying the user accessing the data and the\ncorresponding rights that the user enjoys in order to make access decisions\nregarding the modification of audit data.\n\n    Audit information includes all information (e.g., audit records, audit\nsettings, and audit reports) needed to successfully audit information system\nactivity.\n\n    Modification of database audit data could mask the theft of, or the\nunauthorized modification of, sensitive data stored in the database.",
      "descriptions": {
        "default": "If audit data were to become compromised, then competent forensic\nanalysis and discovery of the true source of potentially malicious system\nactivity is impossible to achieve.\n\n    To ensure the veracity of audit data the information system and/or the\napplication must protect audit information from unauthorized modification.\n\n    This requirement can be achieved through multiple methods that will depend\nupon system architecture and design. Some commonly employed methods include\nensuring log files enjoy the proper file system permissions and limiting log\ndata locations.\n\n    Applications providing a user interface to audit data will leverage user\npermissions and roles identifying the user accessing the data and the\ncorresponding rights that the user enjoys in order to make access decisions\nregarding the modification of audit data.\n\n    Audit information includes all information (e.g., audit records, audit\nsettings, and audit reports) needed to successfully audit information system\nactivity.\n\n    Modification of database audit data could mask the theft of, or the\nunauthorized modification of, sensitive data stored in the database.",
        "check": "At the command prompt, enter the following command:\n\n# stat -c \"%n is owned by %U:%G\" /var/log/vmware/vpostgres/*.log\n\nIf the ownership of any log files is not \"vpostgres:users\", this is a finding",
        "fix": "At the command prompt, enter the following command:\n\n# chown vpostgres:users <file_name>\n\nReplace <file_name> with files to be modified"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "postgres",
        "gtitle": "SRG-APP-000119-DB-000060",
        "gid": null,
        "rid": "VCPG-67-000006",
        "stig_id": "VCPG-67-000006",
        "cci": "CCI-000163",
        "nist": [
          "AU-9",
          "Rev_4"
        ]
      },
      "code": "control \"VCPG-67-000006\" do\n  title \"The vPostgres database must have the correct ownership on the log\nfiles.\"\n  desc  \"If audit data were to become compromised, then competent forensic\nanalysis and discovery of the true source of potentially malicious system\nactivity is impossible to achieve.\n\n    To ensure the veracity of audit data the information system and/or the\napplication must protect audit information from unauthorized modification.\n\n    This requirement can be achieved through multiple methods that will depend\nupon system architecture and design. Some commonly employed methods include\nensuring log files enjoy the proper file system permissions and limiting log\ndata locations.\n\n    Applications providing a user interface to audit data will leverage user\npermissions and roles identifying the user accessing the data and the\ncorresponding rights that the user enjoys in order to make access decisions\nregarding the modification of audit data.\n\n    Audit information includes all information (e.g., audit records, audit\nsettings, and audit reports) needed to successfully audit information system\nactivity.\n\n    Modification of database audit data could mask the theft of, or the\nunauthorized modification of, sensitive data stored in the database.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"postgres\"\n  tag gtitle: \"SRG-APP-000119-DB-000060\"\n  tag gid: nil\n  tag rid: \"VCPG-67-000006\"\n  tag stig_id: \"VCPG-67-000006\"\n  tag cci: \"CCI-000163\"\n  tag nist: [\"AU-9\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, enter the following command:\n\n# stat -c \\\"%n is owned by %U:%G\\\" /var/log/vmware/vpostgres/*.log\n\nIf the ownership of any log files is not \\\"vpostgres:users\\\", this is a finding\"\n  desc 'fix', \"At the command prompt, enter the following command:\n\n# chown vpostgres:users <file_name>\n\nReplace <file_name> with files to be modified\"\n\n  command('find /var/log/vmware/vpostgres/ -type f -maxdepth 1 -name \"*\"').stdout.split.each do | fname |\n    describe file(fname) do\n      its('owner') { should cmp 'vpostgres' }\n      its('group') { should cmp 'users' }\n    end\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000006.rb",
        "line": 1
      },
      "id": "VCPG-67-000006"
    },
    {
      "title": "The vPostgres database must enforce authorized access to all PKI\nprivate keys stored/utilized by the DBMS.",
      "desc": "The DoD standard for authentication is DoD-approved PKI certificates.\nPKI certificate-based authentication is performed by requiring the certificate\nholder to cryptographically prove possession of the corresponding private key.\n\n    If the private key is stolen, an attacker can use the private key(s) to\nimpersonate the certificate holder.  In cases where the DBMS-stored private\nkeys are used to authenticate the DBMS to the system’s clients, loss\nof the corresponding private keys would allow an attacker to successfully\nperform undetected man in the middle attacks against the DBMS system and its\nclients.\n\n    Both the holder of a digital certificate and the issuing authority must\ntake careful measures to protect the corresponding private key. Private keys\nshould always be generated and protected in FIPS 140-2 validated cryptographic\nmodules.\n\n    All access to the private key(s) of the DBMS must be restricted to\nauthorized and authenticated users. If unauthorized users have access to one or\nmore of the DBMS's private keys, an attacker could gain access to the key(s)\nand use them to impersonate the database on the network or otherwise perform\nunauthorized actions.",
      "descriptions": {
        "default": "The DoD standard for authentication is DoD-approved PKI certificates.\nPKI certificate-based authentication is performed by requiring the certificate\nholder to cryptographically prove possession of the corresponding private key.\n\n    If the private key is stolen, an attacker can use the private key(s) to\nimpersonate the certificate holder.  In cases where the DBMS-stored private\nkeys are used to authenticate the DBMS to the system’s clients, loss\nof the corresponding private keys would allow an attacker to successfully\nperform undetected man in the middle attacks against the DBMS system and its\nclients.\n\n    Both the holder of a digital certificate and the issuing authority must\ntake careful measures to protect the corresponding private key. Private keys\nshould always be generated and protected in FIPS 140-2 validated cryptographic\nmodules.\n\n    All access to the private key(s) of the DBMS must be restricted to\nauthorized and authenticated users. If unauthorized users have access to one or\nmore of the DBMS's private keys, an attacker could gain access to the key(s)\nand use them to impersonate the database on the network or otherwise perform\nunauthorized actions.",
        "check": "At the command prompt, execute the following command:\n\n# stat -c \"%n permissions are %a\" /storage/db/vpostgres_ssl/server.key\n\nIf the permissions on server.key are not 600, this is a finding.",
        "fix": "At the command prompt, execute the following commands:\n\n# chmod 600 /storage/db/vpostgres_ssl/server.key"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "postgres",
        "gtitle": "SRG-APP-000176-DB-000068",
        "gid": null,
        "rid": "VCPG-67-000014",
        "stig_id": "VCPG-67-000014",
        "cci": "CCI-000186",
        "nist": [
          "IA-5 (2) (b)",
          "Rev_4"
        ]
      },
      "code": "control \"VCPG-67-000014\" do\n  title \"The vPostgres database must enforce authorized access to all PKI\nprivate keys stored/utilized by the DBMS.\"\n  desc  \"The DoD standard for authentication is DoD-approved PKI certificates.\nPKI certificate-based authentication is performed by requiring the certificate\nholder to cryptographically prove possession of the corresponding private key.\n\n    If the private key is stolen, an attacker can use the private key(s) to\nimpersonate the certificate holder.  In cases where the DBMS-stored private\nkeys are used to authenticate the DBMS to the system\\xE2\\x80\\x99s clients, loss\nof the corresponding private keys would allow an attacker to successfully\nperform undetected man in the middle attacks against the DBMS system and its\nclients.\n\n    Both the holder of a digital certificate and the issuing authority must\ntake careful measures to protect the corresponding private key. Private keys\nshould always be generated and protected in FIPS 140-2 validated cryptographic\nmodules.\n\n    All access to the private key(s) of the DBMS must be restricted to\nauthorized and authenticated users. If unauthorized users have access to one or\nmore of the DBMS's private keys, an attacker could gain access to the key(s)\nand use them to impersonate the database on the network or otherwise perform\nunauthorized actions.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"postgres\"\n  tag gtitle: \"SRG-APP-000176-DB-000068\"\n  tag gid: nil\n  tag rid: \"VCPG-67-000014\"\n  tag stig_id: \"VCPG-67-000014\"\n  tag cci: \"CCI-000186\"\n  tag nist: [\"IA-5 (2) (b)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# stat -c \\\"%n permissions are %a\\\" /storage/db/vpostgres_ssl/server.key\n\nIf the permissions on server.key are not 600, this is a finding.\"\n  desc 'fix', \"At the command prompt, execute the following commands:\n\n# chmod 600 /storage/db/vpostgres_ssl/server.key\"\n\n  describe file('/storage/db/vpostgres_ssl/server.key') do\n    its('mode') { should cmp '0600' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000014.rb",
        "line": 1
      },
      "id": "VCPG-67-000014"
    },
    {
      "title": "The vPostgres database must be limited to authorized accounts.",
      "desc": "To assure accountability and prevent unauthenticated access,\norganizational users must be identified and authenticated to prevent potential\nmisuse and compromise of the system.\n\n    Organizational users include organizational employees or individuals the\norganization deems to have equivalent status of employees (e.g., contractors).\nOrganizational users (and any processes acting on behalf of users) must be\nuniquely identified and authenticated for all accesses, except the following:\n\n    (i) Accesses explicitly identified and documented by the organization.\nOrganizations document specific user actions that can be performed on the\ninformation system without identification or authentication; and\n\n    (ii) Accesses that occur through authorized use of group authenticators\nwithout individual authentication. Organizations may require unique\nidentification of individuals in group accounts (e.g., shared privilege\naccounts) or for detailed accountability of individual activity.",
      "descriptions": {
        "default": "To assure accountability and prevent unauthenticated access,\norganizational users must be identified and authenticated to prevent potential\nmisuse and compromise of the system.\n\n    Organizational users include organizational employees or individuals the\norganization deems to have equivalent status of employees (e.g., contractors).\nOrganizational users (and any processes acting on behalf of users) must be\nuniquely identified and authenticated for all accesses, except the following:\n\n    (i) Accesses explicitly identified and documented by the organization.\nOrganizations document specific user actions that can be performed on the\ninformation system without identification or authentication; and\n\n    (ii) Accesses that occur through authorized use of group authenticators\nwithout individual authentication. Organizations may require unique\nidentification of individuals in group accounts (e.g., shared privilege\naccounts) or for detailed accountability of individual activity.",
        "check": "At the command prompt, execute the following command to enter the\npsql prompt:\n\n# grep -v \"^#\" /storage/db/vpostgres/pg_hba.conf|grep -z --color=always\n\"trust\"\n\nIf any rows have \"trust\" specified for the \"METHOD\" column, this is a\nfinding.",
        "fix": "Navigate to and open /storage/db/pgdata/pg_hba.conf.\n\nNavigate to the user that has a method of \"trust\".\nChange the method to \"md5\".\n\nA correct, typical line will look like the below:\n# TYPE  DATABASE        USER            ADDRESS                 METHOD\nhost       all                        all                 127.0.0.1/32\n md5"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "postgres",
        "gtitle": "SRG-APP-000148-DB-000103",
        "gid": null,
        "rid": "VCPG-67-000012",
        "stig_id": "VCPG-67-000012",
        "cci": "CCI-000764",
        "nist": [
          "IA-2",
          "Rev_4"
        ]
      },
      "code": "control \"VCPG-67-000012\" do\n  title \"The vPostgres database must be limited to authorized accounts.\"\n  desc  \"To assure accountability and prevent unauthenticated access,\norganizational users must be identified and authenticated to prevent potential\nmisuse and compromise of the system.\n\n    Organizational users include organizational employees or individuals the\norganization deems to have equivalent status of employees (e.g., contractors).\nOrganizational users (and any processes acting on behalf of users) must be\nuniquely identified and authenticated for all accesses, except the following:\n\n    (i) Accesses explicitly identified and documented by the organization.\nOrganizations document specific user actions that can be performed on the\ninformation system without identification or authentication; and\n\n    (ii) Accesses that occur through authorized use of group authenticators\nwithout individual authentication. Organizations may require unique\nidentification of individuals in group accounts (e.g., shared privilege\naccounts) or for detailed accountability of individual activity.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"postgres\"\n  tag gtitle: \"SRG-APP-000148-DB-000103\"\n  tag gid: nil\n  tag rid: \"VCPG-67-000012\"\n  tag stig_id: \"VCPG-67-000012\"\n  tag cci: \"CCI-000764\"\n  tag nist: [\"IA-2\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command to enter the\npsql prompt:\n\n# grep -v \\\"^#\\\" /storage/db/vpostgres/pg_hba.conf|grep -z --color=always\n\\\"trust\\\"\n\nIf any rows have \\\"trust\\\" specified for the \\\"METHOD\\\" column, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open /storage/db/pgdata/pg_hba.conf.\n\nNavigate to the user that has a method of \\\"trust\\\".\nChange the method to \\\"md5\\\".\n\nA correct, typical line will look like the below:\n# TYPE  DATABASE        USER            ADDRESS                 METHOD\nhost       all                        all                 127.0.0.1/32\n md5\"\n\n  describe postgres_hba_conf('/storage/db/vpostgres/pg_hba.conf').where {type == 'local'} do\n    its ('auth_method') { should_not include 'trust' }\n  end\n\n  describe postgres_hba_conf('/storage/db/vpostgres/pg_hba.conf').where {type == 'host'} do\n    its ('auth_method') { should_not include 'trust' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000012.rb",
        "line": 1
      },
      "id": "VCPG-67-000012"
    },
    {
      "title": "vPostgres must limit the number of connections.",
      "desc": "Database management includes the ability to control the number of\nusers and user sessions utilizing a DBMS. Unlimited concurrent connections to\nthe DBMS could allow a successful Denial of Service (DoS) attack by exhausting\nconnection resources; and a system can also fail or be degraded by an overload\nof legitimate users. Limiting the number of concurrent sessions per user is\nhelpful in reducing these risks.\n\n    This requirement addresses concurrent session control for a single account.\nIt does not address concurrent sessions by a single user via multiple system\naccounts; and it does not deal with the total number of sessions across all\naccounts.\n\n    The capability to limit the number of concurrent sessions per user must be\nconfigured in or added to the DBMS (for example, by use of a logon trigger),\nwhen this is technically feasible. Note that it is not sufficient to limit\nsessions via a web server or application server alone, because legitimate users\nand adversaries can potentially connect to the DBMS by other means.\n\n    The organization will need to define the maximum number of concurrent\nsessions by account type, by account, or a combination thereof. In deciding on\nthe appropriate number, it is important to consider the work requirements of\nthe various types of users. For example, 2 might be an acceptable limit for\ngeneral users accessing the database via an application; but 10 might be too\nfew for a database administrator using a database management GUI tool, where\neach query tab and navigation pane may count as a separate session.\n\n    (Sessions may also be referred to as connections or logons, which for the\npurposes of this requirement are synonyms.)",
      "descriptions": {
        "default": "Database management includes the ability to control the number of\nusers and user sessions utilizing a DBMS. Unlimited concurrent connections to\nthe DBMS could allow a successful Denial of Service (DoS) attack by exhausting\nconnection resources; and a system can also fail or be degraded by an overload\nof legitimate users. Limiting the number of concurrent sessions per user is\nhelpful in reducing these risks.\n\n    This requirement addresses concurrent session control for a single account.\nIt does not address concurrent sessions by a single user via multiple system\naccounts; and it does not deal with the total number of sessions across all\naccounts.\n\n    The capability to limit the number of concurrent sessions per user must be\nconfigured in or added to the DBMS (for example, by use of a logon trigger),\nwhen this is technically feasible. Note that it is not sufficient to limit\nsessions via a web server or application server alone, because legitimate users\nand adversaries can potentially connect to the DBMS by other means.\n\n    The organization will need to define the maximum number of concurrent\nsessions by account type, by account, or a combination thereof. In deciding on\nthe appropriate number, it is important to consider the work requirements of\nthe various types of users. For example, 2 might be an acceptable limit for\ngeneral users accessing the database via an application; but 10 might be too\nfew for a database administrator using a database management GUI tool, where\neach query tab and navigation pane may count as a separate session.\n\n    (Sessions may also be referred to as connections or logons, which for the\npurposes of this requirement are synonyms.)",
        "check": "At the command prompt, execute the following command:\n\n# grep '^\\s*max_connections\\b' /storage/db/vpostgres/postgresql.conf\n\nIf \"max_connections\" is not \"100\", this is a finding.",
        "fix": "At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET\nmax_connections TO '100';\"\n\n/opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT\npg_reload_conf();\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "postgres",
        "gtitle": "SRG-APP-000001-DB-000031",
        "gid": null,
        "rid": "VCPG-67-000001",
        "stig_id": "VCPG-67-000001",
        "cci": "CCI-000054",
        "nist": [
          "AC-10",
          "Rev_4"
        ]
      },
      "code": "control \"VCPG-67-000001\" do\n  title \"vPostgres must limit the number of connections.\"\n  desc  \"Database management includes the ability to control the number of\nusers and user sessions utilizing a DBMS. Unlimited concurrent connections to\nthe DBMS could allow a successful Denial of Service (DoS) attack by exhausting\nconnection resources; and a system can also fail or be degraded by an overload\nof legitimate users. Limiting the number of concurrent sessions per user is\nhelpful in reducing these risks.\n\n    This requirement addresses concurrent session control for a single account.\nIt does not address concurrent sessions by a single user via multiple system\naccounts; and it does not deal with the total number of sessions across all\naccounts.\n\n    The capability to limit the number of concurrent sessions per user must be\nconfigured in or added to the DBMS (for example, by use of a logon trigger),\nwhen this is technically feasible. Note that it is not sufficient to limit\nsessions via a web server or application server alone, because legitimate users\nand adversaries can potentially connect to the DBMS by other means.\n\n    The organization will need to define the maximum number of concurrent\nsessions by account type, by account, or a combination thereof. In deciding on\nthe appropriate number, it is important to consider the work requirements of\nthe various types of users. For example, 2 might be an acceptable limit for\ngeneral users accessing the database via an application; but 10 might be too\nfew for a database administrator using a database management GUI tool, where\neach query tab and navigation pane may count as a separate session.\n\n    (Sessions may also be referred to as connections or logons, which for the\npurposes of this requirement are synonyms.)\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"postgres\"\n  tag gtitle: \"SRG-APP-000001-DB-000031\"\n  tag gid: nil\n  tag rid: \"VCPG-67-000001\"\n  tag stig_id: \"VCPG-67-000001\"\n  tag cci: \"CCI-000054\"\n  tag nist: [\"AC-10\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep '^\\\\s*max_connections\\\\b' /storage/db/vpostgres/postgresql.conf\n\nIf \\\"max_connections\\\" is not \\\"100\\\", this is a finding.\"\n  desc 'fix', \"At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"ALTER SYSTEM SET\nmax_connections TO '100';\\\"\n\n/opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"SELECT\npg_reload_conf();\\\"\"\n\n  #describe postgres_conf(\"#{input('postgres_conf_path')}\") do\n  describe parse_config_file('/storage/db/vpostgres/postgresql.conf') do\n    its('max_connections') { should eq \"100\" }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000001.rb",
        "line": 1
      },
      "id": "VCPG-67-000001"
    },
    {
      "title": "The vPostgres database must be configured to use ssl.",
      "desc": "The DoD standard for authentication is DoD-approved PKI certificates.\n\n    Authentication based on User ID and Password may be used only when it is\nnot possible to employ a PKI certificate, and requires AO approval.\n\n    In such cases, passwords need to be protected at all times, and encryption\nis the standard method for protecting passwords during transmission.\n\n    DBMS passwords sent in clear text format across the network are vulnerable\nto discovery by unauthorized users. Disclosure of passwords may easily lead to\nunauthorized access to the database.",
      "descriptions": {
        "default": "The DoD standard for authentication is DoD-approved PKI certificates.\n\n    Authentication based on User ID and Password may be used only when it is\nnot possible to employ a PKI certificate, and requires AO approval.\n\n    In such cases, passwords need to be protected at all times, and encryption\nis the standard method for protecting passwords during transmission.\n\n    DBMS passwords sent in clear text format across the network are vulnerable\nto discovery by unauthorized users. Disclosure of passwords may easily lead to\nunauthorized access to the database.",
        "check": "At the command prompt, execute the following command:\n\n# grep '^\\s*ssl\\b' /storage/db/vpostgres/postgresql.conf\n\nIf \"ssl\" is not \"on\", this is a finding.",
        "fix": "At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET ssl\nTO 'on';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT\npg_reload_conf();\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "postgres",
        "gtitle": "SRG-APP-000172-DB-000075",
        "gid": null,
        "rid": "VCPG-67-000013",
        "stig_id": "VCPG-67-000013",
        "cci": "CCI-000197",
        "nist": [
          "IA-5 (1) (c)",
          "Rev_4"
        ]
      },
      "code": "control \"VCPG-67-000013\" do\n  title \"The vPostgres database must be configured to use ssl.\"\n  desc  \"The DoD standard for authentication is DoD-approved PKI certificates.\n\n    Authentication based on User ID and Password may be used only when it is\nnot possible to employ a PKI certificate, and requires AO approval.\n\n    In such cases, passwords need to be protected at all times, and encryption\nis the standard method for protecting passwords during transmission.\n\n    DBMS passwords sent in clear text format across the network are vulnerable\nto discovery by unauthorized users. Disclosure of passwords may easily lead to\nunauthorized access to the database.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"postgres\"\n  tag gtitle: \"SRG-APP-000172-DB-000075\"\n  tag gid: nil\n  tag rid: \"VCPG-67-000013\"\n  tag stig_id: \"VCPG-67-000013\"\n  tag cci: \"CCI-000197\"\n  tag nist: [\"IA-5 (1) (c)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep '^\\\\s*ssl\\\\b' /storage/db/vpostgres/postgresql.conf\n\nIf \\\"ssl\\\" is not \\\"on\\\", this is a finding.\"\n  desc 'fix', \"At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"ALTER SYSTEM SET ssl\nTO 'on';\\\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"SELECT\npg_reload_conf();\\\"\"\n\n  describe parse_config_file('/storage/db/vpostgres/postgresql.conf') do\n    its('ssl') { should eq \"on\" }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000013.rb",
        "line": 1
      },
      "id": "VCPG-67-000013"
    },
    {
      "title": "The vPostgres database must complete writing log entries prior to\nreturning results.",
      "desc": "Failure to a known state can address safety or security in accordance\nwith the mission/business needs of the organization.\n\n    Failure to a known secure state helps prevent a loss of confidentiality,\nintegrity, or availability in the event of a failure of the information system\nor a component of the system.\n\n    Preserving information system state information helps to facilitate system\nrestart and return to the operational mode of the organization with less\ndisruption of mission/business processes.\n\n    Since it is usually not possible to test this capability in a production\nenvironment, systems should either be validated in a testing environment or\nprior to installation. This requirement is usually a function of the design of\nthe IDPS component. Compliance can be verified by acceptance/validation\nprocesses or vendor attestation.",
      "descriptions": {
        "default": "Failure to a known state can address safety or security in accordance\nwith the mission/business needs of the organization.\n\n    Failure to a known secure state helps prevent a loss of confidentiality,\nintegrity, or availability in the event of a failure of the information system\nor a component of the system.\n\n    Preserving information system state information helps to facilitate system\nrestart and return to the operational mode of the organization with less\ndisruption of mission/business processes.\n\n    Since it is usually not possible to test this capability in a production\nenvironment, systems should either be validated in a testing environment or\nprior to installation. This requirement is usually a function of the design of\nthe IDPS component. Compliance can be verified by acceptance/validation\nprocesses or vendor attestation.",
        "check": "At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT name,setting\nFROM pg_settings WHERE name IN\n('fsync','full_page_writes','synchronous_commit');\"\n\nIf \"fsync\", \"full_page_writes\", and \"synchronous_commit\" are not all\n\"on\", this is a finding.\n\nThe command should return the below output\n        name        | setting\n--------------------+---------\n fsync              | on\n full_page_writes   | on\n synchronous_commit | on\n(3 rows)",
        "fix": "At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET\n<name> TO 'on';\"\n\n/opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT\npg_reload_conf();\"\n\nNote: Substitute <name> with the incorrectly set parameter"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "postgres",
        "gtitle": "SRG-APP-000226-DB-000147",
        "gid": null,
        "rid": "VCPG-67-000016",
        "stig_id": "VCPG-67-000016",
        "cci": "CCI-001665",
        "nist": [
          "SC-24",
          "Rev_4"
        ]
      },
      "code": "control \"VCPG-67-000016\" do\n  title \"The vPostgres database must complete writing log entries prior to\nreturning results.\"\n  desc  \"Failure to a known state can address safety or security in accordance\nwith the mission/business needs of the organization.\n\n    Failure to a known secure state helps prevent a loss of confidentiality,\nintegrity, or availability in the event of a failure of the information system\nor a component of the system.\n\n    Preserving information system state information helps to facilitate system\nrestart and return to the operational mode of the organization with less\ndisruption of mission/business processes.\n\n    Since it is usually not possible to test this capability in a production\nenvironment, systems should either be validated in a testing environment or\nprior to installation. This requirement is usually a function of the design of\nthe IDPS component. Compliance can be verified by acceptance/validation\nprocesses or vendor attestation.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"postgres\"\n  tag gtitle: \"SRG-APP-000226-DB-000147\"\n  tag gid: nil\n  tag rid: \"VCPG-67-000016\"\n  tag stig_id: \"VCPG-67-000016\"\n  tag cci: \"CCI-001665\"\n  tag nist: [\"SC-24\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"SELECT name,setting\nFROM pg_settings WHERE name IN\n('fsync','full_page_writes','synchronous_commit');\\\"\n\nIf \\\"fsync\\\", \\\"full_page_writes\\\", and \\\"synchronous_commit\\\" are not all\n\\\"on\\\", this is a finding.\n\nThe command should return the below output\n        name        | setting\n--------------------+---------\n fsync              | on\n full_page_writes   | on\n synchronous_commit | on\n(3 rows)\"\n  desc 'fix', \"At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"ALTER SYSTEM SET\n<name> TO 'on';\\\"\n\n/opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"SELECT\npg_reload_conf();\\\"\n\nNote: Substitute <name> with the incorrectly set parameter\n\"\n\n  describe postgres_session('postgres','','localhost').query(\"SELECT name,setting FROM pg_settings WHERE name IN ('fsync','full_page_writes','synchronous_commit');\") do\n    its('output.strip') { should match /^fsync\\|on$/ }\n    its('output.strip') { should match /^full_page_writes\\|on$/ }\n    its('output.strip') { should match /^synchronous_commit\\|on$/ }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000016.rb",
        "line": 1
      },
      "id": "VCPG-67-000016"
    },
    {
      "title": "The vPostgres configuration files must have the correct ownership.",
      "desc": "Protecting audit data also includes identifying and protecting the\ntools used to view and manipulate log data. Therefore, protecting audit tools\nis necessary to prevent unauthorized operation on audit data.\n\n    Applications providing tools to interface with audit data will leverage\nuser permissions and roles identifying the user accessing the tools and the\ncorresponding rights the user enjoys in order make access decisions regarding\nthe modification of audit tools.\n\n    Audit tools include, but are not limited to, vendor-provided and open\nsource audit tools needed to successfully view and manipulate audit information\nsystem activity and records. Audit tools include custom queries and report\ngenerators.",
      "descriptions": {
        "default": "Protecting audit data also includes identifying and protecting the\ntools used to view and manipulate log data. Therefore, protecting audit tools\nis necessary to prevent unauthorized operation on audit data.\n\n    Applications providing tools to interface with audit data will leverage\nuser permissions and roles identifying the user accessing the tools and the\ncorresponding rights the user enjoys in order make access decisions regarding\nthe modification of audit tools.\n\n    Audit tools include, but are not limited to, vendor-provided and open\nsource audit tools needed to successfully view and manipulate audit information\nsystem activity and records. Audit tools include custom queries and report\ngenerators.",
        "check": "At the command prompt, enter the following command:\n\n# stat -c \"%n is owned by %U:%G\" /storage/db/vpostgres/*.conf\n\nIf the ownership of any log files is not \"vpostgres:users\", this is a finding",
        "fix": "At the command prompt, enter the following command:\n\n# chown vpostgres:users <file_name>\n\nReplace <file_name> with files to be modified"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "postgres",
        "gtitle": "SRG-APP-000122-DB-000203",
        "gid": null,
        "rid": "VCPG-67-000007",
        "stig_id": "VCPG-67-000007",
        "cci": "CCI-001494",
        "nist": [
          "AU-9",
          "Rev_4"
        ]
      },
      "code": "control \"VCPG-67-000007\" do\n  title \"The vPostgres configuration files must have the correct ownership.\"\n  desc  \"Protecting audit data also includes identifying and protecting the\ntools used to view and manipulate log data. Therefore, protecting audit tools\nis necessary to prevent unauthorized operation on audit data.\n\n    Applications providing tools to interface with audit data will leverage\nuser permissions and roles identifying the user accessing the tools and the\ncorresponding rights the user enjoys in order make access decisions regarding\nthe modification of audit tools.\n\n    Audit tools include, but are not limited to, vendor-provided and open\nsource audit tools needed to successfully view and manipulate audit information\nsystem activity and records. Audit tools include custom queries and report\ngenerators.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"postgres\"\n  tag gtitle: \"SRG-APP-000122-DB-000203\"\n  tag gid: nil\n  tag rid: \"VCPG-67-000007\"\n  tag stig_id: \"VCPG-67-000007\"\n  tag cci: \"CCI-001494\"\n  tag nist: [\"AU-9\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, enter the following command:\n\n# stat -c \\\"%n is owned by %U:%G\\\" /storage/db/vpostgres/*.conf\n\nIf the ownership of any log files is not \\\"vpostgres:users\\\", this is a finding\"\n  desc 'fix', \"At the command prompt, enter the following command:\n\n# chown vpostgres:users <file_name>\n\nReplace <file_name> with files to be modified\"\n\n  command('find /storage/db/vpostgres/ -type f -maxdepth 1 -name \"*conf*\"').stdout.split.each do | fname |\n    describe file(fname) do\n      its('owner') { should cmp 'vpostgres' }\n      its('group') { should cmp 'users' }\n    end\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000007.rb",
        "line": 1
      },
      "id": "VCPG-67-000007"
    },
    {
      "title": "vPostgres database must be configured to validate characer encoding to\nUTF-8.",
      "desc": "A common vulnerability is unplanned behavior when invalid inputs are\nreceived. This requirement guards against adverse or unintended system behavior\ncaused by invalid inputs, where information system responses to the invalid\ninput may be disruptive or cause the system to fail into an unsafe state.\n\n    The behavior will be derived from the organizational and system\nrequirements and includes, but is not limited to, notification of the\nappropriate personnel, creating an audit record, and rejecting invalid input.",
      "descriptions": {
        "default": "A common vulnerability is unplanned behavior when invalid inputs are\nreceived. This requirement guards against adverse or unintended system behavior\ncaused by invalid inputs, where information system responses to the invalid\ninput may be disruptive or cause the system to fail into an unsafe state.\n\n    The behavior will be derived from the organizational and system\nrequirements and includes, but is not limited to, notification of the\nappropriate personnel, creating an audit record, and rejecting invalid input.",
        "check": "At the command prompt, execute the following command:\n\n# grep '^\\s*client_encoding\\b' /storage/db/vpostgres/postgresql.conf\n\nIf \"client_encoding\" is not \"UTF8\", this is a finding.",
        "fix": "At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET\nclient_encoding TO 'UTF8';\"\n\n/opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT\npg_reload_conf();\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "postgres",
        "gtitle": "SRG-APP-000447-DB-000393",
        "gid": null,
        "rid": "VCPG-67-000024",
        "stig_id": "VCPG-67-000024",
        "cci": "CCI-002754",
        "nist": [
          "SI-10 (3)",
          "Rev_4"
        ]
      },
      "code": "control \"VCPG-67-000024\" do\n  title \"vPostgres database must be configured to validate characer encoding to\nUTF-8.\"\n  desc  \"A common vulnerability is unplanned behavior when invalid inputs are\nreceived. This requirement guards against adverse or unintended system behavior\ncaused by invalid inputs, where information system responses to the invalid\ninput may be disruptive or cause the system to fail into an unsafe state.\n\n    The behavior will be derived from the organizational and system\nrequirements and includes, but is not limited to, notification of the\nappropriate personnel, creating an audit record, and rejecting invalid input.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"postgres\"\n  tag gtitle: \"SRG-APP-000447-DB-000393\"\n  tag gid: nil\n  tag rid: \"VCPG-67-000024\"\n  tag stig_id: \"VCPG-67-000024\"\n  tag cci: \"CCI-002754\"\n  tag nist: [\"SI-10 (3)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep '^\\\\s*client_encoding\\\\b' /storage/db/vpostgres/postgresql.conf\n\nIf \\\"client_encoding\\\" is not \\\"UTF8\\\", this is a finding.\n \"\n  desc 'fix', \"At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"ALTER SYSTEM SET\nclient_encoding TO 'UTF8';\\\"\n\n/opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"SELECT\npg_reload_conf();\\\"\"\n\n  describe parse_config_file('/storage/db/vpostgres/postgresql.conf') do\n    its('client_encoding') { should cmp \"UTF8\" }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000024.rb",
        "line": 1
      },
      "id": "VCPG-67-000024"
    },
    {
      "title": "The DBMS must provide non-privileged users with error messages that\nprovide information necessary for corrective actions without revealing\ninformation that could be exploited by adversaries.",
      "desc": "Any DBMS or associated application providing too much information in\nerror messages on the screen or printout risks compromising the data and\nsecurity of the system. The structure and content of error messages need to be\ncarefully considered by the organization and development team.\n\n    Databases can inadvertently provide a wealth of information to an attacker\nthrough improperly handled error messages. In addition to sensitive business or\npersonal information, database errors can provide host names, IP addresses,\nuser names, and other system information not required for troubleshooting but\nvery useful to someone targeting the system.\n\n    Carefully consider the structure/content of error messages. The extent to\nwhich information systems are able to identify and handle error conditions is\nguided by organizational policy and operational requirements. Information that\ncould be exploited by adversaries includes, for example, logon attempts with\npasswords entered by mistake as the username, mission/business information that\ncan be derived from (if not stated explicitly by) information recorded, and\npersonal information, such as account numbers, social security numbers, and\ncredit card numbers.",
      "descriptions": {
        "default": "Any DBMS or associated application providing too much information in\nerror messages on the screen or printout risks compromising the data and\nsecurity of the system. The structure and content of error messages need to be\ncarefully considered by the organization and development team.\n\n    Databases can inadvertently provide a wealth of information to an attacker\nthrough improperly handled error messages. In addition to sensitive business or\npersonal information, database errors can provide host names, IP addresses,\nuser names, and other system information not required for troubleshooting but\nvery useful to someone targeting the system.\n\n    Carefully consider the structure/content of error messages. The extent to\nwhich information systems are able to identify and handle error conditions is\nguided by organizational policy and operational requirements. Information that\ncould be exploited by adversaries includes, for example, logon attempts with\npasswords entered by mistake as the username, mission/business information that\ncan be derived from (if not stated explicitly by) information recorded, and\npersonal information, such as account numbers, social security numbers, and\ncredit card numbers.",
        "check": "At the command prompt, execute the following command:\n\n# grep \"client_min_messages\" /storage/db/vpostgres/postgresql.conf\n\nIf there is no output, this is not a finding. If there is output and\n'client_min_messages' is not set to 'notice', this is a finding.",
        "fix": "Navigate to and open /storage/db/vpostgres/postgresql.conf.\n\nFind the 'client_min_messages' setting and set it to 'notice'."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "postgres",
        "gtitle": "SRG-APP-000266-DB-000162",
        "gid": null,
        "rid": "VCPG-67-000019",
        "stig_id": "VCPG-67-000019",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCPG-67-000019\" do\n  title \"The DBMS must provide non-privileged users with error messages that\nprovide information necessary for corrective actions without revealing\ninformation that could be exploited by adversaries.\"\n  desc  \"Any DBMS or associated application providing too much information in\nerror messages on the screen or printout risks compromising the data and\nsecurity of the system. The structure and content of error messages need to be\ncarefully considered by the organization and development team.\n\n    Databases can inadvertently provide a wealth of information to an attacker\nthrough improperly handled error messages. In addition to sensitive business or\npersonal information, database errors can provide host names, IP addresses,\nuser names, and other system information not required for troubleshooting but\nvery useful to someone targeting the system.\n\n    Carefully consider the structure/content of error messages. The extent to\nwhich information systems are able to identify and handle error conditions is\nguided by organizational policy and operational requirements. Information that\ncould be exploited by adversaries includes, for example, logon attempts with\npasswords entered by mistake as the username, mission/business information that\ncan be derived from (if not stated explicitly by) information recorded, and\npersonal information, such as account numbers, social security numbers, and\ncredit card numbers.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"postgres\"\n  tag gtitle: \"SRG-APP-000266-DB-000162\"\n  tag gid: nil\n  tag rid: \"VCPG-67-000019\"\n  tag stig_id: \"VCPG-67-000019\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep \\\"client_min_messages\\\" /storage/db/vpostgres/postgresql.conf\n\nIf there is no output, this is not a finding. If there is output and\n'client_min_messages' is not set to 'notice', this is a finding.\"\n  desc 'fix', \"Navigate to and open /storage/db/vpostgres/postgresql.conf.\n\nFind the 'client_min_messages' setting and set it to 'notice'.\"\n\n  describe.one do\n    describe parse_config_file('/storage/db/vpostgres/postgresql.conf') do\n      its('client_min_messages') { should cmp nil }\n    end\n    describe parse_config_file('/storage/db/vpostgres/postgresql.conf') do\n      its('client_min_messages') { should cmp \"notice\" }\n    end\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000019.rb",
        "line": 1
      },
      "id": "VCPG-67-000019"
    },
    {
      "title": "The vPostgres database must have the correct permissions on the log\nfiles.",
      "desc": "If audit data were to become compromised, then competent forensic\nanalysis and discovery of the true source of potentially malicious system\nactivity is difficult, if not impossible, to achieve. In addition, access to\naudit records provides information an attacker could potentially use to his or\nher advantage.\n\n    To ensure the veracity of audit data, the information system and/or the\napplication must protect audit information from any and all unauthorized\naccess. This includes read, write, copy, etc.\n\n    This requirement can be achieved through multiple methods which will depend\nupon system architecture and design. Some commonly employed methods include\nensuring log files enjoy the proper file system permissions utilizing file\nsystem protections and limiting log data location.\n\n    Additionally, applications with user interfaces to audit records should not\nallow for the unfettered manipulation of or access to those records via the\napplication. If the application provides access to the audit data, the\napplication becomes accountable for ensuring that audit information is\nprotected from unauthorized access.\n\n    Audit information includes all information (e.g., audit records, audit\nsettings, and audit reports) needed to successfully audit information system\nactivity.",
      "descriptions": {
        "default": "If audit data were to become compromised, then competent forensic\nanalysis and discovery of the true source of potentially malicious system\nactivity is difficult, if not impossible, to achieve. In addition, access to\naudit records provides information an attacker could potentially use to his or\nher advantage.\n\n    To ensure the veracity of audit data, the information system and/or the\napplication must protect audit information from any and all unauthorized\naccess. This includes read, write, copy, etc.\n\n    This requirement can be achieved through multiple methods which will depend\nupon system architecture and design. Some commonly employed methods include\nensuring log files enjoy the proper file system permissions utilizing file\nsystem protections and limiting log data location.\n\n    Additionally, applications with user interfaces to audit records should not\nallow for the unfettered manipulation of or access to those records via the\napplication. If the application provides access to the audit data, the\napplication becomes accountable for ensuring that audit information is\nprotected from unauthorized access.\n\n    Audit information includes all information (e.g., audit records, audit\nsettings, and audit reports) needed to successfully audit information system\nactivity.",
        "check": "At the command prompt, enter the following command:\n\n# stat -c \"%n permissions are %a\" /var/log/vmware/vpostgres/*.log\n\nIf the permissions on any log files are not \"600\", this is a finding",
        "fix": "At the command prompt, enter the following command:\n\n# chmod 600 /storage/db/pgdata/pg_log/<file_name>\n\nReplace <file_name> with files to be modified\n\nAt the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET\nlog_file_mode TO '0600';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT\npg_reload_conf();\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "postgres",
        "gtitle": "SRG-APP-000118-DB-000059",
        "gid": null,
        "rid": "VCPG-67-000005",
        "stig_id": "VCPG-67-000005",
        "cci": "CCI-000162",
        "nist": [
          "AU-9",
          "Rev_4"
        ]
      },
      "code": "control \"VCPG-67-000005\" do\n  title \"The vPostgres database must have the correct permissions on the log\nfiles.\"\n  desc  \"If audit data were to become compromised, then competent forensic\nanalysis and discovery of the true source of potentially malicious system\nactivity is difficult, if not impossible, to achieve. In addition, access to\naudit records provides information an attacker could potentially use to his or\nher advantage.\n\n    To ensure the veracity of audit data, the information system and/or the\napplication must protect audit information from any and all unauthorized\naccess. This includes read, write, copy, etc.\n\n    This requirement can be achieved through multiple methods which will depend\nupon system architecture and design. Some commonly employed methods include\nensuring log files enjoy the proper file system permissions utilizing file\nsystem protections and limiting log data location.\n\n    Additionally, applications with user interfaces to audit records should not\nallow for the unfettered manipulation of or access to those records via the\napplication. If the application provides access to the audit data, the\napplication becomes accountable for ensuring that audit information is\nprotected from unauthorized access.\n\n    Audit information includes all information (e.g., audit records, audit\nsettings, and audit reports) needed to successfully audit information system\nactivity.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"postgres\"\n  tag gtitle: \"SRG-APP-000118-DB-000059\"\n  tag gid: nil\n  tag rid: \"VCPG-67-000005\"\n  tag stig_id: \"VCPG-67-000005\"\n  tag cci: \"CCI-000162\"\n  tag nist: [\"AU-9\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, enter the following command:\n\n# stat -c \\\"%n permissions are %a\\\" /var/log/vmware/vpostgres/*.log\n\nIf the permissions on any log files are not \\\"600\\\", this is a finding\"\n  desc 'fix', \"At the command prompt, enter the following command:\n\n# chmod 600 /storage/db/pgdata/pg_log/<file_name>\n\nReplace <file_name> with files to be modified\n\nAt the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"ALTER SYSTEM SET\nlog_file_mode TO '0600';\\\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"SELECT\npg_reload_conf();\\\"\"\n\n  command('find /var/log/vmware/vpostgres/ -type f -maxdepth 1 -name \"*\"').stdout.split.each do | fname |\n    describe file(fname) do\n      its('mode') { should cmp '0600' }\n    end\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000005.rb",
        "line": 1
      },
      "id": "VCPG-67-000005"
    },
    {
      "title": "The DBMS must use NIST FIPS 140-2 validated cryptographic modules for\ncryptographic operations.",
      "desc": "Use of weak or not validated cryptographic algorithms undermines the\npurposes of utilizing encryption and digital signatures to protect data.  Weak\nalgorithms can be easily broken and not validated cryptographic modules may not\nimplement algorithms correctly. Unapproved cryptographic modules or algorithms\nshould not be relied on for authentication, confidentiality or integrity. Weak\ncryptography could allow an attacker to gain access to and modify data stored\nin the database as well as the administration settings of the DBMS.\n\n    Applications, including DBMSs, utilizing cryptography are required to use\napproved NIST FIPS 140-2 validated cryptographic modules that meet the\nrequirements of applicable federal laws, Executive Orders, directives,\npolicies, regulations, standards, and guidance.\n\n    The security functions validated as part of FIPS 140-2 for cryptographic\nmodules are described in FIPS 140-2 Annex A.\n\n    NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified, hardware-based\nencryption modules.",
      "descriptions": {
        "default": "Use of weak or not validated cryptographic algorithms undermines the\npurposes of utilizing encryption and digital signatures to protect data.  Weak\nalgorithms can be easily broken and not validated cryptographic modules may not\nimplement algorithms correctly. Unapproved cryptographic modules or algorithms\nshould not be relied on for authentication, confidentiality or integrity. Weak\ncryptography could allow an attacker to gain access to and modify data stored\nin the database as well as the administration settings of the DBMS.\n\n    Applications, including DBMSs, utilizing cryptography are required to use\napproved NIST FIPS 140-2 validated cryptographic modules that meet the\nrequirements of applicable federal laws, Executive Orders, directives,\npolicies, regulations, standards, and guidance.\n\n    The security functions validated as part of FIPS 140-2 for cryptographic\nmodules are described in FIPS 140-2 Annex A.\n\n    NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified, hardware-based\nencryption modules.",
        "check": "At the command prompt, execute the following command:\n\n# grep '^\\s*ssl_ciphers\\b' /storage/db/vpostgres/postgresql.conf\n\nIf \"ssl_ciphers\" is not \"!aNULL:kECDH+AES:ECDH+AES:RSA+AES:@STRENGTH\", this\nis a finding:",
        "fix": "At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET\nssl_ciphers TO 'FIPS: +3DES:!aNULL';\"\n\n/opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT\npg_reload_conf();\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "postgres",
        "gtitle": "SRG-APP-000179-DB-000114",
        "gid": null,
        "rid": "VCPG-67-000015",
        "stig_id": "VCPG-67-000015",
        "cci": "CCI-000803",
        "nist": [
          "IA-7",
          "Rev_4"
        ]
      },
      "code": "control \"VCPG-67-000015\" do\n  title \"The DBMS must use NIST FIPS 140-2 validated cryptographic modules for\ncryptographic operations.\"\n  desc  \"Use of weak or not validated cryptographic algorithms undermines the\npurposes of utilizing encryption and digital signatures to protect data.  Weak\nalgorithms can be easily broken and not validated cryptographic modules may not\nimplement algorithms correctly. Unapproved cryptographic modules or algorithms\nshould not be relied on for authentication, confidentiality or integrity. Weak\ncryptography could allow an attacker to gain access to and modify data stored\nin the database as well as the administration settings of the DBMS.\n\n    Applications, including DBMSs, utilizing cryptography are required to use\napproved NIST FIPS 140-2 validated cryptographic modules that meet the\nrequirements of applicable federal laws, Executive Orders, directives,\npolicies, regulations, standards, and guidance.\n\n    The security functions validated as part of FIPS 140-2 for cryptographic\nmodules are described in FIPS 140-2 Annex A.\n\n    NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified, hardware-based\nencryption modules.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"postgres\"\n  tag gtitle: \"SRG-APP-000179-DB-000114\"\n  tag gid: nil\n  tag rid: \"VCPG-67-000015\"\n  tag stig_id: \"VCPG-67-000015\"\n  tag cci: \"CCI-000803\"\n  tag nist: [\"IA-7\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep '^\\\\s*ssl_ciphers\\\\b' /storage/db/vpostgres/postgresql.conf\n\nIf \\\"ssl_ciphers\\\" is not \\\"!aNULL:kECDH+AES:ECDH+AES:RSA+AES:@STRENGTH\\\", this\nis a finding:\n\n\"\n  desc 'fix', \"At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"ALTER SYSTEM SET\nssl_ciphers TO 'FIPS: +3DES:!aNULL';\\\"\n\n/opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"SELECT\npg_reload_conf();\\\"\"\n\n  describe parse_config_file('/storage/db/vpostgres/postgresql.conf') do\n    its('ssl_ciphers') { should eq \"'!aNULL:kECDH+AES:ECDH+AES:RSA+AES:@STRENGTH'\" }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000015.rb",
        "line": 1
      },
      "id": "VCPG-67-000015"
    },
    {
      "title": "The vPostgres database must set log_disconnections to on.",
      "desc": "For completeness of forensic analysis, it is necessary to know how\nlong a user's (or other principal's) connection to the DBMS lasts. This can be\nachieved by recording disconnections, in addition to logons/connections, in the\naudit logs.\n\n    Disconnection may be initiated by the user or forced by the system (as in a\ntimeout) or result from a system or network failure. To the greatest extent\npossible, all disconnections must be logged.",
      "descriptions": {
        "default": "For completeness of forensic analysis, it is necessary to know how\nlong a user's (or other principal's) connection to the DBMS lasts. This can be\nachieved by recording disconnections, in addition to logons/connections, in the\naudit logs.\n\n    Disconnection may be initiated by the user or forced by the system (as in a\ntimeout) or result from a system or network failure. To the greatest extent\npossible, all disconnections must be logged.",
        "check": "At the command prompt, execute the following command:\n\n# grep '^log_disconnections' /storage/db/vpostgres/postgresql.conf\n\nIf log_disconnections is not on, this is a finding.",
        "fix": "At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET\nlog_disconnections TO 'on';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT\npg_reload_conf();\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "postgres",
        "gtitle": "SRG-APP-000505-DB-000352",
        "gid": null,
        "rid": "VCPG-67-000027",
        "stig_id": "VCPG-67-000027",
        "cci": "CCI-000172",
        "nist": [
          "AU-12 c",
          "Rev_4"
        ]
      },
      "code": "control \"VCPG-67-000027\" do\n  title \"The vPostgres database must set log_disconnections to on.\"\n  desc  \"For completeness of forensic analysis, it is necessary to know how\nlong a user's (or other principal's) connection to the DBMS lasts. This can be\nachieved by recording disconnections, in addition to logons/connections, in the\naudit logs.\n\n    Disconnection may be initiated by the user or forced by the system (as in a\ntimeout) or result from a system or network failure. To the greatest extent\npossible, all disconnections must be logged.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"postgres\"\n  tag gtitle: \"SRG-APP-000505-DB-000352\"\n  tag gid: nil\n  tag rid: \"VCPG-67-000027\"\n  tag stig_id: \"VCPG-67-000027\"\n  tag cci: \"CCI-000172\"\n  tag nist: [\"AU-12 c\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep '^log_disconnections' /storage/db/vpostgres/postgresql.conf\n\nIf log_disconnections is not on, this is a finding.\"\n  desc 'fix', \"At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"ALTER SYSTEM SET\nlog_disconnections TO 'on';\\\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"SELECT\npg_reload_conf();\\\"\"\n\n  describe parse_config_file('/storage/db/vpostgres/postgresql.conf') do\n    its('log_disconnections') { should cmp \"on\" }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000027.rb",
        "line": 1
      },
      "id": "VCPG-67-000027"
    },
    {
      "title": "The vPostgres must not allow access to unauthorized accounts.",
      "desc": "An isolation boundary provides access control and protects the\nintegrity of the hardware, software, and firmware that perform security\nfunctions.\n\n    Security functions are the hardware, software, and/or firmware of the\ninformation system responsible for enforcing the system security policy and\nsupporting the isolation of code and data on which the protection is based.\n\n    Developers and implementers can increase the assurance in security\nfunctions by employing well-defined security policy models; structured,\ndisciplined, and rigorous hardware and software development techniques; and\nsound system/security engineering principles.\n\n    Database Management Systems typically separate security functionality from\nnon-security functionality via separate databases or schemas. Database objects\nor code implementing security functionality should not be commingled with\nobjects or code implementing application logic. When security and non-security\nfunctionality are commingled, users who have access to non-security\nfunctionality may be able to access security functionality.",
      "descriptions": {
        "default": "An isolation boundary provides access control and protects the\nintegrity of the hardware, software, and firmware that perform security\nfunctions.\n\n    Security functions are the hardware, software, and/or firmware of the\ninformation system responsible for enforcing the system security policy and\nsupporting the isolation of code and data on which the protection is based.\n\n    Developers and implementers can increase the assurance in security\nfunctions by employing well-defined security policy models; structured,\ndisciplined, and rigorous hardware and software development techniques; and\nsound system/security engineering principles.\n\n    Database Management Systems typically separate security functionality from\nnon-security functionality via separate databases or schemas. Database objects\nor code implementing security functionality should not be commingled with\nobjects or code implementing application logic. When security and non-security\nfunctionality are commingled, users who have access to non-security\nfunctionality may be able to access security functionality.",
        "check": "At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"\\dp .*.;\"\n\nReview the Access Privilege column for all Schemas listed as\n\"information_schema\" and \"pg_catalog\".  If access privilege is granted to\nany users other than \"postgres\", this is a finding.",
        "fix": "At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"REVOKE ALL PRIVILEGES\nON <name> FROM <user>;\"\n\nReplace <name> and <user> with the Access Privilege name and account,\nrespectively, discovered during the check."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "postgres",
        "gtitle": "SRG-APP-000233-DB-000124",
        "gid": null,
        "rid": "VCPG-67-000017",
        "stig_id": "VCPG-67-000017",
        "cci": "CCI-001084",
        "nist": [
          "SC-3",
          "Rev_4"
        ]
      },
      "code": "control \"VCPG-67-000017\" do\n  title \"The vPostgres must not allow access to unauthorized accounts.\"\n  desc  \"An isolation boundary provides access control and protects the\nintegrity of the hardware, software, and firmware that perform security\nfunctions.\n\n    Security functions are the hardware, software, and/or firmware of the\ninformation system responsible for enforcing the system security policy and\nsupporting the isolation of code and data on which the protection is based.\n\n    Developers and implementers can increase the assurance in security\nfunctions by employing well-defined security policy models; structured,\ndisciplined, and rigorous hardware and software development techniques; and\nsound system/security engineering principles.\n\n    Database Management Systems typically separate security functionality from\nnon-security functionality via separate databases or schemas. Database objects\nor code implementing security functionality should not be commingled with\nobjects or code implementing application logic. When security and non-security\nfunctionality are commingled, users who have access to non-security\nfunctionality may be able to access security functionality.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"postgres\"\n  tag gtitle: \"SRG-APP-000233-DB-000124\"\n  tag gid: nil\n  tag rid: \"VCPG-67-000017\"\n  tag stig_id: \"VCPG-67-000017\"\n  tag cci: \"CCI-001084\"\n  tag nist: [\"SC-3\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"\\\\dp .*.;\\\"\n\nReview the Access Privilege column for all Schemas listed as\n\\\"information_schema\\\" and \\\"pg_catalog\\\".  If access privilege is granted to\nany users other than \\\"postgres\\\", this is a finding.\"\n  desc 'fix', \"At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"REVOKE ALL PRIVILEGES\nON <name> FROM <user>;\\\"\n\nReplace <name> and <user> with the Access Privilege name and account,\nrespectively, discovered during the check.\"\n\n  describe command(\"psql -U postgres -c '\\\\dp .*.;' | awk -F'|' '{print $4}' | grep -v 'Access' | sed -r '/^\\s*$/d' | cut -d'+' -f1 | grep -v -E 'postgres=|=r|w/postgres'\") do\n    its ('stdout.strip') { should cmp '' }\n  end\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000017.rb",
        "line": 1
      },
      "id": "VCPG-67-000017"
    },
    {
      "title": "vPostgres database objects must only be accessible to the postgres\naccount.",
      "desc": "Within the database, object ownership implies full privileges to the\nowned object, including the privilege to assign access to the owned objects to\nother subjects. Database functions and procedures can be coded using definer's\nrights. This allows anyone who utilizes the object to perform the actions if\nthey were the owner. If not properly managed, this can lead to privileged\nactions being taken by unauthorized individuals.\n\n    Conversely, if critical tables or other objects rely on unauthorized owner\naccounts, these objects may be lost when an account is removed.",
      "descriptions": {
        "default": "Within the database, object ownership implies full privileges to the\nowned object, including the privilege to assign access to the owned objects to\nother subjects. Database functions and procedures can be coded using definer's\nrights. This allows anyone who utilizes the object to perform the actions if\nthey were the owner. If not properly managed, this can lead to privileged\nactions being taken by unauthorized individuals.\n\n    Conversely, if critical tables or other objects rely on unauthorized owner\naccounts, these objects may be lost when an account is removed.",
        "check": "At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -d VCDB -x -U postgres -c\n\"\\dt;\"|grep Owner|grep -v vc\n\nIf any output if returned, this is a finding.",
        "fix": "At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER TABLE\n<tablename> OWNER TO vc;\"\n\nReplace <tablename> with the name of the table discovered during the check."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "postgres",
        "gtitle": "SRG-APP-000133-DB-000200",
        "gid": null,
        "rid": "VCPG-67-000008",
        "stig_id": "VCPG-67-000008",
        "cci": "CCI-001499",
        "nist": [
          "CM-5 (6)",
          "Rev_4"
        ]
      },
      "code": "control \"VCPG-67-000008\" do\n  title \"vPostgres database objects must only be accessible to the postgres\naccount.\"\n  desc  \"Within the database, object ownership implies full privileges to the\nowned object, including the privilege to assign access to the owned objects to\nother subjects. Database functions and procedures can be coded using definer's\nrights. This allows anyone who utilizes the object to perform the actions if\nthey were the owner. If not properly managed, this can lead to privileged\nactions being taken by unauthorized individuals.\n\n    Conversely, if critical tables or other objects rely on unauthorized owner\naccounts, these objects may be lost when an account is removed.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"postgres\"\n  tag gtitle: \"SRG-APP-000133-DB-000200\"\n  tag gid: nil\n  tag rid: \"VCPG-67-000008\"\n  tag stig_id: \"VCPG-67-000008\"\n  tag cci: \"CCI-001499\"\n  tag nist: [\"CM-5 (6)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -d VCDB -x -U postgres -c\n\\\"\\\\dt;\\\"|grep Owner|grep -v vc\n\nIf any output if returned, this is a finding.\"\n  desc 'fix', \"At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \\\"ALTER TABLE\n<tablename> OWNER TO vc;\\\"\n\nReplace <tablename> with the name of the table discovered during the check.\n\"\n\n  describe postgres_session('postgres','','localhost').query(\"SELECT * FROM pg_tables WHERE schemaname = \\'vc\\' and tableowner != \\'vc\\';\",['VCDB']) do\n    its('output') {should eq \"\"}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000008.rb",
        "line": 1
      },
      "id": "VCPG-67-000008"
    },
    {
      "title": "rhttpproxy must produce log records containing sufficient information\nto establish the source of events.",
      "desc": "After a security incident has occurred, investigators will often\nreview log files to determine what happened and determining the source of an\nevent is crucial for forensics. rhttpproxy must be configured for verbose\nlogging in order to capture client IP addresses and the associated actions.",
      "descriptions": {
        "default": "After a security incident has occurred, investigators will often\nreview log files to determine what happened and determining the source of an\nevent is crucial for forensics. rhttpproxy must be configured for verbose\nlogging in order to capture client IP addresses and the associated actions.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --xpath '/config/log/level' /etc/vmware-rhttpproxy/config.xml\n\nExpected result:\n\n<level>verbose</level>\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open /etc/vmware-rhttpproxy/config.xml\n\nLocate the <log> block and configure <level> as follows:\n\n<level>verbose</level>\n\nRestart the service for changes to take effect.\n\n# vmon-cli --restart rhttpproxy"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000016-WSR-000005",
        "gid": null,
        "rid": "VCRP-67-000005",
        "stig_id": "VCRP-67-000005",
        "cci": "CCI-000067",
        "nist": [
          "AC-17 (1)",
          "Rev_4"
        ]
      },
      "code": "control \"VCRP-67-000005\" do\n  title \"rhttpproxy must produce log records containing sufficient information\nto establish the source of events.\"\n  desc  \"After a security incident has occurred, investigators will often\nreview log files to determine what happened and determining the source of an\nevent is crucial for forensics. rhttpproxy must be configured for verbose\nlogging in order to capture client IP addresses and the associated actions.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000016-WSR-000005\"\n  tag gid: nil\n  tag rid: \"VCRP-67-000005\"\n  tag stig_id: \"VCRP-67-000005\"\n  tag cci: \"CCI-000067\"\n  tag nist: [\"AC-17 (1)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --xpath '/config/log/level' /etc/vmware-rhttpproxy/config.xml\n\nExpected result:\n\n<level>verbose</level>\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open /etc/vmware-rhttpproxy/config.xml\n\nLocate the <log> block and configure <level> as follows:\n\n<level>verbose</level>\n\nRestart the service for changes to take effect.\n\n# vmon-cli --restart rhttpproxy\"\n\n  describe xml('/etc/vmware-rhttpproxy/config.xml') do\n    its(['/config/log/level']) { should cmp ['verbose'] }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/286bdedf5e99b23d5d8a0eabb6315cd0ce3a2551346245f6ea69353506de45e6/controls/VCRP-67-000005.rb",
        "line": 1
      },
      "id": "VCRP-67-000005"
    },
    {
      "title": "rhttpproxy must have logging enabled.",
      "desc": "After a security incident has occurred, investigators will often\nreview log files to determine what happened. rhttpproxy must create logs upon\nservice start up in order to capture information relevant to investigations.",
      "descriptions": {
        "default": "After a security incident has occurred, investigators will often\nreview log files to determine what happened. rhttpproxy must create logs upon\nservice start up in order to capture information relevant to investigations.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --xpath '/config/log/outputToFiles' /etc/vmware-rhttpproxy/config.xml\n\nExpected result:\n\n<outputToFiles>true</outputToFiles>\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open /etc/vmware-rhttpproxy/config.xml\n\nLocate the <log> block and configure <outputToFiles> as follows:\n\n<outputToFiles>true</outputToFiles>\n\nRestart the service for changes to take effect.\n\n# vmon-cli --restart rhttpproxy"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000093-WSR-000053",
        "gid": null,
        "rid": "VCRP-67-000006",
        "stig_id": "VCRP-67-000006",
        "cci": "CCI-001462",
        "nist": [
          "AU-14 (2)",
          "Rev_4"
        ]
      },
      "code": "control \"VCRP-67-000006\" do\n  title \"rhttpproxy must have logging enabled.\"\n  desc  \"After a security incident has occurred, investigators will often\nreview log files to determine what happened. rhttpproxy must create logs upon\nservice start up in order to capture information relevant to investigations.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000093-WSR-000053\"\n  tag gid: nil\n  tag rid: \"VCRP-67-000006\"\n  tag stig_id: \"VCRP-67-000006\"\n  tag cci: \"CCI-001462\"\n  tag nist: [\"AU-14 (2)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --xpath '/config/log/outputToFiles' /etc/vmware-rhttpproxy/config.xml\n\nExpected result:\n\n<outputToFiles>true</outputToFiles>\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open /etc/vmware-rhttpproxy/config.xml\n\nLocate the <log> block and configure <outputToFiles> as follows:\n\n<outputToFiles>true</outputToFiles>\n\nRestart the service for changes to take effect.\n\n# vmon-cli --restart rhttpproxy\"\n\n  describe xml('/etc/vmware-rhttpproxy/config.xml') do\n    its(['/config/log/outputToFiles']) { should cmp ['true'] }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/286bdedf5e99b23d5d8a0eabb6315cd0ce3a2551346245f6ea69353506de45e6/controls/VCRP-67-000006.rb",
        "line": 1
      },
      "id": "VCRP-67-000006"
    },
    {
      "title": "rhttpproxy must use cryptography to protect the integrity of remote\nsessions.",
      "desc": "rhttpproxy supports TLS 1.0, 1.1 and 1.2 and can be configured to\nsupport any combination thereof. Due to intrinsic problems in TLS 1.0 and 1.1\nthey must  be disabled and TLS 1.2 must be the only procotol supported for\nclient connections.",
      "descriptions": {
        "default": "rhttpproxy supports TLS 1.0, 1.1 and 1.2 and can be configured to\nsupport any combination thereof. Due to intrinsic problems in TLS 1.0 and 1.1\nthey must  be disabled and TLS 1.2 must be the only procotol supported for\nclient connections.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --xpath '/config/vmacore/ssl/protocols'\n/etc/vmware-rhttpproxy/config.xml\n\nExpected result:\n\n<protocols>tls1.2</protocols>\n\nIf there is no output, this is NOT a finding.\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open /etc/vmware-rhttpproxy/config.xml\n\nLocate the <ssl> block inside of the <vmacore> block and configure <protocols>\nas follows:\n\n<protocols>tls1.2</protocols>\n\nRestart the service for changes to take effect.\n\n# vmon-cli --restart rhttpproxy"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000015-WSR-000014",
        "gid": null,
        "rid": "VCRP-67-000004",
        "stig_id": "VCRP-67-000004",
        "cci": "CCI-001453",
        "nist": [
          "AC-17 (2)",
          "Rev_4"
        ]
      },
      "code": "control \"VCRP-67-000004\" do\n  title \"rhttpproxy must use cryptography to protect the integrity of remote\nsessions.\"\n  desc  \"rhttpproxy supports TLS 1.0, 1.1 and 1.2 and can be configured to\nsupport any combination thereof. Due to intrinsic problems in TLS 1.0 and 1.1\nthey must  be disabled and TLS 1.2 must be the only procotol supported for\nclient connections. \"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000015-WSR-000014\"\n  tag gid: nil\n  tag rid: \"VCRP-67-000004\"\n  tag stig_id: \"VCRP-67-000004\"\n  tag cci: \"CCI-001453\"\n  tag nist: [\"AC-17 (2)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --xpath '/config/vmacore/ssl/protocols'\n/etc/vmware-rhttpproxy/config.xml\n\nExpected result:\n\n<protocols>tls1.2</protocols>\n\nIf there is no output, this is NOT a finding.\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open /etc/vmware-rhttpproxy/config.xml\n\nLocate the <ssl> block inside of the <vmacore> block and configure <protocols>\nas follows:\n\n<protocols>tls1.2</protocols>\n\nRestart the service for changes to take effect.\n\n# vmon-cli --restart rhttpproxy\"\n\n  describe.one do\n  \n    describe xml('/etc/vmware-rhttpproxy/config.xml') do\n      its(['/config/vmacore/ssl/protocols']) { should cmp ['tls1.2'] }\n    end\n\n    describe xml('/etc/vmware-rhttpproxy/config.xml') do\n      its(['/config/vmacore/ssl/protocols']) { should cmp [] }\n    end\n\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/286bdedf5e99b23d5d8a0eabb6315cd0ce3a2551346245f6ea69353506de45e6/controls/VCRP-67-000004.rb",
        "line": 1
      },
      "id": "VCRP-67-000004"
    },
    {
      "title": "rhttproxy must exclusively use the HTTPS protocol for client\nconnections.",
      "desc": "Remotely accessing vCenter via the rhttpproxy involves sensitive\ninformation going over the wire. To protect the confidentiality and integrity\nof these communications, the rhttpproxy must be configured to use an encrypted\nsession of HTTPS rather than plain-text HTTP.",
      "descriptions": {
        "default": "Remotely accessing vCenter via the rhttpproxy involves sensitive\ninformation going over the wire. To protect the confidentiality and integrity\nof these communications, the rhttpproxy must be configured to use an encrypted\nsession of HTTPS rather than plain-text HTTP.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --xpath '/config/ssl' /etc/vmware-rhttpproxy/config.xml\n\nExpected result:\n\n<ssl>\n    <!-- The server private key file -->\n    <privateKey>/etc/vmware-rhttpproxy/ssl/rui.key</privateKey>\n    <!-- The server side certificate file -->\n    <certificate>/etc/vmware-rhttpproxy/ssl/rui.crt</certificate>\n    <!-- vecs server name. Currently vecs runs on all node types. -->\n    <vecsServerName>localhost</vecsServerName>\n  </ssl>\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open /etc/vmware-rhttpproxy/config.xml\n\nLocate the first <ssl> block and configure <protocols> as follows:\n\n  <ssl>\n    <!-- The server private key file -->\n    <privateKey>/etc/vmware-rhttpproxy/ssl/rui.key</privateKey>\n    <!-- The server side certificate file -->\n    <certificate>/etc/vmware-rhttpproxy/ssl/rui.crt</certificate>\n    <!-- vecs server name. Currently vecs runs on all node types. -->\n    <vecsServerName>localhost</vecsServerName>\n  </ssl>\n\nRestart the service for changes to take effect.\n\n# vmon-cli --restart rhttpproxy"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000315-WSR-000003",
        "gid": null,
        "rid": "VCRP-67-000008",
        "stig_id": "VCRP-67-000008",
        "cci": "CCI-002314",
        "nist": [
          "AC-17 (1)",
          "Rev_4"
        ]
      },
      "code": "control \"VCRP-67-000008\" do\n  title \"rhttproxy must exclusively use the HTTPS protocol for client\nconnections.\"\n  desc  \"Remotely accessing vCenter via the rhttpproxy involves sensitive\ninformation going over the wire. To protect the confidentiality and integrity\nof these communications, the rhttpproxy must be configured to use an encrypted\nsession of HTTPS rather than plain-text HTTP.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000315-WSR-000003\"\n  tag gid: nil\n  tag rid: \"VCRP-67-000008\"\n  tag stig_id: \"VCRP-67-000008\"\n  tag cci: \"CCI-002314\"\n  tag nist: [\"AC-17 (1)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --xpath '/config/ssl' /etc/vmware-rhttpproxy/config.xml\n\nExpected result:\n\n<ssl>\n    <!-- The server private key file -->\n    <privateKey>/etc/vmware-rhttpproxy/ssl/rui.key</privateKey>\n    <!-- The server side certificate file -->\n    <certificate>/etc/vmware-rhttpproxy/ssl/rui.crt</certificate>\n    <!-- vecs server name. Currently vecs runs on all node types. -->\n    <vecsServerName>localhost</vecsServerName>\n  </ssl>\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open /etc/vmware-rhttpproxy/config.xml\n\nLocate the first <ssl> block and configure <protocols> as follows:\n\n  <ssl>\n    <!-- The server private key file -->\n    <privateKey>/etc/vmware-rhttpproxy/ssl/rui.key</privateKey>\n    <!-- The server side certificate file -->\n    <certificate>/etc/vmware-rhttpproxy/ssl/rui.crt</certificate>\n    <!-- vecs server name. Currently vecs runs on all node types. -->\n    <vecsServerName>localhost</vecsServerName>\n  </ssl>\n\nRestart the service for changes to take effect.\n\n# vmon-cli --restart rhttpproxy\"\n\n  describe xml('/etc/vmware-rhttpproxy/config.xml') do\n    its(['/config/ssl/privateKey']) { should cmp ['/etc/vmware-rhttpproxy/ssl/rui.key'] }\n    its(['/config/ssl/certificate']) { should cmp ['/etc/vmware-rhttpproxy/ssl/rui.crt'] }\n    its(['/config/ssl/vecsServerName']) { should cmp ['localhost'] }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/286bdedf5e99b23d5d8a0eabb6315cd0ce3a2551346245f6ea69353506de45e6/controls/VCRP-67-000008.rb",
        "line": 1
      },
      "id": "VCRP-67-000008"
    },
    {
      "title": "rhttpproxy log files must be moved to a permanent repository in\naccordance with site policy.",
      "desc": "rhttpproxy produces a handful of logs that must be offloaded from the\noriginating system. This information can then be used for diagnostic purposes,\nforensics purposes, or other purposes relevant to ensuring the availability and\nintegrity of the hosted application.",
      "descriptions": {
        "default": "rhttpproxy produces a handful of logs that must be offloaded from the\noriginating system. This information can then be used for diagnostic purposes,\nforensics purposes, or other purposes relevant to ensuring the availability and\nintegrity of the hosted application.",
        "check": "At the command prompt, execute the following command:\n\n# grep -v \"^#\" /etc/vmware-syslog/stig-services-rhttpproxy.conf\n\nExpected result:\n\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/rhttpproxy/rhttpproxy.log\"\n      Tag=\"rhttpproxy-main\"\n      Severity=\"info\"\n      Facility=\"local0\")\n\nIf the file does not exist, this is a finding.\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open\n/etc/vmware-syslog/stig-services-rhttpproxy.conf , creating the file if it does\nnot exist.\n\nSet the contents of the file as follows:\n\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/rhttpproxy/rhttpproxy.log\"\n      Tag=\"rhttpproxy-main\"\n      Severity=\"info\"\n      Facility=\"local0\")"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000358-WSR-000063",
        "gid": null,
        "rid": "VCRP-67-000009",
        "stig_id": "VCRP-67-000009",
        "cci": "CCI-001851",
        "nist": [
          "AU-4 (1)",
          "Rev_4"
        ]
      },
      "code": "control \"VCRP-67-000009\" do\n  title \"rhttpproxy log files must be moved to a permanent repository in\naccordance with site policy.\"\n  desc  \"rhttpproxy produces a handful of logs that must be offloaded from the\noriginating system. This information can then be used for diagnostic purposes,\nforensics purposes, or other purposes relevant to ensuring the availability and\nintegrity of the hosted application.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000358-WSR-000063\"\n  tag gid: nil\n  tag rid: \"VCRP-67-000009\"\n  tag stig_id: \"VCRP-67-000009\"\n  tag cci: \"CCI-001851\"\n  tag nist: [\"AU-4 (1)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep -v \\\"^#\\\" /etc/vmware-syslog/stig-services-rhttpproxy.conf\n\nExpected result:\n\ninput(type=\\\"imfile\\\"\n      File=\\\"/var/log/vmware/rhttpproxy/rhttpproxy.log\\\"\n      Tag=\\\"rhttpproxy-main\\\"\n      Severity=\\\"info\\\"\n      Facility=\\\"local0\\\")\n\nIf the file does not exist, this is a finding.\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open\n/etc/vmware-syslog/stig-services-rhttpproxy.conf , creating the file if it does\nnot exist.\n\nSet the contents of the file as follows:\n\ninput(type=\\\"imfile\\\"\n      File=\\\"/var/log/vmware/rhttpproxy/rhttpproxy.log\\\"\n      Tag=\\\"rhttpproxy-main\\\"\n      Severity=\\\"info\\\"\n      Facility=\\\"local0\\\")\"\n\n  describe file('/etc/vmware-syslog/stig-services-rhttpproxy.conf') do\n    it { should exist }\n  end\n  \n  describe command('grep -v \"^#\" /etc/vmware-syslog/stig-services-rhttpproxy.conf') do\n    its ('stdout') { should match \"input(type=\\\"imfile\\\"\\n      File=\\\"/var/log/vmware/rhttpproxy/rhttpproxy.log\\\"\\n      Tag=\\\"rhttpproxy-main\\\"\\n      Severity=\\\"info\\\"\\n      Facility=\\\"local0\\\")\\n\" }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/286bdedf5e99b23d5d8a0eabb6315cd0ce3a2551346245f6ea69353506de45e6/controls/VCRP-67-000009.rb",
        "line": 1
      },
      "id": "VCRP-67-000009"
    },
    {
      "title": "The rhttpproxy private key file must be owned by root and group owned\nby root.",
      "desc": "rhttpproxy's private key is used to prove the identity of the server\nto clients and securely exchange the shared secret key used to encrypt\ncommunications between the web server and clients.\n\n    By gaining access to the private key, an attacker can pretend to be an\nauthorized server and decrypt the TLS traffic between a client and the web\nserver.",
      "descriptions": {
        "default": "rhttpproxy's private key is used to prove the identity of the server\nto clients and securely exchange the shared secret key used to encrypt\ncommunications between the web server and clients.\n\n    By gaining access to the private key, an attacker can pretend to be an\nauthorized server and decrypt the TLS traffic between a client and the web\nserver.",
        "check": "At the command prompt, execute the following command:\n\n# stat -c \"%n permisions are %a, is owned by %U and group owned by %G\"\n/etc/vmware-rhttpproxy/ssl/rui.key\n\nExpected result:\n\n/etc/vmware-rhttpproxy/ssl/rui.key permisions are 600, is owned by root and\ngroup owned by root\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "At the command prompt, execute the following command:\n\n# chown root:root /etc/vmware-rhttpproxy/ssl/rui.key"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000176-WSR-000096",
        "gid": null,
        "rid": "VCRP-67-000007",
        "stig_id": "VCRP-67-000007",
        "cci": "CCI-000186",
        "nist": [
          "IA-5 (2) (b)",
          "Rev_4"
        ]
      },
      "code": "control \"VCRP-67-000007\" do\n  title \"The rhttpproxy private key file must be owned by root and group owned\nby root.\"\n  desc  \"rhttpproxy's private key is used to prove the identity of the server\nto clients and securely exchange the shared secret key used to encrypt\ncommunications between the web server and clients.\n\n    By gaining access to the private key, an attacker can pretend to be an\nauthorized server and decrypt the TLS traffic between a client and the web\nserver.\n  \"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000176-WSR-000096\"\n  tag gid: nil\n  tag rid: \"VCRP-67-000007\"\n  tag stig_id: \"VCRP-67-000007\"\n  tag cci: \"CCI-000186\"\n  tag nist: [\"IA-5 (2) (b)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# stat -c \\\"%n permisions are %a, is owned by %U and group owned by %G\\\"\n/etc/vmware-rhttpproxy/ssl/rui.key\n\nExpected result:\n\n/etc/vmware-rhttpproxy/ssl/rui.key permisions are 600, is owned by root and\ngroup owned by root\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"At the command prompt, execute the following command:\n\n# chown root:root /etc/vmware-rhttpproxy/ssl/rui.key\n\"\n\n  describe file('/etc/vmware-rhttpproxy/ssl/rui.key') do\n    its('mode') { should cmp '0600'}\n    its('owner') { should cmp 'root' }\n    its('group') { should cmp 'root' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/286bdedf5e99b23d5d8a0eabb6315cd0ce3a2551346245f6ea69353506de45e6/controls/VCRP-67-000007.rb",
        "line": 1
      },
      "id": "VCRP-67-000007"
    },
    {
      "title": "rhttpproxy must be configured to operate solely with FIPS ciphers.",
      "desc": "rhttpproxy ships with FIPS validated OpenSSL cryptographic libraries\nand can be configured to run in FIPS mode for protection of data-in-transit\nover the client TLS connection.",
      "descriptions": {
        "default": "rhttpproxy ships with FIPS validated OpenSSL cryptographic libraries\nand can be configured to run in FIPS mode for protection of data-in-transit\nover the client TLS connection.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --xpath '/config/vmacore/ssl/fips' /etc/vmware-rhttpproxy/config.xml\n\nExpected result:\n\n<fips>true</fips>\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open /etc/vmware-rhttpproxy/config.xml\n\nLocate the <ssl> block inside of the <vmacore> block and configure <fips> as\nfollows:\n\n<fips>true</fips>\n\nRestart the service for changes to take effect.\n\n# vmon-cli --restart rhttpproxy"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000014-WSR-000006",
        "gid": null,
        "rid": "VCRP-67-000003",
        "stig_id": "VCRP-67-000003",
        "cci": "CCI-000068",
        "nist": [
          "AC-17 (2)",
          "Rev_4"
        ]
      },
      "code": "control \"VCRP-67-000003\" do\n  title \"rhttpproxy must be configured to operate solely with FIPS ciphers.\"\n  desc  \"rhttpproxy ships with FIPS validated OpenSSL cryptographic libraries\nand can be configured to run in FIPS mode for protection of data-in-transit\nover the client TLS connection.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000014-WSR-000006\"\n  tag gid: nil\n  tag rid: \"VCRP-67-000003\"\n  tag stig_id: \"VCRP-67-000003\"\n  tag cci: \"CCI-000068\"\n  tag nist: [\"AC-17 (2)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --xpath '/config/vmacore/ssl/fips' /etc/vmware-rhttpproxy/config.xml\n\nExpected result:\n\n<fips>true</fips>\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open /etc/vmware-rhttpproxy/config.xml\n\nLocate the <ssl> block inside of the <vmacore> block and configure <fips> as\nfollows:\n\n<fips>true</fips>\n\nRestart the service for changes to take effect.\n\n# vmon-cli --restart rhttpproxy\"\n\n  describe xml('/etc/vmware-rhttpproxy/config.xml') do\n    its(['/config/vmacore/ssl/fips']) { should cmp ['true'] }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/286bdedf5e99b23d5d8a0eabb6315cd0ce3a2551346245f6ea69353506de45e6/controls/VCRP-67-000003.rb",
        "line": 1
      },
      "id": "VCRP-67-000003"
    },
    {
      "title": "rhttpproxy must drop connections to disconnected clients.",
      "desc": "rhttpproxy client connections that are established but no longer\nconnected can consume resources that might otherwise be required by active\nconnections. It is a best practice to terminate connections that are no longer\nconnected to an active client.",
      "descriptions": {
        "default": "rhttpproxy client connections that are established but no longer\nconnected can consume resources that might otherwise be required by active\nconnections. It is a best practice to terminate connections that are no longer\nconnected to an active client.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --xpath '/config/vmacore/tcpKeepAlive/clientSocket/idleTimeSec'\n/etc/vmware-rhttpproxy/config.xml\n\nExpected result:\n\n<idleTimeSec>900</idleTimeSec>\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open /etc/vmware-rhttpproxy/config.xml\n\nLocate the <clientSocket> block and configure <idleTimeSec> as follows:\n\n<idleTimeSec>900</idleTimeSec>\n\nRestart the service for changes to take effect.\n\n# vmon-cli --restart rhttpproxy"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000001-WSR-000001",
        "gid": null,
        "rid": "VCRP-67-000001",
        "stig_id": "VCRP-67-000001",
        "cci": "CCI-000054",
        "nist": [
          "AC-10",
          "Rev_4"
        ]
      },
      "code": "control \"VCRP-67-000001\" do\n  title \"rhttpproxy must drop connections to disconnected clients.\"\n  desc  \"rhttpproxy client connections that are established but no longer\nconnected can consume resources that might otherwise be required by active\nconnections. It is a best practice to terminate connections that are no longer\nconnected to an active client.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000001-WSR-000001\"\n  tag gid: nil\n  tag rid: \"VCRP-67-000001\"\n  tag stig_id: \"VCRP-67-000001\"\n  tag cci: \"CCI-000054\"\n  tag nist: [\"AC-10\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --xpath '/config/vmacore/tcpKeepAlive/clientSocket/idleTimeSec'\n/etc/vmware-rhttpproxy/config.xml\n\nExpected result:\n\n<idleTimeSec>900</idleTimeSec>\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open /etc/vmware-rhttpproxy/config.xml\n\nLocate the <clientSocket> block and configure <idleTimeSec> as follows:\n\n<idleTimeSec>900</idleTimeSec>\n\nRestart the service for changes to take effect.\n\n# vmon-cli --restart rhttpproxy\"\n\n  describe xml('/etc/vmware-rhttpproxy/config.xml') do\n    its(['/config/vmacore/tcpKeepAlive/clientSocket/idleTimeSec']) { should cmp '900' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/286bdedf5e99b23d5d8a0eabb6315cd0ce3a2551346245f6ea69353506de45e6/controls/VCRP-67-000001.rb",
        "line": 1
      },
      "id": "VCRP-67-000001"
    },
    {
      "title": "rhttpproxy must set a limit on established connections.",
      "desc": "rhttpproxy client connections must be limited in order to preserve\nsystem resources and to continue servicing connections without interruption.\nWithout a limit, set the system would be vulnerable to a trivial denial of\nservice attack where connections are created en masse and vCenter resources are\nentirely consumed.",
      "descriptions": {
        "default": "rhttpproxy client connections must be limited in order to preserve\nsystem resources and to continue servicing connections without interruption.\nWithout a limit, set the system would be vulnerable to a trivial denial of\nservice attack where connections are created en masse and vCenter resources are\nentirely consumed.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --xpath '/config/vmacore/http/maxConnections'\n/etc/vmware-rhttpproxy/config.xml\n\nExpected result:\n\n<maxConnections> 2048 </maxConnections>\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open /etc/vmware-rhttpproxy/config.xml\n\nLocate the <http> block and configure <maxConnections> as follows:\n\n<maxConnections> 2048 </maxConnections>\n\nRestart the service for changes to take effect.\n\n# vmon-cli --restart rhttpproxy"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000001-WSR-000001",
        "gid": null,
        "rid": "VCRP-67-000002",
        "stig_id": "VCRP-67-000002",
        "cci": "CCI-000054",
        "nist": [
          "AC-10",
          "Rev_4"
        ]
      },
      "code": "control \"VCRP-67-000002\" do\n  title \"rhttpproxy must set a limit on established connections.\"\n  desc  \"rhttpproxy client connections must be limited in order to preserve\nsystem resources and to continue servicing connections without interruption.\nWithout a limit, set the system would be vulnerable to a trivial denial of\nservice attack where connections are created en masse and vCenter resources are\nentirely consumed.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000001-WSR-000001\"\n  tag gid: nil\n  tag rid: \"VCRP-67-000002\"\n  tag stig_id: \"VCRP-67-000002\"\n  tag cci: \"CCI-000054\"\n  tag nist: [\"AC-10\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --xpath '/config/vmacore/http/maxConnections'\n/etc/vmware-rhttpproxy/config.xml\n\nExpected result:\n\n<maxConnections> 2048 </maxConnections>\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open /etc/vmware-rhttpproxy/config.xml\n\nLocate the <http> block and configure <maxConnections> as follows:\n\n<maxConnections> 2048 </maxConnections>\n\nRestart the service for changes to take effect.\n\n# vmon-cli --restart rhttpproxy\"\n  \n  describe.one do\n  \n    describe xml('/etc/vmware-rhttpproxy/config.xml') do\n      its(['/config/vmacore/http/maxConnections']) { should cmp [\"2048\"] }\n    end\n\n    describe xml('/etc/vmware-rhttpproxy/config.xml') do\n      its(['/config/vmacore/http/maxConnections']) { should cmp [\" 2048 \"] }\n    end\n  \n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/286bdedf5e99b23d5d8a0eabb6315cd0ce3a2551346245f6ea69353506de45e6/controls/VCRP-67-000002.rb",
        "line": 1
      },
      "id": "VCRP-67-000002"
    },
    {
      "title": "The Security Token Service must must be configured with the\nappropriate ports.",
      "desc": "Web servers provide numerous processes, features, and functionalities\nthat utilize TCP/IP ports. Some of these processes may be deemed unnecessary or\ntoo unsecure to run on a production system. The ports that the Security Token\nService listens on are configured in the catalina.properties file and must be\nveriified as accurate to their shipping state.",
      "descriptions": {
        "default": "Web servers provide numerous processes, features, and functionalities\nthat utilize TCP/IP ports. Some of these processes may be deemed unnecessary or\ntoo unsecure to run on a production system. The ports that the Security Token\nService listens on are configured in the catalina.properties file and must be\nveriified as accurate to their shipping state.",
        "check": "At the command prompt, execute the following command:\n\n# grep 'bio' /usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nExpected result:\n\nbio-custom.http.port=7080\nbio-custom.https.port=8443\nbio-ssl-localhost.https.port=7444\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nNavigate to the ports specification section.\n\nSet the Security Token Service port specifications according to the below list:\n\nbio-custom.http.port=7080\nbio-custom.https.port=8443\nbio-ssl-localhost.https.port=7444"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000383-WSR-000175",
        "gid": null,
        "rid": "VCST-67-000028",
        "stig_id": "VCST-67-000028",
        "cci": "CCI-001762",
        "nist": [
          "CM-7 (1) (b)",
          "Rev_4"
        ]
      },
      "code": "control \"VCST-67-000028\" do\n  title \"The Security Token Service must must be configured with the\nappropriate ports.\"\n  desc  \"Web servers provide numerous processes, features, and functionalities\nthat utilize TCP/IP ports. Some of these processes may be deemed unnecessary or\ntoo unsecure to run on a production system. The ports that the Security Token\nService listens on are configured in the catalina.properties file and must be\nveriified as accurate to their shipping state.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000383-WSR-000175\"\n  tag gid: nil\n  tag rid: \"VCST-67-000028\"\n  tag stig_id: \"VCST-67-000028\"\n  tag cci: \"CCI-001762\"\n  tag nist: [\"CM-7 (1) (b)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep 'bio' /usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nExpected result:\n\nbio-custom.http.port=7080\nbio-custom.https.port=8443\nbio-ssl-localhost.https.port=7444\n\nIf the output of the command does not match the expected result, this is a\nfinding.\n\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nNavigate to the ports specification section.\n\nSet the Security Token Service port specifications according to the below list:\n\nbio-custom.http.port=7080\nbio-custom.https.port=8443\nbio-ssl-localhost.https.port=7444\n\"\n\n  describe parse_config_file('/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties').params['bio-custom.http.port'] do\n    it { should eq '7080' }\n  end\n\n  describe parse_config_file('/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties').params['bio-custom.https.port'] do\n    it { should eq '8443' }\n  end\n\n  describe parse_config_file('/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties').params['bio-ssl-localhost.https.port'] do\n    it { should eq '7444' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000028.rb",
        "line": 1
      },
      "id": "VCST-67-000028"
    },
    {
      "title": "The Security Token Service must record user access in a format that\nenables monitoring of remote access.",
      "desc": "Remote access can be exploited by an attacker to compromise the\nserver.  By recording all remote access activities, it will be possible to\ndetermine the attacker's location, intent, and degree of success.\n\n    Tomcat can be configured with an AccessLogValve, a component that can be\ninserted into the request processing pipeline to provide robust access logging.\nThe Access Log Valve creates log files in the same format as those created by\nstandard web servers. When AccessLogValve is properly configured, log files\nwill contain all the forensic information necessary in the case of a security\nincident.",
      "descriptions": {
        "default": "Remote access can be exploited by an attacker to compromise the\nserver.  By recording all remote access activities, it will be possible to\ndetermine the attacker's location, intent, and degree of success.\n\n    Tomcat can be configured with an AccessLogValve, a component that can be\ninserted into the request processing pipeline to provide robust access logging.\nThe Access Log Valve creates log files in the same format as those created by\nstandard web servers. When AccessLogValve is properly configured, log files\nwill contain all the forensic information necessary in the case of a security\nincident.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/server.xml | sed '2\ns/xmlns=\".*\"//g' | xmllint --xpath\n'/Server/Service/Engine/Host/Valve[@className=\"org.apache.catalina.valves.AccessLogValve\"]'/@pattern\n-\n\nExpected result:\n\npattern=\"%h %{X-Forwarded-For}i %l %u %t &quot;%r&quot; %s %b\n&quot;%{User-Agent}i&quot;\" resolveHosts=\"false\"\nprefix=\"localhost_access_log\" suffix=\".txt\" />\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nConfigure the <Host> node with the two nodes below.\n\n<Valve className=\"org.apache.catalina.valves.RemoteIpValve\"\nhttpServerPort=\"80\" httpsServerPort=\"443\"\nprotocolHeader=\"x-forwarded-proto\" proxiesHeader=\"x-forwarded-by\"\nremoteIpHeader=\"x-forwarded-for\" requestAttributesEnabled=\"true\"\ninternalProxies=\"127\\.0\\.0\\.1\" />\n\n<Valve className=\"org.apache.catalina.valves.AccessLogValve\"\ndirectory=\"logs\" pattern=\"%h %{X-Forwarded-For}i %l %u %t &quot;%r&quot; %s\n%b &quot;%{User-Agent}i&quot;\" resolveHosts=\"false\"\nprefix=\"localhost_access_log\" suffix=\".txt\" />"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000016-WSR-000005",
        "gid": null,
        "rid": "VCST-67-000005",
        "stig_id": "VCST-67-000005",
        "cci": "CCI-000067",
        "nist": [
          "AC-17 (1)",
          "Rev_4"
        ]
      },
      "code": "control \"VCST-67-000005\" do\n  title \"The Security Token Service must record user access in a format that\nenables monitoring of remote access.\"\n  desc  \"Remote access can be exploited by an attacker to compromise the\nserver.  By recording all remote access activities, it will be possible to\ndetermine the attacker's location, intent, and degree of success.\n\n    Tomcat can be configured with an AccessLogValve, a component that can be\ninserted into the request processing pipeline to provide robust access logging.\nThe Access Log Valve creates log files in the same format as those created by\nstandard web servers. When AccessLogValve is properly configured, log files\nwill contain all the forensic information necessary in the case of a security\nincident.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000016-WSR-000005\"\n  tag gid: nil\n  tag rid: \"VCST-67-000005\"\n  tag stig_id: \"VCST-67-000005\"\n  tag cci: \"CCI-000067\"\n  tag nist: [\"AC-17 (1)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/server.xml | sed '2\ns/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'/Server/Service/Engine/Host/Valve[@className=\\\"org.apache.catalina.valves.AccessLogValve\\\"]'/@pattern\n-\n\nExpected result:\n\npattern=\\\"%h %{X-Forwarded-For}i %l %u %t &quot;%r&quot; %s %b\n&quot;%{User-Agent}i&quot;\\\" resolveHosts=\\\"false\\\"\nprefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\" />\n\nIf the output does not match the expected result, this is a finding.\n\n\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nConfigure the <Host> node with the two nodes below.\n\n<Valve className=\\\"org.apache.catalina.valves.RemoteIpValve\\\"\nhttpServerPort=\\\"80\\\" httpsServerPort=\\\"443\\\"\nprotocolHeader=\\\"x-forwarded-proto\\\" proxiesHeader=\\\"x-forwarded-by\\\"\nremoteIpHeader=\\\"x-forwarded-for\\\" requestAttributesEnabled=\\\"true\\\"\ninternalProxies=\\\"127\\\\.0\\\\.0\\\\.1\\\" />\n\n<Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\"\ndirectory=\\\"logs\\\" pattern=\\\"%h %{X-Forwarded-For}i %l %u %t &quot;%r&quot; %s\n%b &quot;%{User-Agent}i&quot;\\\" resolveHosts=\\\"false\\\"\nprefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\" />\"\n\n  describe xml('/usr/lib/vmware-sso/vmware-sts/conf/server.xml') do\n    its(['Server/Service/Engine/Host/Valve[@className=\"org.apache.catalina.valves.AccessLogValve\"]/@pattern']) { should cmp ['%h %{X-Forwarded-For}i %l %u %t &quot;%r&quot; %s %b &quot;%{User-Agent}i&quot;'] }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000005.rb",
        "line": 1
      },
      "id": "VCST-67-000005"
    },
    {
      "title": "The Security Token Service must set URIEncoding to UTF-8.",
      "desc": "Invalid user input occurs when a user inserts data or characters into\na hosted application's data entry field and the hosted application is\nunprepared to process that data. This results in unanticipated application\nbehavior, potentially leading to an application compromise. Invalid user input\nis one of the primary methods employed when attempting to compromise an\napplication.\n\n    An attacker can also enter Unicode characters into hosted applications in\nan effort to break out of the document home or root home directory or to bypass\nsecurity checks. The Security Token Service must be configured to use a\nconsistent character set via the URIEncoding attribute on the Connector nodes.",
      "descriptions": {
        "default": "Invalid user input occurs when a user inserts data or characters into\na hosted application's data entry field and the hosted application is\nunprepared to process that data. This results in unanticipated application\nbehavior, potentially leading to an application compromise. Invalid user input\nis one of the primary methods employed when attempting to compromise an\napplication.\n\n    An attacker can also enter Unicode characters into hosted applications in\nan effort to break out of the document home or root home directory or to bypass\nsecurity checks. The Security Token Service must be configured to use a\nconsistent character set via the URIEncoding attribute on the Connector nodes.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/server.xml | sed '2\ns/xmlns=\".*\"//g' | xmllint --xpath\n'/Server/Service/Connector[@port=\"${bio-custom.http.port}\"]/@URIEncoding' -\n\nExpected result:\n\nURIEncoding=\"UTF-8\"\n\nIf the output does not match the expected result, this is a finding",
        "fix": "Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nNavigate to each of the <Connector> nodes.\n\nConfigure each <Connector> node with the value 'URIEncoding=\"UTF-8\"'."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000251-WSR-000157",
        "gid": null,
        "rid": "VCST-67-000020",
        "stig_id": "VCST-67-000020",
        "cci": "CCI-001310",
        "nist": [
          "SI-10",
          "Rev_4"
        ]
      },
      "code": "control \"VCST-67-000020\" do\n  title \"The Security Token Service must set URIEncoding to UTF-8.\"\n  desc  \"Invalid user input occurs when a user inserts data or characters into\na hosted application's data entry field and the hosted application is\nunprepared to process that data. This results in unanticipated application\nbehavior, potentially leading to an application compromise. Invalid user input\nis one of the primary methods employed when attempting to compromise an\napplication.\n\n    An attacker can also enter Unicode characters into hosted applications in\nan effort to break out of the document home or root home directory or to bypass\nsecurity checks. The Security Token Service must be configured to use a\nconsistent character set via the URIEncoding attribute on the Connector nodes.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000251-WSR-000157\"\n  tag gid: nil\n  tag rid: \"VCST-67-000020\"\n  tag stig_id: \"VCST-67-000020\"\n  tag cci: \"CCI-001310\"\n  tag nist: [\"SI-10\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/server.xml | sed '2\ns/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'/Server/Service/Connector[@port=\\\"${bio-custom.http.port}\\\"]/@URIEncoding' -\n\nExpected result:\n\nURIEncoding=\\\"UTF-8\\\"\n\nIf the output does not match the expected result, this is a finding\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nNavigate to each of the <Connector> nodes.\n\nConfigure each <Connector> node with the value 'URIEncoding=\\\"UTF-8\\\"'.\"\n\n  list = [\"UTF-8\"]\n  describe xml('/usr/lib/vmware-sso/vmware-sts/conf/server.xml') do\n    its(['Server/Service/Connector/@URIEncoding']) { should be_in list}\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000020.rb",
        "line": 1
      },
      "id": "VCST-67-000020"
    },
    {
      "title": "The Security Token Service must be configured to show error pages with\nminimal information.",
      "desc": "Web servers will often display error messages to client users\ndisplaying enough information to aid in the debugging of the error. The\ninformation given back in error messages may display the web server type,\nversion, patches installed, plug-ins and modules installed, type of code being\nused by the hosted application, and any backends being used for data storage.\nThis information could be used by an attacker to blueprint what type of attacks\nmight be successful. As such, the Security Token Service must be configured to\nnot show server version information in error messages.",
      "descriptions": {
        "default": "Web servers will often display error messages to client users\ndisplaying enough information to aid in the debugging of the error. The\ninformation given back in error messages may display the web server type,\nversion, patches installed, plug-ins and modules installed, type of code being\nused by the hosted application, and any backends being used for data storage.\nThis information could be used by an attacker to blueprint what type of attacks\nmight be successful. As such, the Security Token Service must be configured to\nnot show server version information in error messages.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/server.xml | sed '2\ns/xmlns=\".*\"//g' | xmllint --xpath\n'/Server/Service/Engine/Host/Valve[@className=\"org.apache.catalina.valves.ErrorReportValve\"]'\n-\n\nExpected result:\n\n<Valve className=\"org.apache.catalina.valves.ErrorReportValve\"\nshowReport=\"false\" showServerInfo=\"false\"/>\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n. Locate the following Host block:\n\n<Host appBase=\"webapps\" ...>\n...\n</Host>\n\nInside this block, add the following on a new line:\n\n<Valve className=\"org.apache.catalina.valves.ErrorReportValve\"\nshowReport=\"false\" showServerInfo=\"false\" />"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000266-WSR-000159",
        "gid": null,
        "rid": "VCST-67-000024",
        "stig_id": "VCST-67-000024",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCST-67-000024\" do\n  title \"The Security Token Service must be configured to show error pages with\nminimal information.\"\n  desc  \"Web servers will often display error messages to client users\ndisplaying enough information to aid in the debugging of the error. The\ninformation given back in error messages may display the web server type,\nversion, patches installed, plug-ins and modules installed, type of code being\nused by the hosted application, and any backends being used for data storage.\nThis information could be used by an attacker to blueprint what type of attacks\nmight be successful. As such, the Security Token Service must be configured to\nnot show server version information in error messages.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000266-WSR-000159\"\n  tag gid: nil\n  tag rid: \"VCST-67-000024\"\n  tag stig_id: \"VCST-67-000024\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/server.xml | sed '2\ns/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'/Server/Service/Engine/Host/Valve[@className=\\\"org.apache.catalina.valves.ErrorReportValve\\\"]'\n-\n\nExpected result:\n\n<Valve className=\\\"org.apache.catalina.valves.ErrorReportValve\\\"\nshowReport=\\\"false\\\" showServerInfo=\\\"false\\\"/>\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n. Locate the following Host block:\n\n<Host appBase=\\\"webapps\\\" ...>\n...\n</Host>\n\nInside this block, add the following on a new line:\n\n<Valve className=\\\"org.apache.catalina.valves.ErrorReportValve\\\"\nshowReport=\\\"false\\\" showServerInfo=\\\"false\\\" />\"\n\n  describe xml('/usr/lib/vmware-sso/vmware-sts/conf/server.xml') do\n    its(['Server/Service/Engine/Host/Valve[@className=\\'org.apache.catalina.valves.ErrorReportValve\\']/@showServerInfo']) { should cmp 'false' }\n    its(['Server/Service/Engine/Host/Valve[@className=\\'org.apache.catalina.valves.ErrorReportValve\\']/@showReport']) { should cmp 'false' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000024.rb",
        "line": 1
      },
      "id": "VCST-67-000024"
    },
    {
      "title": "The Security Token Service must not have the Web Distributed Authoring\n(WebDAV) servlet installed.",
      "desc": "Web Distributed Authoring (WebDAV) is an extension to the HTTP\nprotocol that, when developed, was meant to allow users to create, change, and\nmove documents on a server, typically a web server or web share. WebDAV is not\nwidely used and has serious security concerns because it may allow clients to\nmodify unauthorized files on the web server and must therefore be disabled.\n\n    Tomcat uses the org.apache.catalina.servlets.WebdavServlet servlet to\nprovide WebDAV services. Because the WebDAV service has been found to have an\nexcessive number of vulnerabilities, this servlet must not be installed. The\nSecurity Token Service does not configure WebDAV by default.",
      "descriptions": {
        "default": "Web Distributed Authoring (WebDAV) is an extension to the HTTP\nprotocol that, when developed, was meant to allow users to create, change, and\nmove documents on a server, typically a web server or web share. WebDAV is not\nwidely used and has serious security concerns because it may allow clients to\nmodify unauthorized files on the web server and must therefore be disabled.\n\n    Tomcat uses the org.apache.catalina.servlets.WebdavServlet servlet to\nprovide WebDAV services. Because the WebDAV service has been found to have an\nexcessive number of vulnerabilities, this servlet must not be installed. The\nSecurity Token Service does not configure WebDAV by default.",
        "check": "At the command prompt, execute the following command:\n\n# grep -n 'webdav' /usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nIf the command produces any output, this is a finding.",
        "fix": "Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/web.xml.\n\nFind the <servlet-name>webdav</servlet-name> node and remove the entire parent\n<servlet> block.\n\nFind the <servlet-name>webdav</servlet-name> node and remove the entire parent\n<servlet-mapping> block."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000141-WSR-000085",
        "gid": null,
        "rid": "VCST-67-000014",
        "stig_id": "VCST-67-000014",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCST-67-000014\" do\n  title \"The Security Token Service must not have the Web Distributed Authoring\n(WebDAV) servlet installed.\"\n  desc  \"Web Distributed Authoring (WebDAV) is an extension to the HTTP\nprotocol that, when developed, was meant to allow users to create, change, and\nmove documents on a server, typically a web server or web share. WebDAV is not\nwidely used and has serious security concerns because it may allow clients to\nmodify unauthorized files on the web server and must therefore be disabled.\n\n    Tomcat uses the org.apache.catalina.servlets.WebdavServlet servlet to\nprovide WebDAV services. Because the WebDAV service has been found to have an\nexcessive number of vulnerabilities, this servlet must not be installed. The\nSecurity Token Service does not configure WebDAV by default.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000141-WSR-000085\"\n  tag gid: nil\n  tag rid: \"VCST-67-000014\"\n  tag stig_id: \"VCST-67-000014\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep -n 'webdav' /usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nIf the command produces any output, this is a finding.\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/web.xml.\n\nFind the <servlet-name>webdav</servlet-name> node and remove the entire parent\n<servlet> block.\n\nFind the <servlet-name>webdav</servlet-name> node and remove the entire parent\n<servlet-mapping> block.\"\n\n  describe xml('/usr/lib/vmware-sso/vmware-sts/conf/web.xml') do\n    its('/web-app/servlet-mapping[servlet-name=\"webdav\"]') { should eq [] }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000014.rb",
        "line": 1
      },
      "id": "VCST-67-000014"
    },
    {
      "title": "The Security Token Service must generate log records during java\nstartup and shutdown.",
      "desc": "Logging must be started as soon as possible when a service starts and\nas late as possible when a service is stopped. Many forms of suspicious actions\ncan be detected by analyzing logs for unexpected service starts and stops.\nAlso, by starting to log immediately after a service starts, it becomes more\ndifficult for suspicous activity to go un-logged.",
      "descriptions": {
        "default": "Logging must be started as soon as possible when a service starts and\nas late as possible when a service is stopped. Many forms of suspicious actions\ncan be detected by analyzing logs for unexpected service starts and stops.\nAlso, by starting to log immediately after a service starts, it becomes more\ndifficult for suspicous activity to go un-logged.",
        "check": "At the command prompt, execute the following command:\n\n# grep \"1catalina.org.apache.juli.FileHandler\"\n/usr/lib/vmware-sso/vmware-sts/conf/logging.properties\n\nExpected result:\n\nhandlers = 1catalina.org.apache.juli.FileHandler,\n2localhost.org.apache.juli.FileHandler, 3manager.org.apache.juli.FileHandler,\n4host-manager.org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\n.handlers = 1catalina.org.apache.juli.FileHandler\n1catalina.org.apache.juli.FileHandler.level = FINE\n1catalina.org.apache.juli.FileHandler.directory = ${catalina.base}/logs\n1catalina.org.apache.juli.FileHandler.prefix = catalina.\n1catalina.org.apache.juli.FileHandler.bufferSize = -1\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-sso/vmware-sts/conf/logging.properties .\n\nEnsure that the 'handlers' and '.handlers' lines are configured as below:\n\nhandlers = 1catalina.org.apache.juli.FileHandler,\n2localhost.org.apache.juli.FileHandler, 3manager.org.apache.juli.FileHandler,\n4host-manager.org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\n\n.handlers = 1catalina.org.apache.juli.FileHandler\n\nEnsure that the following lines are present:\n\n1catalina.org.apache.juli.FileHandler.level = FINE\n1catalina.org.apache.juli.FileHandler.directory = ${catalina.base}/logs\n1catalina.org.apache.juli.FileHandler.prefix = catalina.\n1catalina.org.apache.juli.FileHandler.bufferSize = -1"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000089-WSR-000047",
        "gid": null,
        "rid": "VCST-67-000006",
        "stig_id": "VCST-67-000006",
        "cci": "CCI-000169",
        "nist": [
          "AU-12 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCST-67-000006\" do\n  title \"The Security Token Service must generate log records during java\nstartup and shutdown.\"\n  desc  \"Logging must be started as soon as possible when a service starts and\nas late as possible when a service is stopped. Many forms of suspicious actions\ncan be detected by analyzing logs for unexpected service starts and stops.\nAlso, by starting to log immediately after a service starts, it becomes more\ndifficult for suspicous activity to go un-logged.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000089-WSR-000047\"\n  tag gid: nil\n  tag rid: \"VCST-67-000006\"\n  tag stig_id: \"VCST-67-000006\"\n  tag cci: \"CCI-000169\"\n  tag nist: [\"AU-12 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep \\\"1catalina.org.apache.juli.FileHandler\\\"\n/usr/lib/vmware-sso/vmware-sts/conf/logging.properties\n\nExpected result:\n\nhandlers = 1catalina.org.apache.juli.FileHandler,\n2localhost.org.apache.juli.FileHandler, 3manager.org.apache.juli.FileHandler,\n4host-manager.org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\n.handlers = 1catalina.org.apache.juli.FileHandler\n1catalina.org.apache.juli.FileHandler.level = FINE\n1catalina.org.apache.juli.FileHandler.directory = ${catalina.base}/logs\n1catalina.org.apache.juli.FileHandler.prefix = catalina.\n1catalina.org.apache.juli.FileHandler.bufferSize = -1\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-sso/vmware-sts/conf/logging.properties .\n\nEnsure that the 'handlers' and '.handlers' lines are configured as below:\n\nhandlers = 1catalina.org.apache.juli.FileHandler,\n2localhost.org.apache.juli.FileHandler, 3manager.org.apache.juli.FileHandler,\n4host-manager.org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\n\n.handlers = 1catalina.org.apache.juli.FileHandler\n\nEnsure that the following lines are present:\n\n1catalina.org.apache.juli.FileHandler.level = FINE\n1catalina.org.apache.juli.FileHandler.directory = ${catalina.base}/logs\n1catalina.org.apache.juli.FileHandler.prefix = catalina.\n1catalina.org.apache.juli.FileHandler.bufferSize = -1\"\n\n  describe parse_config_file('/usr/lib/vmware-sso/vmware-sts/conf/logging.properties').params['handlers'] do\n    it { should eq '1catalina.org.apache.juli.FileHandler, 2localhost.org.apache.juli.FileHandler, 3manager.org.apache.juli.FileHandler, 4host-manager.org.apache.juli.FileHandler, java.util.logging.ConsoleHandler' }\n  end\n\n  describe parse_config_file('/usr/lib/vmware-sso/vmware-sts/conf/logging.properties').params['.handlers'] do\n    it { should eq '1catalina.org.apache.juli.FileHandler' }\n  end\n\n  describe parse_config_file('/usr/lib/vmware-sso/vmware-sts/conf/logging.properties').params['1catalina.org.apache.juli.FileHandler.level'] do\n    it { should eq 'FINE' }\n  end\n\n  describe parse_config_file('/usr/lib/vmware-sso/vmware-sts/conf/logging.properties').params['1catalina.org.apache.juli.FileHandler.directory'] do\n    it { should eq '${catalina.base}/logs' }\n  end\n\n  describe parse_config_file('/usr/lib/vmware-sso/vmware-sts/conf/logging.properties').params['1catalina.org.apache.juli.FileHandler.prefix'] do\n    it { should eq 'catalina.' }\n  end\n\n  describe parse_config_file('/usr/lib/vmware-sso/vmware-sts/conf/logging.properties').params['1catalina.org.apache.juli.FileHandler.bufferSize'] do\n    it { should eq '-1' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000006.rb",
        "line": 1
      },
      "id": "VCST-67-000006"
    },
    {
      "title": "The Security Token Service must use the setCharacterEncodingFilter\nfilter.",
      "desc": "Invalid user input occurs when a user inserts data or characters into\na hosted application's data entry field and the hosted application is\nunprepared to process that data. This results in unanticipated application\nbehavior, potentially leading to an application compromise. Invalid user input\nis one of the primary methods employed when attempting to compromise an\napplication.\n\n    An attacker can also enter Unicode characters into hosted applications in\nan effort to break out of the document home or root home directory or to bypass\nsecurity checks. VMware utilizes the standard Tomcat SetCharacterEncodingFilter\nto provide a layer of defense against character encoding attacks. Filters are\nJava objects that performs filtering tasks on either the request to a resource\n(a servlet or static content), or on the response from a resource, or both.",
      "descriptions": {
        "default": "Invalid user input occurs when a user inserts data or characters into\na hosted application's data entry field and the hosted application is\nunprepared to process that data. This results in unanticipated application\nbehavior, potentially leading to an application compromise. Invalid user input\nis one of the primary methods employed when attempting to compromise an\napplication.\n\n    An attacker can also enter Unicode characters into hosted applications in\nan effort to break out of the document home or root home directory or to bypass\nsecurity checks. VMware utilizes the standard Tomcat SetCharacterEncodingFilter\nto provide a layer of defense against character encoding attacks. Filters are\nJava objects that performs filtering tasks on either the request to a resource\n(a servlet or static content), or on the response from a resource, or both.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2\ns/xmlns=\".*\"//g' | xmllint --xpath\n'/web-app/filter-mapping/filter-name[text()=\"setCharacterEncodingFilter\"]/parent::filter-mapping'\n-\n\nExpected result:\n\n<filter-mapping>\n    <filter-name>setCharacterEncodingFilter</filter-name>\n    <url-pattern>/*</url-pattern>\n</filter-mapping>\n\nIf the output is does not match the expected result, this is a finding.\n\nAt the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2\ns/xmlns=\".*\"//g' | xmllint --xpath\n'/web-app/filter/filter-name[text()=\"setCharacterEncodingFilter\"]/parent::filter'\n-\n\nExpected result:\n\n<filter>\n    <filter-name>setCharacterEncodingFilter</filter-name>\n\n<filter-class>org.apache.catalina.filters.SetCharacterEncodingFilter</filter-class>\n    <init-param>\n      <param-name>encoding</param-name>\n      <param-value>UTF-8</param-value>\n      <param-name>ignore</param-name>\n      <param-value>false</param-value>\n    </init-param>\n<async-supported>true</async-supported>\n</filter>\n\nIf the output is does not match the expected result, this is a finding.",
        "fix": "Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nConfigure the <web-app> node with the child nodes listed below.\n\n<filter-mapping>\n    <filter-name>setCharacterEncodingFilter</filter-name>\n    <url-pattern>/*</url-pattern>\n</filter-mapping>\n<filter>\n    <filter-name>setCharacterEncodingFilter</filter-name>\n\n<filter-class>org.apache.catalina.filters.SetCharacterEncodingFilter</filter-class>\n    <init-param>\n      <param-name>encoding</param-name>\n      <param-value>UTF-8</param-value>\n      <param-name>ignore</param-name>\n      <param-value>false</param-value>\n    </init-param>\n<async-supported>true</async-supported>\n</filter>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000251-WSR-000157",
        "gid": null,
        "rid": "VCST-67-000021",
        "stig_id": "VCST-67-000021",
        "cci": "CCI-001310",
        "nist": [
          "SI-10",
          "Rev_4"
        ]
      },
      "code": "control \"VCST-67-000021\" do\n  title \"The Security Token Service must use the setCharacterEncodingFilter\nfilter.\"\n  desc  \"Invalid user input occurs when a user inserts data or characters into\na hosted application's data entry field and the hosted application is\nunprepared to process that data. This results in unanticipated application\nbehavior, potentially leading to an application compromise. Invalid user input\nis one of the primary methods employed when attempting to compromise an\napplication.\n\n    An attacker can also enter Unicode characters into hosted applications in\nan effort to break out of the document home or root home directory or to bypass\nsecurity checks. VMware utilizes the standard Tomcat SetCharacterEncodingFilter\nto provide a layer of defense against character encoding attacks. Filters are\nJava objects that performs filtering tasks on either the request to a resource\n(a servlet or static content), or on the response from a resource, or both.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000251-WSR-000157\"\n  tag gid: nil\n  tag rid: \"VCST-67-000021\"\n  tag stig_id: \"VCST-67-000021\"\n  tag cci: \"CCI-001310\"\n  tag nist: [\"SI-10\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2\ns/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'/web-app/filter-mapping/filter-name[text()=\\\"setCharacterEncodingFilter\\\"]/parent::filter-mapping'\n-\n\nExpected result:\n\n<filter-mapping>\n    <filter-name>setCharacterEncodingFilter</filter-name>\n    <url-pattern>/*</url-pattern>\n</filter-mapping>\n\nIf the output is does not match the expected result, this is a finding.\n\nAt the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2\ns/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'/web-app/filter/filter-name[text()=\\\"setCharacterEncodingFilter\\\"]/parent::filter'\n-\n\nExpected result:\n\n<filter>\n    <filter-name>setCharacterEncodingFilter</filter-name>\n\n<filter-class>org.apache.catalina.filters.SetCharacterEncodingFilter</filter-class>\n    <init-param>\n      <param-name>encoding</param-name>\n      <param-value>UTF-8</param-value>\n      <param-name>ignore</param-name>\n      <param-value>false</param-value>\n    </init-param>\n<async-supported>true</async-supported>\n</filter>\n\nIf the output is does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nConfigure the <web-app> node with the child nodes listed below.\n\n<filter-mapping>\n    <filter-name>setCharacterEncodingFilter</filter-name>\n    <url-pattern>/*</url-pattern>\n</filter-mapping>\n<filter>\n    <filter-name>setCharacterEncodingFilter</filter-name>\n\n<filter-class>org.apache.catalina.filters.SetCharacterEncodingFilter</filter-class>\n    <init-param>\n      <param-name>encoding</param-name>\n      <param-value>UTF-8</param-value>\n      <param-name>ignore</param-name>\n      <param-value>false</param-value>\n    </init-param>\n<async-supported>true</async-supported>\n</filter>\"\n\n  describe xml('/usr/lib/vmware-sso/vmware-sts/conf/web.xml') do\n    its('/web-app/filter-mapping[filter-name=\"setCharacterEncodingFilter\"]/url-pattern') { should cmp '*' }\n    its('/web-app/filter[filter-name=\"setCharacterEncodingFilter\"]/filter-class') { should cmp 'org.apache.catalina.filters.SetCharacterEncodingFilter' }\n    its('/web-app/filter[filter-name=\"setCharacterEncodingFilter\"]/init-param[param-name=\"encoding\"]/param-value') { should cmp 'UTF-8' }\n    its('/web-app/filter[filter-name=\"setCharacterEncodingFilter\"]/init-param[param-name=\"ignore\"]/param-value') { should cmp 'false' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000021.rb",
        "line": 1
      },
      "id": "VCST-67-000021"
    },
    {
      "title": "The Security Token Service must have the debug option disabled.",
      "desc": "Information needed by an attacker to begin looking for possible\nvulnerabilities in a web server includes any information about the web server\nand plug-ins or modules being used. When debugging or trace information is\nenabled in a production web server, information about the web server, such as\nweb server type, version, patches installed, plug-ins and modules installed,\ntype of code being used by the hosted application, and any backends being used\nfor data storage may be displayed. Since this information may be placed in logs\nand general messages during normal operation of the web server, an attacker\ndoes not need to cause an error condition to gain this information.\n\n    The Security Token Service can be configured to set the debugging level. By\nsetting the debugging level to zero (0), no debugging information will be\nprovided to a malicious user.",
      "descriptions": {
        "default": "Information needed by an attacker to begin looking for possible\nvulnerabilities in a web server includes any information about the web server\nand plug-ins or modules being used. When debugging or trace information is\nenabled in a production web server, information about the web server, such as\nweb server type, version, patches installed, plug-ins and modules installed,\ntype of code being used by the hosted application, and any backends being used\nfor data storage may be displayed. Since this information may be placed in logs\nand general messages during normal operation of the web server, an attacker\ndoes not need to cause an error condition to gain this information.\n\n    The Security Token Service can be configured to set the debugging level. By\nsetting the debugging level to zero (0), no debugging information will be\nprovided to a malicious user.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2\ns/xmlns=\".*\"//g' | xmllint --xpath\n'//param-name[text()=\"debug\"]/parent::init-param' -\n\nExpected result:\n\n<init-param>\n<param-name>debug</param-name>\n<param-value>0</param-value>\n</init-param>\n\nIf the output of the command does not match the expected result, this is a finding. If no lines is returned this is NOT a finding.",
        "fix": "Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nNavigate to all <debug> nodes that are not set to \"0\".\n\nSet the <param-value> to \"0\" in all <param-name>debug</param-name> nodes.\n\nNote: The debug setting should look like the below:\n\n               <init-param>\n                  <param-name>debug</param-name>\n                  <param-value>0</param-value>\n               </init-param>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000266-WSR-000160",
        "gid": null,
        "rid": "VCST-67-000026",
        "stig_id": "VCST-67-000026",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCST-67-000026\" do\n  title \"The Security Token Service must have the debug option disabled.\"\n  desc  \"Information needed by an attacker to begin looking for possible\nvulnerabilities in a web server includes any information about the web server\nand plug-ins or modules being used. When debugging or trace information is\nenabled in a production web server, information about the web server, such as\nweb server type, version, patches installed, plug-ins and modules installed,\ntype of code being used by the hosted application, and any backends being used\nfor data storage may be displayed. Since this information may be placed in logs\nand general messages during normal operation of the web server, an attacker\ndoes not need to cause an error condition to gain this information.\n\n    The Security Token Service can be configured to set the debugging level. By\nsetting the debugging level to zero (0), no debugging information will be\nprovided to a malicious user.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000266-WSR-000160\"\n  tag gid: nil\n  tag rid: \"VCST-67-000026\"\n  tag stig_id: \"VCST-67-000026\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2\ns/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'//param-name[text()=\\\"debug\\\"]/parent::init-param' -\n\nExpected result:\n\n<init-param>\n<param-name>debug</param-name>\n<param-value>0</param-value>\n</init-param>\n\nIf the output of the command does not match the expected result, this is a finding. If no lines is returned this is NOT a finding.\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nNavigate to all <debug> nodes that are not set to \\\"0\\\".\n\nSet the <param-value> to \\\"0\\\" in all <param-name>debug</param-name> nodes.\n\nNote: The debug setting should look like the below:\n\n               <init-param>\n                  <param-name>debug</param-name>\n                  <param-value>0</param-value>\n               </init-param>\"\n\n  describe.one do\n\n    describe xml('/usr/lib/vmware-sso/vmware-sts/conf/web.xml') do\n      its('/web-app/servlet/init-param[param-name=\"debug\"]/param-value') { should eq [] }\n    end\n\n    describe xml('/usr/lib/vmware-sso/vmware-sts/conf/web.xml') do\n      its('/web-app/servlet/init-param[param-name=\"debug\"]/param-value') { should cmp \"0\" }\n    end\n  \n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000026.rb",
        "line": 1
      },
      "id": "VCST-67-000026"
    },
    {
      "title": "The Security Token Service must have Multipurpose Internet Mail\nExtensions (MIME) that invoke OS shell programs disabled.",
      "desc": "MIME mappings tell the Security Token Service what type of program\nvarious file types and extensions are and what external utilities or programs\nare needed to execute the file type. By ensuring that various shell\nscript MIME types are not included in web.xml, the server is protected against\nmalicious users tricking the server into executing shell command files.",
      "descriptions": {
        "default": "MIME mappings tell the Security Token Service what type of program\nvarious file types and extensions are and what external utilities or programs\nare needed to execute the file type. By ensuring that various shell\nscript MIME types are not included in web.xml, the server is protected against\nmalicious users tricking the server into executing shell command files.",
        "check": "At the command prompt, execute the following command:\n\n# grep -En '(x-csh<)|(x-sh<)|(x-shar<)|(x-ksh<)'\n/usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nIf the command produces any output, this is a finding.",
        "fix": "Open /usr/lib/vmware-sso/vmware-sts/conf/web.xml in a text editor.\nRemove any and all of the following nodes lines.\n\n<mime-type>application/x-csh</mime-type>\n<mime-type>application/x-shar</mime-type>\n<mime-type>application/x-sh</mime-type>\n<mime-type>application/x-ksh</mime-type>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000141-WSR-000081",
        "gid": null,
        "rid": "VCST-67-000012",
        "stig_id": "VCST-67-000012",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCST-67-000012\" do\n  title \"The Security Token Service must have Multipurpose Internet Mail\nExtensions (MIME) that invoke OS shell programs disabled.\"\n  desc  \"MIME mappings tell the Security Token Service what type of program\nvarious file types and extensions are and what external utilities or programs\nare needed to execute the file type. By ensuring that various shell\nscript MIME types are not included in web.xml, the server is protected against\nmalicious users tricking the server into executing shell command files.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000141-WSR-000081\"\n  tag gid: nil\n  tag rid: \"VCST-67-000012\"\n  tag stig_id: \"VCST-67-000012\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep -En '(x-csh<)|(x-sh<)|(x-shar<)|(x-ksh<)'\n/usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nIf the command produces any output, this is a finding.\"\n  desc 'fix', \"Open /usr/lib/vmware-sso/vmware-sts/conf/web.xml in a text editor.\nRemove any and all of the following nodes lines.\n\n<mime-type>application/x-csh</mime-type>\n<mime-type>application/x-shar</mime-type>\n<mime-type>application/x-sh</mime-type>\n<mime-type>application/x-ksh</mime-type>\"\n\n  describe command('grep -En \\'(x-csh<)|(x-sh<)|(x-shar<)|(x-ksh<)\\' /usr/lib/vmware-sso/vmware-sts/conf/web.xml') do\n    its ('stdout.strip') { should eq '' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000012.rb",
        "line": 1
      },
      "id": "VCST-67-000012"
    },
    {
      "title": "The Security Token Service must not be configured with unsupported\nrealms.",
      "desc": "The Security Token Service performs user authentication at the\napplication level and not through Tomcat. In the name of eliminating\nunnecessary features and to ensure that the Security Token Service remains in\nit's shipping state, the lack of a UserDatabaseRealm configuration must be\nconfirmed.",
      "descriptions": {
        "default": "The Security Token Service performs user authentication at the\napplication level and not through Tomcat. In the name of eliminating\nunnecessary features and to ensure that the Security Token Service remains in\nit's shipping state, the lack of a UserDatabaseRealm configuration must be\nconfirmed.",
        "check": "At the command prompt, execute the following command:\n\n# grep UserDatabaseRealm /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nIf the command produces any output, this is a finding.",
        "fix": "Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n. Remove the <Realm> node returned in the check."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000141-WSR-000015",
        "gid": null,
        "rid": "VCST-67-000010",
        "stig_id": "VCST-67-000010",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCST-67-000010\" do\n  title \"The Security Token Service must not be configured with unsupported\nrealms.\"\n  desc  \"The Security Token Service performs user authentication at the\napplication level and not through Tomcat. In the name of eliminating\nunnecessary features and to ensure that the Security Token Service remains in\nit's shipping state, the lack of a UserDatabaseRealm configuration must be\nconfirmed.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000141-WSR-000015\"\n  tag gid: nil\n  tag rid: \"VCST-67-000010\"\n  tag stig_id: \"VCST-67-000010\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep UserDatabaseRealm /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nIf the command produces any output, this is a finding.\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n. Remove the <Realm> node returned in the check.\"\n\n  describe command('grep UserDatabaseRealm /usr/lib/vmware-sso/vmware-sts/conf/server.xml') do\n    its ('stdout.strip') { should eq '' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000010.rb",
        "line": 1
      },
      "id": "VCST-67-000010"
    },
    {
      "title": "The Security Token Service must limit the number of allowed\nconnections.",
      "desc": "Limiting the number of established connections to the Security Token\nService is a basic DoS protection. Servers where the limit is too high or\nunlimited can potentially run out of system resources and negatively affect\nsystem availability.",
      "descriptions": {
        "default": "Limiting the number of established connections to the Security Token\nService is a basic DoS protection. Servers where the limit is too high or\nunlimited can potentially run out of system resources and negatively affect\nsystem availability.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/server.xml | sed '2\ns/xmlns=\".*\"//g' | xmllint --xpath\n'/Server/Service/Connector[@port=\"${bio-custom.http.port}\"]/@acceptCount' -\n\nExpected result:\n\nacceptCount=\"100\"\n\nIf the output does not match the expected result, this is a finding",
        "fix": "Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nNavigate to the <Connector> configured with port=\"${bio-custom.http.port}\".\nAdd or change the folllowing value:\n\nacceptCount=\"100\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000246-WSR-000149",
        "gid": null,
        "rid": "VCST-67-000019",
        "stig_id": "VCST-67-000019",
        "cci": "CCI-001094",
        "nist": [
          "SC-5 (1)",
          "Rev_4"
        ]
      },
      "code": "control \"VCST-67-000019\" do\n  title \"The Security Token Service must limit the number of allowed\nconnections.\"\n  desc  \"Limiting the number of established connections to the Security Token\nService is a basic DoS protection. Servers where the limit is too high or\nunlimited can potentially run out of system resources and negatively affect\nsystem availability.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000246-WSR-000149\"\n  tag gid: nil\n  tag rid: \"VCST-67-000019\"\n  tag stig_id: \"VCST-67-000019\"\n  tag cci: \"CCI-001094\"\n  tag nist: [\"SC-5 (1)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/server.xml | sed '2\ns/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'/Server/Service/Connector[@port=\\\"${bio-custom.http.port}\\\"]/@acceptCount' -\n\nExpected result:\n\nacceptCount=\\\"100\\\"\n\nIf the output does not match the expected result, this is a finding\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nNavigate to the <Connector> configured with port=\\\"${bio-custom.http.port}\\\".\nAdd or change the folllowing value:\n\nacceptCount=\\\"100\\\"\"\n\n  describe xml('/usr/lib/vmware-sso/vmware-sts/conf/server.xml') do\n    its(['Server/Service/Connector[@port=\"${bio-custom.http.port}\"]/@acceptCount']) { should cmp '100'}\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000019.rb",
        "line": 1
      },
      "id": "VCST-67-000019"
    },
    {
      "title": "Rsyslog must be configured to monitor and ship Security Token Service\nlog files.",
      "desc": "The Security Token Service produces a number of logs that must be\noffloaded from the originating system. This information can then be used for\ndiagnostic purposes, forensics purposes, or other purposes relevant to ensuring\nthe availability and integrity of the hosted application.",
      "descriptions": {
        "default": "The Security Token Service produces a number of logs that must be\noffloaded from the originating system. This information can then be used for\ndiagnostic purposes, forensics purposes, or other purposes relevant to ensuring\nthe availability and integrity of the hosted application.",
        "check": "At the command prompt, execute the following command:\n\n# grep -v \"^#\" /etc/vmware-syslog/stig-services-sso.conf\n\nExpected result:\n\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/*.log\"\n      Tag=\"vmidentity\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/sts-runtime.log.*\"\n      Tag=\"sts-runtime\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n\nIf the file does not exist, this is a finding.\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open /etc/vmware-syslog/stig-services-sso.conf ,\ncreating the file if it does not exist.\n\nSet the contents of the file as follows:\n\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/*.log\"\n      Tag=\"vmidentity\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/sts-runtime.log.*\"\n      Tag=\"sts-runtime\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000358-WSR-000163",
        "gid": null,
        "rid": "VCST-67-000027",
        "stig_id": "VCST-67-000027",
        "cci": "CCI-001851",
        "nist": [
          "AU-4 (1)",
          "Rev_4"
        ]
      },
      "code": "control \"VCST-67-000027\" do\n  title \"Rsyslog must be configured to monitor and ship Security Token Service\nlog files.\"\n  desc  \"The Security Token Service produces a number of logs that must be\noffloaded from the originating system. This information can then be used for\ndiagnostic purposes, forensics purposes, or other purposes relevant to ensuring\nthe availability and integrity of the hosted application.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000358-WSR-000163\"\n  tag gid: nil\n  tag rid: \"VCST-67-000027\"\n  tag stig_id: \"VCST-67-000027\"\n  tag cci: \"CCI-001851\"\n  tag nist: [\"AU-4 (1)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep -v \\\"^#\\\" /etc/vmware-syslog/stig-services-sso.conf\n\nExpected result:\n\ninput(type=\\\"imfile\\\"\n      File=\\\"/var/log/vmware/sso/*.log\\\"\n      Tag=\\\"vmidentity\\\"\n      PersistStateInterval=\\\"200\\\"\n      Severity=\\\"info\\\"\n      Facility=\\\"local0\\\")\ninput(type=\\\"imfile\\\"\n      File=\\\"/var/log/vmware/sso/sts-runtime.log.*\\\"\n      Tag=\\\"sts-runtime\\\"\n      PersistStateInterval=\\\"200\\\"\n      Severity=\\\"info\\\"\n      Facility=\\\"local0\\\")\n\nIf the file does not exist, this is a finding.\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open /etc/vmware-syslog/stig-services-sso.conf ,\ncreating the file if it does not exist.\n\nSet the contents of the file as follows:\n\ninput(type=\\\"imfile\\\"\n      File=\\\"/var/log/vmware/sso/*.log\\\"\n      Tag=\\\"vmidentity\\\"\n      PersistStateInterval=\\\"200\\\"\n      Severity=\\\"info\\\"\n      Facility=\\\"local0\\\")\ninput(type=\\\"imfile\\\"\n      File=\\\"/var/log/vmware/sso/sts-runtime.log.*\\\"\n      Tag=\\\"sts-runtime\\\"\n      PersistStateInterval=\\\"200\\\"\n      Severity=\\\"info\\\"\n      Facility=\\\"local0\\\")\"\n\n  describe file('/etc/vmware-syslog/stig-services-sso.conf') do\n    it { should exist }\n  end\n  describe command('grep -v \"^#\" /etc/vmware-syslog/stig-services-sso.conf') do\n    its ('stdout') { should match \"input(type=\\\"imfile\\\"\\n      File=\\\"/var/log/vmware/sso/*.log\\\"\\n      Tag=\\\"vmidentity\\\"\\n      PersistStateInterval=\\\"200\\\"\\n      Severity=\\\"info\\\"\\n      Facility=\\\"local0\\\")\\ninput(type=\\\"imfile\\\"\\n      File=\\\"/var/log/vmware/sso/sts-runtime.log.*\\\"\\n      Tag=\\\"sts-runtime\\\"\\n      PersistStateInterval=\\\"200\\\"\\n      Severity=\\\"info\\\"\\n      Facility=\\\"local0\\\")\\n\" }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000027.rb",
        "line": 1
      },
      "id": "VCST-67-000027"
    },
    {
      "title": "The Security Token Service must limit the number of concurrent\nconnections permitted.",
      "desc": "Resource exhaustion can occur when an unlimited number of concurrent\nrequests are allowed on a web site, facilitating a denial of service attack.\nUnless the number of requests is controlled, the web server can consume enough\nsystem resources to cause a system crash.\n\n    Mitigating this kind of attack will include limiting the number of\nconcurrent HTTP/HTTPS requests. In Tomcat, each incoming request requires a\nthread for the duration of that request. If more simultaneous requests are\nreceived than can be handled by the currently available request processing\nthreads, additional threads will be created up to the value of the maxThreads\nattribute.",
      "descriptions": {
        "default": "Resource exhaustion can occur when an unlimited number of concurrent\nrequests are allowed on a web site, facilitating a denial of service attack.\nUnless the number of requests is controlled, the web server can consume enough\nsystem resources to cause a system crash.\n\n    Mitigating this kind of attack will include limiting the number of\nconcurrent HTTP/HTTPS requests. In Tomcat, each incoming request requires a\nthread for the duration of that request. If more simultaneous requests are\nreceived than can be handled by the currently available request processing\nthreads, additional threads will be created up to the value of the maxThreads\nattribute.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/server.xml | sed '2\ns/xmlns=\".*\"//g' | xmllint --xpath\n'/Server/Service/Executor[@name=\"tomcatThreadPool\"]/@maxThreads' -\n\nExpected result:\n\nmaxThreads=\"300\"\n\nIf the output does not match the expected result, this is a finding",
        "fix": "Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nNavigate to the <Executor> mode with the name of tomcatThreadPool and configure\nwith the value 'maxThreads=\"300\"'\n\nNote: The <Executor> node should be configured per the below:\n\n<Executor maxThreads=\"300\" minSpareThreads=\"50\" name=\"tomcatThreadPool\"\nnamePrefix=\"tomcat-http--\" />"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000001-WSR-000001",
        "gid": null,
        "rid": "VCST-67-000002",
        "stig_id": "VCST-67-000002",
        "cci": "CCI-000054",
        "nist": [
          "AC-10",
          "Rev_4"
        ]
      },
      "code": "control \"VCST-67-000002\" do\n  title \"The Security Token Service must limit the number of concurrent\nconnections permitted.\"\n  desc  \"Resource exhaustion can occur when an unlimited number of concurrent\nrequests are allowed on a web site, facilitating a denial of service attack.\nUnless the number of requests is controlled, the web server can consume enough\nsystem resources to cause a system crash.\n\n    Mitigating this kind of attack will include limiting the number of\nconcurrent HTTP/HTTPS requests. In Tomcat, each incoming request requires a\nthread for the duration of that request. If more simultaneous requests are\nreceived than can be handled by the currently available request processing\nthreads, additional threads will be created up to the value of the maxThreads\nattribute.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000001-WSR-000001\"\n  tag gid: nil\n  tag rid: \"VCST-67-000002\"\n  tag stig_id: \"VCST-67-000002\"\n  tag cci: \"CCI-000054\"\n  tag nist: [\"AC-10\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/server.xml | sed '2\ns/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'/Server/Service/Executor[@name=\\\"tomcatThreadPool\\\"]/@maxThreads' -\n\nExpected result:\n\nmaxThreads=\\\"300\\\"\n\nIf the output does not match the expected result, this is a finding\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nNavigate to the <Executor> mode with the name of tomcatThreadPool and configure\nwith the value 'maxThreads=\\\"300\\\"'\n\nNote: The <Executor> node should be configured per the below:\n\n<Executor maxThreads=\\\"300\\\" minSpareThreads=\\\"50\\\" name=\\\"tomcatThreadPool\\\"\nnamePrefix=\\\"tomcat-http--\\\" />\n\"\n\n  describe xml('/usr/lib/vmware-sso/vmware-sts/conf/server.xml') do\n    its(['/Server/Service/Executor[@name=\"tomcatThreadPool\"]/@maxThreads']) { should cmp '300' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000002.rb",
        "line": 1
      },
      "id": "VCST-67-000002"
    },
    {
      "title": "The Security Token Service must limit the amount of time that each TCP\nconnection is kept alive.",
      "desc": "Denial of Service is one threat against web servers.  Many DoS attacks\nattempt to consume web server resources in such a way that no more resources\nare available to satisfy legitimate requests.\n\n    In Tomcat, the 'connectionTimeout' attribute sets the number of\nmilliseconds the server will wait after accepting a connection for the request\nURI line to be presented. This timeout will also be used when reading the\nrequest body (if any). This prevents idle sockets that are not sending HTTP\nrequests from consuming system resources and potentially denying new\nconnections.",
      "descriptions": {
        "default": "Denial of Service is one threat against web servers.  Many DoS attacks\nattempt to consume web server resources in such a way that no more resources\nare available to satisfy legitimate requests.\n\n    In Tomcat, the 'connectionTimeout' attribute sets the number of\nmilliseconds the server will wait after accepting a connection for the request\nURI line to be presented. This timeout will also be used when reading the\nrequest body (if any). This prevents idle sockets that are not sending HTTP\nrequests from consuming system resources and potentially denying new\nconnections.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/server.xml | sed '2\ns/xmlns=\".*\"//g' | xmllint --xpath\n'/Server/Service/Connector[@port=\"${bio-custom.http.port}\"]/@connectionTimeout'\n-\n\nExpected result:\n\nconnectionTimeout=\"60000\"\n\nIf the output does not match the expected result, this is a finding",
        "fix": "Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nNavigate to each of the <Connector> nodes.\n\nConfigure each <Connector> node with the value:\n\nconnectionTimeout=\"60000\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000001-WSR-000001",
        "gid": null,
        "rid": "VCST-67-000001",
        "stig_id": "VCST-67-000001",
        "cci": "CCI-000054",
        "nist": [
          "AC-10",
          "Rev_4"
        ]
      },
      "code": "control \"VCST-67-000001\" do\n  title \"The Security Token Service must limit the amount of time that each TCP\nconnection is kept alive.\"\n  desc  \"Denial of Service is one threat against web servers.  Many DoS attacks\nattempt to consume web server resources in such a way that no more resources\nare available to satisfy legitimate requests.\n\n    In Tomcat, the 'connectionTimeout' attribute sets the number of\nmilliseconds the server will wait after accepting a connection for the request\nURI line to be presented. This timeout will also be used when reading the\nrequest body (if any). This prevents idle sockets that are not sending HTTP\nrequests from consuming system resources and potentially denying new\nconnections.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000001-WSR-000001\"\n  tag gid: nil\n  tag rid: \"VCST-67-000001\"\n  tag stig_id: \"VCST-67-000001\"\n  tag cci: \"CCI-000054\"\n  tag nist: [\"AC-10\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/server.xml | sed '2\ns/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'/Server/Service/Connector[@port=\\\"${bio-custom.http.port}\\\"]/@connectionTimeout'\n-\n\nExpected result:\n\nconnectionTimeout=\\\"60000\\\"\n\nIf the output does not match the expected result, this is a finding\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nNavigate to each of the <Connector> nodes.\n\nConfigure each <Connector> node with the value:\n\nconnectionTimeout=\\\"60000\\\"\"\n\n  begin\n    vcui_conf = xml('/usr/lib/vmware-sso/vmware-sts/conf/server.xml')\n\n      if vcui_conf['Server/Service/Connector/attribute::connectionTimeout'].is_a?(Array)\n        vcui_conf['Server/Service/Connector/attribute::connectionTimeout'].each do |x|\n          describe x do\n            it { should eq \"60000\" }\n          end\n        end\n      else\n        describe xml(vcui_conf['Server/Service/Connector/attribute::connectionTimeout']) do\n          it { should eq \"60000\" }\n        end\n      end\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000001.rb",
        "line": 1
      },
      "id": "VCST-67-000001"
    },
    {
      "title": "The Security Token Service must be configured to limit access to\ninternal packages.",
      "desc": "The 'package.access' entry in the catalina.properties file implements\naccess control at the package level. When properly configured, a Security\nException will be reported should an errant or malicious webapp attempt to\naccess the listed internal classes directly, or if a new class is defined under\nthe protected packages. The Security Token Service comes pre-configured with\nthe appropriate packages defined in 'package.access' and this configuration\nmust be maintained.",
      "descriptions": {
        "default": "The 'package.access' entry in the catalina.properties file implements\naccess control at the package level. When properly configured, a Security\nException will be reported should an errant or malicious webapp attempt to\naccess the listed internal classes directly, or if a new class is defined under\nthe protected packages. The Security Token Service comes pre-configured with\nthe appropriate packages defined in 'package.access' and this configuration\nmust be maintained.",
        "check": "At the command prompt, execute the following command:\n\n# grep \"package.access\"\n/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nExpected result:\n\npackage.access=sun.,org.apache.catalina.,org.apache.coyote.,org.apache.tomcat.,org.apache.jasper.\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties and ensure that the\n'package.access' line is configured as follows:\n\npackage.access=sun.,org.apache.catalina.,org.apache.coyote.,org.apache.tomcat.,org.apache.jasper."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000141-WSR-000075",
        "gid": null,
        "rid": "VCST-67-000011",
        "stig_id": "VCST-67-000011",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCST-67-000011\" do\n  title \"The Security Token Service must be configured to limit access to\ninternal packages.\"\n  desc  \"The 'package.access' entry in the catalina.properties file implements\naccess control at the package level. When properly configured, a Security\nException will be reported should an errant or malicious webapp attempt to\naccess the listed internal classes directly, or if a new class is defined under\nthe protected packages. The Security Token Service comes pre-configured with\nthe appropriate packages defined in 'package.access' and this configuration\nmust be maintained. \"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000141-WSR-000075\"\n  tag gid: nil\n  tag rid: \"VCST-67-000011\"\n  tag stig_id: \"VCST-67-000011\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep \\\"package.access\\\"\n/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nExpected result:\n\npackage.access=sun.,org.apache.catalina.,org.apache.coyote.,org.apache.tomcat.,org.apache.jasper.\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties and ensure that the\n'package.access' line is configured as follows:\n\npackage.access=sun.,org.apache.catalina.,org.apache.coyote.,org.apache.tomcat.,org.apache.jasper.\n\"\n\n  describe parse_config_file('/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties').params['package.access'] do\n    it { should eq 'sun.,org.apache.catalina.,org.apache.coyote.,org.apache.tomcat.,org.apache.jasper.' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000011.rb",
        "line": 1
      },
      "id": "VCST-67-000011"
    },
    {
      "title": "Security Token Service log files must only be modifiable by privileged\nusers.",
      "desc": "Log data is essential in the investigation of events. The accuracy of\nthe information is always pertinent. One of the first steps an attacker will\nundertake is the modification or deletion of log records to cover his tracks\nand prolong discovery. The web server must protect the log data from\nunauthorized modification. Security Token Service restricts all modification of\nlog files by default but this configuration must be verified.",
      "descriptions": {
        "default": "Log data is essential in the investigation of events. The accuracy of\nthe information is always pertinent. One of the first steps an attacker will\nundertake is the modification or deletion of log records to cover his tracks\nand prolong discovery. The web server must protect the log data from\nunauthorized modification. Security Token Service restricts all modification of\nlog files by default but this configuration must be verified.",
        "check": "At the command prompt, execute the following command:\n\n# find /storage/log/vmware/sso/ -xdev -type f -a '(' -perm -o+w -o -not -user\nroot -o -not -group root ')' -exec ls -ld {} \\;\n\nIf any files are returned, this is a finding.",
        "fix": "At the command prompt, execute the following commands:\n\n# chmod o-w <file>\n# chown root:root <file>\n\nNote: Subsitute <file> with the listed file."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000119-WSR-000069",
        "gid": null,
        "rid": "VCST-67-000007",
        "stig_id": "VCST-67-000007",
        "cci": "CCI-000163",
        "nist": [
          "AU-9",
          "Rev_4"
        ]
      },
      "code": "control \"VCST-67-000007\" do\n  title \"Security Token Service log files must only be modifiable by privileged\nusers.\"\n  desc  \"Log data is essential in the investigation of events. The accuracy of\nthe information is always pertinent. One of the first steps an attacker will\nundertake is the modification or deletion of log records to cover his tracks\nand prolong discovery. The web server must protect the log data from\nunauthorized modification. Security Token Service restricts all modification of\nlog files by default but this configuration must be verified.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000119-WSR-000069\"\n  tag gid: nil\n  tag rid: \"VCST-67-000007\"\n  tag stig_id: \"VCST-67-000007\"\n  tag cci: \"CCI-000163\"\n  tag nist: [\"AU-9\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# find /storage/log/vmware/sso/ -xdev -type f -a '(' -perm -o+w -o -not -user\nroot -o -not -group root ')' -exec ls -ld {} \\\\;\n\nIf any files are returned, this is a finding.\"\n  desc 'fix', \"At the command prompt, execute the following commands:\n\n# chmod o-w <file>\n# chown root:root <file>\n\nNote: Subsitute <file> with the listed file.\"\n\n  command('find /storage/log/vmware/sso/ -type f -xdev').stdout.split.each do | fname |\n    describe file(fname) do\n      it { should_not be_more_permissive_than('0644') }\n      its('owner') {should eq 'root'}\n      its('group') {should eq 'root'}\n    end\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000007.rb",
        "line": 1
      },
      "id": "VCST-67-000007"
    },
    {
      "title": "The Security Token Service must have mappings set for Java servlet\npages.",
      "desc": "Resource mapping is the process of tying a particular file type to a\nprocess in the web server that can serve that type of file to a requesting\nclient and to identify which file types are not to be delivered to a client.\n\n    By not specifying which files can and which files cannot be served to a\nuser, the web server could deliver to a user web server configuration files,\nlog files, password files, etc.\n\n    As Tomcat is a java-based web server, the main file extension used is\n*.jsp.  This check ensures that the *.jsp and *.jspx file types has been\nproperly mapped to servlets.",
      "descriptions": {
        "default": "Resource mapping is the process of tying a particular file type to a\nprocess in the web server that can serve that type of file to a requesting\nclient and to identify which file types are not to be delivered to a client.\n\n    By not specifying which files can and which files cannot be served to a\nuser, the web server could deliver to a user web server configuration files,\nlog files, password files, etc.\n\n    As Tomcat is a java-based web server, the main file extension used is\n*.jsp.  This check ensures that the *.jsp and *.jspx file types has been\nproperly mapped to servlets.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2\ns/xmlns=\".*\"//g' | xmllint --xpath\n'/web-app/servlet-mapping/servlet-name[text()=\"jsp\"]/parent::servlet-mapping'\n-\n\nExpected result:\n\n<servlet-mapping>\n    <servlet-name>jsp</servlet-name>\n    <url-pattern>*.jsp</url-pattern>\n    <url-pattern>*.jspx</url-pattern>\n</servlet-mapping>\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nInside the <web-app> parent node, add the following:\n\n<servlet-mapping>\n    <servlet-name>jsp</servlet-name>\n    <url-pattern>*.jsp</url-pattern>\n    <url-pattern>*.jspx</url-pattern>\n</servlet-mapping>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000141-WSR-000083",
        "gid": null,
        "rid": "VCST-67-000013",
        "stig_id": "VCST-67-000013",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCST-67-000013\" do\n  title \"The Security Token Service must have mappings set for Java servlet\npages.\"\n  desc  \"Resource mapping is the process of tying a particular file type to a\nprocess in the web server that can serve that type of file to a requesting\nclient and to identify which file types are not to be delivered to a client.\n\n    By not specifying which files can and which files cannot be served to a\nuser, the web server could deliver to a user web server configuration files,\nlog files, password files, etc.\n\n    As Tomcat is a java-based web server, the main file extension used is\n*.jsp.  This check ensures that the *.jsp and *.jspx file types has been\nproperly mapped to servlets.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000141-WSR-000083\"\n  tag gid: nil\n  tag rid: \"VCST-67-000013\"\n  tag stig_id: \"VCST-67-000013\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2\ns/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'/web-app/servlet-mapping/servlet-name[text()=\\\"jsp\\\"]/parent::servlet-mapping'\n-\n\nExpected result:\n\n<servlet-mapping>\n    <servlet-name>jsp</servlet-name>\n    <url-pattern>*.jsp</url-pattern>\n    <url-pattern>*.jspx</url-pattern>\n</servlet-mapping>\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nInside the <web-app> parent node, add the following:\n\n<servlet-mapping>\n    <servlet-name>jsp</servlet-name>\n    <url-pattern>*.jsp</url-pattern>\n    <url-pattern>*.jspx</url-pattern>\n</servlet-mapping>\n\"\n\n  list = [\"*.jsp\", \"*.jspx\"]\n  describe xml('/usr/lib/vmware-sso/vmware-sts/conf/web.xml') do\n    its('/web-app/servlet-mapping[servlet-name=\"JspServlet\"]/url-pattern') { should be_in list }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000013.rb",
        "line": 1
      },
      "id": "VCST-67-000013"
    },
    {
      "title": "The Security Token Service must set the secure flag for cookies.",
      "desc": "The secure flag is an option that can be set by the application server\nwhen sending a new cookie to the user within an HTTP Response. The purpose of\nthe secure flag is to prevent cookies from being observed by unauthorized\nparties due to the transmission of a the cookie in clear text. By setting the\nsecure flag, the browser will prevent the transmission of a cookie over an\nunencrypted channel. The Security Token Service is configured to only be\naccessible over a TLS tunnel but this cookie flag is still a recommended best\npractice.",
      "descriptions": {
        "default": "The secure flag is an option that can be set by the application server\nwhen sending a new cookie to the user within an HTTP Response. The purpose of\nthe secure flag is to prevent cookies from being observed by unauthorized\nparties due to the transmission of a the cookie in clear text. By setting the\nsecure flag, the browser will prevent the transmission of a cookie over an\nunencrypted channel. The Security Token Service is configured to only be\naccessible over a TLS tunnel but this cookie flag is still a recommended best\npractice.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2\ns/xmlns=\".*\"//g' | xmllint --xpath\n'/web-app/session-config/cookie-config/secure' -\n\nExpected result:\n\n<secure>true</secure>\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nNavigate to the /<web-apps>/<session-config>/<cookie-config> node and configure\nit as follows.\n\n    <cookie-config>\n      <http-only>true</http-only>\n      <secure>true</secure>\n    </cookie-config>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000439-WSR-000155",
        "gid": null,
        "rid": "VCST-67-000030",
        "stig_id": "VCST-67-000030",
        "cci": "CCI-002418",
        "nist": [
          "SC-8",
          "Rev_4"
        ]
      },
      "code": "control \"VCST-67-000030\" do\n  title \"The Security Token Service must set the secure flag for cookies.\"\n  desc  \"The secure flag is an option that can be set by the application server\nwhen sending a new cookie to the user within an HTTP Response. The purpose of\nthe secure flag is to prevent cookies from being observed by unauthorized\nparties due to the transmission of a the cookie in clear text. By setting the\nsecure flag, the browser will prevent the transmission of a cookie over an\nunencrypted channel. The Security Token Service is configured to only be\naccessible over a TLS tunnel but this cookie flag is still a recommended best\npractice.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000439-WSR-000155\"\n  tag gid: nil\n  tag rid: \"VCST-67-000030\"\n  tag stig_id: \"VCST-67-000030\"\n  tag cci: \"CCI-002418\"\n  tag nist: [\"SC-8\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2\ns/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'/web-app/session-config/cookie-config/secure' -\n\nExpected result:\n\n<secure>true</secure>\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nNavigate to the /<web-apps>/<session-config>/<cookie-config> node and configure\nit as follows.\n\n    <cookie-config>\n      <http-only>true</http-only>\n      <secure>true</secure>\n    </cookie-config>\"\n\n  describe xml('/usr/lib/vmware-sso/vmware-sts/conf/web.xml') do\n    its('/web-app/session-config/cookie-config/secure') { should cmp 'true' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000030.rb",
        "line": 1
      },
      "id": "VCST-67-000030"
    },
    {
      "title": "The Security Token Service must only run one webapp.",
      "desc": "VMware ships the Security Token Service on the VCSA with one webapp,\nin ROOT.war. Any other .war file is potentially malicious and must be removed.",
      "descriptions": {
        "default": "VMware ships the Security Token Service on the VCSA with one webapp,\nin ROOT.war. Any other .war file is potentially malicious and must be removed.",
        "check": "At the command prompt, execute the following command:\n\n# ls /usr/lib/vmware-sso/vmware-sts/webapps/*.war\n\nExpected result:\n\n/usr/lib/vmware-sso/vmware-sts/webapps/ROOT.war\n\nIf the result of this command does not match the expected result, this is a\nfinding.",
        "fix": "For each unexpected file returned in the check, run the following\ncommand:\n\n# rm /usr/lib/vmware-sso/vmware-sts/webapps/<NAME>.war\n\nRestart the service with the following command:\n\n# service-control --restart vmware-stsd"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000131-WSR-000073",
        "gid": null,
        "rid": "VCST-67-000009",
        "stig_id": "VCST-67-000009",
        "cci": "CCI-001749",
        "nist": [
          "CM-5 (3)",
          "Rev_4"
        ]
      },
      "code": "control \"VCST-67-000009\" do\n  title \"The Security Token Service must only run one webapp.\"\n  desc  \"VMware ships the Security Token Service on the VCSA with one webapp,\nin ROOT.war. Any other .war file is potentially malicious and must be removed.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000131-WSR-000073\"\n  tag gid: nil\n  tag rid: \"VCST-67-000009\"\n  tag stig_id: \"VCST-67-000009\"\n  tag cci: \"CCI-001749\"\n  tag nist: [\"CM-5 (3)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# ls /usr/lib/vmware-sso/vmware-sts/webapps/*.war\n\nExpected result:\n\n/usr/lib/vmware-sso/vmware-sts/webapps/ROOT.war\n\nIf the result of this command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"For each unexpected file returned in the check, run the following\ncommand:\n\n# rm /usr/lib/vmware-sso/vmware-sts/webapps/<NAME>.war\n\nRestart the service with the following command:\n\n# service-control --restart vmware-stsd\"\n\n  describe command('ls /usr/lib/vmware-sso/vmware-sts/webapps/*.war') do\n    its ('stdout.strip') { should eq '/usr/lib/vmware-sso/vmware-sts/webapps/ROOT.war' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000009.rb",
        "line": 1
      },
      "id": "VCST-67-000009"
    },
    {
      "title": "The Security Token Service must be configured with memory leak\nprotection.",
      "desc": "The Java Runtime environment can cause a memory leak or lock files\nunder certain conditions. Without memory leak protection, the Security Token\nService can continue to consume system resources which will lead to\nOutOfMemoryErrors when re-loading web applications.\n\n    Memory leaks occur when JRE code uses the context class loader to load a\nsingleton as this will cause a memory leak if a web application class loader\nhappens to be the context class loader at the time. The\nJreMemoryLeakPreventionListener class is designed to initialise these\nsingletons when Tomcat's common class loader is the context class loader.\nProper use of JRE memory leak protection will ensure that the hosted\napplication does not consume system resources and cause an unstable environment.",
      "descriptions": {
        "default": "The Java Runtime environment can cause a memory leak or lock files\nunder certain conditions. Without memory leak protection, the Security Token\nService can continue to consume system resources which will lead to\nOutOfMemoryErrors when re-loading web applications.\n\n    Memory leaks occur when JRE code uses the context class loader to load a\nsingleton as this will cause a memory leak if a web application class loader\nhappens to be the context class loader at the time. The\nJreMemoryLeakPreventionListener class is designed to initialise these\nsingletons when Tomcat's common class loader is the context class loader.\nProper use of JRE memory leak protection will ensure that the hosted\napplication does not consume system resources and cause an unstable environment.",
        "check": "At the command prompt, execute the following command:\n\n# grep JreMemoryLeakPreventionListener\n/usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nExpected result:\n\n<Listener\nclassName=\"org.apache.catalina.core.JreMemoryLeakPreventionListener\"/>\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nNavigate to the <Server> node.\n\nAdd '<Listener\nclassName=\"org.apache.catalina.core.JreMemoryLeakPreventionListener\"/>' to\nthe <Server> node."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000141-WSR-000086",
        "gid": null,
        "rid": "VCST-67-000015",
        "stig_id": "VCST-67-000015",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCST-67-000015\" do\n  title \"The Security Token Service must be configured with memory leak\nprotection.\"\n  desc  \"The Java Runtime environment can cause a memory leak or lock files\nunder certain conditions. Without memory leak protection, the Security Token\nService can continue to consume system resources which will lead to\nOutOfMemoryErrors when re-loading web applications.\n\n    Memory leaks occur when JRE code uses the context class loader to load a\nsingleton as this will cause a memory leak if a web application class loader\nhappens to be the context class loader at the time. The\nJreMemoryLeakPreventionListener class is designed to initialise these\nsingletons when Tomcat's common class loader is the context class loader.\nProper use of JRE memory leak protection will ensure that the hosted\napplication does not consume system resources and cause an unstable environment.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000141-WSR-000086\"\n  tag gid: nil\n  tag rid: \"VCST-67-000015\"\n  tag stig_id: \"VCST-67-000015\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep JreMemoryLeakPreventionListener\n/usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nExpected result:\n\n<Listener\nclassName=\\\"org.apache.catalina.core.JreMemoryLeakPreventionListener\\\"/>\n\nIf the output of the command does not match the expected result, this is a\nfinding.\n\n\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nNavigate to the <Server> node.\n\nAdd '<Listener\nclassName=\\\"org.apache.catalina.core.JreMemoryLeakPreventionListener\\\"/>' to\nthe <Server> node.\"\n\n  describe xml('/usr/lib/vmware-sso/vmware-sts/conf/server.xml') do\n    its('Server/Listener/attribute::className') { should include 'org.apache.catalina.core.JreMemoryLeakPreventionListener' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000015.rb",
        "line": 1
      },
      "id": "VCST-67-000015"
    },
    {
      "title": "The Security Token Service must set the welcome-file node to a default\nweb page.",
      "desc": "Enumeration techniques, such as URL parameter manipulation, rely upon\nbeing able to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. By having a default hosted application web page, the anonymous web\nuser will not obtain directory browsing information or an error message that\nreveals the server type and version. Ensuring that every document directory has\nan index.jsp (or equivalent) file is one approach to mitigating the\nvulnerability.",
      "descriptions": {
        "default": "Enumeration techniques, such as URL parameter manipulation, rely upon\nbeing able to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. By having a default hosted application web page, the anonymous web\nuser will not obtain directory browsing information or an error message that\nreveals the server type and version. Ensuring that every document directory has\nan index.jsp (or equivalent) file is one approach to mitigating the\nvulnerability.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2\ns/xmlns=\".*\"//g' | xmllint --xpath '/web-app/welcome-file-list' -\n\nExpected result:\n\n<welcome-file-list>\n<welcome-file>index.html</welcome-file>\n    <welcome-file>index.htm</welcome-file>\n    <welcome-file>index.jsp</welcome-file>\n</welcome-file-list>\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nAdd the following section under the <web-apps> node:\n\n<welcome-file-list>\n<welcome-file>index.html</welcome-file>\n    <welcome-file>index.htm</welcome-file>\n    <welcome-file>index.jsp</welcome-file>\n</welcome-file-list>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000266-WSR-000142",
        "gid": null,
        "rid": "VCST-67-000022",
        "stig_id": "VCST-67-000022",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCST-67-000022\" do\n  title \"The Security Token Service must set the welcome-file node to a default\nweb page.\"\n  desc  \"Enumeration techniques, such as URL parameter manipulation, rely upon\nbeing able to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. By having a default hosted application web page, the anonymous web\nuser will not obtain directory browsing information or an error message that\nreveals the server type and version. Ensuring that every document directory has\nan index.jsp (or equivalent) file is one approach to mitigating the\nvulnerability.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000266-WSR-000142\"\n  tag gid: nil\n  tag rid: \"VCST-67-000022\"\n  tag stig_id: \"VCST-67-000022\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2\ns/xmlns=\\\".*\\\"//g' | xmllint --xpath '/web-app/welcome-file-list' -\n\nExpected result:\n\n<welcome-file-list>\n<welcome-file>index.html</welcome-file>\n    <welcome-file>index.htm</welcome-file>\n    <welcome-file>index.jsp</welcome-file>\n</welcome-file-list>\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nAdd the following section under the <web-apps> node:\n\n<welcome-file-list>\n<welcome-file>index.html</welcome-file>\n    <welcome-file>index.htm</welcome-file>\n    <welcome-file>index.jsp</welcome-file>\n</welcome-file-list>\n\n\"\n\n  list = [\"index.html\", \"index.htm\", \"index.jsp\"]\n  describe xml('/usr/lib/vmware-sso/vmware-sts/conf/web.xml') do\n    its('/web-app/welcome-file-list/welcome-file') { should be_in list }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000022.rb",
        "line": 1
      },
      "id": "VCST-67-000022"
    },
    {
      "title": "The Security Token Service must limit the maximum size of a POST\nrequest.",
      "desc": "The 'maxPostSize' value is the maximum size in bytes of the POST which\nwill be handled by the container FORM URL parameter parsing. Limit its size to\nreduce exposure to a DOS attack. If 'maxPostSize' is not set, the default value\nof 2097152 (2MB) is used. Security Token Service is configured in it's shipping\nstate to not set a value for 'maxPostSize'.",
      "descriptions": {
        "default": "The 'maxPostSize' value is the maximum size in bytes of the POST which\nwill be handled by the container FORM URL parameter parsing. Limit its size to\nreduce exposure to a DOS attack. If 'maxPostSize' is not set, the default value\nof 2097152 (2MB) is used. Security Token Service is configured in it's shipping\nstate to not set a value for 'maxPostSize'.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/server.xml | sed '2\ns/xmlns=\".*\"//g' | xmllint --xpath\n'/Server/Service/Connector[@port=\"${bio-custom.http.port}\"]/@maxPostSize' -\n\nExpected result:\n\nXPath set is empty\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nNavigate to each of the <Connector> nodes.\n\nRemove any configuration for 'maxPostSize'."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000001-WSR-000001",
        "gid": null,
        "rid": "VCST-67-000003",
        "stig_id": "VCST-67-000003",
        "cci": "CCI-000054",
        "nist": [
          "AC-10",
          "Rev_4"
        ]
      },
      "code": "control \"VCST-67-000003\" do\n  title \"The Security Token Service must limit the maximum size of a POST\nrequest.\"\n  desc  \"The 'maxPostSize' value is the maximum size in bytes of the POST which\nwill be handled by the container FORM URL parameter parsing. Limit its size to\nreduce exposure to a DOS attack. If 'maxPostSize' is not set, the default value\nof 2097152 (2MB) is used. Security Token Service is configured in it's shipping\nstate to not set a value for 'maxPostSize'.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000001-WSR-000001\"\n  tag gid: nil\n  tag rid: \"VCST-67-000003\"\n  tag stig_id: \"VCST-67-000003\"\n  tag cci: \"CCI-000054\"\n  tag nist: [\"AC-10\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/server.xml | sed '2\ns/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'/Server/Service/Connector[@port=\\\"${bio-custom.http.port}\\\"]/@maxPostSize' -\n\nExpected result:\n\nXPath set is empty\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nNavigate to each of the <Connector> nodes.\n\nRemove any configuration for 'maxPostSize'.\n\"\n\n  describe xml('/usr/lib/vmware-sso/vmware-sts/conf/server.xml') do\n    its('Server/Service/Connector/attribute::maxPostSize') { should eq [] }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000003.rb",
        "line": 1
      },
      "id": "VCST-67-000003"
    },
    {
      "title": "The Security Token Service must not show directory listings.",
      "desc": "Enumeration techniques, such as URL parameter manipulation, rely upon\nbeing able to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. Ensuring that directory listing is disabled is one approach to\nmitigating the vulnerability.",
      "descriptions": {
        "default": "Enumeration techniques, such as URL parameter manipulation, rely upon\nbeing able to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. Ensuring that directory listing is disabled is one approach to\nmitigating the vulnerability.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2\ns/xmlns=\".*\"//g' | xmllint --xpath\n'//param-name[text()=\"listings\"]/parent::init-param' -\n\nExpected result:\n\n<init-param>\n      <param-name>listings</param-name>\n      <param-value>false</param-value>\n</init-param>\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nSet the <param-value> to \"false\" in all <param-name>listing</param-name>\nnodes.\n\nNote: The setting should look like the below:\n\n<init-param>\n      <param-name>listings</param-name>\n      <param-value>false</param-value>\n</init-param>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000266-WSR-000142",
        "gid": null,
        "rid": "VCST-67-000023",
        "stig_id": "VCST-67-000023",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCST-67-000023\" do\n  title \"The Security Token Service must not show directory listings.\"\n  desc  \"Enumeration techniques, such as URL parameter manipulation, rely upon\nbeing able to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. Ensuring that directory listing is disabled is one approach to\nmitigating the vulnerability.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000266-WSR-000142\"\n  tag gid: nil\n  tag rid: \"VCST-67-000023\"\n  tag stig_id: \"VCST-67-000023\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2\ns/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'//param-name[text()=\\\"listings\\\"]/parent::init-param' -\n\nExpected result:\n\n<init-param>\n      <param-name>listings</param-name>\n      <param-value>false</param-value>\n</init-param>\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nSet the <param-value> to \\\"false\\\" in all <param-name>listing</param-name>\nnodes.\n\nNote: The setting should look like the below:\n\n<init-param>\n      <param-name>listings</param-name>\n      <param-value>false</param-value>\n</init-param>\"\n\n  describe.one do\n\n    describe xml('/usr/lib/vmware-sso/vmware-sts/conf/web.xml') do\n      its('/web-app/servlet/init-param[param-name=\"listings\"]/param-value') { should eq [] }\n    end\n\n    describe xml('/usr/lib/vmware-sso/vmware-sts/conf/web.xml') do\n      its('/web-app/servlet/init-param[param-name=\"listings\"]/param-value') { should cmp \"false\" }\n    end\n\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000023.rb",
        "line": 1
      },
      "id": "VCST-67-000023"
    },
    {
      "title": "The Security Token Service must not enable support for TRACE requests.",
      "desc": "\"Trace\" is a technique for a user to request internal information\nabout Tomcat. This is useful during product development, but should not be\nenabled in production.  Allowing a attacker to conduct a Trace operation\nagainst the Security Token Service will expose information that would be useful\nto perform a more targeted attack. The Security Token Service provides the\nallowTrace parameter as means to disable responding to Trace requests.",
      "descriptions": {
        "default": "\"Trace\" is a technique for a user to request internal information\nabout Tomcat. This is useful during product development, but should not be\nenabled in production.  Allowing a attacker to conduct a Trace operation\nagainst the Security Token Service will expose information that would be useful\nto perform a more targeted attack. The Security Token Service provides the\nallowTrace parameter as means to disable responding to Trace requests.",
        "check": "At the command prompt, execute the following command:\n\n# grep allowTrace /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nIf allowTrace is set to \"true\", this is a finding. If no line is returned\nthis is NOT a finding.",
        "fix": "Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nNavigate to and locate 'allowTrace=\"true\"'\n\nRemove the 'allowTrace=\"true\"' setting."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000266-WSR-000160",
        "gid": null,
        "rid": "VCST-67-000025",
        "stig_id": "VCST-67-000025",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCST-67-000025\" do\n  title \"The Security Token Service must not enable support for TRACE requests.\"\n  desc  \"\\\"Trace\\\" is a technique for a user to request internal information\nabout Tomcat. This is useful during product development, but should not be\nenabled in production.  Allowing a attacker to conduct a Trace operation\nagainst the Security Token Service will expose information that would be useful\nto perform a more targeted attack. The Security Token Service provides the\nallowTrace parameter as means to disable responding to Trace requests.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000266-WSR-000160\"\n  tag gid: nil\n  tag rid: \"VCST-67-000025\"\n  tag stig_id: \"VCST-67-000025\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep allowTrace /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nIf allowTrace is set to \\\"true\\\", this is a finding. If no line is returned\nthis is NOT a finding.\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nNavigate to and locate 'allowTrace=\\\"true\\\"'\n\nRemove the 'allowTrace=\\\"true\\\"' setting.\"\n\n  describe.one do\n    describe xml('/usr/lib/vmware-sso/vmware-sts/conf/server.xml') do\n      its(['Server/Service/Connector/attribute::allowTrace']) { should eq [] }\n    end\n\n    describe xml('/usr/lib/vmware-sso/vmware-sts/conf/server.xml') do\n      its(['Server/Service/Connector/attribute::allowTrace']) { should cmp \"false\" }\n    end\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000025.rb",
        "line": 1
      },
      "id": "VCST-67-000025"
    },
    {
      "title": "The Security Token Service must disable the shutdown port.",
      "desc": "An attacker has at least two reasons to stop a web server. The first\nis to cause a DoS, and the second is to put in place changes the attacker made\nto the web server configuration. If the Tomcat shutdown port feature is\nenabled, a shutdown signal can be sent to the Security Token Service through\nthis port. To ensure availability, the shutdown port must be disabled.",
      "descriptions": {
        "default": "An attacker has at least two reasons to stop a web server. The first\nis to cause a DoS, and the second is to put in place changes the attacker made\nto the web server configuration. If the Tomcat shutdown port feature is\nenabled, a shutdown signal can be sent to the Security Token Service through\nthis port. To ensure availability, the shutdown port must be disabled.",
        "check": "At the command prompt, execute the following command:\n\n# grep 'base.shutdown.port'\n/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nExpected result:\n\nbase.shutdown.port=-1\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Open /usr/lib/vmware-sso/vmware-sts/conf/catalina.properties in a\ntext editor.\n\nAdd or modify the following setting:\n\nbase.shutdown.port=-1"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000435-WSR-000147",
        "gid": null,
        "rid": "VCST-67-000029",
        "stig_id": "VCST-67-000029",
        "cci": "CCI-002385",
        "nist": [
          "SC-5",
          "Rev_4"
        ]
      },
      "code": "control \"VCST-67-000029\" do\n  title \"The Security Token Service must disable the shutdown port.\"\n  desc  \"An attacker has at least two reasons to stop a web server. The first\nis to cause a DoS, and the second is to put in place changes the attacker made\nto the web server configuration. If the Tomcat shutdown port feature is\nenabled, a shutdown signal can be sent to the Security Token Service through\nthis port. To ensure availability, the shutdown port must be disabled.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000435-WSR-000147\"\n  tag gid: nil\n  tag rid: \"VCST-67-000029\"\n  tag stig_id: \"VCST-67-000029\"\n  tag cci: \"CCI-002385\"\n  tag nist: [\"SC-5\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep 'base.shutdown.port'\n/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nExpected result:\n\nbase.shutdown.port=-1\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Open /usr/lib/vmware-sso/vmware-sts/conf/catalina.properties in a\ntext editor.\n\nAdd or modify the following setting:\n\nbase.shutdown.port=-1\"\n\n  describe parse_config_file('/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties').params['base.shutdown.port'] do\n    it { should eq '-1' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000029.rb",
        "line": 1
      },
      "id": "VCST-67-000029"
    },
    {
      "title": "The Security Token Service directory tree must have permissions in an\n\"out of the box\" state.",
      "desc": "As a rule, accounts on a web server are to be kept to a minimum. Only\nadministrators, web managers, developers, auditors, and web authors require\naccounts on the machine hosting the web server. The resources to which these\naccounts have access must also be closely monitored and controlled. The\nSecurity Token Service files must be adequately protected with correct\npermissions as applied \"out of the box\".",
      "descriptions": {
        "default": "As a rule, accounts on a web server are to be kept to a minimum. Only\nadministrators, web managers, developers, auditors, and web authors require\naccounts on the machine hosting the web server. The resources to which these\naccounts have access must also be closely monitored and controlled. The\nSecurity Token Service files must be adequately protected with correct\npermissions as applied \"out of the box\".",
        "check": "At the command prompt, execute the following command:\n\n# find /usr/lib/vmware-sso/vmware-sts/ -xdev -type f -a '(' -not -user root -o\n-not -group root ')' -exec ls -ld {} \\;\n\nIf the command produces any output, this is a finding.",
        "fix": "At the command prompt, execute the following command:\n\n# chown root:root <file_name>\n\nRepeat the command for each file that was returned\n\nNote: Replace <file_name> for the name of the file that was returned."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000211-WSR-000030",
        "gid": null,
        "rid": "VCST-67-000017",
        "stig_id": "VCST-67-000017",
        "cci": "CCI-001082",
        "nist": [
          "SC-2",
          "Rev_4"
        ]
      },
      "code": "control \"VCST-67-000017\" do\n  title \"The Security Token Service directory tree must have permissions in an\n\\\"out of the box\\\" state.\"\n  desc  \"As a rule, accounts on a web server are to be kept to a minimum. Only\nadministrators, web managers, developers, auditors, and web authors require\naccounts on the machine hosting the web server. The resources to which these\naccounts have access must also be closely monitored and controlled. The\nSecurity Token Service files must be adequately protected with correct\npermissions as applied \\\"out of the box\\\".\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000211-WSR-000030\"\n  tag gid: nil\n  tag rid: \"VCST-67-000017\"\n  tag stig_id: \"VCST-67-000017\"\n  tag cci: \"CCI-001082\"\n  tag nist: [\"SC-2\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# find /usr/lib/vmware-sso/vmware-sts/ -xdev -type f -a '(' -not -user root -o\n-not -group root ')' -exec ls -ld {} \\\\;\n\nIf the command produces any output, this is a finding.\"\n  desc 'fix', \"At the command prompt, execute the following command:\n\n# chown\\ root:root <file_name>\n\nRepeat the command for each file that was returned\n\nNote: Replace <file_name> for the name of the file that was returned.\n\"\n\n  describe command('find /usr/lib/vmware-sso/vmware-sts/ -xdev -type f -a \\'(\\' -not -user root -o -not -group root \\')\\' -exec ls -ld {} \\;') do\n   its('stdout.strip') { should eq ''}\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000017.rb",
        "line": 1
      },
      "id": "VCST-67-000017"
    },
    {
      "title": "The Security Token Service must fail to a known safe state if system\ninitialization fails, shutdown fails, or aborts fail.",
      "desc": "Determining a safe state for failure and weighing that against a\npotential DoS for users depends on what type of application the web server is\nhosting. For the Security Token Service, it is preferable that the service\nabort startup on any initialization failure rather than continuing in a\ndegraded, and potentailly insecure, state.",
      "descriptions": {
        "default": "Determining a safe state for failure and weighing that against a\npotential DoS for users depends on what type of application the web server is\nhosting. For the Security Token Service, it is preferable that the service\nabort startup on any initialization failure rather than continuing in a\ndegraded, and potentailly insecure, state.",
        "check": "At the command line, execute the following command:\n\n# grep EXIT_ON_INIT_FAILURE\n/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nExpected result :\n\norg.apache.catalina.startup.EXIT_ON_INIT_FAILURE=true\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nAdd or change the following line:\n\norg.apache.catalina.startup.EXIT_ON_INIT_FAILURE=true"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000225-WSR-000140",
        "gid": null,
        "rid": "VCST-67-000018",
        "stig_id": "VCST-67-000018",
        "cci": "CCI-001190",
        "nist": [
          "SC-24",
          "Rev_4"
        ]
      },
      "code": "control \"VCST-67-000018\" do\n  title \"The Security Token Service must fail to a known safe state if system\ninitialization fails, shutdown fails, or aborts fail.\"\n  desc  \"Determining a safe state for failure and weighing that against a\npotential DoS for users depends on what type of application the web server is\nhosting. For the Security Token Service, it is preferable that the service\nabort startup on any initialization failure rather than continuing in a\ndegraded, and potentailly insecure, state.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000225-WSR-000140\"\n  tag gid: nil\n  tag rid: \"VCST-67-000018\"\n  tag stig_id: \"VCST-67-000018\"\n  tag cci: \"CCI-001190\"\n  tag nist: [\"SC-24\", \"Rev_4\"]\n  desc 'check', \"At the command line, execute the following command:\n\n# grep EXIT_ON_INIT_FAILURE\n/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nExpected result :\n\norg.apache.catalina.startup.EXIT_ON_INIT_FAILURE=true\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nAdd or change the following line:\n\norg.apache.catalina.startup.EXIT_ON_INIT_FAILURE=true\"\n\n  describe parse_config_file('/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties').params['org.apache.catalina.startup.EXIT_ON_INIT_FAILURE'] do\n    it { should eq 'true' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000018.rb",
        "line": 1
      },
      "id": "VCST-67-000018"
    },
    {
      "title": "The Security Token Service must protect cookies from XSS.",
      "desc": "Cookies are a common way to save session state over the HTTP(S)\nprotocol. If an attacker can compromise session data stored in a cookie, they\nare better able to launch an attack against the server and its applications.\nWhen you tag a cookie with the HttpOnly flag, it tells the browser that this\nparticular cookie should only be accessed by the originating server. Any\nattempt to access the cookie from client script is strictly forbidden.",
      "descriptions": {
        "default": "Cookies are a common way to save session state over the HTTP(S)\nprotocol. If an attacker can compromise session data stored in a cookie, they\nare better able to launch an attack against the server and its applications.\nWhen you tag a cookie with the HttpOnly flag, it tells the browser that this\nparticular cookie should only be accessed by the originating server. Any\nattempt to access the cookie from client script is strictly forbidden.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2\ns/xmlns=\".*\"//g' | xmllint --xpath\n'/web-app/session-config/cookie-config/http-only' -\n\nExpected result:\n\n<http-only>true</http-only>\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nNavigate to the <session-config> node and configure it as follows.\n\n<session-config>\n        <session-timeout>30</session-timeout>\n        <cookie-config>\n            <http-only>true</http-only>\n            <secure>true</secure>\n        </cookie-config>\n    </session-config>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000001-WSR-000002",
        "gid": null,
        "rid": "VCST-67-000004",
        "stig_id": "VCST-67-000004",
        "cci": "CCI-000054",
        "nist": [
          "AC-10",
          "Rev_4"
        ]
      },
      "code": "control \"VCST-67-000004\" do\n  title \"The Security Token Service must protect cookies from XSS.\"\n  desc  \"Cookies are a common way to save session state over the HTTP(S)\nprotocol. If an attacker can compromise session data stored in a cookie, they\nare better able to launch an attack against the server and its applications.\nWhen you tag a cookie with the HttpOnly flag, it tells the browser that this\nparticular cookie should only be accessed by the originating server. Any\nattempt to access the cookie from client script is strictly forbidden.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000001-WSR-000002\"\n  tag gid: nil\n  tag rid: \"VCST-67-000004\"\n  tag stig_id: \"VCST-67-000004\"\n  tag cci: \"CCI-000054\"\n  tag nist: [\"AC-10\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2\ns/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'/web-app/session-config/cookie-config/http-only' -\n\nExpected result:\n\n<http-only>true</http-only>\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nNavigate to the <session-config> node and configure it as follows.\n\n<session-config>\n        <session-timeout>30</session-timeout>\n        <cookie-config>\n            <http-only>true</http-only>\n            <secure>true</secure>\n        </cookie-config>\n    </session-config>\n\"\n\n  describe xml('/usr/lib/vmware-sso/vmware-sts/conf/web.xml') do\n    its(['/web-app/session-config/cookie-config/http-only']) { should cmp 'true' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000004.rb",
        "line": 1
      },
      "id": "VCST-67-000004"
    },
    {
      "title": "The Security Token Service application files must be verified for\ntheir integrity.",
      "desc": "Verifying that the Security Token Service application code is\nunchanged from it's shipping state is essential for file validation and\nnon-repudiation of the Security Token Service itself. There is no reason that\nthe MD5 hash of the rpm original files should be changed after installation,\nexcluding configuration files.",
      "descriptions": {
        "default": "Verifying that the Security Token Service application code is\nunchanged from it's shipping state is essential for file validation and\nnon-repudiation of the Security Token Service itself. There is no reason that\nthe MD5 hash of the rpm original files should be changed after installation,\nexcluding configuration files.",
        "check": "At the command prompt, execute the following command:\n\n# rpm -V vmware-identity-sts|grep \"^..5......\"|grep -E\n\"\\.war|\\.jar|\\.sh|\\.py\"\n\nIf is any output, this is a finding.",
        "fix": "Re-install the VCSA or roll back to a snapshot. Modifying the\nSecurity Token Service installation files manually is not supported by VMware."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000131-WSR-000051",
        "gid": null,
        "rid": "VCST-67-000008",
        "stig_id": "VCST-67-000008",
        "cci": "CCI-001749",
        "nist": [
          "CM-5 (3)",
          "Rev_4"
        ]
      },
      "code": "control \"VCST-67-000008\" do\n  title \"The Security Token Service application files must be verified for\ntheir integrity.\"\n  desc  \"Verifying that the Security Token Service application code is\nunchanged from it's shipping state is essential for file validation and\nnon-repudiation of the Security Token Service itself. There is no reason that\nthe MD5 hash of the rpm original files should be changed after installation,\nexcluding configuration files.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000131-WSR-000051\"\n  tag gid: nil\n  tag rid: \"VCST-67-000008\"\n  tag stig_id: \"VCST-67-000008\"\n  tag cci: \"CCI-001749\"\n  tag nist: [\"CM-5 (3)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# rpm -V vmware-identity-sts|grep \\\"^..5......\\\"|grep -E\n\\\"\\\\.war|\\\\.jar|\\\\.sh|\\\\.py\\\"\n\nIf is any output, this is a finding.\"\n  desc 'fix', \"Re-install the VCSA or roll back to a snapshot. Modifying the\nSecurity Token Service installation files manually is not supported by VMware.\"\n\n  describe command('rpm -V vmware-identity-sts|grep \"^..5......\"|grep -E \"\\.war|\\.jar|\\.sh|\\.py\"') do\n    its ('stdout.strip') { should eq '' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000008.rb",
        "line": 1
      },
      "id": "VCST-67-000008"
    },
    {
      "title": "The Security Token Service must not have any symbolic links in the web\ncontent directory tree.",
      "desc": "A web server is designed to deliver content and execute scripts or\napplications on the request of a client or user. Containing user requests to\nfiles in the directory tree of the hosted web application and limiting the\nexecution of scripts and applications guarantees that the user is not accessing\ninformation protected outside the application's realm. By checking that no\nsymbolic links exist in the document root, the web server is protected from\nusers jumping outside the hosted application directory tree and gaining access\nto the other directories, including the system root.",
      "descriptions": {
        "default": "A web server is designed to deliver content and execute scripts or\napplications on the request of a client or user. Containing user requests to\nfiles in the directory tree of the hosted web application and limiting the\nexecution of scripts and applications guarantees that the user is not accessing\ninformation protected outside the application's realm. By checking that no\nsymbolic links exist in the document root, the web server is protected from\nusers jumping outside the hosted application directory tree and gaining access\nto the other directories, including the system root.",
        "check": "At the command prompt, execute the following command:\n\n# find /usr/lib/vmware-sso/vmware-sts/webapps/ -type l -ls\n\nIf the command produces any output, this is a finding.",
        "fix": "At the command prompt, execute the following commands:\n\nNote: Replace <file_name> for the name of any files that were returned.\n\n# unlink <file_name>\n\nRepeat the commands for each file that was returned."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000141-WSR-000087",
        "gid": null,
        "rid": "VCST-67-000016",
        "stig_id": "VCST-67-000016",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCST-67-000016\" do\n  title \"The Security Token Service must not have any symbolic links in the web\ncontent directory tree.\"\n  desc  \"A web server is designed to deliver content and execute scripts or\napplications on the request of a client or user. Containing user requests to\nfiles in the directory tree of the hosted web application and limiting the\nexecution of scripts and applications guarantees that the user is not accessing\ninformation protected outside the application's realm. By checking that no\nsymbolic links exist in the document root, the web server is protected from\nusers jumping outside the hosted application directory tree and gaining access\nto the other directories, including the system root.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000141-WSR-000087\"\n  tag gid: nil\n  tag rid: \"VCST-67-000016\"\n  tag stig_id: \"VCST-67-000016\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# find /usr/lib/vmware-sso/vmware-sts/webapps/ -type l -ls\n\nIf the command produces any output, this is a finding.\"\n  desc 'fix', \"At the command prompt, execute the following commands:\n\nNote: Replace <file_name> for the name of any files that were returned.\n\n# unlink <file_name>\n\nRepeat the commands for each file that was returned.\"\n\n  describe command('find /usr/lib/vmware-sso/vmware-sts/webapps/ -type l -ls') do\n    its ('stdout.strip') { should eq '' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000016.rb",
        "line": 1
      },
      "id": "VCST-67-000016"
    },
    {
      "title": "VAMI must have debug logging disabled.",
      "desc": "Information needed by an attacker to begin looking for possible\nvulnerabilities in a web server includes any information about the web server\nand plug-ins or modules being used. When debugging or trace information is\nenabled in a production web server, information about the web server, such as\nweb server type, version, patches installed, plug-ins and modules installed,\ntype of code being used by the hosted application, and any backends being used\nfor data storage may be displayed. Since this information may be placed in logs\nand general messages during normal operation of the web server, an attacker\ndoes not need to cause an error condition to gain this information.",
      "descriptions": {
        "default": "Information needed by an attacker to begin looking for possible\nvulnerabilities in a web server includes any information about the web server\nand plug-ins or modules being used. When debugging or trace information is\nenabled in a production web server, information about the web server, such as\nweb server type, version, patches installed, plug-ins and modules installed,\ntype of code being used by the hosted application, and any backends being used\nfor data storage may be displayed. Since this information may be placed in logs\nand general messages during normal operation of the web server, an attacker\ndoes not need to cause an error condition to gain this information.",
        "check": "At the command prompt, execute the following command:\n\ngrep '^debug.log-request-handling' /opt/vmware/etc/lighttpd/lighttpd.conf\n\nIf the value for \"debug.log-request-handling\" is not set to \"disable\", this\nis a finding.",
        "fix": "Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf\n\nConfigure the \"lighttpd.conf\" file with the following:\n\ndebug.log-request-handling = \"disable\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "vami",
        "gtitle": "SRG-APP-000266-WSR-000160",
        "gid": null,
        "rid": "VCLD-67-000031",
        "stig_id": "VCLD-67-000031",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCLD-67-000031\" do\n  title \"VAMI must have debug logging disabled.\"\n  desc  \"Information needed by an attacker to begin looking for possible\nvulnerabilities in a web server includes any information about the web server\nand plug-ins or modules being used. When debugging or trace information is\nenabled in a production web server, information about the web server, such as\nweb server type, version, patches installed, plug-ins and modules installed,\ntype of code being used by the hosted application, and any backends being used\nfor data storage may be displayed. Since this information may be placed in logs\nand general messages during normal operation of the web server, an attacker\ndoes not need to cause an error condition to gain this information.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"vami\"\n  tag gtitle: \"SRG-APP-000266-WSR-000160\"\n  tag gid: nil\n  tag rid: \"VCLD-67-000031\"\n  tag stig_id: \"VCLD-67-000031\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\ngrep '^debug.log-request-handling' /opt/vmware/etc/lighttpd/lighttpd.conf\n\nIf the value for \\\"debug.log-request-handling\\\" is not set to \\\"disable\\\", this\nis a finding.\"\n  desc 'fix', \"Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf\n\nConfigure the \\\"lighttpd.conf\\\" file with the following:\n\ndebug.log-request-handling = \\\"disable\\\"\"\n\n  describe parse_config_file('/opt/vmware/etc/lighttpd/lighttpd.conf').params['debug.log-request-handling'] do\n    it { should eq \"\\\"disable\\\"\" }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000031.rb",
        "line": 1
      },
      "id": "VCLD-67-000031"
    },
    {
      "title": "VAMI must generate log records for system startup and shutdown.",
      "desc": "Logging must be started as soon as possible when a service starts and\nwhen a service is stopped. Many forms of suspicious actions can be\ndetected by analyzing logs for unexpected service starts and stops.\nAlso, by starting to log immediately after a service starts, it becomes\nmore difficult for suspicous activity to go un-logged.",
      "descriptions": {
        "default": "Logging must be started as soon as possible when a service starts and\nwhen a service is stopped. Many forms of suspicious actions can be\ndetected by analyzing logs for unexpected service starts and stops.\nAlso, by starting to log immediately after a service starts, it becomes\nmore difficult for suspicous activity to go un-logged.",
        "check": "At the command prompt, execute the following command:\n\n# /opt/vmware/sbin/vami-lighttpd -p -f /opt/vmware/etc/lighttpd/lighttpd.conf|grep \"server.errorlog\"\n\nExpected result:\n\n    server.errorlog                   = \"/opt/vmware/var/log/lighttpd/error.log\"\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf\n\nConfigure the \"lighttpd.conf\" file with the following:\n\nserver.errorlog = \"/opt/vmware/var/log/lighttpd/error.log\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "vami",
        "gtitle": "SRG-APP-000089-WSR-000047",
        "gid": null,
        "rid": "VCLD-67-000005",
        "stig_id": "VCLD-67-000005",
        "cci": "CCI-000169",
        "nist": [
          "AU-12 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCLD-67-000005\" do\n  title \"VAMI must generate log records for system startup and shutdown.\"\n  desc  \"Logging must be started as soon as possible when a service starts and\nwhen a service is stopped. Many forms of suspicious actions can be\ndetected by analyzing logs for unexpected service starts and stops.\nAlso, by starting to log immediately after a service starts, it becomes\nmore difficult for suspicous activity to go un-logged.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"vami\"\n  tag gtitle: \"SRG-APP-000089-WSR-000047\"\n  tag gid: nil\n  tag rid: \"VCLD-67-000005\"\n  tag stig_id: \"VCLD-67-000005\"\n  tag cci: \"CCI-000169\"\n  tag nist: [\"AU-12 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# /opt/vmware/sbin/vami-lighttpd -p -f /opt/vmware/etc/lighttpd/lighttpd.conf|grep \\\"server.errorlog\\\"\n\nExpected result:\n\n    server.errorlog                   = \\\"/opt/vmware/var/log/lighttpd/error.log\\\"\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf\n\nConfigure the \\\"lighttpd.conf\\\" file with the following:\n\nserver.errorlog = \\\"/opt/vmware/var/log/lighttpd/error.log\\\"\"\n\n  describe.one do\n\n    describe parse_config_file('/opt/vmware/etc/lighttpd/lighttpd.conf').params['server.errorlog'] do\n      it { should eq \"\\\"/opt/vmware/var/log/lighttpd/error.log\\\"\" }\n    end\n\n    describe parse_config_file('/opt/vmware/etc/lighttpd/lighttpd.conf').params['server.errorlog'] do\n      it { should eq \"/opt/vmware/var/log/lighttpd/error.log\" }\n    end\n\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000005.rb",
        "line": 1
      },
      "id": "VCLD-67-000005"
    },
    {
      "title": "VAMI must have all mappings to unused and vulnerable scripts to be\nremoved.",
      "desc": "Scripts allow server side processing on behalf of the hosted\napplication user or as processes needed in the implementation of hosted\napplications. Removing scripts not needed for application operation or deemed\nvulnerable helps to secure the web server. To assure scripts are not added to\nthe web server and run maliciously, those script mappings that are not needed\nor used by the web server for hosted application operation must be removed.",
      "descriptions": {
        "default": "Scripts allow server side processing on behalf of the hosted\napplication user or as processes needed in the implementation of hosted\napplications. Removing scripts not needed for application operation or deemed\nvulnerable helps to secure the web server. To assure scripts are not added to\nthe web server and run maliciously, those script mappings that are not needed\nor used by the web server for hosted application operation must be removed.",
        "check": "At the command prompt, execute the following command:\n\ncat /opt/vmware/etc/lighttpd/lighttpd.conf | awk '/cgi\\.assign/,/\\)/'\n\nIf the output does not exactly match the below expected output, this is a\nfinding.\n\ncgi.assign                 = ( \".pl\"  => \"/usr/bin/perl\",\n                               \".cgi\" => \"/usr/bin/perl\",\n                               \".rb\"  => \"/usr/bin/ruby\",\n                               \".erb\" => \"/usr/bin/eruby\",\n                               \".py\"  => \"/usr/bin/python\" )",
        "fix": "Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf\n\nNavigate to the cgi.assign section and replace it entirely with the following:\n\ncgi.assign                 = ( \".pl\"  => \"/usr/bin/perl\",\n                               \".cgi\" => \"/usr/bin/perl\",\n                               \".rb\"  => \"/usr/bin/ruby\",\n                               \".erb\" => \"/usr/bin/eruby\",\n                               \".py\"  => \"/usr/bin/python\" )"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "vami",
        "gtitle": "SRG-APP-000141-WSR-000082",
        "gid": null,
        "rid": "VCLD-67-000019",
        "stig_id": "VCLD-67-000019",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCLD-67-000019\" do\n  title \"VAMI must have all mappings to unused and vulnerable scripts to be\nremoved.\"\n  desc  \"Scripts allow server side processing on behalf of the hosted\napplication user or as processes needed in the implementation of hosted\napplications. Removing scripts not needed for application operation or deemed\nvulnerable helps to secure the web server. To assure scripts are not added to\nthe web server and run maliciously, those script mappings that are not needed\nor used by the web server for hosted application operation must be removed.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"vami\"\n  tag gtitle: \"SRG-APP-000141-WSR-000082\"\n  tag gid: nil\n  tag rid: \"VCLD-67-000019\"\n  tag stig_id: \"VCLD-67-000019\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\ncat /opt/vmware/etc/lighttpd/lighttpd.conf | awk '/cgi\\\\.assign/,/\\\\)/'\n\nIf the output does not exactly match the below expected output, this is a\nfinding.\n\ncgi.assign                 = ( \\\".pl\\\"  => \\\"/usr/bin/perl\\\",\n                               \\\".cgi\\\" => \\\"/usr/bin/perl\\\",\n                               \\\".rb\\\"  => \\\"/usr/bin/ruby\\\",\n                               \\\".erb\\\" => \\\"/usr/bin/eruby\\\",\n                               \\\".py\\\"  => \\\"/usr/bin/python\\\" )\"\n  desc 'fix', \"Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf\n\nNavigate to the cgi.assign section and replace it entirely with the following:\n\ncgi.assign                 = ( \\\".pl\\\"  => \\\"/usr/bin/perl\\\",\n                               \\\".cgi\\\" => \\\"/usr/bin/perl\\\",\n                               \\\".rb\\\"  => \\\"/usr/bin/ruby\\\",\n                               \\\".erb\\\" => \\\"/usr/bin/eruby\\\",\n                               \\\".py\\\"  => \\\"/usr/bin/python\\\" )\"\n\n  describe command(\"cat /opt/vmware/etc/lighttpd/lighttpd.conf | awk '/cgi\\.assign/,/\\)/'\") do\n    its ('stdout') { should match \"cgi.assign                 = ( \\\".pl\\\"  => \\\"/usr/bin/perl\\\",\\n                               \\\".cgi\\\" => \\\"/usr/bin/perl\\\",\\n                               \\\".rb\\\"  => \\\"/usr/bin/ruby\\\",\\n                               \\\".erb\\\" => \\\"/usr/bin/eruby\\\",\\n                               \\\".py\\\"  => \\\"/usr/bin/python\\\" )\\n\" }\n  end\n                            \nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000019.rb",
        "line": 1
      },
      "id": "VCLD-67-000019"
    },
    {
      "title": "VAMI must prevent hosted applications from exhausting system\nresources.",
      "desc": "When it comes to DoS attacks, most of the attention is paid to\nensuring that systems and applications are not victims of these attacks. While\nit is true that those accountable for systems want to ensure they are not\naffected by a DoS attack, they also need to ensure their systems and\napplications are not used to launch such an attack against others. To that\nextent, a variety of technologies exist to limit, or in some cases, eliminate\nthe effects of DoS attacks. Limiting system resources that are allocated to any\nuser to a bare minimum may also reduce the ability of users to launch some DoS\nattacks. Applications and application developers must take the steps needed to\nensure users cannot use these applications to launch DoS attacks against other\nsystems and networks.\n\n    An example would be preventing Lighttpd from keeping idle connections open\nfor too long.",
      "descriptions": {
        "default": "When it comes to DoS attacks, most of the attention is paid to\nensuring that systems and applications are not victims of these attacks. While\nit is true that those accountable for systems want to ensure they are not\naffected by a DoS attack, they also need to ensure their systems and\napplications are not used to launch such an attack against others. To that\nextent, a variety of technologies exist to limit, or in some cases, eliminate\nthe effects of DoS attacks. Limiting system resources that are allocated to any\nuser to a bare minimum may also reduce the ability of users to launch some DoS\nattacks. Applications and application developers must take the steps needed to\nensure users cannot use these applications to launch DoS attacks against other\nsystems and networks.\n\n    An example would be preventing Lighttpd from keeping idle connections open\nfor too long.",
        "check": "At the command prompt, execute the following command:\n\ngrep '^server.max-keep-alive-idle' /opt/vmware/etc/lighttpd/lighttpd.conf\n\nIf the \"server.max-keep-alive-idle\" is not set to \"30\", this is a finding.",
        "fix": "Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf file.\n\nConfigure the lighttpd.conf file with the following:\n\nserver.max-keep-alive-idle = 30"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "vami",
        "gtitle": "SRG-APP-000141-WSR-000086",
        "gid": null,
        "rid": "VCLD-67-000022",
        "stig_id": "VCLD-67-000022",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCLD-67-000022\" do\n  title \"VAMI must prevent hosted applications from exhausting system\nresources.\"\n  desc  \"When it comes to DoS attacks, most of the attention is paid to\nensuring that systems and applications are not victims of these attacks. While\nit is true that those accountable for systems want to ensure they are not\naffected by a DoS attack, they also need to ensure their systems and\napplications are not used to launch such an attack against others. To that\nextent, a variety of technologies exist to limit, or in some cases, eliminate\nthe effects of DoS attacks. Limiting system resources that are allocated to any\nuser to a bare minimum may also reduce the ability of users to launch some DoS\nattacks. Applications and application developers must take the steps needed to\nensure users cannot use these applications to launch DoS attacks against other\nsystems and networks.\n\n    An example would be preventing Lighttpd from keeping idle connections open\nfor too long.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"vami\"\n  tag gtitle: \"SRG-APP-000141-WSR-000086\"\n  tag gid: nil\n  tag rid: \"VCLD-67-000022\"\n  tag stig_id: \"VCLD-67-000022\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\ngrep '^server.max-keep-alive-idle' /opt/vmware/etc/lighttpd/lighttpd.conf\n\nIf the \\\"server.max-keep-alive-idle\\\" is not set to \\\"30\\\", this is a finding.\"\n  desc 'fix', \"Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf file.\n\nConfigure the lighttpd.conf file with the following:\n\nserver.max-keep-alive-idle = 30\"\n\n  describe parse_config_file('/opt/vmware/etc/lighttpd/lighttpd.conf').params['server.max-keep-alive-idle'] do\n    it { should eq '30' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000022.rb",
        "line": 1
      },
      "id": "VCLD-67-000022"
    },
    {
      "title": "VAMI must be protected from being stopped by a non-privileged user.",
      "desc": "An attacker has at least two reasons to stop a web server. The first\nis to cause a DoS, and the second is to put in place changes the attacker made\nto the web server configuration.",
      "descriptions": {
        "default": "An attacker has at least two reasons to stop a web server. The first\nis to cause a DoS, and the second is to put in place changes the attacker made\nto the web server configuration.",
        "check": "At the command prompt, execute the following command:\n\n# ps -f -U root | awk '$0 ~ /vami-lighttpd/ && $0 !~ /awk/ {print}'\n\nIf the \"vami-lighttpd\" process is not owned by \"root\", this is a finding.",
        "fix": "Navigate to and open /usr/lib/systemd/system/vami-lighttp.service\nin a text editor.\n\nUnder the \"[Service]\" section, remove the line that beings with \"User=\".\n\nAt the command prompt, execute the following command:\n\n# service vami-lighttp restart"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "vami",
        "gtitle": "SRG-APP-000435-WSR-000147",
        "gid": null,
        "rid": "VCLD-67-000033",
        "stig_id": "VCLD-67-000033",
        "cci": "CCI-002385",
        "nist": [
          "SC-5",
          "Rev_4"
        ]
      },
      "code": "control \"VCLD-67-000033\" do\n  title \"VAMI must be protected from being stopped by a non-privileged user.\"\n  desc  \"An attacker has at least two reasons to stop a web server. The first\nis to cause a DoS, and the second is to put in place changes the attacker made\nto the web server configuration. \"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"vami\"\n  tag gtitle: \"SRG-APP-000435-WSR-000147\"\n  tag gid: nil\n  tag rid: \"VCLD-67-000033\"\n  tag stig_id: \"VCLD-67-000033\"\n  tag cci: \"CCI-002385\"\n  tag nist: [\"SC-5\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# ps -f -U root | awk '$0 ~ /vami-lighttpd/ && $0 !~ /awk/ {print}'\n\nIf the \\\"vami-lighttpd\\\" process is not owned by \\\"root\\\", this is a finding.\"\n  desc 'fix', \"Navigate to and open /usr/lib/systemd/system/vami-lighttp.service\nin a text editor.\n\nUnder the \\\"[Service]\\\" section, remove the line that beings with \\\"User=\\\".\n\nAt the command prompt, execute the following command:\n\n# service vami-lighttp restart\"\n\n  describe processes('vami-lighttpd') do\n    its('users') { should eq ['root'] }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000033.rb",
        "line": 1
      },
      "id": "VCLD-67-000033"
    },
    {
      "title": "VAMI must only allow authenticated system administrators to have\naccess to the keystore.",
      "desc": "The web server's private key is used to prove the identity of the\nserver to clients and securely exchange the shared secret key used to encrypt\ncommunications between the web server and clients.By gaining access to the\nprivate key, an attacker can pretend to be an authorized server and decrypt the\nSSL traffic between a client and the web server.",
      "descriptions": {
        "default": "The web server's private key is used to prove the identity of the\nserver to clients and securely exchange the shared secret key used to encrypt\ncommunications between the web server and clients.By gaining access to the\nprivate key, an attacker can pretend to be an authorized server and decrypt the\nSSL traffic between a client and the web server.",
        "check": "At the command prompt, execute the following command:\n\nstat /etc/applmgmt/appliance/server.pem|grep Access\n\nIf the \"server.pem\" file is not owned by \"root\", group owned by \"root\" or\nthe file permissions are not \"600\", this is a finding.",
        "fix": "At the command prompt, execute the following commands:\n\nchown root:root /etc/applmgmt/appliance/server.pem\nchmod 600 /etc/applmgmt/appliance/server.pem"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "vami",
        "gtitle": "SRG-APP-000176-WSR-000096",
        "gid": null,
        "rid": "VCLD-67-000025",
        "stig_id": "VCLD-67-000025",
        "cci": "CCI-000186",
        "nist": [
          "IA-5 (2) (b)",
          "Rev_4"
        ]
      },
      "code": "control \"VCLD-67-000025\" do\n  title \"VAMI must only allow authenticated system administrators to have\naccess to the keystore.\"\n  desc  \"The web server's private key is used to prove the identity of the\nserver to clients and securely exchange the shared secret key used to encrypt\ncommunications between the web server and clients.By gaining access to the\nprivate key, an attacker can pretend to be an authorized server and decrypt the\nSSL traffic between a client and the web server.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"vami\"\n  tag gtitle: \"SRG-APP-000176-WSR-000096\"\n  tag gid: nil\n  tag rid: \"VCLD-67-000025\"\n  tag stig_id: \"VCLD-67-000025\"\n  tag cci: \"CCI-000186\"\n  tag nist: [\"IA-5 (2) (b)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\nstat /etc/applmgmt/appliance/server.pem|grep Access\n\nIf the \\\"server.pem\\\" file is not owned by \\\"root\\\", group owned by \\\"root\\\" or\nthe file permissions are not \\\"600\\\", this is a finding.\"\n  desc 'fix', \"At the command prompt, execute the following commands:\n\nchown root:root /etc/applmgmt/appliance/server.pem\nchmod 600 /etc/applmgmt/appliance/server.pem\"\n\n  describe file('/etc/applmgmt/appliance/server.pem') do\n    its('owner') { should cmp 'root' }\n    its('group') { should cmp 'root' }\n    its('mode') { should cmp '0600' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000025.rb",
        "line": 1
      },
      "id": "VCLD-67-000025"
    },
    {
      "title": "VAMI must produce log records containing sufficient information to\nestablish what type of events occurred.",
      "desc": "After a security incident has occurred, investigators will often\nreview log files to determine what happened.  Understanding what type of event\noccurred is critical for investigation of a susipicous event.",
      "descriptions": {
        "default": "After a security incident has occurred, investigators will often\nreview log files to determine what happened.  Understanding what type of event\noccurred is critical for investigation of a susipicous event.",
        "check": "At the command prompt, execute the following command:\n\ngrep \"accesslog.format\" /opt/vmware/etc/lighttpd/lighttpd.conf\n\nThe output should be as follows:\n\n# accesslog.format = \"%h %l %u %t \\\"%r\\\" %b %>s \\\"%{User-Agent}i\\\"\n\\\"%{Referer}i\\\"\"\n\n\nThe default, commented, accesslog format is acceptable for this requirement. If\nthe setting is uncommented the format must include '%r' at a minimum. If the\noutput is not as expected, this is a finding.",
        "fix": "Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf\n\nComment any existing accesslog.format lines by adding a '#' at the beginning of\nthe line."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "vami",
        "gtitle": "SRG-APP-000095-WSR-000056",
        "gid": null,
        "rid": "VCLD-67-000006",
        "stig_id": "VCLD-67-000006",
        "cci": "CCI-000130",
        "nist": [
          "AU-3",
          "Rev_4"
        ]
      },
      "code": "control \"VCLD-67-000006\" do\n  title \"VAMI must produce log records containing sufficient information to\nestablish what type of events occurred.\"\n  desc  \"After a security incident has occurred, investigators will often\nreview log files to determine what happened.  Understanding what type of event\noccurred is critical for investigation of a susipicous event.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"vami\"\n  tag gtitle: \"SRG-APP-000095-WSR-000056\"\n  tag gid: nil\n  tag rid: \"VCLD-67-000006\"\n  tag stig_id: \"VCLD-67-000006\"\n  tag cci: \"CCI-000130\"\n  tag nist: [\"AU-3\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\ngrep \\\"accesslog.format\\\" /opt/vmware/etc/lighttpd/lighttpd.conf\n\nThe output should be as follows:\n\n# accesslog.format = \\\"%h %l %u %t \\\\\\\"%r\\\\\\\" %b %>s \\\\\\\"%{User-Agent}i\\\\\\\"\n\\\\\\\"%{Referer}i\\\\\\\"\\\"\n\n\nThe default, commented, accesslog format is acceptable for this requirement. If\nthe setting is uncommented the format must include '%r' at a minimum. If the\noutput is not as expected, this is a finding.\"\n  desc 'fix', \"Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf\n\nComment any existing accesslog.format lines by adding a '#' at the beginning of\nthe line.\"\n\n  describe command('grep \"accesslog.format\" /opt/vmware/etc/lighttpd/lighttpd.conf') do\n    its ('stdout.strip') { should match /^# accesslog.format.*$/ }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000006.rb",
        "line": 1
      },
      "id": "VCLD-67-000006"
    },
    {
      "title": "VAMI must be configured with FIPS 140-2 compliant ciphers for HTTPS\nconnections.",
      "desc": "Encryption of data-in-flight is an essential element of protecting\ninformation confidentiality.  If a web server uses weak or outdated encryption\nalgorithms, then the server's communications can potentially be compromised.\n\n    The US Federal Information Processing Standards (FIPS) publication 140-2,\nSecurity Requirements for Cryptographic Modules (FIPS 140-2) identifies eleven\nareas for a cryptographic module used inside a security system that protects\ninformation.  FIPS 140-2 approved ciphers provide the maximum level of\nencryption possible for a private web server.\n\n    Configuration of ciphers used by TC Server are set in the\ncatalina.properties file.  Only those ciphers specified in the configuration\nfile, and which are available in the installed OpenSSL library, will be used by\nTC Server while encrypting data for transmission.",
      "descriptions": {
        "default": "Encryption of data-in-flight is an essential element of protecting\ninformation confidentiality.  If a web server uses weak or outdated encryption\nalgorithms, then the server's communications can potentially be compromised.\n\n    The US Federal Information Processing Standards (FIPS) publication 140-2,\nSecurity Requirements for Cryptographic Modules (FIPS 140-2) identifies eleven\nareas for a cryptographic module used inside a security system that protects\ninformation.  FIPS 140-2 approved ciphers provide the maximum level of\nencryption possible for a private web server.\n\n    Configuration of ciphers used by TC Server are set in the\ncatalina.properties file.  Only those ciphers specified in the configuration\nfile, and which are available in the installed OpenSSL library, will be used by\nTC Server while encrypting data for transmission.",
        "check": "At the command prompt, execute the following command:\n\n/opt/vmware/sbin/vami-lighttpd -p -f\n/opt/vmware/etc/lighttpd/lighttpd.conf|grep \"ssl.cipher-list\"\n\nIf the value ssl.cipher-list = \"!aNULL:kECDH+AESGCM:ECDH+AESGCM:RSA+AESGCM:kECDH+AES:ECDH+AES:RSA+AES\" is not returned or\ncommented out, this is a finding.",
        "fix": "Navigate to and open /etc/applmgmt/appliance/lighttpd.conf\n\nRemove any existing \"ssl.cipher-list\" entry and repalce with the following:\n\nssl.cipher-list = \"!aNULL:kECDH+AESGCM:ECDH+AESGCM:RSA+AESGCM:kECDH+AES:ECDH+AES:RSA+AES\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "vami",
        "gtitle": "SRG-APP-000014-WSR-000006",
        "gid": null,
        "rid": "VCLD-67-000002",
        "stig_id": "VCLD-67-000002",
        "cci": "CCI-000068",
        "nist": [
          "AC-17 (2)",
          "Rev_4"
        ]
      },
      "code": "control \"VCLD-67-000002\" do\n  title \"VAMI must be configured with FIPS 140-2 compliant ciphers for HTTPS\nconnections.\"\n  desc  \"Encryption of data-in-flight is an essential element of protecting\ninformation confidentiality.  If a web server uses weak or outdated encryption\nalgorithms, then the server's communications can potentially be compromised.\n\n    The US Federal Information Processing Standards (FIPS) publication 140-2,\nSecurity Requirements for Cryptographic Modules (FIPS 140-2) identifies eleven\nareas for a cryptographic module used inside a security system that protects\ninformation.  FIPS 140-2 approved ciphers provide the maximum level of\nencryption possible for a private web server.\n\n    Configuration of ciphers used by TC Server are set in the\ncatalina.properties file.  Only those ciphers specified in the configuration\nfile, and which are available in the installed OpenSSL library, will be used by\nTC Server while encrypting data for transmission.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"vami\"\n  tag gtitle: \"SRG-APP-000014-WSR-000006\"\n  tag gid: nil\n  tag rid: \"VCLD-67-000002\"\n  tag stig_id: \"VCLD-67-000002\"\n  tag cci: \"CCI-000068\"\n  tag nist: [\"AC-17 (2)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n/opt/vmware/sbin/vami-lighttpd -p -f\n/opt/vmware/etc/lighttpd/lighttpd.conf|grep \\\"ssl.cipher-list\\\"\n\nIf the value ssl.cipher-list = \\\"!aNULL:kECDH+AESGCM:ECDH+AESGCM:RSA+AESGCM:kECDH+AES:ECDH+AES:RSA+AES\\\" is not returned or\ncommented out, this is a finding.\"\n  desc 'fix', \"Navigate to and open /etc/applmgmt/appliance/lighttpd.conf\n\nRemove any existing \\\"ssl.cipher-list\\\" entry and repalce with the following:\n\nssl.cipher-list = \\\"!aNULL:kECDH+AESGCM:ECDH+AESGCM:RSA+AESGCM:kECDH+AES:ECDH+AES:RSA+AES\\\"\"\n\n  describe parse_config_file('/etc/applmgmt/appliance/lighttpd.conf').params['ssl.cipher-list'] do\n    it { should eq \"\\\"!aNULL:kECDH+AESGCM:ECDH+AESGCM:RSA+AESGCM:kECDH+AES:ECDH+AES:RSA+AES\\\"\" }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000002.rb",
        "line": 1
      },
      "id": "VCLD-67-000002"
    },
    {
      "title": "VAMI must not be configured to use mod_status.",
      "desc": "Any application providing too much information in error logs and in\nadministrative messages to the screen risks compromising the data and security\nof the application and system. The structure and content of error messages\nneeds to be carefully considered by the organization and development team.\n\n    Lighttpd must only generate error messages that provide information\nnecessary for corrective actions without revealing sensitive or potentially\nharmful information in error logs and administrative messages.  The mod_status\nmodule generates the status overview of the webserver. The information covers:\n\n    uptime\n    average throughput\n    current throughput\n    active connections and their state\n\n    While this information is useful on a development system, production\nsystems must not have mod_status enabled.",
      "descriptions": {
        "default": "Any application providing too much information in error logs and in\nadministrative messages to the screen risks compromising the data and security\nof the application and system. The structure and content of error messages\nneeds to be carefully considered by the organization and development team.\n\n    Lighttpd must only generate error messages that provide information\nnecessary for corrective actions without revealing sensitive or potentially\nharmful information in error logs and administrative messages.  The mod_status\nmodule generates the status overview of the webserver. The information covers:\n\n    uptime\n    average throughput\n    current throughput\n    active connections and their state\n\n    While this information is useful on a development system, production\nsystems must not have mod_status enabled.",
        "check": "At the command prompt, execute the following command:\n\n/opt/vmware/sbin/vami-lighttpd -p -f\n/opt/vmware/etc/lighttpd/lighttpd.conf|grep mod_status\n\nIf there is any output, this is a finding.",
        "fix": "Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf.\n\nRemove any lines that specify mod_status."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "vami",
        "gtitle": "SRG-APP-000266-WSR-000159",
        "gid": null,
        "rid": "VCLD-67-000030",
        "stig_id": "VCLD-67-000030",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCLD-67-000030\" do\n  title \"VAMI must not be configured to use mod_status.\"\n  desc  \"Any application providing too much information in error logs and in\nadministrative messages to the screen risks compromising the data and security\nof the application and system. The structure and content of error messages\nneeds to be carefully considered by the organization and development team.\n\n    Lighttpd must only generate error messages that provide information\nnecessary for corrective actions without revealing sensitive or potentially\nharmful information in error logs and administrative messages.  The mod_status\nmodule generates the status overview of the webserver. The information covers:\n\n    uptime\n    average throughput\n    current throughput\n    active connections and their state\n\n    While this information is useful on a development system, production\nsystems must not have mod_status enabled.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"vami\"\n  tag gtitle: \"SRG-APP-000266-WSR-000159\"\n  tag gid: nil\n  tag rid: \"VCLD-67-000030\"\n  tag stig_id: \"VCLD-67-000030\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n/opt/vmware/sbin/vami-lighttpd -p -f\n/opt/vmware/etc/lighttpd/lighttpd.conf|grep mod_status\n\nIf there is any output, this is a finding.\"\n  desc 'fix', \"Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf.\n\nRemove any lines that specify mod_status.\"\n\n  describe parse_config_file('/opt/vmware/etc/lighttpd/lighttpd.conf').params['mod_status'] do\n    it { should eq nil }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000030.rb",
        "line": 1
      },
      "id": "VCLD-67-000030"
    },
    {
      "title": "VAMI must only contain services and functions necessary for operation.",
      "desc": "A web server can provide many features, services, and processes. Some\nof these may be deemed unnecessary or too unsecure to run on a production DoD\nsystem.\n\n    The web server must provide the capability to disable, uninstall, or\ndeactivate functionality and services that are deemed to be non-essential to\nthe web server mission or can adversely impact server performance.",
      "descriptions": {
        "default": "A web server can provide many features, services, and processes. Some\nof these may be deemed unnecessary or too unsecure to run on a production DoD\nsystem.\n\n    The web server must provide the capability to disable, uninstall, or\ndeactivate functionality and services that are deemed to be non-essential to\nthe web server mission or can adversely impact server performance.",
        "check": "At the command prompt, execute the following command:\n\ncat /opt/vmware/etc/lighttpd/lighttpd.conf | awk '/server\\.modules/,/\\)/'\n\nIf does not match the below output, this is a finding.\n\nserver.modules = (\n  \"mod_access\",\n  \"mod_accesslog\",\n  \"mod_proxy\",\n  \"mod_cgi\",\n  \"mod_rewrite\",\n)\nserver.modules += ( \"mod_magnet\" )",
        "fix": "Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf\n\nNavigate to and configure the \"server.modules\" section and replace it with\nthe following:\n\nserver.modules = (\n  \"mod_access\",\n  \"mod_accesslog\",\n  \"mod_proxy\",\n  \"mod_cgi\",\n  \"mod_rewrite\",\n)\nserver.modules += ( \"mod_magnet\" )"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "vami",
        "gtitle": "SRG-APP-000141-WSR-000075",
        "gid": null,
        "rid": "VCLD-67-000016",
        "stig_id": "VCLD-67-000016",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCLD-67-000016\" do\n  title \"VAMI must only contain services and functions necessary for operation.\"\n  desc  \"A web server can provide many features, services, and processes. Some\nof these may be deemed unnecessary or too unsecure to run on a production DoD\nsystem.\n\n    The web server must provide the capability to disable, uninstall, or\ndeactivate functionality and services that are deemed to be non-essential to\nthe web server mission or can adversely impact server performance.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"vami\"\n  tag gtitle: \"SRG-APP-000141-WSR-000075\"\n  tag gid: nil\n  tag rid: \"VCLD-67-000016\"\n  tag stig_id: \"VCLD-67-000016\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\ncat /opt/vmware/etc/lighttpd/lighttpd.conf | awk '/server\\\\.modules/,/\\\\)/'\n\nIf does not match the below output, this is a finding.\n\nserver.modules = (\n  \\\"mod_access\\\",\n  \\\"mod_accesslog\\\",\n  \\\"mod_proxy\\\",\n  \\\"mod_cgi\\\",\n  \\\"mod_rewrite\\\",\n)\nserver.modules += ( \\\"mod_magnet\\\" )\n\"\n  desc 'fix', \"Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf\n\nNavigate to and configure the \\\"server.modules\\\" section and replace it with\nthe following:\n\nserver.modules = (\n  \\\"mod_access\\\",\n  \\\"mod_accesslog\\\",\n  \\\"mod_proxy\\\",\n  \\\"mod_cgi\\\",\n  \\\"mod_rewrite\\\",\n)\nserver.modules += ( \\\"mod_magnet\\\" )\"\n\n  describe command(\"cat /opt/vmware/etc/lighttpd/lighttpd.conf | awk '/server\\.modules/,/\\)/'\") do\n    its ('stdout') { should match \"server.modules = (\\n  \\\"mod_access\\\",\\n  \\\"mod_accesslog\\\",\\n  \\\"mod_proxy\\\",\\n  \\\"mod_cgi\\\",\\n  \\\"mod_rewrite\\\",\\n)\\nserver.modules += ( \\\"mod_magnet\\\" )\\n\"  }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000016.rb",
        "line": 1
      },
      "id": "VCLD-67-000016"
    },
    {
      "title": "Rsyslog must be configured to monitor VAMI logs.",
      "desc": "For performance reasons, rsyslog file monitoring is preferred over\nconfiguring VAMI to send events to a syslog facility. Without ensuring that\nlogs are created, that rsyslog configs are created and that those configs are\nloaded, the log file monitoring and shipping will not be effective.",
      "descriptions": {
        "default": "For performance reasons, rsyslog file monitoring is preferred over\nconfiguring VAMI to send events to a syslog facility. Without ensuring that\nlogs are created, that rsyslog configs are created and that those configs are\nloaded, the log file monitoring and shipping will not be effective.",
        "check": "At the command prompt, execute the following command:\n\n# grep -v \"^#\" /etc/vmware-syslog/stig-services-vami.conf\n\nExpected result:\n\ninput(type=\"imfile\" File=\"/opt/vmware/var/log/lighttpd/access.log\"\nTag=\"vami-access\"\nSeverity=\"info\"\nFacility=\"local0\")\n\nIf the file does not exist, this is a finding.\n\nIf the output of the command does not match the expected result above, this is\na finding.",
        "fix": "Navigate to and open\n/etc/vmware-syslog/vmware-syslog/stig-services-vami.conf , creating the file if\nit does not exist.\n\nSet the contents of the file as follows:\n\ninput(type=\"imfile\" File=\"/opt/vmware/var/log/lighttpd/access.log\"\nTag=\"vami-access\"\nSeverity=\"info\"\nFacility=\"local0\")"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "vami",
        "gtitle": "SRG-APP-000125-WSR-000071",
        "gid": null,
        "rid": "VCLD-67-000014",
        "stig_id": "VCLD-67-000014",
        "cci": "CCI-001348",
        "nist": [
          "AU-9 (2)",
          "Rev_4"
        ]
      },
      "code": "control \"VCLD-67-000014\" do\n  title \"Rsyslog must be configured to monitor VAMI logs.\"\n  desc  \"For performance reasons, rsyslog file monitoring is preferred over\nconfiguring VAMI to send events to a syslog facility. Without ensuring that\nlogs are created, that rsyslog configs are created and that those configs are\nloaded, the log file monitoring and shipping will not be effective.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"vami\"\n  tag gtitle: \"SRG-APP-000125-WSR-000071\"\n  tag gid: nil\n  tag rid: \"VCLD-67-000014\"\n  tag stig_id: \"VCLD-67-000014\"\n  tag cci: \"CCI-001348\"\n  tag nist: [\"AU-9 (2)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep -v \\\"^#\\\" /etc/vmware-syslog/stig-services-vami.conf\n\nExpected result:\n\ninput(type=\\\"imfile\\\" File=\\\"/opt/vmware/var/log/lighttpd/access.log\\\"\nTag=\\\"vami-access\\\"\nSeverity=\\\"info\\\"\nFacility=\\\"local0\\\")\n\nIf the file does not exist, this is a finding.\n\nIf the output of the command does not match the expected result above, this is\na finding.\"\n  desc 'fix', \"Navigate to and open\n/etc/vmware-syslog/vmware-syslog/stig-services-vami.conf , creating the file if\nit does not exist.\n\nSet the contents of the file as follows:\n\ninput(type=\\\"imfile\\\" File=\\\"/opt/vmware/var/log/lighttpd/access.log\\\"\nTag=\\\"vami-access\\\"\nSeverity=\\\"info\\\"\nFacility=\\\"local0\\\")\"\n\n  describe file('/etc/vmware-syslog/stig-services-vami.conf') do\n    it { should exist }\n  end\n  describe command('grep -v \"^#\" /etc/vmware-syslog/stig-services-vami.conf') do\n    its ('stdout') { should match \"input(type=\\\"imfile\\\" File=\\\"/opt/vmware/var/log/lighttpd/access.log\\\"\\nTag=\\\"vami-access\\\"\\nSeverity=\\\"info\\\"\\nFacility=\\\"local0\\\")\\n\" }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000014.rb",
        "line": 1
      },
      "id": "VCLD-67-000014"
    },
    {
      "title": "VAMI must have Multipurpose Internet Mail Extensions (MIME) that\ninvoke OS shell programs disabled.",
      "desc": "Controlling what a user of a hosted application can access is part of\nthe security posture of the web server. Any time a user can access more\nfunctionality than is needed for the operation of the hosted application poses\na security issue. A user with too much access can view information that is not\nneeded for the user's job role, or the user could use the function in an\nunintentional manner.A MIME tells the web server what type of program various\nfile types and extensions are and what external utilities or programs are\nneeded to execute the file type.",
      "descriptions": {
        "default": "Controlling what a user of a hosted application can access is part of\nthe security posture of the web server. Any time a user can access more\nfunctionality than is needed for the operation of the hosted application poses\na security issue. A user with too much access can view information that is not\nneeded for the user's job role, or the user could use the function in an\nunintentional manner.A MIME tells the web server what type of program various\nfile types and extensions are and what external utilities or programs are\nneeded to execute the file type.",
        "check": "At the command prompt, execute the following command:\n\ncat /opt/vmware/etc/lighttpd/lighttpd.conf | egrep '\".sh\"|\".csh\"'\n\nIf the command returns any value, this is a finding.",
        "fix": "Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf\n\nNavigate to the mimetype.assign section and remove any lines that reference\n\".sh\" or \".csh\"."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "vami",
        "gtitle": "SRG-APP-000141-WSR-000081",
        "gid": null,
        "rid": "VCLD-67-000017",
        "stig_id": "VCLD-67-000017",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCLD-67-000017\" do\n  title \"VAMI must have Multipurpose Internet Mail Extensions (MIME) that\ninvoke OS shell programs disabled.\"\n  desc  \"Controlling what a user of a hosted application can access is part of\nthe security posture of the web server. Any time a user can access more\nfunctionality than is needed for the operation of the hosted application poses\na security issue. A user with too much access can view information that is not\nneeded for the user's job role, or the user could use the function in an\nunintentional manner.A MIME tells the web server what type of program various\nfile types and extensions are and what external utilities or programs are\nneeded to execute the file type.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"vami\"\n  tag gtitle: \"SRG-APP-000141-WSR-000081\"\n  tag gid: nil\n  tag rid: \"VCLD-67-000017\"\n  tag stig_id: \"VCLD-67-000017\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\ncat /opt/vmware/etc/lighttpd/lighttpd.conf | egrep '\\\".sh\\\"|\\\".csh\\\"'\n\nIf the command returns any value, this is a finding.\"\n  desc 'fix', \"Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf\n\nNavigate to the mimetype.assign section and remove any lines that reference\n\\\".sh\\\" or \\\".csh\\\".\"\n\n  describe command(\"cat /opt/vmware/etc/lighttpd/lighttpd.conf | awk '/mimetype\\.assign/,/\\)/'\") do\n    its ('stdout') { should_not match /\".sh\"/ }\n    its ('stdout') { should_not match /\".csh\"/ }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000017.rb",
        "line": 1
      },
      "id": "VCLD-67-000017"
    },
    {
      "title": "VAMI must be configured to use mod_accesslog.",
      "desc": "Remote access can be exploited by an attacker to compromise the\nserver.  By recording all remote access activities, it will be possible to\ndetermine the attacker's location, intent, and degree of success.\n\n    Lighttpd uses the mod_accesslog module to share information with external\nmonitoring systems.",
      "descriptions": {
        "default": "Remote access can be exploited by an attacker to compromise the\nserver.  By recording all remote access activities, it will be possible to\ndetermine the attacker's location, intent, and degree of success.\n\n    Lighttpd uses the mod_accesslog module to share information with external\nmonitoring systems.",
        "check": "At the command prompt, execute the following command:\n\ncat /opt/vmware/etc/lighttpd/lighttpd.conf | awk '/server\\.modules/,/\\)/'\n\nIf the value \"mod_accesslog\" is not listed, this is a finding.",
        "fix": "Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf\n\nNavigate to and configure the \"server.modules\" section with the following\nvalue:\n\nmod_accesslog"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "vami",
        "gtitle": "SRG-APP-000016-WSR-000005",
        "gid": null,
        "rid": "VCLD-67-000004",
        "stig_id": "VCLD-67-000004",
        "cci": "CCI-000067",
        "nist": [
          "AC-17 (1)",
          "Rev_4"
        ]
      },
      "code": "control \"VCLD-67-000004\" do\n  title \"VAMI must be configured to use mod_accesslog.\"\n  desc  \"Remote access can be exploited by an attacker to compromise the\nserver.  By recording all remote access activities, it will be possible to\ndetermine the attacker's location, intent, and degree of success.\n\n    Lighttpd uses the mod_accesslog module to share information with external\nmonitoring systems.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"vami\"\n  tag gtitle: \"SRG-APP-000016-WSR-000005\"\n  tag gid: nil\n  tag rid: \"VCLD-67-000004\"\n  tag stig_id: \"VCLD-67-000004\"\n  tag cci: \"CCI-000067\"\n  tag nist: [\"AC-17 (1)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\ncat /opt/vmware/etc/lighttpd/lighttpd.conf | awk '/server\\\\.modules/,/\\\\)/'\n\nIf the value \\\"mod_accesslog\\\" is not listed, this is a finding.\"\n  desc 'fix', \"Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf\n\nNavigate to and configure the \\\"server.modules\\\" section with the following\nvalue:\n\nmod_accesslog\"\n\n  describe command(\"cat /opt/vmware/etc/lighttpd/lighttpd.conf | awk '/server\\.modules/,/\\)/'\") do\n    its ('stdout') { should match \"server.modules = (\\n  \\\"mod_access\\\",\\n  \\\"mod_accesslog\\\",\\n  \\\"mod_proxy\\\",\\n  \\\"mod_cgi\\\",\\n  \\\"mod_rewrite\\\",\\n)\\nserver.modules += ( \\\"mod_magnet\\\" )\\n\"  }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000004.rb",
        "line": 1
      },
      "id": "VCLD-67-000004"
    },
    {
      "title": "VAMI must only listen on localhost.",
      "desc": "The web server must be configured to listen on a specified IP address\nand port. Without specifying an IP address and port for the web server\nto utilize, the web server will listen on all IP addresses available to the\nhosting server. If the web server has multiple IP addresses, i.e., a\nmanagement IP address, the web server will also accept connections on the\nmanagement IP address. Accessing the hosted application through an IP\naddress normally used for non-application functions opens the possibility of\nuser access to resources, utilities, files, ports, and protocols that are\nprotected on the desired application IP address.",
      "descriptions": {
        "default": "The web server must be configured to listen on a specified IP address\nand port. Without specifying an IP address and port for the web server\nto utilize, the web server will listen on all IP addresses available to the\nhosting server. If the web server has multiple IP addresses, i.e., a\nmanagement IP address, the web server will also accept connections on the\nmanagement IP address. Accessing the hosted application through an IP\naddress normally used for non-application functions opens the possibility of\nuser access to resources, utilities, files, ports, and protocols that are\nprotected on the desired application IP address.",
        "check": "At the command prompt, execute the following command:\n\ngrep '^server.port' /opt/vmware/etc/lighttpd/lighttpd.conf\n\nIf the value of \"server.port\" is not \"5480\" or no value is returned, this\nis a finding.",
        "fix": "Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf file.\n\nRemove any existing server.port entry and add the following line:\n\nserver.port = 5480"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "vami",
        "gtitle": "SRG-APP-000142-WSR-000089",
        "gid": null,
        "rid": "VCLD-67-000024",
        "stig_id": "VCLD-67-000024",
        "cci": "CCI-000382",
        "nist": [
          "CM-7 b",
          "Rev_4"
        ]
      },
      "code": "control \"VCLD-67-000024\" do\n  title \"VAMI must only listen on localhost.\"\n  desc  \"The web server must be configured to listen on a specified IP address\nand port. Without specifying an IP address and port for the web server\nto utilize, the web server will listen on all IP addresses available to the\nhosting server. If the web server has multiple IP addresses, i.e., a\nmanagement IP address, the web server will also accept connections on the\nmanagement IP address. Accessing the hosted application through an IP\naddress normally used for non-application functions opens the possibility of\nuser access to resources, utilities, files, ports, and protocols that are\nprotected on the desired application IP address.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"vami\"\n  tag gtitle: \"SRG-APP-000142-WSR-000089\"\n  tag gid: nil\n  tag rid: \"VCLD-67-000024\"\n  tag stig_id: \"VCLD-67-000024\"\n  tag cci: \"CCI-000382\"\n  tag nist: [\"CM-7 b\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\ngrep '^server.port' /opt/vmware/etc/lighttpd/lighttpd.conf\n\nIf the value of \\\"server.port\\\" is not \\\"5480\\\" or no value is returned, this\nis a finding.\"\n  desc 'fix', \"Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf file.\n\nRemove any existing server.port entry and add the following line:\n\nserver.port = 5480\"\n\n  describe parse_config_file('/opt/vmware/etc/lighttpd/lighttpd.conf').params['server.port'] do\n    it { should eq '5480' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000024.rb",
        "line": 1
      },
      "id": "VCLD-67-000024"
    },
    {
      "title": "VAMI server files must be verified for their integrity (e.g.,\nchecksums and hashes) before becoming part of the production web server.",
      "desc": "Being able to verify that a patch, upgrade, certificate, etc., being\nadded to the web server is unchanged from the producer of the file is essential\nfor file validation and non-repudiation of the information.\n\n    VMware delivers product updates and patches regularly.  It is crucial that\nsystem administrators coordinate installation of product updates with the site\nISSO to ensure that only valid files are uploaded onto the system.",
      "descriptions": {
        "default": "Being able to verify that a patch, upgrade, certificate, etc., being\nadded to the web server is unchanged from the producer of the file is essential\nfor file validation and non-repudiation of the information.\n\n    VMware delivers product updates and patches regularly.  It is crucial that\nsystem administrators coordinate installation of product updates with the site\nISSO to ensure that only valid files are uploaded onto the system.",
        "check": "At the command prompt, execute the following command:\n\nrpm -qa|grep lighttpd|xargs rpm -V\n\nIf the command returns output for any file other than\n/opt/vmware/etc/lighttpd/lighttpd.conf , this is a finding.",
        "fix": "If the VAMI binaries have been modified from the default state when\ndeployed as part of the VCSA then the system must be wiped and redeployed or\nrestored from backup. VMware does not recommend or support recovering from such\na state by reinstalling RPMs or similar efforts."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "vami",
        "gtitle": "SRG-APP-000131-WSR-000051",
        "gid": null,
        "rid": "VCLD-67-000015",
        "stig_id": "VCLD-67-000015",
        "cci": "CCI-001749",
        "nist": [
          "CM-5 (3)",
          "Rev_4"
        ]
      },
      "code": "control \"VCLD-67-000015\" do\n  title \"VAMI server files must be verified for their integrity (e.g.,\nchecksums and hashes) before becoming part of the production web server.\"\n  desc  \"Being able to verify that a patch, upgrade, certificate, etc., being\nadded to the web server is unchanged from the producer of the file is essential\nfor file validation and non-repudiation of the information.\n\n    VMware delivers product updates and patches regularly.  It is crucial that\nsystem administrators coordinate installation of product updates with the site\nISSO to ensure that only valid files are uploaded onto the system.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"vami\"\n  tag gtitle: \"SRG-APP-000131-WSR-000051\"\n  tag gid: nil\n  tag rid: \"VCLD-67-000015\"\n  tag stig_id: \"VCLD-67-000015\"\n  tag cci: \"CCI-001749\"\n  tag nist: [\"CM-5 (3)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\nrpm -qa|grep lighttpd|xargs rpm -V\n\nIf the command returns output for any file other than\n/opt/vmware/etc/lighttpd/lighttpd.conf , this is a finding.\"\n  desc 'fix', \"If the VAMI binaries have been modified from the default state when\ndeployed as part of the VCSA then the system must be wiped and redeployed or\nrestored from backup. VMware does not recommend or support recovering from such\na state by reinstalling RPMs or similar efforts.\"\n\n  describe command('rpm -qa|grep lighttpd|xargs rpm -V') do\n    its ('stdout.strip') { should match \"S.5....T.  c /opt/vmware/etc/lighttpd/lighttpd.conf\"}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000015.rb",
        "line": 1
      },
      "id": "VCLD-67-000015"
    },
    {
      "title": "VAMI must disable directory browsing.",
      "desc": "The goal is to completely control the web user's experience in\nnavigating any portion of the web document root directories. Ensuring all web\ncontent directories have at least the equivalent of an index.html file is a\nsignificant factor to accomplish this end.\n\n    Enumeration techniques, such as URL parameter manipulation, rely upon being\nable to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. By having a default hosted application web page, the anonymous web\nuser will not obtain directory browsing information or an error message that\nreveals the server type and version.",
      "descriptions": {
        "default": "The goal is to completely control the web user's experience in\nnavigating any portion of the web document root directories. Ensuring all web\ncontent directories have at least the equivalent of an index.html file is a\nsignificant factor to accomplish this end.\n\n    Enumeration techniques, such as URL parameter manipulation, rely upon being\nable to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. By having a default hosted application web page, the anonymous web\nuser will not obtain directory browsing information or an error message that\nreveals the server type and version.",
        "check": "At the command prompt, execute the following command:\n\ngrep '^dir-listing.activate' /opt/vmware/etc/lighttpd/lighttpd.conf\n\nIf the value for \"dir-listing.activate\" is not set to \"disable\", this is a\nfinding.",
        "fix": "Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf\n\nConfigure the \"lighttpd.conf\" file with the following:\n\n dir-listing.activate  = \"disable\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "vami",
        "gtitle": "SRG-APP-000266-WSR-000142",
        "gid": null,
        "rid": "VCLD-67-000029",
        "stig_id": "VCLD-67-000029",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCLD-67-000029\" do\n  title \"VAMI must disable directory browsing.\"\n  desc  \"The goal is to completely control the web user's experience in\nnavigating any portion of the web document root directories. Ensuring all web\ncontent directories have at least the equivalent of an index.html file is a\nsignificant factor to accomplish this end.\n\n    Enumeration techniques, such as URL parameter manipulation, rely upon being\nable to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. By having a default hosted application web page, the anonymous web\nuser will not obtain directory browsing information or an error message that\nreveals the server type and version.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"vami\"\n  tag gtitle: \"SRG-APP-000266-WSR-000142\"\n  tag gid: nil\n  tag rid: \"VCLD-67-000029\"\n  tag stig_id: \"VCLD-67-000029\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\ngrep '^dir-listing.activate' /opt/vmware/etc/lighttpd/lighttpd.conf\n\nIf the value for \\\"dir-listing.activate\\\" is not set to \\\"disable\\\", this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf\n\nConfigure the \\\"lighttpd.conf\\\" file with the following:\n\n dir-listing.activate  = \\\"disable\\\"\"\n\n  describe parse_config_file('/opt/vmware/etc/lighttpd/lighttpd.conf').params['dir-listing.activate'] do\n    it { should eq \"\\\"disable\\\"\" }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000029.rb",
        "line": 1
      },
      "id": "VCLD-67-000029"
    },
    {
      "title": "VAMI must have resource mappings set to disable the serving of certain\nfile types.",
      "desc": "Resource mapping is the process of tying a particular file type to a\nprocess in the web server that can serve that type of file to a requesting\nclient and to identify which file types are not to be delivered to a client.\n\n    By not specifying which files can and which files cannot be served to a\nuser, the web server could deliver to a user web server configuration files,\nlog files, password files, etc.",
      "descriptions": {
        "default": "Resource mapping is the process of tying a particular file type to a\nprocess in the web server that can serve that type of file to a requesting\nclient and to identify which file types are not to be delivered to a client.\n\n    By not specifying which files can and which files cannot be served to a\nuser, the web server could deliver to a user web server configuration files,\nlog files, password files, etc.",
        "check": "At the command prompt, execute the following command:\n\ngrep \"url.access-deny\" /opt/vmware/etc/lighttpd/lighttpd.conf\n\nIf the output does not include \"~\" and \".inc\" at a minimum, this is a\nfinding.",
        "fix": "Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf\n\nNavigate to the url.access-deny line and replace it entirely with the following:\n\nurl.access-deny             = ( \"~\", \".inc\" )"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "vami",
        "gtitle": "SRG-APP-000141-WSR-000083",
        "gid": null,
        "rid": "VCLD-67-000020",
        "stig_id": "VCLD-67-000020",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCLD-67-000020\" do\n  title \"VAMI must have resource mappings set to disable the serving of certain\nfile types.\"\n  desc  \"Resource mapping is the process of tying a particular file type to a\nprocess in the web server that can serve that type of file to a requesting\nclient and to identify which file types are not to be delivered to a client.\n\n    By not specifying which files can and which files cannot be served to a\nuser, the web server could deliver to a user web server configuration files,\nlog files, password files, etc.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"vami\"\n  tag gtitle: \"SRG-APP-000141-WSR-000083\"\n  tag gid: nil\n  tag rid: \"VCLD-67-000020\"\n  tag stig_id: \"VCLD-67-000020\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\ngrep \\\"url.access-deny\\\" /opt/vmware/etc/lighttpd/lighttpd.conf\n\nIf the output does not include \\\"~\\\" and \\\".inc\\\" at a minimum, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf\n\nNavigate to the url.access-deny line and replace it entirely with the following:\n\nurl.access-deny             = ( \\\"~\\\", \\\".inc\\\" )\"\n\n  describe parse_config_file('/opt/vmware/etc/lighttpd/lighttpd.conf').params['url.access-deny'] do\n    it { should eq '( \"~\", \".inc\" )' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000020.rb",
        "line": 1
      },
      "id": "VCLD-67-000020"
    },
    {
      "title": "VAMI must use an approved TLS version for encryption.",
      "desc": "Transport Layer Security (TLS) is a required transmission protocol for\na web server hosting controlled information. The use of TLS provides\nconfidentiality of data in transit between the web server and client. FIPS\n140-2 approved TLS versions must be enabled and non-FIPS-approved SSL versions\nmust be disabled.\n\n    NIST SP 800-52 defines the approved TLS versions for government\napplications.",
      "descriptions": {
        "default": "Transport Layer Security (TLS) is a required transmission protocol for\na web server hosting controlled information. The use of TLS provides\nconfidentiality of data in transit between the web server and client. FIPS\n140-2 approved TLS versions must be enabled and non-FIPS-approved SSL versions\nmust be disabled.\n\n    NIST SP 800-52 defines the approved TLS versions for government\napplications.",
        "check": "At the command prompt, execute the following command:\n\nNote:  The command should return 2 outputs: ssl.use-sslv2 and ssl.use-sslv3\n\ngrep '^ssl.use' /opt/vmware/etc/lighttpd/lighttpd.conf\n\nIf any returned value is set to \"enable\" other than \"ssl.use-tlsv12\", this\nis a finding.",
        "fix": "Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf\n\nReplace any and all \"ssl.use-*\" lines with following:\n\nssl.use-sslv2 = \"disable\"\nssl.use-sslv3 = \"disable\"\nssl.use-tlsv10 = \"disable\"\nssl.use-tlsv11 = \"disable\"\nssl.use-tlsv12 = \"enable\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "vami",
        "gtitle": "SRG-APP-000439-WSR-000156",
        "gid": null,
        "rid": "VCLD-67-000034",
        "stig_id": "VCLD-67-000034",
        "cci": "CCI-002418",
        "nist": [
          "SC-8",
          "Rev_4"
        ]
      },
      "code": "control \"VCLD-67-000034\" do\n  title \"VAMI must use an approved TLS version for encryption.\"\n  desc  \"Transport Layer Security (TLS) is a required transmission protocol for\na web server hosting controlled information. The use of TLS provides\nconfidentiality of data in transit between the web server and client. FIPS\n140-2 approved TLS versions must be enabled and non-FIPS-approved SSL versions\nmust be disabled.\n\n    NIST SP 800-52 defines the approved TLS versions for government\napplications.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"vami\"\n  tag gtitle: \"SRG-APP-000439-WSR-000156\"\n  tag gid: nil\n  tag rid: \"VCLD-67-000034\"\n  tag stig_id: \"VCLD-67-000034\"\n  tag cci: \"CCI-002418\"\n  tag nist: [\"SC-8\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\nNote:  The command should return 2 outputs: ssl.use-sslv2 and ssl.use-sslv3\n\ngrep '^ssl.use' /opt/vmware/etc/lighttpd/lighttpd.conf\n\nIf any returned value is set to \\\"enable\\\" other than \\\"ssl.use-tlsv12\\\", this\nis a finding.\"\n  desc 'fix', \"Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf\n\nReplace any and all \\\"ssl.use-*\\\" lines with following:\n\nssl.use-sslv2 = \\\"disable\\\"\nssl.use-sslv3 = \\\"disable\\\"\nssl.use-tlsv10 = \\\"disable\\\"\nssl.use-tlsv11 = \\\"disable\\\"\nssl.use-tlsv12 = \\\"enable\\\"\"\n\n  describe parse_config_file('/opt/vmware/etc/lighttpd/lighttpd.conf').params['ssl.use-sslv2'] do\n    it { should eq \"\\\"disable\\\"\" }\n  end\n  describe parse_config_file('/opt/vmware/etc/lighttpd/lighttpd.conf').params['ssl.use-sslv3'] do\n    it { should eq \"\\\"disable\\\"\" }\n  end\n  describe parse_config_file('/opt/vmware/etc/lighttpd/lighttpd.conf').params['ssl.use-tlsv10'] do\n    it { should eq \"\\\"disable\\\"\" }\n  end\n  describe parse_config_file('/opt/vmware/etc/lighttpd/lighttpd.conf').params['ssl.use-tlsv11'] do\n    it { should eq \"\\\"disable\\\"\" }\n  end\n  describe parse_config_file('/opt/vmware/etc/lighttpd/lighttpd.conf').params['ssl.use-tlsv12'] do\n    it { should eq \"\\\"enable\\\"\" }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000034.rb",
        "line": 1
      },
      "id": "VCLD-67-000034"
    },
    {
      "title": "VAMI must limit the number of simultaneous requests.",
      "desc": "Denial of Service is one threat against web servers.  Many DoS attacks\nattempt to consume web server resources in such a way that no more resources\nare available to satisfy legitimate requests.  Mitigation against these threats\nis to take steps to  limit the number of resources that can be consumed in\ncertain ways.\n\n    Lighttpd provides the maxConnections attribute of the <Connector Elements>\nto limit the number of concurrent TCP connections.",
      "descriptions": {
        "default": "Denial of Service is one threat against web servers.  Many DoS attacks\nattempt to consume web server resources in such a way that no more resources\nare available to satisfy legitimate requests.  Mitigation against these threats\nis to take steps to  limit the number of resources that can be consumed in\ncertain ways.\n\n    Lighttpd provides the maxConnections attribute of the <Connector Elements>\nto limit the number of concurrent TCP connections.",
        "check": "At the command prompt, execute the following command:\n\ngrep \"server.max-connections = 1024\" /opt/vmware/etc/lighttpd/lighttpd.conf\n\nIf the \"server.max-connections\" is not set to \"1024\", commented out, or\ndoes not exist, this is a finding.",
        "fix": "Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf\n\nConfigure the \"lighttpd.conf\" file with the following value:\n\nserver.max-connections = 1024"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "vami",
        "gtitle": "SRG-APP-000001-WSR-000001",
        "gid": null,
        "rid": "VCLD-67-000001",
        "stig_id": "VCLD-67-000001",
        "cci": "CCI-000054",
        "nist": [
          "AC-10",
          "Rev_4"
        ]
      },
      "code": "control \"VCLD-67-000001\" do\n  title \"VAMI must limit the number of simultaneous requests.\"\n  desc  \"Denial of Service is one threat against web servers.  Many DoS attacks\nattempt to consume web server resources in such a way that no more resources\nare available to satisfy legitimate requests.  Mitigation against these threats\nis to take steps to  limit the number of resources that can be consumed in\ncertain ways.\n\n    Lighttpd provides the maxConnections attribute of the <Connector Elements>\nto limit the number of concurrent TCP connections.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"vami\"\n  tag gtitle: \"SRG-APP-000001-WSR-000001\"\n  tag gid: nil\n  tag rid: \"VCLD-67-000001\"\n  tag stig_id: \"VCLD-67-000001\"\n  tag cci: \"CCI-000054\"\n  tag nist: [\"AC-10\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\ngrep \\\"server.max-connections = 1024\\\" /opt/vmware/etc/lighttpd/lighttpd.conf\n\nIf the \\\"server.max-connections\\\" is not set to \\\"1024\\\", commented out, or\ndoes not exist, this is a finding.\n\n\n\"\n  desc 'fix', \"Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf\n\nConfigure the \\\"lighttpd.conf\\\" file with the following value:\n\nserver.max-connections = 1024\"\n\n  describe parse_config_file('/opt/vmware/etc/lighttpd/lighttpd.conf').params['server.max-connections'] do\n    it { should eq '1024' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000001.rb",
        "line": 1
      },
      "id": "VCLD-67-000001"
    },
    {
      "title": "VAMI must protect against or limit the effects of HTTP types of Denial\nof Service (DoS) attacks.",
      "desc": "In UNIX and related computer operating systems, a file descriptor is\nan indicator used to access a file or other input/output resource, such as a\npipe or network connection. File descriptors index into a per-process file\ndescriptor table maintained by the kernel, that in turn indexes into a\nsystem-wide table of files opened by all processes, called the file table.\n\n    As a single-threaded server, Lighttpd must be limited in the number of file\ndescriptors that can be allocated.  This will prevent Lighttpd from being used\nin a form of DoS attack against the Operating System.",
      "descriptions": {
        "default": "In UNIX and related computer operating systems, a file descriptor is\nan indicator used to access a file or other input/output resource, such as a\npipe or network connection. File descriptors index into a per-process file\ndescriptor table maintained by the kernel, that in turn indexes into a\nsystem-wide table of files opened by all processes, called the file table.\n\n    As a single-threaded server, Lighttpd must be limited in the number of file\ndescriptors that can be allocated.  This will prevent Lighttpd from being used\nin a form of DoS attack against the Operating System.",
        "check": "At the command prompt, execute the following command:\n\ngrep '^server.max-fds' /opt/vmware/etc/lighttpd/lighttpd.conf\n\nIf the value for \"server.max-fds\" is not set to \"2048\", this is a finding.",
        "fix": "Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf\n\nConfigure the \"lighttpd.conf\" file with the following:\n\nserver.max-fds = 2048"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "vami",
        "gtitle": "SRG-APP-000246-WSR-000149",
        "gid": null,
        "rid": "VCLD-67-000027",
        "stig_id": "VCLD-67-000027",
        "cci": "CCI-001094",
        "nist": [
          "SC-5 (1)",
          "Rev_4"
        ]
      },
      "code": "control \"VCLD-67-000027\" do\n  title \"VAMI must protect against or limit the effects of HTTP types of Denial\nof Service (DoS) attacks.\"\n  desc  \"In UNIX and related computer operating systems, a file descriptor is\nan indicator used to access a file or other input/output resource, such as a\npipe or network connection. File descriptors index into a per-process file\ndescriptor table maintained by the kernel, that in turn indexes into a\nsystem-wide table of files opened by all processes, called the file table.\n\n    As a single-threaded server, Lighttpd must be limited in the number of file\ndescriptors that can be allocated.  This will prevent Lighttpd from being used\nin a form of DoS attack against the Operating System.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"vami\"\n  tag gtitle: \"SRG-APP-000246-WSR-000149\"\n  tag gid: nil\n  tag rid: \"VCLD-67-000027\"\n  tag stig_id: \"VCLD-67-000027\"\n  tag cci: \"CCI-001094\"\n  tag nist: [\"SC-5 (1)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\ngrep '^server.max-fds' /opt/vmware/etc/lighttpd/lighttpd.conf\n\nIf the value for \\\"server.max-fds\\\" is not set to \\\"2048\\\", this is a finding.\"\n  desc 'fix', \"Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf\n\nConfigure the \\\"lighttpd.conf\\\" file with the following:\n\nserver.max-fds = 2048\"\n\n  describe parse_config_file('/opt/vmware/etc/lighttpd/lighttpd.conf').params['server.max-fds'] do\n    it { should eq '2048' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000027.rb",
        "line": 1
      },
      "id": "VCLD-67-000027"
    },
    {
      "title": "VAMI must use cryptography to protect the integrity of remote\nsessions.",
      "desc": "Data exchanged between the user and the web server can range from\nstatic display data to credentials used to log into the hosted application.\nEven when data appears to be static, the non-displayed logic in a web page may\nexpose business logic or trusted system relationships. The integrity of all the\ndata being exchanged between the user and web server must always be trusted. To\nprotect the integrity and trust, encryption methods should be used to protect\nthe complete communication session.\n\n    In order to protect the integrity and confidentiality of the remote\nsessions, Lighttpd uses SSL/TLS.",
      "descriptions": {
        "default": "Data exchanged between the user and the web server can range from\nstatic display data to credentials used to log into the hosted application.\nEven when data appears to be static, the non-displayed logic in a web page may\nexpose business logic or trusted system relationships. The integrity of all the\ndata being exchanged between the user and web server must always be trusted. To\nprotect the integrity and trust, encryption methods should be used to protect\nthe complete communication session.\n\n    In order to protect the integrity and confidentiality of the remote\nsessions, Lighttpd uses SSL/TLS.",
        "check": "At the command prompt, execute the following command:\n\ngrep '^ssl.engine' /opt/vmware/etc/lighttpd/lighttpd.conf\n\nIf the value \"ssl.engine\" is not set to \"enable\", this is a finding.",
        "fix": "Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf\n\nConfigure the \"lighttpd.conf\" file with the following value:\n\nssl.engine = \"enable\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "vami",
        "gtitle": "SRG-APP-000015-WSR-000014",
        "gid": null,
        "rid": "VCLD-67-000003",
        "stig_id": "VCLD-67-000003",
        "cci": "CCI-001453",
        "nist": [
          "AC-17 (2)",
          "Rev_4"
        ]
      },
      "code": "control \"VCLD-67-000003\" do\n  title \"VAMI must use cryptography to protect the integrity of remote\nsessions.\"\n  desc  \"Data exchanged between the user and the web server can range from\nstatic display data to credentials used to log into the hosted application.\nEven when data appears to be static, the non-displayed logic in a web page may\nexpose business logic or trusted system relationships. The integrity of all the\ndata being exchanged between the user and web server must always be trusted. To\nprotect the integrity and trust, encryption methods should be used to protect\nthe complete communication session.\n\n    In order to protect the integrity and confidentiality of the remote\nsessions, Lighttpd uses SSL/TLS.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"vami\"\n  tag gtitle: \"SRG-APP-000015-WSR-000014\"\n  tag gid: nil\n  tag rid: \"VCLD-67-000003\"\n  tag stig_id: \"VCLD-67-000003\"\n  tag cci: \"CCI-001453\"\n  tag nist: [\"AC-17 (2)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\ngrep '^ssl.engine' /opt/vmware/etc/lighttpd/lighttpd.conf\n\nIf the value \\\"ssl.engine\\\" is not set to \\\"enable\\\", this is a finding.\"\n  desc 'fix', \"Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf\n\nConfigure the \\\"lighttpd.conf\\\" file with the following value:\n\nssl.engine = \\\"enable\\\"\"\n\n  describe parse_config_file('/opt/vmware/etc/lighttpd/lighttpd.conf').params['ssl.engine'] do\n    it { should eq \"\\\"enable\\\"\" }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000003.rb",
        "line": 1
      },
      "id": "VCLD-67-000003"
    },
    {
      "title": "VAMI must set the enconding for all text mime types to UTF-8.",
      "desc": "Invalid user input occurs when a user inserts data or characters into\na hosted application's data entry field and the hosted application is\nunprepared to process that data. This results in unanticipated application\nbehavior, potentially leading to an application compromise. Invalid user input\nis one of the primary methods employed when attempting to compromise an\napplication.\n\n    An attacker can also enter Unicode into hosted applications in an effort to\nbreak out of the document home or root home directory or to bypass security\nchecks.",
      "descriptions": {
        "default": "Invalid user input occurs when a user inserts data or characters into\na hosted application's data entry field and the hosted application is\nunprepared to process that data. This results in unanticipated application\nbehavior, potentially leading to an application compromise. Invalid user input\nis one of the primary methods employed when attempting to compromise an\napplication.\n\n    An attacker can also enter Unicode into hosted applications in an effort to\nbreak out of the document home or root home directory or to bypass security\nchecks.",
        "check": "At the command prompt, execute the following command:\n\ngrep 'text/' /opt/vmware/etc/lighttpd/lighttpd.conf | grep -v 'charset=utf-8'\n\nIf any value is returned, this is a finding.",
        "fix": "Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf\n\nNavigate to the \"mimetype.assign\" block. Replace all the mappings whose\nassigned type is \"text/*\" with to include mappings for utf-8 encoding, as\nfollows:\n\n  \".css\"          =>      \"text/css; charset=utf-8\",\n  \".html\"         =>      \"text/html; charset=utf-8\",\n  \".htm\"          =>      \"text/html; charset=utf-8\",\n  \".js\"           =>      \"text/javascript; charset=utf-8\",\n  \".asc\"          =>      \"text/plain; charset=utf-8\",\n  \".c\"            =>      \"text/plain; charset=utf-8\",\n  \".cpp\"          =>      \"text/plain; charset=utf-8\",\n  \".log\"          =>      \"text/plain; charset=utf-8\",\n  \".conf\"         =>      \"text/plain; charset=utf-8\",\n  \".text\"         =>      \"text/plain; charset=utf-8\",\n  \".txt\"          =>      \"text/plain; charset=utf-8\",\n  \".spec\"         =>      \"text/plain; charset=utf-8\",\n  \".dtd\"          =>      \"text/xml; charset=utf-8\",\n  \".xml\"          =>      \"text/xml; charset=utf-8\","
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "vami",
        "gtitle": "SRG-APP-000251-WSR-000157",
        "gid": null,
        "rid": "VCLD-67-000028",
        "stig_id": "VCLD-67-000028",
        "cci": "CCI-001310",
        "nist": [
          "SI-10",
          "Rev_4"
        ]
      },
      "code": "control \"VCLD-67-000028\" do\n  title \"VAMI must set the enconding for all text mime types to UTF-8.\"\n  desc  \"Invalid user input occurs when a user inserts data or characters into\na hosted application's data entry field and the hosted application is\nunprepared to process that data. This results in unanticipated application\nbehavior, potentially leading to an application compromise. Invalid user input\nis one of the primary methods employed when attempting to compromise an\napplication.\n\n    An attacker can also enter Unicode into hosted applications in an effort to\nbreak out of the document home or root home directory or to bypass security\nchecks.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"vami\"\n  tag gtitle: \"SRG-APP-000251-WSR-000157\"\n  tag gid: nil\n  tag rid: \"VCLD-67-000028\"\n  tag stig_id: \"VCLD-67-000028\"\n  tag cci: \"CCI-001310\"\n  tag nist: [\"SI-10\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\ngrep 'text/' /opt/vmware/etc/lighttpd/lighttpd.conf | grep -v 'charset=utf-8'\n\nIf any value is returned, this is a finding.\"\n  desc 'fix', \"Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf\n\nNavigate to the \\\"mimetype.assign\\\" block. Replace all the mappings whose\nassigned type is \\\"text/*\\\" with to include mappings for utf-8 encoding, as\nfollows:\n\n  \\\".css\\\"          =>      \\\"text/css; charset=utf-8\\\",\n  \\\".html\\\"         =>      \\\"text/html; charset=utf-8\\\",\n  \\\".htm\\\"          =>      \\\"text/html; charset=utf-8\\\",\n  \\\".js\\\"           =>      \\\"text/javascript; charset=utf-8\\\",\n  \\\".asc\\\"          =>      \\\"text/plain; charset=utf-8\\\",\n  \\\".c\\\"            =>      \\\"text/plain; charset=utf-8\\\",\n  \\\".cpp\\\"          =>      \\\"text/plain; charset=utf-8\\\",\n  \\\".log\\\"          =>      \\\"text/plain; charset=utf-8\\\",\n  \\\".conf\\\"         =>      \\\"text/plain; charset=utf-8\\\",\n  \\\".text\\\"         =>      \\\"text/plain; charset=utf-8\\\",\n  \\\".txt\\\"          =>      \\\"text/plain; charset=utf-8\\\",\n  \\\".spec\\\"         =>      \\\"text/plain; charset=utf-8\\\",\n  \\\".dtd\\\"          =>      \\\"text/xml; charset=utf-8\\\",\n  \\\".xml\\\"          =>      \\\"text/xml; charset=utf-8\\\",\"\n\n  describe command(\"grep 'text/' /opt/vmware/etc/lighttpd/lighttpd.conf | grep -v 'charset=utf-8'\") do\n      its ('stdout') { should eq '' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000028.rb",
        "line": 1
      },
      "id": "VCLD-67-000028"
    },
    {
      "title": "VAMI must not have the Web Distributed Authoring (WebDAV) servlet\ninstalled.",
      "desc": "A web server can be installed with functionality that, just by its\nnature, is not secure. Web Distributed Authoring (WebDAV) is an extension to\nthe HTTP protocol that, when developed, was meant to allow users to create,\nchange, and move documents on a server, typically a web server or web share.\nAllowing this functionality, development, and deployment is much easier for web\nauthors.\n\n    WebDAV is not widely used and has serious security concerns because it may\nallow clients to modify unauthorized files on the web server.",
      "descriptions": {
        "default": "A web server can be installed with functionality that, just by its\nnature, is not secure. Web Distributed Authoring (WebDAV) is an extension to\nthe HTTP protocol that, when developed, was meant to allow users to create,\nchange, and move documents on a server, typically a web server or web share.\nAllowing this functionality, development, and deployment is much easier for web\nauthors.\n\n    WebDAV is not widely used and has serious security concerns because it may\nallow clients to modify unauthorized files on the web server.",
        "check": "At the command prompt, execute the following command:\n\n/opt/vmware/sbin/vami-lighttpd -p -f\n/opt/vmware/etc/lighttpd/lighttpd.conf|grep mod_webdav\n\nIf any value is returned, this is a finding.",
        "fix": "Navigate to and open  /opt/vmware/etc/lighttpd/lighttpd.conf\n\nDelete or comment out the mod_webdav line. The line may be in an included\nconfig and not in the parent config itself."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "vami",
        "gtitle": "SRG-APP-000141-WSR-000085",
        "gid": null,
        "rid": "VCLD-67-000021",
        "stig_id": "VCLD-67-000021",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCLD-67-000021\" do\n  title \"VAMI must not have the Web Distributed Authoring (WebDAV) servlet\ninstalled.\"\n  desc  \"A web server can be installed with functionality that, just by its\nnature, is not secure. Web Distributed Authoring (WebDAV) is an extension to\nthe HTTP protocol that, when developed, was meant to allow users to create,\nchange, and move documents on a server, typically a web server or web share.\nAllowing this functionality, development, and deployment is much easier for web\nauthors.\n\n    WebDAV is not widely used and has serious security concerns because it may\nallow clients to modify unauthorized files on the web server.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"vami\"\n  tag gtitle: \"SRG-APP-000141-WSR-000085\"\n  tag gid: nil\n  tag rid: \"VCLD-67-000021\"\n  tag stig_id: \"VCLD-67-000021\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n/opt/vmware/sbin/vami-lighttpd -p -f\n/opt/vmware/etc/lighttpd/lighttpd.conf|grep mod_webdav\n\nIf any value is returned, this is a finding.\"\n  desc 'fix', \"Navigate to and open  /opt/vmware/etc/lighttpd/lighttpd.conf\n\nDelete or comment out the mod_webdav line. The line may be in an included\nconfig and not in the parent config itself.\"\n\n  describe parse_config_file('/opt/vmware/etc/lighttpd/lighttpd.conf').params['mod_webdav'] do\n    it { should eq nil }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000021.rb",
        "line": 1
      },
      "id": "VCLD-67-000021"
    },
    {
      "title": "VAMI must explicitly disable Multipurpose Internet Mail Extensions\n(MIME) mime mappings based on \"Content-Type\".",
      "desc": "Controlling what a user of a hosted application can access is part of\nthe security posture of the web server. Any time a user can access more\nfunctionality than is needed for the operation of the hosted application poses\na security issue. A user with too much access can view information that is not\nneeded for the user's job role, or the user could use the function in an\nunintentional manner.A MIME tells the web server what type of program various\nfile types and extensions are and what external utilities or programs are\nneeded to execute the file type.",
      "descriptions": {
        "default": "Controlling what a user of a hosted application can access is part of\nthe security posture of the web server. Any time a user can access more\nfunctionality than is needed for the operation of the hosted application poses\na security issue. A user with too much access can view information that is not\nneeded for the user's job role, or the user could use the function in an\nunintentional manner.A MIME tells the web server what type of program various\nfile types and extensions are and what external utilities or programs are\nneeded to execute the file type.",
        "check": "At the command prompt, execute the following command:\n\ngrep \"mimetype.use-xattr\" /opt/vmware/etc/lighttpd/lighttpd.conf\n\nIf the mimetype.use-xattr value exists and is sent to anything other than\n\"disable\", this is a finding.",
        "fix": "Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf\n\nReplace any and all \"mimetype.use-xattr\" lines with the following:\n\nmimetype.use-xattr        = \"disable\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "vami",
        "gtitle": "SRG-APP-000141-WSR-000081",
        "gid": null,
        "rid": "VCLD-67-000018",
        "stig_id": "VCLD-67-000018",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCLD-67-000018\" do\n  title \"VAMI must explicitly disable Multipurpose Internet Mail Extensions\n(MIME) mime mappings based on \\\"Content-Type\\\".\"\n  desc  \"Controlling what a user of a hosted application can access is part of\nthe security posture of the web server. Any time a user can access more\nfunctionality than is needed for the operation of the hosted application poses\na security issue. A user with too much access can view information that is not\nneeded for the user's job role, or the user could use the function in an\nunintentional manner.A MIME tells the web server what type of program various\nfile types and extensions are and what external utilities or programs are\nneeded to execute the file type.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"vami\"\n  tag gtitle: \"SRG-APP-000141-WSR-000081\"\n  tag gid: nil\n  tag rid: \"VCLD-67-000018\"\n  tag stig_id: \"VCLD-67-000018\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\ngrep \\\"mimetype.use-xattr\\\" /opt/vmware/etc/lighttpd/lighttpd.conf\n\nIf the mimetype.use-xattr value exists and is sent to anything other than\n\\\"disable\\\", this is a finding.\"\n  desc 'fix', \"Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf\n\nReplace any and all \\\"mimetype.use-xattr\\\" lines with the following:\n\nmimetype.use-xattr        = \\\"disable\\\"\"\n\n  describe parse_config_file('/opt/vmware/etc/lighttpd/lighttpd.conf').params['mimetype.use-xattr'] do\n    it { should eq \"\\\"disable\\\"\" }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000018.rb",
        "line": 1
      },
      "id": "VCLD-67-000018"
    },
    {
      "title": "VAMI log files must be owned by root",
      "desc": "Log data is essential in the investigation of events. If log data were\nto become compromised, then competent forensic analysis and discovery of the\ntrue source of potentially malicious system activity would be difficult, if not\nimpossible, to achieve. In addition, access to log records provides information\nan attacker could potentially use to their advantage since each event record\nmight contain communication ports, protocols, services, trust relationships,\nuser names, etc.The web server must protect the log data from unauthorized\nread, write, copy, etc. This can be done by the web server if the web server is\nalso doing the logging function. The web server may also use an external log\nsystem. In either case, the logs must be protected from access by\nnon-privileged users.",
      "descriptions": {
        "default": "Log data is essential in the investigation of events. If log data were\nto become compromised, then competent forensic analysis and discovery of the\ntrue source of potentially malicious system activity would be difficult, if not\nimpossible, to achieve. In addition, access to log records provides information\nan attacker could potentially use to their advantage since each event record\nmight contain communication ports, protocols, services, trust relationships,\nuser names, etc.The web server must protect the log data from unauthorized\nread, write, copy, etc. This can be done by the web server if the web server is\nalso doing the logging function. The web server may also use an external log\nsystem. In either case, the logs must be protected from access by\nnon-privileged users.",
        "check": "At the command prompt, execute the following command:\n\nstat -c \"%n has %a permissions and is owned by %U:%G\" /opt/vmware/var/log/lighttpd/*.log\n\nExpected result:\n\n/opt/vmware/var/log/lighttpd/access.log has 644 permissions and is owned by root:root\n/opt/vmware/var/log/lighttpd/error.log has 644 permissions and is owned by root:root\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "At the command prompt, enter the following command:\n\n# chown root:root /opt/vmware/var/log/lighttpd/*.log\n# chmod 640 /opt/vmware/var/log/lighttpd/*.log"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "vami",
        "gtitle": "SRG-APP-000118-WSR-000068",
        "gid": null,
        "rid": "VCLD-67-000011",
        "stig_id": "VCLD-67-000011",
        "cci": "CCI-000162",
        "nist": [
          "AU-9",
          "Rev_4"
        ]
      },
      "code": "control \"VCLD-67-000011\" do\n  title \"VAMI log files must be owned by root\"\n  desc  \"Log data is essential in the investigation of events. If log data were\nto become compromised, then competent forensic analysis and discovery of the\ntrue source of potentially malicious system activity would be difficult, if not\nimpossible, to achieve. In addition, access to log records provides information\nan attacker could potentially use to their advantage since each event record\nmight contain communication ports, protocols, services, trust relationships,\nuser names, etc.The web server must protect the log data from unauthorized\nread, write, copy, etc. This can be done by the web server if the web server is\nalso doing the logging function. The web server may also use an external log\nsystem. In either case, the logs must be protected from access by\nnon-privileged users.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"vami\"\n  tag gtitle: \"SRG-APP-000118-WSR-000068\"\n  tag gid: nil\n  tag rid: \"VCLD-67-000011\"\n  tag stig_id: \"VCLD-67-000011\"\n  tag cci: \"CCI-000162\"\n  tag nist: [\"AU-9\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\nstat -c \\\"%n has %a permissions and is owned by %U:%G\\\" /opt/vmware/var/log/lighttpd/*.log\n\nExpected result:\n\n/opt/vmware/var/log/lighttpd/access.log has 644 permissions and is owned by root:root\n/opt/vmware/var/log/lighttpd/error.log has 644 permissions and is owned by root:root\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"At the command prompt, enter the following command:\n\n# chown root:root /opt/vmware/var/log/lighttpd/*.log\n# chmod 640 /opt/vmware/var/log/lighttpd/*.log\n\"\n\n  command('find /opt/vmware/var/log/lighttpd/ -maxdepth 1 -name \"*.log\"').stdout.split.each do | fname |\n    describe file(fname) do\n      its('owner') { should cmp 'root' }\n      its('group') { should cmp 'root' }\n      it { should_not be_more_permissive_than('0640') }\n    end\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000011.rb",
        "line": 1
      },
      "id": "VCLD-67-000011"
    },
    {
      "title": "VAMI must not have any symbolic links in the web content directory\ntree.",
      "desc": "A web server is designed to deliver content and execute scripts or\napplications on the request of a client or user.  Containing user requests to\nfiles in the directory tree of the hosted web application and limiting the\nexecution of scripts and applications guarantees that the user is not accessing\ninformation protected outside the application's realm.\n\n    By checking that no symbolic links exist in the document root, the web\nserver is protected from users jumping outside the hosted application directory\ntree and gaining access to the other directories, including the system root.",
      "descriptions": {
        "default": "A web server is designed to deliver content and execute scripts or\napplications on the request of a client or user.  Containing user requests to\nfiles in the directory tree of the hosted web application and limiting the\nexecution of scripts and applications guarantees that the user is not accessing\ninformation protected outside the application's realm.\n\n    By checking that no symbolic links exist in the document root, the web\nserver is protected from users jumping outside the hosted application directory\ntree and gaining access to the other directories, including the system root.",
        "check": "At the command prompt, execute the following command:\n\nfind /opt/vmware/share/htdocs -type l\n\nIf any files are listed, this is a finding.",
        "fix": "At the command prompt, enter the following commands:\n\nNote: Replace <file_name> for the name of any files that were returned.\n\nunlink <file_name>\n\nRepeat the commands for each file that was listed."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "component": "vami",
        "gtitle": "SRG-APP-000141-WSR-000087",
        "gid": null,
        "rid": "VCLD-67-000023",
        "stig_id": "VCLD-67-000023",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCLD-67-000023\" do\n  title \"VAMI must not have any symbolic links in the web content directory\ntree.\"\n  desc  \"A web server is designed to deliver content and execute scripts or\napplications on the request of a client or user.  Containing user requests to\nfiles in the directory tree of the hosted web application and limiting the\nexecution of scripts and applications guarantees that the user is not accessing\ninformation protected outside the application's realm.\n\n    By checking that no symbolic links exist in the document root, the web\nserver is protected from users jumping outside the hosted application directory\ntree and gaining access to the other directories, including the system root.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag component: \"vami\"\n  tag gtitle: \"SRG-APP-000141-WSR-000087\"\n  tag gid: nil\n  tag rid: \"VCLD-67-000023\"\n  tag stig_id: \"VCLD-67-000023\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\nfind /opt/vmware/share/htdocs -type l\n\nIf any files are listed, this is a finding.\"\n  desc 'fix', \"At the command prompt, enter the following commands:\n\nNote: Replace <file_name> for the name of any files that were returned.\n\nunlink <file_name>\n\nRepeat the commands for each file that was listed.\"\n\n  describe command('find /opt/vmware/share/htdocs -type l') do\n      its ('stdout') { should eq '' }\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000023.rb",
        "line": 1
      },
      "id": "VCLD-67-000023"
    },
    {
      "title": "Rsyslog must be configured to monitor and ship vSphere Client log\nfiles.",
      "desc": "The vSphere Client produces a handful of logs that must be offloaded\nfrom the originating system. This information can then be used for diagnostic\npurposes, forensics purposes, or other purposes relevant to ensuring the\navailability and integrity of the hosted application.",
      "descriptions": {
        "default": "The vSphere Client produces a handful of logs that must be offloaded\nfrom the originating system. This information can then be used for diagnostic\npurposes, forensics purposes, or other purposes relevant to ensuring the\navailability and integrity of the hosted application.",
        "check": "At the command prompt, execute the following command:\n\n# grep -v \"^#\" /etc/vmware-syslog/stig-vsphere-client.conf\n\nExpected result:\n\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vsphere-client/logs/access/localhost_access*\"\n      Tag=\"client-access\"\n      Severity=\"info\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vsphere-client/logs/vsphere-client-runtime*\"\n      Tag=\"client-runtime\"\n      Severity=\"info\"\n      Facility=\"local0\")\n\nIf the file does not exist, this is a finding.\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open /etc/vmware-syslog/stig-vsphere-client.conf ,\ncreating the file if it does not exist.\n\nSet the contents of the file as follows:\n\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vsphere-client/logs/access/localhost_access*\"\n      Tag=\"client-access\"\n      Severity=\"info\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vsphere-client/logs/vsphere-client-runtime*\"\n      Tag=\"client-runtime\"\n      Severity=\"info\"\n      Facility=\"local0\")"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000358-WSR-000163",
        "gid": null,
        "rid": "VCFL-67-000027",
        "stig_id": "VCFL-67-000027",
        "cci": "CCI-001851",
        "nist": [
          "AU-4 (1)",
          "Rev_4"
        ]
      },
      "code": "control \"VCFL-67-000027\" do\n  title \"Rsyslog must be configured to monitor and ship vSphere Client log\nfiles.\"\n  desc  \"The vSphere Client produces a handful of logs that must be offloaded\nfrom the originating system. This information can then be used for diagnostic\npurposes, forensics purposes, or other purposes relevant to ensuring the\navailability and integrity of the hosted application.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000358-WSR-000163\"\n  tag gid: nil\n  tag rid: \"VCFL-67-000027\"\n  tag stig_id: \"VCFL-67-000027\"\n  tag cci: \"CCI-001851\"\n  tag nist: [\"AU-4 (1)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep -v \\\"^#\\\" /etc/vmware-syslog/stig-vsphere-client.conf\n\nExpected result:\n\ninput(type=\\\"imfile\\\"\n      File=\\\"/var/log/vmware/vsphere-client/logs/access/localhost_access*\\\"\n      Tag=\\\"client-access\\\"\n      Severity=\\\"info\\\"\n      Facility=\\\"local0\\\")\ninput(type=\\\"imfile\\\"\n      File=\\\"/var/log/vmware/vsphere-client/logs/vsphere-client-runtime*\\\"\n      Tag=\\\"client-runtime\\\"\n      Severity=\\\"info\\\"\n      Facility=\\\"local0\\\")\n\nIf the file does not exist, this is a finding.\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open /etc/vmware-syslog/stig-vsphere-client.conf ,\ncreating the file if it does not exist.\n\nSet the contents of the file as follows:\n\ninput(type=\\\"imfile\\\"\n      File=\\\"/var/log/vmware/vsphere-client/logs/access/localhost_access*\\\"\n      Tag=\\\"client-access\\\"\n      Severity=\\\"info\\\"\n      Facility=\\\"local0\\\")\ninput(type=\\\"imfile\\\"\n      File=\\\"/var/log/vmware/vsphere-client/logs/vsphere-client-runtime*\\\"\n      Tag=\\\"client-runtime\\\"\n      Severity=\\\"info\\\"\n      Facility=\\\"local0\\\")\"\n\n  describe file('/etc/vmware-syslog/stig-vsphere-client.conf') do\n    it { should exist }\n  end\n  describe command('grep -v \"^#\" /etc/vmware-syslog/stig-vsphere-client.conf') do\n    its ('stdout') { should match \"input(type=\\\"imfile\\\"\\n      File=\\\"/var/log/vmware/vsphere-client/logs/access/localhost_access*\\\"\\n      Tag=\\\"client-access\\\"\\n      Severity=\\\"info\\\"\\n      Facility=\\\"local0\\\")\\ninput(type=\\\"imfile\\\"\\n      File=\\\"/var/log/vmware/vsphere-client/logs/vsphere-client-runtime*\\\"\\n      Tag=\\\"client-runtime\\\"\\n      Severity=\\\"info\\\"\\n      Facility=\\\"local0\\\")\\n\" }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000027.rb",
        "line": 1
      },
      "id": "VCFL-67-000027"
    },
    {
      "title": "vSphere Client must limit the maximum size of a POST request.",
      "desc": "The 'maxPostSize' value is the maximum size in bytes of the POST which\nwill be handled by the container FORM URL parameter parsing. Limit its size to\nreduce exposure to a DOS attack. If 'maxPostSize' is not set, the default value\nof 2097152 (2MB) is used. Security Token Service is configured in it's shipping\nstate to not set a value for 'maxPostSize'.",
      "descriptions": {
        "default": "The 'maxPostSize' value is the maximum size in bytes of the POST which\nwill be handled by the container FORM URL parameter parsing. Limit its size to\nreduce exposure to a DOS attack. If 'maxPostSize' is not set, the default value\nof 2097152 (2MB) is used. Security Token Service is configured in it's shipping\nstate to not set a value for 'maxPostSize'.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector/@maxPostSize'\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nXPath set is empty\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nNavigate to each of the <Connector> nodes.\n\nRemove any configuration for 'maxPostSize'."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000001-WSR-000001",
        "gid": null,
        "rid": "VCFL-67-000003",
        "stig_id": "VCFL-67-000003",
        "cci": "CCI-000054",
        "nist": [
          "AC-10",
          "Rev_4"
        ]
      },
      "code": "control \"VCFL-67-000003\" do\n  title \"vSphere Client must limit the maximum size of a POST request.\"\n  desc  \"The 'maxPostSize' value is the maximum size in bytes of the POST which\nwill be handled by the container FORM URL parameter parsing. Limit its size to\nreduce exposure to a DOS attack. If 'maxPostSize' is not set, the default value\nof 2097152 (2MB) is used. Security Token Service is configured in it's shipping\nstate to not set a value for 'maxPostSize'.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000001-WSR-000001\"\n  tag gid: nil\n  tag rid: \"VCFL-67-000003\"\n  tag stig_id: \"VCFL-67-000003\"\n  tag cci: \"CCI-000054\"\n  tag nist: [\"AC-10\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector/@maxPostSize'\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nXPath set is empty\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nNavigate to each of the <Connector> nodes.\n\nRemove any configuration for 'maxPostSize'.\n\"\n\n  describe xml('/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml') do\n    its('Server/Service/Connector/attribute::maxPostSize') { should eq [] }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000003.rb",
        "line": 1
      },
      "id": "VCFL-67-000003"
    },
    {
      "title": "vSphere Client must set the welcome-file node to a default web page.",
      "desc": "Enumeration techniques, such as URL parameter manipulation, rely upon\nbeing able to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. By having a default hosted application web page, the anonymous web\nuser will not obtain directory browsing information or an error message that\nreveals the server type and version. Ensuring that every document directory has\nan index.jsp (or equivalent) file is one approach to mitigating the\nvulnerability.",
      "descriptions": {
        "default": "Enumeration techniques, such as URL parameter manipulation, rely upon\nbeing able to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. By having a default hosted application web page, the anonymous web\nuser will not obtain directory browsing information or an error message that\nreveals the server type and version. Ensuring that every document directory has\nan index.jsp (or equivalent) file is one approach to mitigating the\nvulnerability.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format\n/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml | sed\n's/xmlns=\".*\"//g' | xmllint --xpath '/web-app/welcome-file-list' -\n\nExpected result:\n\n<welcome-file-list>\n    <welcome-file>index.html</welcome-file>\n    <welcome-file>index.htm</welcome-file>\n    <welcome-file>index.jsp</welcome-file>\n  </welcome-file-list>\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml\n\nInspect the file and ensure that it contains the below section:\n\n<welcome-file-list>\n    <welcome-file>index.html</welcome-file>\n    <welcome-file>index.htm</welcome-file>\n    <welcome-file>index.jsp</welcome-file>\n  </welcome-file-list>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000266-WSR-000142",
        "gid": null,
        "rid": "VCFL-67-000022",
        "stig_id": "VCFL-67-000022",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCFL-67-000022\" do\n  title \"vSphere Client must set the welcome-file node to a default web page.\"\n  desc  \"Enumeration techniques, such as URL parameter manipulation, rely upon\nbeing able to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. By having a default hosted application web page, the anonymous web\nuser will not obtain directory browsing information or an error message that\nreveals the server type and version. Ensuring that every document directory has\nan index.jsp (or equivalent) file is one approach to mitigating the\nvulnerability.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000266-WSR-000142\"\n  tag gid: nil\n  tag rid: \"VCFL-67-000022\"\n  tag stig_id: \"VCFL-67-000022\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format\n/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml | sed\n's/xmlns=\\\".*\\\"//g' | xmllint --xpath '/web-app/welcome-file-list' -\n\nExpected result:\n\n<welcome-file-list>\n    <welcome-file>index.html</welcome-file>\n    <welcome-file>index.htm</welcome-file>\n    <welcome-file>index.jsp</welcome-file>\n  </welcome-file-list>\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml\n\nInspect the file and ensure that it contains the below section:\n\n<welcome-file-list>\n    <welcome-file>index.html</welcome-file>\n    <welcome-file>index.htm</welcome-file>\n    <welcome-file>index.jsp</welcome-file>\n  </welcome-file-list>\"\n\n  list = [\"index.html\", \"index.htm\", \"index.jsp\"]\n  describe xml('//usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml') do\n    its('/web-app/welcome-file-list/welcome-file') { should be_in list }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000022.rb",
        "line": 1
      },
      "id": "VCFL-67-000022"
    },
    {
      "title": "vSphere Client must ensure appropriate permissions are set on the\nkeystore.",
      "desc": "The web server's private key is used to prove the identity of the\nserver to clients and securely exchange the shared secret key used to encrypt\ncommunications between the web server and clients.By gaining access to the\nprivate key, an attacker can pretend to be an authorized server and decrypt the\nSSL traffic between a client and the web server.\n\n    vSphere Client pulls the machine certificate from the VECS keystore and\nstores it in keystore.jks so Tomcat can access it. The minimum permissions and\nownership on the keystore are set by default but must be verified.",
      "descriptions": {
        "default": "The web server's private key is used to prove the identity of the\nserver to clients and securely exchange the shared secret key used to encrypt\ncommunications between the web server and clients.By gaining access to the\nprivate key, an attacker can pretend to be an authorized server and decrypt the\nSSL traffic between a client and the web server.\n\n    vSphere Client pulls the machine certificate from the VECS keystore and\nstores it in keystore.jks so Tomcat can access it. The minimum permissions and\nownership on the keystore are set by default but must be verified.",
        "check": "At the command prompt, execute the following command:\n\n# stat -c \"%n permissions are %a and is owned by %U:%G\"\n/etc/vmware/vsphere-client/keystore.jks\n\nExpected result:\n\n/etc/vmware/vsphere-client/keystore.jks permissions are 640 and is owned by\nvsphere-client:users\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "At the command prompt, execute the following command:\n\n# chmod 640 /etc/vmware/vsphere-client/keystore.jks\n# chown vsphere-client:users /etc/vmware/vsphere-client/keystore.jks"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000176-WSR-000096",
        "gid": null,
        "rid": "VCFL-67-000018",
        "stig_id": "VCFL-67-000018",
        "cci": "CCI-000186",
        "nist": [
          "IA-5 (2) (b)",
          "Rev_4"
        ]
      },
      "code": "control \"VCFL-67-000018\" do\n  title \"vSphere Client must ensure appropriate permissions are set on the\nkeystore.\"\n  desc  \"The web server's private key is used to prove the identity of the\nserver to clients and securely exchange the shared secret key used to encrypt\ncommunications between the web server and clients.By gaining access to the\nprivate key, an attacker can pretend to be an authorized server and decrypt the\nSSL traffic between a client and the web server.\n\n    vSphere Client pulls the machine certificate from the VECS keystore and\nstores it in keystore.jks so Tomcat can access it. The minimum permissions and\nownership on the keystore are set by default but must be verified.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000176-WSR-000096\"\n  tag gid: nil\n  tag rid: \"VCFL-67-000018\"\n  tag stig_id: \"VCFL-67-000018\"\n  tag cci: \"CCI-000186\"\n  tag nist: [\"IA-5 (2) (b)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# stat -c \\\"%n permissions are %a and is owned by %U:%G\\\"\n/etc/vmware/vsphere-client/keystore.jks\n\nExpected result:\n\n/etc/vmware/vsphere-client/keystore.jks permissions are 640 and is owned by\nvsphere-client:users\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"At the command prompt, execute the following command:\n\n# chmod 640 /etc/vmware/vsphere-client/keystore.jks\n# chown vsphere-client:users /etc/vmware/vsphere-client/keystore.jks\"\n\n  describe file('/etc/vmware/vsphere-client/keystore.jks') do\n    its('mode') { should cmp '0640' }\n    its('owner') { should eq 'vsphere-client'}\n    its('group') { should eq 'users'}\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000018.rb",
        "line": 1
      },
      "id": "VCFL-67-000018"
    },
    {
      "title": "vSphere Client must be configured with FIPS 140-2 compliant ciphers\nfor HTTPS connections.",
      "desc": "Encryption of data-in-flight is an essential element of protecting\ninformation confidentiality. If a web server uses weak or outdated encryption\nalgorithms, then the server's communications can potentially be compromised.\n\n    The US Federal Information Processing Standards (FIPS) publication 140-2,\nSecurity Requirements for Cryptographic Modules (FIPS 140-2) approved ciphers\nprovide the maximum level of encryption possible for a private web server.\n\n    The Tomcat conenctor listening on 9443 comes pre-configured with\nappropriate FIPS ciphers by deault but this must be verified.",
      "descriptions": {
        "default": "Encryption of data-in-flight is an essential element of protecting\ninformation confidentiality. If a web server uses weak or outdated encryption\nalgorithms, then the server's communications can potentially be compromised.\n\n    The US Federal Information Processing Standards (FIPS) publication 140-2,\nSecurity Requirements for Cryptographic Modules (FIPS 140-2) approved ciphers\nprovide the maximum level of encryption possible for a private web server.\n\n    The Tomcat conenctor listening on 9443 comes pre-configured with\nappropriate FIPS ciphers by deault but this must be verified.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format --xpath\n'/Server/Service/Connector[@port=9443]/SSLHostConfig/@ciphers'\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nciphers=\"TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384,TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,TLS_RSA_WITH_AES_256_CBC_SHA256,TLS_ECDH_RSA_WITH_AES_256_CBC_SHA,TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA,TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,TLS_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDH_RSA_WITH_AES_128_CBC_SHA,TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA\"\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nMake sure that the SSLHostConfig contains the following value:\n\nciphers=\"TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384,TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,TLS_RSA_WITH_AES_256_CBC_SHA256,TLS_ECDH_RSA_WITH_AES_256_CBC_SHA,TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA,TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,TLS_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDH_RSA_WITH_AES_128_CBC_SHA,TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000014-WSR-000006",
        "gid": null,
        "rid": "VCFL-67-000005",
        "stig_id": "VCFL-67-000005",
        "cci": "CCI-000068",
        "nist": [
          "AC-17 (2)",
          "Rev_4"
        ]
      },
      "code": "control \"VCFL-67-000005\" do\n  title \"vSphere Client must be configured with FIPS 140-2 compliant ciphers\nfor HTTPS connections.\"\n  desc  \"Encryption of data-in-flight is an essential element of protecting\ninformation confidentiality. If a web server uses weak or outdated encryption\nalgorithms, then the server's communications can potentially be compromised.\n\n    The US Federal Information Processing Standards (FIPS) publication 140-2,\nSecurity Requirements for Cryptographic Modules (FIPS 140-2) approved ciphers\nprovide the maximum level of encryption possible for a private web server.\n\n    The Tomcat conenctor listening on 9443 comes pre-configured with\nappropriate FIPS ciphers by deault but this must be verified.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000014-WSR-000006\"\n  tag gid: nil\n  tag rid: \"VCFL-67-000005\"\n  tag stig_id: \"VCFL-67-000005\"\n  tag cci: \"CCI-000068\"\n  tag nist: [\"AC-17 (2)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format --xpath\n'/Server/Service/Connector[@port=9443]/SSLHostConfig/@ciphers'\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nciphers=\\\"TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384,TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,TLS_RSA_WITH_AES_256_CBC_SHA256,TLS_ECDH_RSA_WITH_AES_256_CBC_SHA,TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA,TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,TLS_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDH_RSA_WITH_AES_128_CBC_SHA,TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA\\\"\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nMake sure that the SSLHostConfig contains the following value:\n\nciphers=\\\"TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384,TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,TLS_RSA_WITH_AES_256_CBC_SHA256,TLS_ECDH_RSA_WITH_AES_256_CBC_SHA,TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA,TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,TLS_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDH_RSA_WITH_AES_128_CBC_SHA,TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA\\\"\"\n\n  describe xml('/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml') do\n    its('Server/Service/Connector/SSLHostConfig/attribute::ciphers') { should include 'TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384,TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,TLS_RSA_WITH_AES_256_CBC_SHA256,TLS_ECDH_RSA_WITH_AES_256_CBC_SHA,TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA,TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,TLS_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDH_RSA_WITH_AES_128_CBC_SHA,TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000005.rb",
        "line": 1
      },
      "id": "VCFL-67-000005"
    },
    {
      "title": "vSphere Client must must be configured with the appropriate ports.",
      "desc": "Web servers provide numerous processes, features, and functionalities\nthat utilize TCP/IP ports. Some of these processes may be deemed unnecessary or\ntoo unsecure to run on a production system. vSphere Client comes configured\nwith two connectors. One is behind the reverse proxy and listening on 9090 and\nthe other is serving SSL natively on 9443. The ports that vSphere Client\nlistens on must be veriified as accurate to their shipping state.",
      "descriptions": {
        "default": "Web servers provide numerous processes, features, and functionalities\nthat utilize TCP/IP ports. Some of these processes may be deemed unnecessary or\ntoo unsecure to run on a production system. vSphere Client comes configured\nwith two connectors. One is behind the reverse proxy and listening on 9090 and\nthe other is serving SSL natively on 9443. The ports that vSphere Client\nlistens on must be veriified as accurate to their shipping state.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector/@port'\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nport=\"9090\" port=\"9443\"\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\nin a text editor.\n\nOn the first <Connector>, with redirectPort=\"9443\", configure the port as\nfollows:\n\nport=\"9090\"\n\nOn the second <Connector>, with  SSLEnabled=\"true\", configure the port as\nfollows:\n\nport=\"9443\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000383-WSR-000175",
        "gid": null,
        "rid": "VCFL-67-000028",
        "stig_id": "VCFL-67-000028",
        "cci": "CCI-001762",
        "nist": [
          "CM-7 (1) (b)",
          "Rev_4"
        ]
      },
      "code": "control \"VCFL-67-000028\" do\n  title \"vSphere Client must must be configured with the appropriate ports.\"\n  desc  \"Web servers provide numerous processes, features, and functionalities\nthat utilize TCP/IP ports. Some of these processes may be deemed unnecessary or\ntoo unsecure to run on a production system. vSphere Client comes configured\nwith two connectors. One is behind the reverse proxy and listening on 9090 and\nthe other is serving SSL natively on 9443. The ports that vSphere Client\nlistens on must be veriified as accurate to their shipping state.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000383-WSR-000175\"\n  tag gid: nil\n  tag rid: \"VCFL-67-000028\"\n  tag stig_id: \"VCFL-67-000028\"\n  tag cci: \"CCI-001762\"\n  tag nist: [\"CM-7 (1) (b)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector/@port'\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nport=\\\"9090\\\" port=\\\"9443\\\"\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\nin a text editor.\n\nOn the first <Connector>, with redirectPort=\\\"9443\\\", configure the port as\nfollows:\n\nport=\\\"9090\\\"\n\nOn the second <Connector>, with  SSLEnabled=\\\"true\\\", configure the port as\nfollows:\n\nport=\\\"9443\\\"\"\n\n  describe xml('/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml') do\n    its(['Server/Service/Connector[@redirectPort=\"9443\"]/@port']) { should cmp '9090'}\n  end\n\n  describe xml('/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml') do\n    its(['Server/Service/Connector[@SSLEnabled=\"true\"]/@port']) { should cmp '9443'}\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000028.rb",
        "line": 1
      },
      "id": "VCFL-67-000028"
    },
    {
      "title": "vSphere Client must limit the number of allowed connections.",
      "desc": "Limiting the number of established connections to Sphere Client is a\nbasic DoS protection. Servers where the limit is too high or unlimited can\npotentially run out of system resources and negatively affect system\navailability.",
      "descriptions": {
        "default": "Limiting the number of established connections to Sphere Client is a\nbasic DoS protection. Servers where the limit is too high or unlimited can\npotentially run out of system resources and negatively affect system\navailability.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector/@acceptCount'\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nacceptCount=\"300\" acceptCount=\"300\"\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nConfigure each <Connector> node with the following:\n\nacceptCount=\"300\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000246-WSR-000149",
        "gid": null,
        "rid": "VCFL-67-000020",
        "stig_id": "VCFL-67-000020",
        "cci": "CCI-001094",
        "nist": [
          "SC-5 (1)",
          "Rev_4"
        ]
      },
      "code": "control \"VCFL-67-000020\" do\n  title \"vSphere Client must limit the number of allowed connections.\"\n  desc  \"Limiting the number of established connections to Sphere Client is a\nbasic DoS protection. Servers where the limit is too high or unlimited can\npotentially run out of system resources and negatively affect system\navailability.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000246-WSR-000149\"\n  tag gid: nil\n  tag rid: \"VCFL-67-000020\"\n  tag stig_id: \"VCFL-67-000020\"\n  tag cci: \"CCI-001094\"\n  tag nist: [\"SC-5 (1)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector/@acceptCount'\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nacceptCount=\\\"300\\\" acceptCount=\\\"300\\\"\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nConfigure each <Connector> node with the following:\n\nacceptCount=\\\"300\\\"\"\n\n  describe xml('/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml') do\n    its(['Server/Service/Connector/@acceptCount']) { should be_in [\"300\"]}\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000020.rb",
        "line": 1
      },
      "id": "VCFL-67-000020"
    },
    {
      "title": "vSphere Client  must protect cookies from XSS.",
      "desc": "Cookies are a common way to save session state over the HTTP(S)\nprotocol. If an attacker can compromise session data stored in a cookie, they\nare better able to launch an attack against the server and its applications.\nWhen you tag a cookie with the HttpOnly flag, it tells the browser that this\nparticular cookie should only be accessed by the originating server. Any\nattempt to access the cookie from client script is strictly forbidden.",
      "descriptions": {
        "default": "Cookies are a common way to save session state over the HTTP(S)\nprotocol. If an attacker can compromise session data stored in a cookie, they\nare better able to launch an attack against the server and its applications.\nWhen you tag a cookie with the HttpOnly flag, it tells the browser that this\nparticular cookie should only be accessed by the originating server. Any\nattempt to access the cookie from client script is strictly forbidden.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --xpath '/Context/@useHttpOnly'\n/usr/lib/vmware-vsphere-client/server/configuration/context.xml\n\nExpected result:\n\nuseHttpOnly=\"true\"\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/context.xml\n\nConfigure the <Context> node as follows:\n\n<Context useHttpOnly=\"true\">"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000001-WSR-000002",
        "gid": null,
        "rid": "VCFL-67-000004",
        "stig_id": "VCFL-67-000004",
        "cci": "CCI-000054",
        "nist": [
          "AC-10",
          "Rev_4"
        ]
      },
      "code": "control \"VCFL-67-000004\" do\n  title \"vSphere Client  must protect cookies from XSS.\"\n  desc  \"Cookies are a common way to save session state over the HTTP(S)\nprotocol. If an attacker can compromise session data stored in a cookie, they\nare better able to launch an attack against the server and its applications.\nWhen you tag a cookie with the HttpOnly flag, it tells the browser that this\nparticular cookie should only be accessed by the originating server. Any\nattempt to access the cookie from client script is strictly forbidden.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000001-WSR-000002\"\n  tag gid: nil\n  tag rid: \"VCFL-67-000004\"\n  tag stig_id: \"VCFL-67-000004\"\n  tag cci: \"CCI-000054\"\n  tag nist: [\"AC-10\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --xpath '/Context/@useHttpOnly'\n/usr/lib/vmware-vsphere-client/server/configuration/context.xml\n\nExpected result:\n\nuseHttpOnly=\\\"true\\\"\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/context.xml\n\nConfigure the <Context> node as follows:\n\n<Context useHttpOnly=\\\"true\\\">\"\n\n  describe xml('/usr/lib/vmware-vsphere-client/server/configuration/context.xml') do\n    its(['Context/attribute::useHttpOnly']) { should eq ['true'] }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000004.rb",
        "line": 1
      },
      "id": "VCFL-67-000004"
    },
    {
      "title": "vSphere Client must disable the shutdown port.",
      "desc": "An attacker has at least two reasons to stop a web server. The first\nis to cause a DoS, and the second is to put in place changes the attacker made\nto the web server configuration. If the Tomcat shutdown port feature is\nenabled, a shutdown signal can be sent to vSphere Client through this port. To\nensure availability, the shutdown port must be disabled.",
      "descriptions": {
        "default": "An attacker has at least two reasons to stop a web server. The first\nis to cause a DoS, and the second is to put in place changes the attacker made\nto the web server configuration. If the Tomcat shutdown port feature is\nenabled, a shutdown signal can be sent to vSphere Client through this port. To\nensure availability, the shutdown port must be disabled.",
        "check": "# xmllint --format --xpath '/Server/@port'\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nport=\"-1\"\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\nin a text editor.\n\nMake sure that the server port is disabled as follows:\n\n<Server port=\"-1\">"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000435-WSR-000147",
        "gid": null,
        "rid": "VCFL-67-000029",
        "stig_id": "VCFL-67-000029",
        "cci": "CCI-002385",
        "nist": [
          "SC-5",
          "Rev_4"
        ]
      },
      "code": "control \"VCFL-67-000029\" do\n  title \"vSphere Client must disable the shutdown port.\"\n  desc  \"An attacker has at least two reasons to stop a web server. The first\nis to cause a DoS, and the second is to put in place changes the attacker made\nto the web server configuration. If the Tomcat shutdown port feature is\nenabled, a shutdown signal can be sent to vSphere Client through this port. To\nensure availability, the shutdown port must be disabled.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000435-WSR-000147\"\n  tag gid: nil\n  tag rid: \"VCFL-67-000029\"\n  tag stig_id: \"VCFL-67-000029\"\n  tag cci: \"CCI-002385\"\n  tag nist: [\"SC-5\", \"Rev_4\"]\n  desc 'check', \"# xmllint --format --xpath '/Server/@port'\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nport=\\\"-1\\\"\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\nin a text editor.\n\nMake sure that the server port is disabled as follows:\n\n<Server port=\\\"-1\\\">\"\n\n  describe xml('/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml') do\n    its('Server/attribute::port') { should cmp '-1' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000029.rb",
        "line": 1
      },
      "id": "VCFL-67-000029"
    },
    {
      "title": "vSphere Client must be configured to show error pages with minimal\ninformation.",
      "desc": "Web servers will often display error messages to client users\ndisplaying enough information to aid in the debugging of the error. The\ninformation given back in error messages may display the web server type,\nversion, patches installed, plug-ins and modules installed, type of code being\nused by the hosted application, and any backends being used for data storage.\nThis information could be used by an attacker to blueprint what type of attacks\nmight be successful. As such, vSphere Client must be configured to not show\nserver version information in error messages.",
      "descriptions": {
        "default": "Web servers will often display error messages to client users\ndisplaying enough information to aid in the debugging of the error. The\ninformation given back in error messages may display the web server type,\nversion, patches installed, plug-ins and modules installed, type of code being\nused by the hosted application, and any backends being used for data storage.\nThis information could be used by an attacker to blueprint what type of attacks\nmight be successful. As such, vSphere Client must be configured to not show\nserver version information in error messages.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector/@server'\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nserver=\"Anonymous\" server=\"Anonymous\"\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nConfigure each <Connector> node with the following:\n\nserver=\"Anonymous\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000266-WSR-000159",
        "gid": null,
        "rid": "VCFL-67-000024",
        "stig_id": "VCFL-67-000024",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCFL-67-000024\" do\n  title \"vSphere Client must be configured to show error pages with minimal\ninformation.\"\n  desc  \"Web servers will often display error messages to client users\ndisplaying enough information to aid in the debugging of the error. The\ninformation given back in error messages may display the web server type,\nversion, patches installed, plug-ins and modules installed, type of code being\nused by the hosted application, and any backends being used for data storage.\nThis information could be used by an attacker to blueprint what type of attacks\nmight be successful. As such, vSphere Client must be configured to not show\nserver version information in error messages.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000266-WSR-000159\"\n  tag gid: nil\n  tag rid: \"VCFL-67-000024\"\n  tag stig_id: \"VCFL-67-000024\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector/@server'\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nserver=\\\"Anonymous\\\" server=\\\"Anonymous\\\"\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nConfigure each <Connector> node with the following:\n\nserver=\\\"Anonymous\\\"\"\n\n  begin\n    vcui_conf = xml('/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml')\n\n      if vcui_conf['Server/Service/Connector/attribute::server'].is_a?(Array)\n        vcui_conf['Server/Service/Connector/attribute::server'].each do |x|\n          describe x do\n            it { should eq \"Anonymous\" }\n          end\n        end\n      else\n        describe xml(vcui_conf['Server/Service/Connector/attribute::server']) do\n          it { should eq \"Anonymous\" }\n        end\n      end\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000024.rb",
        "line": 1
      },
      "id": "VCFL-67-000024"
    },
    {
      "title": "vSphere Client must not enable support for TRACE requests.",
      "desc": "\"Trace\" is a technique for a user to request internal information\nabout Tomcat. This is useful during product development, but should not be\nenabled in production.  Allowing a attacker to conduct a Trace operation\nagainst the Security Token Service will expose information that would be useful\nto perform a more targeted attack. vSphere Client provides the allowTrace\nparameter as means to disable responding to Trace requests.",
      "descriptions": {
        "default": "\"Trace\" is a technique for a user to request internal information\nabout Tomcat. This is useful during product development, but should not be\nenabled in production.  Allowing a attacker to conduct a Trace operation\nagainst the Security Token Service will expose information that would be useful\nto perform a more targeted attack. vSphere Client provides the allowTrace\nparameter as means to disable responding to Trace requests.",
        "check": "At the command prompt, execute the following command:\n\n# grep allowTrace\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nIf allowTrace is set to \"true\", this is a finding. If no line is returned\nthis is NOT a finding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nNavigate to and locate 'allowTrace=\"true\"'\n\nRemove the 'allowTrace=\"true\"' setting."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000266-WSR-000160",
        "gid": null,
        "rid": "VCFL-67-000025",
        "stig_id": "VCFL-67-000025",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCFL-67-000025\" do\n  title \"vSphere Client must not enable support for TRACE requests.\"\n  desc  \"\\\"Trace\\\" is a technique for a user to request internal information\nabout Tomcat. This is useful during product development, but should not be\nenabled in production.  Allowing a attacker to conduct a Trace operation\nagainst the Security Token Service will expose information that would be useful\nto perform a more targeted attack. vSphere Client provides the allowTrace\nparameter as means to disable responding to Trace requests.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000266-WSR-000160\"\n  tag gid: nil\n  tag rid: \"VCFL-67-000025\"\n  tag stig_id: \"VCFL-67-000025\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep allowTrace\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nIf allowTrace is set to \\\"true\\\", this is a finding. If no line is returned\nthis is NOT a finding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nNavigate to and locate 'allowTrace=\\\"true\\\"'\n\nRemove the 'allowTrace=\\\"true\\\"' setting.\"\n\n  describe.one do\n    describe xml('/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml') do\n      its(['Server/Service/Connector/attribute::allowTrace']) { should eq [] }\n    end\n\n    describe xml('/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml') do\n      its(['Server/Service/Connector/attribute::allowTrace']) { should cmp \"false\" }\n    end\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000025.rb",
        "line": 1
      },
      "id": "VCFL-67-000025"
    },
    {
      "title": "vSphere Client must be configured to enable SSL/TLS.",
      "desc": "Data exchanged between the user and the web server can range from\nstatic display data to credentials used to log into the hosted application.\nEven when data appears to be static, the non-displayed logic in a web page may\nexpose business logic or trusted system relationships. The integrity of all the\ndata being exchanged between the user and web server must always be trusted. To\nprotect the integrity and trust, encryption methods should be used to protect\nthe complete communication session.\n\n    HTTP connections in Virgo are managed through the Connector object. The\nvSphere Client endpoint has two connectors. One is behind a reverse proxy which\nterminates TLS and the other is serving SSL/TLS natively on 9443. We will be\naddressing the first in a separate STIG while this control addresses ensuring\nSSL/TLS is enabled on the 9443 connector.",
      "descriptions": {
        "default": "Data exchanged between the user and the web server can range from\nstatic display data to credentials used to log into the hosted application.\nEven when data appears to be static, the non-displayed logic in a web page may\nexpose business logic or trusted system relationships. The integrity of all the\ndata being exchanged between the user and web server must always be trusted. To\nprotect the integrity and trust, encryption methods should be used to protect\nthe complete communication session.\n\n    HTTP connections in Virgo are managed through the Connector object. The\nvSphere Client endpoint has two connectors. One is behind a reverse proxy which\nterminates TLS and the other is serving SSL/TLS natively on 9443. We will be\naddressing the first in a separate STIG while this control addresses ensuring\nSSL/TLS is enabled on the 9443 connector.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector[@port=9443]/@SSLEnabled'\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nSSLEnabled=\"true\"\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nMake sure that the <Connector> node with 'port=9443' contains the following\nvalue:\n\nSSLEnabled=\"true\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000015-WSR-000014",
        "gid": null,
        "rid": "VCFL-67-000006",
        "stig_id": "VCFL-67-000006",
        "cci": "CCI-001453",
        "nist": [
          "AC-17 (2)",
          "Rev_4"
        ]
      },
      "code": "control \"VCFL-67-000006\" do\n  title \"vSphere Client must be configured to enable SSL/TLS.\"\n  desc  \"Data exchanged between the user and the web server can range from\nstatic display data to credentials used to log into the hosted application.\nEven when data appears to be static, the non-displayed logic in a web page may\nexpose business logic or trusted system relationships. The integrity of all the\ndata being exchanged between the user and web server must always be trusted. To\nprotect the integrity and trust, encryption methods should be used to protect\nthe complete communication session.\n\n    HTTP connections in Virgo are managed through the Connector object. The\nvSphere Client endpoint has two connectors. One is behind a reverse proxy which\nterminates TLS and the other is serving SSL/TLS natively on 9443. We will be\naddressing the first in a separate STIG while this control addresses ensuring\nSSL/TLS is enabled on the 9443 connector.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000015-WSR-000014\"\n  tag gid: nil\n  tag rid: \"VCFL-67-000006\"\n  tag stig_id: \"VCFL-67-000006\"\n  tag cci: \"CCI-001453\"\n  tag nist: [\"AC-17 (2)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector[@port=9443]/@SSLEnabled'\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nSSLEnabled=\\\"true\\\"\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nMake sure that the <Connector> node with 'port=9443' contains the following\nvalue:\n\nSSLEnabled=\\\"true\\\"\n\"\n\n  describe xml('/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml') do\n    its(['Server/Service/Connector[@port=\"9443\"]/@SSLEnabled']) { should cmp 'true'}\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000006.rb",
        "line": 1
      },
      "id": "VCFL-67-000006"
    },
    {
      "title": "vSphere Client must record user access in a format that enables\nmonitoring of remote access.",
      "desc": "Remote access can be exploited by an attacker to compromise the\nserver.  By recording all remote access activities, it will be possible to\ndetermine the attacker's location, intent, and degree of success.\n\n    Virgo can be configured with an AccessLogValve, a component that can be\ninserted into the request processing pipeline to provide robust access logging.\nThe Access Log Valve creates log files in the same format as those created by\nstandard web servers. When AccessLogValve is properly configured, log files\nwill contain all the forensic information necessary in the case of a security\nincident.",
      "descriptions": {
        "default": "Remote access can be exploited by an attacker to compromise the\nserver.  By recording all remote access activities, it will be possible to\ndetermine the attacker's location, intent, and degree of success.\n\n    Virgo can be configured with an AccessLogValve, a component that can be\ninserted into the request processing pipeline to provide robust access logging.\nThe Access Log Valve creates log files in the same format as those created by\nstandard web servers. When AccessLogValve is properly configured, log files\nwill contain all the forensic information necessary in the case of a security\nincident.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml | sed '2\ns/xmlns=\".*\"//g' |  xmllint --xpath\n'/Server/Service/Engine/Host/Valve[@className=\"org.apache.catalina.valves.AccessLogValve\"]'/@pattern\n-\n\nExpected result:\n\npattern=\"%h %{x-forwarded-for}i %l %u %t &quot;%r&quot; %s %b\n%{#hashedSessionId#}s %I %D\"\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nEnsure the log pattern in log pattern in the\n\"org.apache.catalina.valves.AccessLogValve\" node is set to the following:\n\npattern=\"%h %{x-forwarded-for}i %l %u %t &quot;%r&quot; %s %b\n%{#hashedSessionId#}s %I %D\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000016-WSR-000005",
        "gid": null,
        "rid": "VCFL-67-000009",
        "stig_id": "VCFL-67-000009",
        "cci": "CCI-000067",
        "nist": [
          "AC-17 (1)",
          "Rev_4"
        ]
      },
      "code": "control \"VCFL-67-000009\" do\n  title \"vSphere Client must record user access in a format that enables\nmonitoring of remote access.\"\n  desc  \"Remote access can be exploited by an attacker to compromise the\nserver.  By recording all remote access activities, it will be possible to\ndetermine the attacker's location, intent, and degree of success.\n\n    Virgo can be configured with an AccessLogValve, a component that can be\ninserted into the request processing pipeline to provide robust access logging.\nThe Access Log Valve creates log files in the same format as those created by\nstandard web servers. When AccessLogValve is properly configured, log files\nwill contain all the forensic information necessary in the case of a security\nincident.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000016-WSR-000005\"\n  tag gid: nil\n  tag rid: \"VCFL-67-000009\"\n  tag stig_id: \"VCFL-67-000009\"\n  tag cci: \"CCI-000067\"\n  tag nist: [\"AC-17 (1)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml | sed '2\ns/xmlns=\\\".*\\\"//g' |  xmllint --xpath\n'/Server/Service/Engine/Host/Valve[@className=\\\"org.apache.catalina.valves.AccessLogValve\\\"]'/@pattern\n-\n\nExpected result:\n\npattern=\\\"%h %{x-forwarded-for}i %l %u %t &quot;%r&quot; %s %b\n%{#hashedSessionId#}s %I %D\\\"\n\nIf the output does not match the expected result, this is a finding.\n\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nEnsure the log pattern in log pattern in the\n\\\"org.apache.catalina.valves.AccessLogValve\\\" node is set to the following:\n\npattern=\\\"%h %{x-forwarded-for}i %l %u %t &quot;%r&quot; %s %b\n%{#hashedSessionId#}s %I %D\\\"\"\n\n  describe xml('/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml') do\n    its(['Server/Service/Engine/Host/Valve[@className=\"org.apache.catalina.valves.AccessLogValve\"]/@pattern']) { should cmp ['%h %{x-forwarded-for}i %l %u %t &quot;%r&quot; %s %b %{#hashedSessionId#}s %I %D'] }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000009.rb",
        "line": 1
      },
      "id": "VCFL-67-000009"
    },
    {
      "title": "vSphere Client must have the debug option turned off.",
      "desc": "Information needed by an attacker to begin looking for possible\nvulnerabilities in a web server includes any information about the web server\nand plug-ins or modules being used. When debugging or trace information is\nenabled in a production web server, information about the web server, such as\nweb server type, version, patches installed, plug-ins and modules installed,\ntype of code being used by the hosted application, and any backends being used\nfor data storage may be displayed. Since this information may be placed in logs\nand general messages during normal operation of the web server, an attacker\ndoes not need to cause an error condition to gain this information.\n\n    vSphere Client can be configured to set the debugging level.  By setting\nthe debugging level to zero (0), no debugging information will be provided to a\nmalicious user.",
      "descriptions": {
        "default": "Information needed by an attacker to begin looking for possible\nvulnerabilities in a web server includes any information about the web server\nand plug-ins or modules being used. When debugging or trace information is\nenabled in a production web server, information about the web server, such as\nweb server type, version, patches installed, plug-ins and modules installed,\ntype of code being used by the hosted application, and any backends being used\nfor data storage may be displayed. Since this information may be placed in logs\nand general messages during normal operation of the web server, an attacker\ndoes not need to cause an error condition to gain this information.\n\n    vSphere Client can be configured to set the debugging level.  By setting\nthe debugging level to zero (0), no debugging information will be provided to a\nmalicious user.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format\n/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml | sed\n's/xmlns=\".*\"//g' | xmllint --xpath\n'//param-name[text()=\"debug\"]/parent::init-param' -\n\nExpected result:\n\n<init-param>\n      <param-name>debug</param-name>\n      <param-value>0</param-value>\n    </init-param>\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml\n\nNavigate to all <debug> nodes that are not set to \"0\".\n\nSet the <param-value> to \"0\" in all <param-name>debug</param-name> nodes.\n\nNote: The debug setting should look like the below:\n\n<init-param>\n      <param-name>debug</param-name>\n      <param-value>0</param-value>\n    </init-param>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000266-WSR-000160",
        "gid": null,
        "rid": "VCFL-67-000026",
        "stig_id": "VCFL-67-000026",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCFL-67-000026\" do\n  title \"vSphere Client must have the debug option turned off.\"\n  desc  \"Information needed by an attacker to begin looking for possible\nvulnerabilities in a web server includes any information about the web server\nand plug-ins or modules being used. When debugging or trace information is\nenabled in a production web server, information about the web server, such as\nweb server type, version, patches installed, plug-ins and modules installed,\ntype of code being used by the hosted application, and any backends being used\nfor data storage may be displayed. Since this information may be placed in logs\nand general messages during normal operation of the web server, an attacker\ndoes not need to cause an error condition to gain this information.\n\n    vSphere Client can be configured to set the debugging level.  By setting\nthe debugging level to zero (0), no debugging information will be provided to a\nmalicious user.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000266-WSR-000160\"\n  tag gid: nil\n  tag rid: \"VCFL-67-000026\"\n  tag stig_id: \"VCFL-67-000026\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format\n/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml | sed\n's/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'//param-name[text()=\\\"debug\\\"]/parent::init-param' -\n\nExpected result:\n\n<init-param>\n      <param-name>debug</param-name>\n      <param-value>0</param-value>\n    </init-param>\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml\n\nNavigate to all <debug> nodes that are not set to \\\"0\\\".\n\nSet the <param-value> to \\\"0\\\" in all <param-name>debug</param-name> nodes.\n\nNote: The debug setting should look like the below:\n\n<init-param>\n      <param-name>debug</param-name>\n      <param-value>0</param-value>\n    </init-param>\"\n\n  describe.one do\n\n    describe xml('/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml') do\n      its('/web-app/servlet/init-param[param-name=\"debug\"]/param-value') { should eq [] }\n    end\n\n    describe xml('/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml') do\n      its('/web-app/servlet/init-param[param-name=\"debug\"]/param-value') { should cmp \"0\" }\n    end\n\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000026.rb",
        "line": 1
      },
      "id": "VCFL-67-000026"
    },
    {
      "title": "vSphere Client must set URIEncoding to UTF-8.",
      "desc": "Invalid user input occurs when a user inserts data or characters into\na hosted application's data entry field and the hosted application is\nunprepared to process that data. This results in unanticipated application\nbehavior, potentially leading to an application compromise. Invalid user input\nis one of the primary methods employed when attempting to compromise an\napplication.\n\n    An attacker can also enter Unicode characters into hosted applications in\nan effort to break out of the document home or root home directory or to bypass\nsecurity checks. vSphere Client must be configured to use a consistent\ncharacter set via the URIEncoding attribute on the Connector nodes.",
      "descriptions": {
        "default": "Invalid user input occurs when a user inserts data or characters into\na hosted application's data entry field and the hosted application is\nunprepared to process that data. This results in unanticipated application\nbehavior, potentially leading to an application compromise. Invalid user input\nis one of the primary methods employed when attempting to compromise an\napplication.\n\n    An attacker can also enter Unicode characters into hosted applications in\nan effort to break out of the document home or root home directory or to bypass\nsecurity checks. vSphere Client must be configured to use a consistent\ncharacter set via the URIEncoding attribute on the Connector nodes.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector/@URIEncoding'\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nURIEncoding=\"UTF-8\" URIEncoding=\"UTF-8\"r\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nConfigure each <Connector> node with the following:\n\nURIEncoding=\"UTF-8\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000251-WSR-000157",
        "gid": null,
        "rid": "VCFL-67-000021",
        "stig_id": "VCFL-67-000021",
        "cci": "CCI-001310",
        "nist": [
          "SI-10",
          "Rev_4"
        ]
      },
      "code": "control \"VCFL-67-000021\" do\n  title \"vSphere Client must set URIEncoding to UTF-8.\"\n  desc  \"Invalid user input occurs when a user inserts data or characters into\na hosted application's data entry field and the hosted application is\nunprepared to process that data. This results in unanticipated application\nbehavior, potentially leading to an application compromise. Invalid user input\nis one of the primary methods employed when attempting to compromise an\napplication.\n\n    An attacker can also enter Unicode characters into hosted applications in\nan effort to break out of the document home or root home directory or to bypass\nsecurity checks. vSphere Client must be configured to use a consistent\ncharacter set via the URIEncoding attribute on the Connector nodes.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000251-WSR-000157\"\n  tag gid: nil\n  tag rid: \"VCFL-67-000021\"\n  tag stig_id: \"VCFL-67-000021\"\n  tag cci: \"CCI-001310\"\n  tag nist: [\"SI-10\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector/@URIEncoding'\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nURIEncoding=\\\"UTF-8\\\" URIEncoding=\\\"UTF-8\\\"r\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nConfigure each <Connector> node with the following:\n\nURIEncoding=\\\"UTF-8\\\"\"\n\n  begin\n    vcui_conf = xml('/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml')\n\n      if vcui_conf['Server/Service/Connector/attribute::URIEncoding'].is_a?(Array)\n        vcui_conf['Server/Service/Connector/attribute::URIEncoding'].each do |x|\n          describe x do\n            it { should eq \"UTF-8\" }\n          end\n        end\n      else\n        describe xml(vcui_conf['Server/Service/Connector/attribute::URIEncoding']) do\n          it { should eq \"UTF-8\" }\n        end\n      end\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000021.rb",
        "line": 1
      },
      "id": "VCFL-67-000021"
    },
    {
      "title": "vSphere Client must be configured to only communicate over TLS 1.2.",
      "desc": "Data exchanged between the user and the web server can range from\nstatic display data to credentials used to log into the hosted application.\nEven when data appears to be static, the non-displayed logic in a web page may\nexpose business logic or trusted system relationships. The integrity of all the\ndata being exchanged between the user and web server must always be trusted. To\nprotect the integrity and trust, encryption methods should be used to protect\nthe complete communication session.\n\n    HTTP connections in Virgo are managed through the Connector object. The\nvSphere Client endpoint has two Connectors. One is behind a reverse proxy which\nterminates TLS and the other is serving TLS natively on 9443. We will be\naddressing the first in a separate STIG while this control addresses ensuring\nTLS is enabled on the 9443 Connector.",
      "descriptions": {
        "default": "Data exchanged between the user and the web server can range from\nstatic display data to credentials used to log into the hosted application.\nEven when data appears to be static, the non-displayed logic in a web page may\nexpose business logic or trusted system relationships. The integrity of all the\ndata being exchanged between the user and web server must always be trusted. To\nprotect the integrity and trust, encryption methods should be used to protect\nthe complete communication session.\n\n    HTTP connections in Virgo are managed through the Connector object. The\nvSphere Client endpoint has two Connectors. One is behind a reverse proxy which\nterminates TLS and the other is serving TLS natively on 9443. We will be\naddressing the first in a separate STIG while this control addresses ensuring\nTLS is enabled on the 9443 Connector.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format --xpath\n'/Server/Service/Connector[@port=9443]/SSLHostConfig/@protocols'\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nprotocols=\"TLSv1.2\"\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nMake sure that the <SSLHostConfig> node contains the following value:\n\nprotocols=\"TLSv1.2\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000015-WSR-000014",
        "gid": null,
        "rid": "VCFL-67-000007",
        "stig_id": "VCFL-67-000007",
        "cci": "CCI-001453",
        "nist": [
          "AC-17 (2)",
          "Rev_4"
        ]
      },
      "code": "control \"VCFL-67-000007\" do\n  title \"vSphere Client must be configured to only communicate over TLS 1.2.\"\n  desc  \"Data exchanged between the user and the web server can range from\nstatic display data to credentials used to log into the hosted application.\nEven when data appears to be static, the non-displayed logic in a web page may\nexpose business logic or trusted system relationships. The integrity of all the\ndata being exchanged between the user and web server must always be trusted. To\nprotect the integrity and trust, encryption methods should be used to protect\nthe complete communication session.\n\n    HTTP connections in Virgo are managed through the Connector object. The\nvSphere Client endpoint has two Connectors. One is behind a reverse proxy which\nterminates TLS and the other is serving TLS natively on 9443. We will be\naddressing the first in a separate STIG while this control addresses ensuring\nTLS is enabled on the 9443 Connector.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000015-WSR-000014\"\n  tag gid: nil\n  tag rid: \"VCFL-67-000007\"\n  tag stig_id: \"VCFL-67-000007\"\n  tag cci: \"CCI-001453\"\n  tag nist: [\"AC-17 (2)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format --xpath\n'/Server/Service/Connector[@port=9443]/SSLHostConfig/@protocols'\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nprotocols=\\\"TLSv1.2\\\"\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nMake sure that the <SSLHostConfig> node contains the following value:\n\nprotocols=\\\"TLSv1.2\\\"\n\"\n\n  describe xml('/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml') do\n    its(['Server/Service/Connector/SSLHostConfig/@protocols']) { should cmp 'TLSv1.2'}\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000007.rb",
        "line": 1
      },
      "id": "VCFL-67-000007"
    },
    {
      "title": "vSphere Client must be configured to utilize the HTTPS scheme.",
      "desc": "Data exchanged between the user and the web server can range from\nstatic display data to credentials used to log into the hosted application.\nEven when data appears to be static, the non-displayed logic in a web page may\nexpose business logic or trusted system relationships. The integrity of all the\ndata being exchanged between the user and web server must always be trusted. To\nprotect the integrity and trust, encryption methods should be used to protect\nthe complete communication session.\n\n    HTTP connections in Virgo are managed through the Connector object. The\nvSphere Client endpoint has two Connectors. One is behind a reverse proxy which\nterminates TLS and the other is serving TLS natively on 9443. We will be\naddressing the first in a separate STIG while this control addresses ensuring\nthe HTTPS scheme is enabled on the 9443 Connector.",
      "descriptions": {
        "default": "Data exchanged between the user and the web server can range from\nstatic display data to credentials used to log into the hosted application.\nEven when data appears to be static, the non-displayed logic in a web page may\nexpose business logic or trusted system relationships. The integrity of all the\ndata being exchanged between the user and web server must always be trusted. To\nprotect the integrity and trust, encryption methods should be used to protect\nthe complete communication session.\n\n    HTTP connections in Virgo are managed through the Connector object. The\nvSphere Client endpoint has two Connectors. One is behind a reverse proxy which\nterminates TLS and the other is serving TLS natively on 9443. We will be\naddressing the first in a separate STIG while this control addresses ensuring\nthe HTTPS scheme is enabled on the 9443 Connector.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector[@port=9443]/@scheme'\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nscheme=\"https\"\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nMake sure that the <Connector> node with 'port=9443' contains the following\nvalue:\n\nscheme=\"https\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000015-WSR-000014",
        "gid": null,
        "rid": "VCFL-67-000008",
        "stig_id": "VCFL-67-000008",
        "cci": "CCI-001453",
        "nist": [
          "AC-17 (2)",
          "Rev_4"
        ]
      },
      "code": "control \"VCFL-67-000008\" do\n  title \"vSphere Client must be configured to utilize the HTTPS scheme.\"\n  desc  \"Data exchanged between the user and the web server can range from\nstatic display data to credentials used to log into the hosted application.\nEven when data appears to be static, the non-displayed logic in a web page may\nexpose business logic or trusted system relationships. The integrity of all the\ndata being exchanged between the user and web server must always be trusted. To\nprotect the integrity and trust, encryption methods should be used to protect\nthe complete communication session.\n\n    HTTP connections in Virgo are managed through the Connector object. The\nvSphere Client endpoint has two Connectors. One is behind a reverse proxy which\nterminates TLS and the other is serving TLS natively on 9443. We will be\naddressing the first in a separate STIG while this control addresses ensuring\nthe HTTPS scheme is enabled on the 9443 Connector.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000015-WSR-000014\"\n  tag gid: nil\n  tag rid: \"VCFL-67-000008\"\n  tag stig_id: \"VCFL-67-000008\"\n  tag cci: \"CCI-001453\"\n  tag nist: [\"AC-17 (2)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector[@port=9443]/@scheme'\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nscheme=\\\"https\\\"\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nMake sure that the <Connector> node with 'port=9443' contains the following\nvalue:\n\nscheme=\\\"https\\\"\"\n\n  describe xml('/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml') do\n    its(['Server/Service/Connector[@port=\"9443\"]/@scheme']) { should cmp 'https'}\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000008.rb",
        "line": 1
      },
      "id": "VCFL-67-000008"
    },
    {
      "title": "vSphere Client must limit the number of concurrent connections\npermitted.",
      "desc": "Resource exhaustion can occur when an unlimited number of concurrent\nrequests are allowed on a web site, facilitating a denial of service attack.\nUnless the number of requests is controlled, the web server can consume enough\nsystem resources to cause a system crash.\n\n    Mitigating this kind of attack will include limiting the number of\nconcurrent HTTP/HTTPS requests. In Virgo, each incoming request requires a\nthread for the duration of that request. If more simultaneous requests are\nreceived than can be handled by the currently available request processing\nthreads, additional threads will be created up to the value of the maxThreads\nattribute.",
      "descriptions": {
        "default": "Resource exhaustion can occur when an unlimited number of concurrent\nrequests are allowed on a web site, facilitating a denial of service attack.\nUnless the number of requests is controlled, the web server can consume enough\nsystem resources to cause a system crash.\n\n    Mitigating this kind of attack will include limiting the number of\nconcurrent HTTP/HTTPS requests. In Virgo, each incoming request requires a\nthread for the duration of that request. If more simultaneous requests are\nreceived than can be handled by the currently available request processing\nthreads, additional threads will be created up to the value of the maxThreads\nattribute.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector/@maxThreads'\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nmaxThreads=\"800\" maxThreads=\"800\"\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nConfigure each <Connector> node with the following:\n\nmaxThreads=\"800\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000001-WSR-000001",
        "gid": null,
        "rid": "VCFL-67-000002",
        "stig_id": "VCFL-67-000002",
        "cci": "CCI-000054",
        "nist": [
          "AC-10",
          "Rev_4"
        ]
      },
      "code": "control \"VCFL-67-000002\" do\n  title \"vSphere Client must limit the number of concurrent connections\npermitted.\"\n  desc  \"Resource exhaustion can occur when an unlimited number of concurrent\nrequests are allowed on a web site, facilitating a denial of service attack.\nUnless the number of requests is controlled, the web server can consume enough\nsystem resources to cause a system crash.\n\n    Mitigating this kind of attack will include limiting the number of\nconcurrent HTTP/HTTPS requests. In Virgo, each incoming request requires a\nthread for the duration of that request. If more simultaneous requests are\nreceived than can be handled by the currently available request processing\nthreads, additional threads will be created up to the value of the maxThreads\nattribute.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000001-WSR-000001\"\n  tag gid: nil\n  tag rid: \"VCFL-67-000002\"\n  tag stig_id: \"VCFL-67-000002\"\n  tag cci: \"CCI-000054\"\n  tag nist: [\"AC-10\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format --xpath '/Server/Service/Connector/@maxThreads'\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nmaxThreads=\\\"800\\\" maxThreads=\\\"800\\\"\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nConfigure each <Connector> node with the following:\n\nmaxThreads=\\\"800\\\"\n\"\n\n  begin\n    vcui_conf = xml('/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml')\n\n      if vcui_conf['Server/Service/Connector/attribute::maxThreads'].is_a?(Array)\n        vcui_conf['Server/Service/Connector/attribute::maxThreads'].each do |x|\n          describe x do\n            it { should eq \"800\" }\n          end\n        end\n      else\n        describe xml(vcui_conf['Server/Service/Connector/attribute::maxThreads']) do\n          it { should eq \"800\" }\n        end\n      end\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000002.rb",
        "line": 1
      },
      "id": "VCFL-67-000002"
    },
    {
      "title": "vSphere Client must have Multipurpose Internet Mail Extensions (MIME)\nthat invoke OS shell programs disabled.",
      "desc": "MIME mappings tell vSphere Client what type of program various file\ntypes and extensions are and what external utilities or programs are needed to\nexecute the file type. By ensuring that various shell script MIME types\nare not included in web.xml, the server is protected against malicious users\ntricking the server into executing shell command files.",
      "descriptions": {
        "default": "MIME mappings tell vSphere Client what type of program various file\ntypes and extensions are and what external utilities or programs are needed to\nexecute the file type. By ensuring that various shell script MIME types\nare not included in web.xml, the server is protected against malicious users\ntricking the server into executing shell command files.",
        "check": "At the command prompt, execute the following command:\n\n# grep -En '(x-csh<)|(x-sh<)|(x-shar<)|(x-ksh<)'\n/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml\n\nIf the command produces any output, this is a finding.",
        "fix": "Open\n/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml in a text\neditor. Remove any and all of the following nodes lines.\n\n<mime-type>application/x-csh</mime-type>\n<mime-type>application/x-shar</mime-type>\n<mime-type>application/x-sh</mime-type>\n<mime-type>application/x-ksh</mime-type>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000141-WSR-000081",
        "gid": null,
        "rid": "VCFL-67-000013",
        "stig_id": "VCFL-67-000013",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCFL-67-000013\" do\n  title \"vSphere Client must have Multipurpose Internet Mail Extensions (MIME)\nthat invoke OS shell programs disabled.\"\n  desc  \"MIME mappings tell vSphere Client what type of program various file\ntypes and extensions are and what external utilities or programs are needed to\nexecute the file type.\\xC2\\xA0By ensuring that various shell script MIME types\nare not included in web.xml, the server is protected against malicious users\ntricking the server into executing shell command files.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000141-WSR-000081\"\n  tag gid: nil\n  tag rid: \"VCFL-67-000013\"\n  tag stig_id: \"VCFL-67-000013\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep -En '(x-csh<)|(x-sh<)|(x-shar<)|(x-ksh<)'\n/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml\n\nIf the command produces any output, this is a finding.\"\n  desc 'fix', \"Open\n/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml in a text\neditor. Remove any and all of the following nodes lines.\n\n<mime-type>application/x-csh</mime-type>\n<mime-type>application/x-shar</mime-type>\n<mime-type>application/x-sh</mime-type>\n<mime-type>application/x-ksh</mime-type>\"\n\n  describe command('grep -En \\'(x-csh<)|(x-sh<)|(x-shar<)|(x-ksh<)\\' /usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml') do\n    its ('stdout.strip') { should eq '' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000013.rb",
        "line": 1
      },
      "id": "VCFL-67-000013"
    },
    {
      "title": "vSphere Client must not have the Web Distributed Authoring (WebDAV)\nservlet installed.",
      "desc": "Web Distributed Authoring (WebDAV) is an extension to the HTTP\nprotocol that, when developed, was meant to allow users to create, change, and\nmove documents on a server, typically a web server or web share. WebDAV is not\nwidely used and has serious security concerns because it may allow clients to\nmodify unauthorized files on the web server and must therefore be disabled.\n\n    Because the WebDAV service has been found to have an excessive number of\nvulnerabilities, this servlet must not be installed. vSphere Client does not\nconfigure WebDAV by default.",
      "descriptions": {
        "default": "Web Distributed Authoring (WebDAV) is an extension to the HTTP\nprotocol that, when developed, was meant to allow users to create, change, and\nmove documents on a server, typically a web server or web share. WebDAV is not\nwidely used and has serious security concerns because it may allow clients to\nmodify unauthorized files on the web server and must therefore be disabled.\n\n    Because the WebDAV service has been found to have an excessive number of\nvulnerabilities, this servlet must not be installed. vSphere Client does not\nconfigure WebDAV by default.",
        "check": "At the command prompt, execute the following command:\n\n# grep -n -i 'webdav'\n/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml\n\nIf the command produces any output, this is a finding.",
        "fix": "Navigate to and open all listed files\n\nNavigate to and locate the mapping for the JSP servlet. It is the\n<servlet-mapping> node that contains <servlet-name>webdav</servlet-name>\n\nRemove the WebDav servlet and any mapping associated with it."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000141-WSR-000085",
        "gid": null,
        "rid": "VCFL-67-000015",
        "stig_id": "VCFL-67-000015",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCFL-67-000015\" do\n  title \"vSphere Client must not have the Web Distributed Authoring (WebDAV)\nservlet installed.\"\n  desc  \"Web Distributed Authoring (WebDAV) is an extension to the HTTP\nprotocol that, when developed, was meant to allow users to create, change, and\nmove documents on a server, typically a web server or web share. WebDAV is not\nwidely used and has serious security concerns because it may allow clients to\nmodify unauthorized files on the web server and must therefore be disabled.\n\n    Because the WebDAV service has been found to have an excessive number of\nvulnerabilities, this servlet must not be installed. vSphere Client does not\nconfigure WebDAV by default.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000141-WSR-000085\"\n  tag gid: nil\n  tag rid: \"VCFL-67-000015\"\n  tag stig_id: \"VCFL-67-000015\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep -n -i 'webdav'\n/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml\n\nIf the command produces any output, this is a finding.\"\n  desc 'fix', \"Navigate to and open all listed files\n\nNavigate to and locate the mapping for the JSP servlet. It is the\n<servlet-mapping> node that contains <servlet-name>webdav</servlet-name>\n\nRemove the WebDav servlet and any mapping associated with it.\"\n\n  describe xml('/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml') do\n    its('/web-app/servlet-mapping[servlet-name=\"webdav\"]') { should eq [] }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000015.rb",
        "line": 1
      },
      "id": "VCFL-67-000015"
    },
    {
      "title": "vSphere Client directory tree must have permissions in an \"out of the\nbox\" state.",
      "desc": "As a rule, accounts on a web server are to be kept to a minimum. Only\nadministrators, web managers, developers, auditors, and web authors require\naccounts on the machine hosting the web server. The resources to which these\naccounts have access must also be closely monitored and controlled. vSphere\nClient files must be adequately protected with correct permissions as applied\n\"out of the box\".",
      "descriptions": {
        "default": "As a rule, accounts on a web server are to be kept to a minimum. Only\nadministrators, web managers, developers, auditors, and web authors require\naccounts on the machine hosting the web server. The resources to which these\naccounts have access must also be closely monitored and controlled. vSphere\nClient files must be adequately protected with correct permissions as applied\n\"out of the box\".",
        "check": "At the command prompt, execute the following command:\n\n# find /usr/lib/vmware-vsphere-client/server -xdev -type f -a '(' -not -user\nvsphere-client -o '(' -not -group root -a -not -group users -not -group cis ')'\n')' -exec ls -ld {} \\;\n\nIf the command produces any output, this is a finding.",
        "fix": "At the command prompt, execute the following command:\n\n#chown vsphere-client:root <file_name>\n\nRepeat the command for each file that was returned\n\nNote: Replace <file_name> for the name of the file that was returned."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000211-WSR-000030",
        "gid": null,
        "rid": "VCFL-67-000019",
        "stig_id": "VCFL-67-000019",
        "cci": "CCI-001082",
        "nist": [
          "SC-2",
          "Rev_4"
        ]
      },
      "code": "control \"VCFL-67-000019\" do\n  title \"vSphere Client directory tree must have permissions in an \\\"out of the\nbox\\\" state.\"\n  desc  \"As a rule, accounts on a web server are to be kept to a minimum. Only\nadministrators, web managers, developers, auditors, and web authors require\naccounts on the machine hosting the web server. The resources to which these\naccounts have access must also be closely monitored and controlled. vSphere\nClient files must be adequately protected with correct permissions as applied\n\\\"out of the box\\\".\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000211-WSR-000030\"\n  tag gid: nil\n  tag rid: \"VCFL-67-000019\"\n  tag stig_id: \"VCFL-67-000019\"\n  tag cci: \"CCI-001082\"\n  tag nist: [\"SC-2\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# find /usr/lib/vmware-vsphere-client/server -xdev -type f -a '(' -not -user\nvsphere-client -o '(' -not -group root -a -not -group users -not -group cis ')'\n')' -exec ls -ld {} \\\\;\n\nIf the command produces any output, this is a finding.\"\n  desc 'fix', \"At the command prompt, execute the following command:\n\n#chown vsphere-client:root <file_name>\n\nRepeat the command for each file that was returned\n\nNote: Replace <file_name> for the name of the file that was returned.\"\n\n=begin  this was too slow with 8000 files\n  groups = [\"root\", \"users\", \"cis\"]\n  command('find /usr/lib/vmware-vsphere-client/server -type f -xdev').stdout.split.each do | fname |\n    describe file(fname) do\n      its('owner') {should eq 'vsphere-client'}\n      its('group') {should be_in groups}\n    end\n  end\n=end\n\n  describe command('find /usr/lib/vmware-vsphere-client/server -xdev -type f -a \\'(\\' -not -user vsphere-client -o \\'(\\' -not -group root -a -not -group users -not -group cis \\')\\' \\')\\' -exec ls -ld {} \\;') do\n   its('stdout.strip') { should eq ''}\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000019.rb",
        "line": 1
      },
      "id": "VCFL-67-000019"
    },
    {
      "title": "vSphere Client log files must only be accessible by privileged users.",
      "desc": "Log data is essential in the investigation of events. If log data were\nto become compromised, then competent forensic analysis and discovery of the\ntrue source of potentially malicious system activity would be difficult, if not\nimpossible, to achieve. In addition, access to log records provides information\nan attacker could potentially use to their advantage since each event record\nmight contain communication ports, protocols, services, trust relationships,\nuser names, etc. The vSphere Client restricts all access to log file by default\nbut this configuration must be verified.",
      "descriptions": {
        "default": "Log data is essential in the investigation of events. If log data were\nto become compromised, then competent forensic analysis and discovery of the\ntrue source of potentially malicious system activity would be difficult, if not\nimpossible, to achieve. In addition, access to log records provides information\nan attacker could potentially use to their advantage since each event record\nmight contain communication ports, protocols, services, trust relationships,\nuser names, etc. The vSphere Client restricts all access to log file by default\nbut this configuration must be verified.",
        "check": "At the command prompt, execute the following command:\n\n# find /storage/log/vmware/vsphere-client/logs/ -xdev -type f -a '(' -not -perm\n600 -o -not -user vsphere-client ')' -exec ls -ld {} \\;\n\nIf any files are returned, this is a finding.",
        "fix": "At the command prompt, execute the following commands:\n\n# chmod 600 /storage/log/vmware/vsphere-client/logs/<file>\n# chown vsphere-client:users /storage/log/vmware/vsphere-client/logs/<file>\n\nNote: Subsitute <file> with the listed file"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000118-WSR-000068",
        "gid": null,
        "rid": "VCFL-67-000011",
        "stig_id": "VCFL-67-000011",
        "cci": "CCI-000162",
        "nist": [
          "AU-9",
          "Rev_4"
        ]
      },
      "code": "control \"VCFL-67-000011\" do\n  title \"vSphere Client log files must only be accessible by privileged users.\"\n  desc  \"Log data is essential in the investigation of events. If log data were\nto become compromised, then competent forensic analysis and discovery of the\ntrue source of potentially malicious system activity would be difficult, if not\nimpossible, to achieve. In addition, access to log records provides information\nan attacker could potentially use to their advantage since each event record\nmight contain communication ports, protocols, services, trust relationships,\nuser names, etc. The vSphere Client restricts all access to log file by default\nbut this configuration must be verified.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000118-WSR-000068\"\n  tag gid: nil\n  tag rid: \"VCFL-67-000011\"\n  tag stig_id: \"VCFL-67-000011\"\n  tag cci: \"CCI-000162\"\n  tag nist: [\"AU-9\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# find /storage/log/vmware/vsphere-client/logs/ -xdev -type f -a '(' -not -perm\n600 -o -not -user vsphere-client ')' -exec ls -ld {} \\\\;\n\nIf any files are returned, this is a finding.\n\"\n  desc 'fix', \"At the command prompt, execute the following commands:\n\n# chmod 600 /storage/log/vmware/vsphere-client/logs/<file>\n# chown vsphere-client:users /storage/log/vmware/vsphere-client/logs/<file>\n\nNote: Subsitute <file> with the listed file\"\n\n  command('find /storage/log/vmware/vsphere-client/logs/ -maxdepth 1 -type f').stdout.split.each do | fname |\n    describe file(fname) do\n      it { should_not be_more_permissive_than('0600') }\n      its('owner') {should eq 'vsphere-client'}\n      its('group') {should eq 'users'}\n    end\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000011.rb",
        "line": 1
      },
      "id": "VCFL-67-000011"
    },
    {
      "title": "vSphere Client must limit the amount of time that each TCP connection\nis kept alive.",
      "desc": "Denial of Service is one threat against web servers.  Many DoS attacks\nattempt to consume web server resources in such a way that no more resources\nare available to satisfy legitimate requests.\n\n    In Virgo, the 'connectionTimeout' attribute sets the number of milliseconds\nthe server will wait after accepting a connection for the request URI line to\nbe presented. This timeout will also be used when reading the request body (if\nany). This prevents idle sockets that are not sending HTTP requests from\nconsuming system resources and potentially denying new connections.",
      "descriptions": {
        "default": "Denial of Service is one threat against web servers.  Many DoS attacks\nattempt to consume web server resources in such a way that no more resources\nare available to satisfy legitimate requests.\n\n    In Virgo, the 'connectionTimeout' attribute sets the number of milliseconds\nthe server will wait after accepting a connection for the request URI line to\nbe presented. This timeout will also be used when reading the request body (if\nany). This prevents idle sockets that are not sending HTTP requests from\nconsuming system resources and potentially denying new connections.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format --xpath\n'/Server/Service/Connector[@port=\"9090\"]/@connectionTimeout'\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nconnectionTimeout=\"20000\"exi\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nConfigure each <Connector> node with the following:\n\nconnectionTimeout=\"20000\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000001-WSR-000001",
        "gid": null,
        "rid": "VCFL-67-000001",
        "stig_id": "VCFL-67-000001",
        "cci": "CCI-000054",
        "nist": [
          "AC-10",
          "Rev_4"
        ]
      },
      "code": "control \"VCFL-67-000001\" do\n  title \"vSphere Client must limit the amount of time that each TCP connection\nis kept alive.\"\n  desc  \"Denial of Service is one threat against web servers.  Many DoS attacks\nattempt to consume web server resources in such a way that no more resources\nare available to satisfy legitimate requests.\n\n    In Virgo, the 'connectionTimeout' attribute sets the number of milliseconds\nthe server will wait after accepting a connection for the request URI line to\nbe presented. This timeout will also be used when reading the request body (if\nany). This prevents idle sockets that are not sending HTTP requests from\nconsuming system resources and potentially denying new connections.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000001-WSR-000001\"\n  tag gid: nil\n  tag rid: \"VCFL-67-000001\"\n  tag stig_id: \"VCFL-67-000001\"\n  tag cci: \"CCI-000054\"\n  tag nist: [\"AC-10\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format --xpath\n'/Server/Service/Connector[@port=\\\"9090\\\"]/@connectionTimeout'\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\nconnectionTimeout=\\\"20000\\\"exi\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nConfigure each <Connector> node with the following:\n\nconnectionTimeout=\\\"20000\\\"\"\n\n  begin\n    vcui_conf = xml('/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml')\n\n      if vcui_conf['Server/Service/Connector/attribute::connectionTimeout'].is_a?(Array)\n        vcui_conf['Server/Service/Connector/attribute::connectionTimeout'].each do |x|\n          describe x do\n            it { should eq \"20000\" }\n          end\n        end\n      else\n        describe xml(vcui_conf['Server/Service/Connector/attribute::connectionTimeout']) do\n          it { should eq \"20000\" }\n        end\n      end\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000001.rb",
        "line": 1
      },
      "id": "VCFL-67-000001"
    },
    {
      "title": "vSphere Client must not have any symbolic links in the web content\ndirectory tree.",
      "desc": "A web server is designed to deliver content and execute scripts or\napplications on the request of a client or user. Containing user requests to\nfiles in the directory tree of the hosted web application and limiting the\nexecution of scripts and applications guarantees that the user is not accessing\ninformation protected outside the application's realm. By checking that no\nsymbolic links exist in the document root, the web server is protected from\nusers jumping outside the hosted application directory tree and gaining access\nto the other directories, including the system root.",
      "descriptions": {
        "default": "A web server is designed to deliver content and execute scripts or\napplications on the request of a client or user. Containing user requests to\nfiles in the directory tree of the hosted web application and limiting the\nexecution of scripts and applications guarantees that the user is not accessing\ninformation protected outside the application's realm. By checking that no\nsymbolic links exist in the document root, the web server is protected from\nusers jumping outside the hosted application directory tree and gaining access\nto the other directories, including the system root.",
        "check": "At the command prompt, execute the following command:\n\n# find /usr/lib/vmware-vsphere-client/server/work/ -type l -ls\n\nIf the command produces any output, this is a finding.",
        "fix": "At the command prompt, execute the following commands:\n\nNote: Replace <file_name> for the name of any files that were returned.\n\n# unlink <file_name>\n\nRepeat the commands for each file that was returned."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000141-WSR-000087",
        "gid": null,
        "rid": "VCFL-67-000017",
        "stig_id": "VCFL-67-000017",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCFL-67-000017\" do\n  title \"vSphere Client must not have any symbolic links in the web content\ndirectory tree.\"\n  desc  \"A web server is designed to deliver content and execute scripts or\napplications on the request of a client or user. Containing user requests to\nfiles in the directory tree of the hosted web application and limiting the\nexecution of scripts and applications guarantees that the user is not accessing\ninformation protected outside the application's realm. By checking that no\nsymbolic links exist in the document root, the web server is protected from\nusers jumping outside the hosted application directory tree and gaining access\nto the other directories, including the system root.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000141-WSR-000087\"\n  tag gid: nil\n  tag rid: \"VCFL-67-000017\"\n  tag stig_id: \"VCFL-67-000017\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# find /usr/lib/vmware-vsphere-client/server/work/ -type l -ls\n\nIf the command produces any output, this is a finding.\"\n  desc 'fix', \"At the command prompt, execute the following commands:\n\nNote: Replace <file_name> for the name of any files that were returned.\n\n# unlink <file_name>\n\nRepeat the commands for each file that was returned.\"\n\n  describe command('find /usr/lib/vmware-vsphere-client/server/work/ -type l -ls') do\n    its ('stdout.strip') { should eq '' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000017.rb",
        "line": 1
      },
      "id": "VCFL-67-000017"
    },
    {
      "title": "vSphere Client must not show directory listings.",
      "desc": "Enumeration techniques, such as URL parameter manipulation, rely upon\nbeing able to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. Ensuring that directory listing is disabled is one approach to\nmitigating the vulnerability.",
      "descriptions": {
        "default": "Enumeration techniques, such as URL parameter manipulation, rely upon\nbeing able to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. Ensuring that directory listing is disabled is one approach to\nmitigating the vulnerability.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format\n/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml | sed\n's/xmlns=\".*\"//g' | xmllint --xpath\n'//param-name[text()=\"listings\"]/parent::init-param' -\n\nExpected result:\n\n<init-param>\n      <param-name>listings</param-name>\n      <param-value>false</param-value>\n    </init-param>\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml\n\nSet the <param-value> to \"false\" in all <param-name>listing</param-name>\nnodes.\n\nNote: The setting should look like the below:\n\n<init-param>\n      <param-name>listings</param-name>\n      <param-value>false</param-value>\n</init-param>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000266-WSR-000142",
        "gid": null,
        "rid": "VCFL-67-000023",
        "stig_id": "VCFL-67-000023",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCFL-67-000023\" do\n  title \"vSphere Client must not show directory listings.\"\n  desc  \"Enumeration techniques, such as URL parameter manipulation, rely upon\nbeing able to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. Ensuring that directory listing is disabled is one approach to\nmitigating the vulnerability.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000266-WSR-000142\"\n  tag gid: nil\n  tag rid: \"VCFL-67-000023\"\n  tag stig_id: \"VCFL-67-000023\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format\n/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml | sed\n's/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'//param-name[text()=\\\"listings\\\"]/parent::init-param' -\n\nExpected result:\n\n<init-param>\n      <param-name>listings</param-name>\n      <param-value>false</param-value>\n    </init-param>\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml\n\nSet the <param-value> to \\\"false\\\" in all <param-name>listing</param-name>\nnodes.\n\nNote: The setting should look like the below:\n\n<init-param>\n      <param-name>listings</param-name>\n      <param-value>false</param-value>\n</init-param>\"\n\n  describe.one do\n\n    describe xml('/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml') do\n      its('/web-app/servlet/init-param[param-name=\"listings\"]/param-value') { should eq [] }\n    end\n\n    describe xml('/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml') do\n      its('/web-app/servlet/init-param[param-name=\"listings\"]/param-value') { should cmp \"false\" }\n    end\n\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000023.rb",
        "line": 1
      },
      "id": "VCFL-67-000023"
    },
    {
      "title": "vSphere Client must set the secure flag for cookies.",
      "desc": "The secure flag is an option that can be set by the application server\nwhen sending a new cookie to the user within an HTTP Response. The purpose of\nthe secure flag is to prevent cookies from being observed by unauthorized\nparties due to the transmission of a the cookie in clear text. By setting the\nsecure flag, the browser will prevent the transmission of a cookie over an\nunencrypted channel.",
      "descriptions": {
        "default": "The secure flag is an option that can be set by the application server\nwhen sending a new cookie to the user within an HTTP Response. The purpose of\nthe secure flag is to prevent cookies from being observed by unauthorized\nparties due to the transmission of a the cookie in clear text. By setting the\nsecure flag, the browser will prevent the transmission of a cookie over an\nunencrypted channel.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format\n/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml | sed\n's/xmlns=\".*\"//g' | xmllint --xpath\n'/web-app/session-config/cookie-config/secure' -\n\nExpected result:\n\n<secure>true</secure>\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml\n\nNavigate to the /<web-apps>/<session-config>/<cookie-config> node and configure\nit as follows.\n\n    <cookie-config>\n      <http-only>true</http-only>\n      <secure>true</secure>\n    </cookie-config>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000439-WSR-000155",
        "gid": null,
        "rid": "VCFL-67-000030",
        "stig_id": "VCFL-67-000030",
        "cci": "CCI-002418",
        "nist": [
          "SC-8",
          "Rev_4"
        ]
      },
      "code": "control \"VCFL-67-000030\" do\n  title \"vSphere Client must set the secure flag for cookies.\"\n  desc  \"The secure flag is an option that can be set by the application server\nwhen sending a new cookie to the user within an HTTP Response. The purpose of\nthe secure flag is to prevent cookies from being observed by unauthorized\nparties due to the transmission of a the cookie in clear text. By setting the\nsecure flag, the browser will prevent the transmission of a cookie over an\nunencrypted channel.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000439-WSR-000155\"\n  tag gid: nil\n  tag rid: \"VCFL-67-000030\"\n  tag stig_id: \"VCFL-67-000030\"\n  tag cci: \"CCI-002418\"\n  tag nist: [\"SC-8\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format\n/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml | sed\n's/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'/web-app/session-config/cookie-config/secure' -\n\nExpected result:\n\n<secure>true</secure>\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml\n\nNavigate to the /<web-apps>/<session-config>/<cookie-config> node and configure\nit as follows.\n\n    <cookie-config>\n      <http-only>true</http-only>\n      <secure>true</secure>\n    </cookie-config>\"\n\n  describe xml('/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml') do\n    its('/web-app/session-config/cookie-config/secure') { should cmp 'true' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000030.rb",
        "line": 1
      },
      "id": "VCFL-67-000030"
    },
    {
      "title": "vSphere Client must have mappings set for Java servlet pages.",
      "desc": "Resource mapping is the process of tying a particular file type to a\nprocess in the web server that can serve that type of file to a requesting\nclient and to identify which file types are not to be delivered to a client.\n\n    By not specifying which files can and which files cannot be served to a\nuser, the web server could deliver to a user web server configuration files,\nlog files, password files, etc.\n\n    As Virgo is a java-based web server, the main file extension used is *.jsp.\n This check ensures that the *.jsp and *.jspx file types has been properly\nmapped to servlets.",
      "descriptions": {
        "default": "Resource mapping is the process of tying a particular file type to a\nprocess in the web server that can serve that type of file to a requesting\nclient and to identify which file types are not to be delivered to a client.\n\n    By not specifying which files can and which files cannot be served to a\nuser, the web server could deliver to a user web server configuration files,\nlog files, password files, etc.\n\n    As Virgo is a java-based web server, the main file extension used is *.jsp.\n This check ensures that the *.jsp and *.jspx file types has been properly\nmapped to servlets.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format\n/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml | sed\n's/xmlns=\".*\"//g' | xmllint --xpath\n'/web-app/servlet-mapping/servlet-name[text()=\"jsp\"]/parent::servlet-mapping'\n-\n\nExpected result:\n\n<servlet-mapping>\n    <servlet-name>jsp</servlet-name>\n    <url-pattern>*.jsp</url-pattern>\n    <url-pattern>*.jspx</url-pattern>\n</servlet-mapping>\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml\n\nNavigate to and locate the mapping for the JSP servlet. It is the\n<servlet-mapping> node that contains <servlet-name>jsp</servlet-name>\n\nConfigure the <servlet-mapping> node to look like the code snippet below\n\n <!-- The mappings for the JSP servlet -->\n <servlet-mapping>\n <servlet-name>jsp</servlet-name>\n <url-pattern>*.jsp</url-pattern>\n <url-pattern>*.jspx</url-pattern>\n </servlet-mapping>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000141-WSR-000083",
        "gid": null,
        "rid": "VCFL-67-000014",
        "stig_id": "VCFL-67-000014",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCFL-67-000014\" do\n  title \"vSphere Client must have mappings set for Java servlet pages.\"\n  desc  \"Resource mapping is the process of tying a particular file type to a\nprocess in the web server that can serve that type of file to a requesting\nclient and to identify which file types are not to be delivered to a client.\n\n    By not specifying which files can and which files cannot be served to a\nuser, the web server could deliver to a user web server configuration files,\nlog files, password files, etc.\n\n    As Virgo is a java-based web server, the main file extension used is *.jsp.\n This check ensures that the *.jsp and *.jspx file types has been properly\nmapped to servlets.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000141-WSR-000083\"\n  tag gid: nil\n  tag rid: \"VCFL-67-000014\"\n  tag stig_id: \"VCFL-67-000014\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format\n/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml | sed\n's/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'/web-app/servlet-mapping/servlet-name[text()=\\\"jsp\\\"]/parent::servlet-mapping'\n-\n\nExpected result:\n\n<servlet-mapping>\n    <servlet-name>jsp</servlet-name>\n    <url-pattern>*.jsp</url-pattern>\n    <url-pattern>*.jspx</url-pattern>\n</servlet-mapping>\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml\n\nNavigate to and locate the mapping for the JSP servlet. It is the\n<servlet-mapping> node that contains <servlet-name>jsp</servlet-name>\n\nConfigure the <servlet-mapping> node to look like the code snippet below\n\n <!-- The mappings for the JSP servlet -->\n <servlet-mapping>\n <servlet-name>jsp</servlet-name>\n <url-pattern>*.jsp</url-pattern>\n <url-pattern>*.jspx</url-pattern>\n </servlet-mapping>\n\"\n\n  list = [\"*.jsp\", \"*.jspx\"]\n  describe xml('/usr/lib/vmware-vsphere-client/server/configuration/conf/web.xml') do\n    its('/web-app/servlet-mapping[servlet-name=\"jsp\"]/url-pattern') { should be_in list }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000014.rb",
        "line": 1
      },
      "id": "VCFL-67-000014"
    },
    {
      "title": "vSphere Client must generate log records during java startup and\nshutdown.",
      "desc": "Logging must be started as soon as possible when a service starts and\nwhen a service is stopped. Many forms of suspicious actions can be detected by\nanalyzing logs for unexpected service starts and stops. Also, by starting to\nlog immediately after a service starts, it becomes more difficult for suspicous\nactivity to go un-logged.\n\n    On the VCSA, the vmware-vmon service starts up the JVMs for various vCenter\nprocesses, including vSphere Client, and the individual json config files\ncontrol the early jvm logging. Ensuring these json files are configured\ncorrectly enables early java stdout and stderr logging.",
      "descriptions": {
        "default": "Logging must be started as soon as possible when a service starts and\nwhen a service is stopped. Many forms of suspicious actions can be detected by\nanalyzing logs for unexpected service starts and stops. Also, by starting to\nlog immediately after a service starts, it becomes more difficult for suspicous\nactivity to go un-logged.\n\n    On the VCSA, the vmware-vmon service starts up the JVMs for various vCenter\nprocesses, including vSphere Client, and the individual json config files\ncontrol the early jvm logging. Ensuring these json files are configured\ncorrectly enables early java stdout and stderr logging.",
        "check": "At the command prompt, execute the following command:\n\n# grep StreamRedirectFile\n/etc/vmware/vmware-vmon/svcCfgfiles/vsphere-client.json\n\nExpected result:\n\n\"StreamRedirectFile\":\n\"%VMWARE_LOG_DIR%/vmware/vsphere-client/logs/vsphere-client-runtime.log\",\n\nIf there is no log file specified for the StreamRedirectFile setting, this is a\nfinding.",
        "fix": "Navigate to and open\n/etc/vmware/vmware-vmon/svcCfgfiles/vsphere-client.json. Below the last line of\nthe 'PreStartCommandArg' block add the following line:\n\n\"StreamRedirectFile\":\n\"%VMWARE_LOG_DIR%/vmware/vsphere-client/logs/vsphere-client-runtime.log\",\n\nRestart the appliance for changes to take effect."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000089-WSR-000047",
        "gid": null,
        "rid": "VCFL-67-000010",
        "stig_id": "VCFL-67-000010",
        "cci": "CCI-000169",
        "nist": [
          "AU-12 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCFL-67-000010\" do\n  title \"vSphere Client must generate log records during java startup and\nshutdown.\"\n  desc  \"Logging must be started as soon as possible when a service starts and\nwhen a service is stopped. Many forms of suspicious actions can be detected by\nanalyzing logs for unexpected service starts and stops. Also, by starting to\nlog immediately after a service starts, it becomes more difficult for suspicous\nactivity to go un-logged.\n\n    On the VCSA, the vmware-vmon service starts up the JVMs for various vCenter\nprocesses, including vSphere Client, and the individual json config files\ncontrol the early jvm logging. Ensuring these json files are configured\ncorrectly enables early java stdout and stderr logging.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000089-WSR-000047\"\n  tag gid: nil\n  tag rid: \"VCFL-67-000010\"\n  tag stig_id: \"VCFL-67-000010\"\n  tag cci: \"CCI-000169\"\n  tag nist: [\"AU-12 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep StreamRedirectFile\n/etc/vmware/vmware-vmon/svcCfgfiles/vsphere-client.json\n\nExpected result:\n\n\\\"StreamRedirectFile\\\":\n\\\"%VMWARE_LOG_DIR%/vmware/vsphere-client/logs/vsphere-client-runtime.log\\\",\n\nIf there is no log file specified for the StreamRedirectFile setting, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open\n/etc/vmware/vmware-vmon/svcCfgfiles/vsphere-client.json. Below the last line of\nthe 'PreStartCommandArg' block add the following line:\n\n\\\"StreamRedirectFile\\\":\n\\\"%VMWARE_LOG_DIR%/vmware/vsphere-client/logs/vsphere-client-runtime.log\\\",\n\nRestart the appliance for changes to take effect.\"\n\n  describe json('/etc/vmware/vmware-vmon/svcCfgfiles/vsphere-client.json') do\n    its('StreamRedirectFile') { should eq '%VMWARE_LOG_DIR%/vmware/vsphere-client/logs/vsphere-client-runtime.log'}\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000010.rb",
        "line": 1
      },
      "id": "VCFL-67-000010"
    },
    {
      "title": "vSphere Client must be configured with memory leak protection.",
      "desc": "The Java Runtime environment can cause a memory leak or lock files\nunder certain conditions. Without memory leak protection, vSphere Client can\ncontinue to consume system resources which will lead to OutOfMemoryErrors when\nre-loading web applications.\n\n    Memory leaks occur when JRE code uses the context class loader to load a\nsingleton as this will cause a memory leak if a web application class loader\nhappens to be the context class loader at the time. The\nJreMemoryLeakPreventionListener class is designed to initialise these\nsingletons when Tomcat's common class loader is the context class loader.\nProper use of JRE memory leak protection will ensure that the hosted\napplication does not consume system resources and cause an unstable environment.",
      "descriptions": {
        "default": "The Java Runtime environment can cause a memory leak or lock files\nunder certain conditions. Without memory leak protection, vSphere Client can\ncontinue to consume system resources which will lead to OutOfMemoryErrors when\nre-loading web applications.\n\n    Memory leaks occur when JRE code uses the context class loader to load a\nsingleton as this will cause a memory leak if a web application class loader\nhappens to be the context class loader at the time. The\nJreMemoryLeakPreventionListener class is designed to initialise these\nsingletons when Tomcat's common class loader is the context class loader.\nProper use of JRE memory leak protection will ensure that the hosted\napplication does not consume system resources and cause an unstable environment.",
        "check": "At the command prompt, execute the following command:\n\n# grep JreMemoryLeakPreventionListener\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\n<Listener\nclassName=\"org.apache.catalina.core.JreMemoryLeakPreventionListener\" />\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nNavigate to the <Server> node.\n\nAdd '<Listener\nclassName=\"org.apache.catalina.core.JreMemoryLeakPreventionListener\"/>' to\nthe <Server> node."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000141-WSR-000086",
        "gid": null,
        "rid": "VCFL-67-000016",
        "stig_id": "VCFL-67-000016",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCFL-67-000016\" do\n  title \"vSphere Client must be configured with memory leak protection.\"\n  desc  \"The Java Runtime environment can cause a memory leak or lock files\nunder certain conditions. Without memory leak protection, vSphere Client can\ncontinue to consume system resources which will lead to OutOfMemoryErrors when\nre-loading web applications.\n\n    Memory leaks occur when JRE code uses the context class loader to load a\nsingleton as this will cause a memory leak if a web application class loader\nhappens to be the context class loader at the time. The\nJreMemoryLeakPreventionListener class is designed to initialise these\nsingletons when Tomcat's common class loader is the context class loader.\nProper use of JRE memory leak protection will ensure that the hosted\napplication does not consume system resources and cause an unstable environment.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000141-WSR-000086\"\n  tag gid: nil\n  tag rid: \"VCFL-67-000016\"\n  tag stig_id: \"VCFL-67-000016\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep JreMemoryLeakPreventionListener\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nExpected result:\n\n<Listener\nclassName=\\\"org.apache.catalina.core.JreMemoryLeakPreventionListener\\\" />\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml\n\nNavigate to the <Server> node.\n\nAdd '<Listener\nclassName=\\\"org.apache.catalina.core.JreMemoryLeakPreventionListener\\\"/>' to\nthe <Server> node.\"\n\n  describe xml('/usr/lib/vmware-vsphere-client/server/configuration/tomcat-server.xml') do\n    its('Server/Listener/attribute::className') { should include 'org.apache.catalina.core.JreMemoryLeakPreventionListener' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000016.rb",
        "line": 1
      },
      "id": "VCFL-67-000016"
    },
    {
      "title": "vSphere Client application files must be verified for their integrity.",
      "desc": "Verifying that vSphere Client application code is unchanged from it's\nshipping state is essential for file validation and non-repudiation of  vSphere\nClient itself. There is no reason that the MD5 hash of the rpm original files\nshould be changed after installation, excluding configuration files.",
      "descriptions": {
        "default": "Verifying that vSphere Client application code is unchanged from it's\nshipping state is essential for file validation and non-repudiation of  vSphere\nClient itself. There is no reason that the MD5 hash of the rpm original files\nshould be changed after installation, excluding configuration files.",
        "check": "At the command prompt, execute the following command:\n\n# rpm -V vsphere-client|grep \"^..5......\"|grep -E\n\"\\.war|\\.jar|\\.sh|\\.py\"\n\nIf is any output, this is a finding.",
        "fix": "Re-install the VCSA or roll back to a snapshot. Modifying the\nvSphere Client installation files manually is not supported by VMware."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000131-WSR-000051",
        "gid": null,
        "rid": "VCFL-67-000012",
        "stig_id": "VCFL-67-000012",
        "cci": "CCI-001749",
        "nist": [
          "CM-5 (3)",
          "Rev_4"
        ]
      },
      "code": "control \"VCFL-67-000012\" do\n  title \"vSphere Client application files must be verified for their integrity.\"\n  desc  \"Verifying that vSphere Client application code is unchanged from it's\nshipping state is essential for file validation and non-repudiation of  vSphere\nClient itself. There is no reason that the MD5 hash of the rpm original files\nshould be changed after installation, excluding configuration files.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000131-WSR-000051\"\n  tag gid: nil\n  tag rid: \"VCFL-67-000012\"\n  tag stig_id: \"VCFL-67-000012\"\n  tag cci: \"CCI-001749\"\n  tag nist: [\"CM-5 (3)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# rpm -V vsphere-client|grep \\\"^..5......\\\"|grep -E\n\\\"\\\\.war|\\\\.jar|\\\\.sh|\\\\.py\\\"\n\nIf is any output, this is a finding.\"\n  desc 'fix', \"Re-install the VCSA or roll back to a snapshot. Modifying the\nvSphere Client installation files manually is not supported by VMware.\"\n\n  describe command('rpm -V vsphere-client|grep \"^..5......\"|grep -E \"\\.war|\\.jar|\\.sh|\\.py\"') do\n    its ('stdout.strip') { should eq '' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000012.rb",
        "line": 1
      },
      "id": "VCFL-67-000012"
    },
    {
      "title": "vSphere UI must be configured to limit access to internal packages.",
      "desc": "The 'package.access' entry in the catalina.properties file implements\naccess control at the package level. When properly configured, a Security\nException will be reported should an errant or malicious webapp attempt to\naccess the listed internal classes directly, or if a new class is defined under\nthe protected packages. The vSphere UI comes pre-configured with the\nappropriate packages defined in 'package.access' and this configuration must be\nmaintained.",
      "descriptions": {
        "default": "The 'package.access' entry in the catalina.properties file implements\naccess control at the package level. When properly configured, a Security\nException will be reported should an errant or malicious webapp attempt to\naccess the listed internal classes directly, or if a new class is defined under\nthe protected packages. The vSphere UI comes pre-configured with the\nappropriate packages defined in 'package.access' and this configuration must be\nmaintained.",
        "check": "At the command prompt, execute the following command:\n\n# grep \"package.access\"\n/usr/lib/vmware-vsphere-ui/server/conf/catalina.properties\n\nExpected result:\n\npackage.access=sun.,org.apache.catalina.,org.apache.coyote.,org.apache.jasper.,org.apache.tomcat.\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-sso/vmware-sts/conf/catalina.propertiess and ensure that the\n'package.access' line is configured as follows:\n\npackage.access=sun.,org.apache.catalina.,org.apache.coyote.,org.apache.jasper.,org.apache.tomcat."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000435-WSR-000147",
        "gid": null,
        "rid": "VCUI-67-000010",
        "stig_id": "VCUI-67-000010",
        "cci": "CCI-002385",
        "nist": [
          "SC-5",
          "Rev_4"
        ]
      },
      "code": "control \"VCUI-67-000010\" do\n  title \"vSphere UI must be configured to limit access to internal packages.\"\n  desc  \"The 'package.access' entry in the catalina.properties file implements\naccess control at the package level. When properly configured, a Security\nException will be reported should an errant or malicious webapp attempt to\naccess the listed internal classes directly, or if a new class is defined under\nthe protected packages. The vSphere UI comes pre-configured with the\nappropriate packages defined in 'package.access' and this configuration must be\nmaintained. \"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000435-WSR-000147\"\n  tag gid: nil\n  tag rid: \"VCUI-67-000010\"\n  tag stig_id: \"VCUI-67-000010\"\n  tag cci: \"CCI-002385\"\n  tag nist: [\"SC-5\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep \\\"package.access\\\"\n/usr/lib/vmware-vsphere-ui/server/conf/catalina.properties\n\nExpected result:\n\npackage.access=sun.,org.apache.catalina.,org.apache.coyote.,org.apache.jasper.,org.apache.tomcat.\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-sso/vmware-sts/conf/catalina.propertiess and ensure that the\n'package.access' line is configured as follows:\n\npackage.access=sun.,org.apache.catalina.,org.apache.coyote.,org.apache.jasper.,org.apache.tomcat.\n\"\n\n  describe parse_config_file('/usr/lib/vmware-vsphere-ui/server/conf/catalina.properties').params['package.access'] do\n    it { should eq 'sun.,org.apache.catalina.,org.apache.coyote.,org.apache.jasper.,org.apache.tomcat.' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000010.rb",
        "line": 1
      },
      "id": "VCUI-67-000010"
    },
    {
      "title": "vSphere UI log files must be moved to a permanent repository in\naccordance with site policy.",
      "desc": "vSphere UI produces a handful of logs that must be offloaded from the\noriginating system. This information can then be used for diagnostic purposes,\nforensics purposes, or other purposes relevant to ensuring the availability and\nintegrity of the hosted application.",
      "descriptions": {
        "default": "vSphere UI produces a handful of logs that must be offloaded from the\noriginating system. This information can then be used for diagnostic purposes,\nforensics purposes, or other purposes relevant to ensuring the availability and\nintegrity of the hosted application.",
        "check": "At the command prompt, execute the following command:\n\n# grep -v \"^#\" /etc/vmware-syslog/stig-services-vsphere-ui.conf\n\nExpected result:\n\ninput(type=\"imfile\"\n\n      File=\"/var/log/vmware/vsphere-ui/logs/access/localhost_access*\"\n\n      Tag=\"ui-access\"\n\n      Severity=\"info\"\n\n      Facility=\"local0\")\n\ninput(type=\"imfile\"\n\n      File=\"/var/log/vmware/vsphere-ui/logs/vsphere-ui-runtime*\"\n\n      Tag=\"ui-runtime\"\n\n      Severity=\"info\"\n\n      Facility=\"local0\")\n\nIf the file does not exist, this is a finding.\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open\n/etc/vmware-syslog/stig-services-vsphere-ui.conf , creating the file if it does\nnot exist.\n\nSet the contents of the file as follows:\n\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vsphere-ui/logs/access/localhost_access*\"\n      Tag=\"ui-access\"\n      Severity=\"info\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vsphere-ui/logs/vsphere-ui-runtime*\"\n      Tag=\"ui-runtime\"\n      Severity=\"info\"\n      Facility=\"local0\")"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": null,
        "gid": null,
        "rid": "VCUI-67-000027",
        "stig_id": "VCUI-67-000027",
        "cci": null,
        "nist": null
      },
      "code": "control \"VCUI-67-000027\" do\n  title \"vSphere UI log files must be moved to a permanent repository in\naccordance with site policy.\"\n  desc  \"vSphere UI produces a handful of logs that must be offloaded from the\noriginating system. This information can then be used for diagnostic purposes,\nforensics purposes, or other purposes relevant to ensuring the availability and\nintegrity of the hosted application.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: \"VCUI-67-000027\"\n  tag stig_id: \"VCUI-67-000027\"\n  tag cci: nil\n  tag nist: nil\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep -v \\\"^#\\\" /etc/vmware-syslog/stig-services-vsphere-ui.conf\n\nExpected result:\n\ninput(type=\\\"imfile\\\"\n\n      File=\\\"/var/log/vmware/vsphere-ui/logs/access/localhost_access*\\\"\n\n      Tag=\\\"ui-access\\\"\n\n      Severity=\\\"info\\\"\n\n      Facility=\\\"local0\\\")\n\ninput(type=\\\"imfile\\\"\n\n      File=\\\"/var/log/vmware/vsphere-ui/logs/vsphere-ui-runtime*\\\"\n\n      Tag=\\\"ui-runtime\\\"\n\n      Severity=\\\"info\\\"\n\n      Facility=\\\"local0\\\")\n\nIf the file does not exist, this is a finding.\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open\n/etc/vmware-syslog/stig-services-vsphere-ui.conf , creating the file if it does\nnot exist.\n\nSet the contents of the file as follows:\n\ninput(type=\\\"imfile\\\"\n      File=\\\"/var/log/vmware/vsphere-ui/logs/access/localhost_access*\\\"\n      Tag=\\\"ui-access\\\"\n      Severity=\\\"info\\\"\n      Facility=\\\"local0\\\")\ninput(type=\\\"imfile\\\"\n      File=\\\"/var/log/vmware/vsphere-ui/logs/vsphere-ui-runtime*\\\"\n      Tag=\\\"ui-runtime\\\"\n      Severity=\\\"info\\\"\n      Facility=\\\"local0\\\")\"\n\n  describe file('/etc/vmware-syslog/stig-services-vsphere-ui.conf') do\n    it { should exist }\n  end\n  describe command('grep -v \"^#\" /etc/vmware-syslog/stig-services-vsphere-ui.conf') do\n    its ('stdout') { should match \"input(type=\\\"imfile\\\"\\n      File=\\\"/var/log/vmware/vsphere-ui/logs/access/localhost_access*\\\"\\n      Tag=\\\"ui-access\\\"\\n      Severity=\\\"info\\\"\\n      Facility=\\\"local0\\\")\\ninput(type=\\\"imfile\\\"\\n      File=\\\"/var/log/vmware/vsphere-ui/logs/vsphere-ui-runtime*\\\"\\n      Tag=\\\"ui-runtime\\\"\\n      Severity=\\\"info\\\"\\n      Facility=\\\"local0\\\")\\n\" }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000027.rb",
        "line": 1
      },
      "id": "VCUI-67-000027"
    },
    {
      "title": "vSphere UI must set the welcome-file node to a default web page.",
      "desc": "Enumeration techniques, such as URL parameter manipulation, rely upon\nbeing able to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. By having a default hosted application web page, the anonymous web\nuser will not obtain directory browsing information or an error message that\nreveals the server type and version. Ensuring that every document directory has\nan index.jsp (or equivalent) file is one approach to mitigating the\nvulnerability.",
      "descriptions": {
        "default": "Enumeration techniques, such as URL parameter manipulation, rely upon\nbeing able to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. By having a default hosted application web page, the anonymous web\nuser will not obtain directory browsing information or an error message that\nreveals the server type and version. Ensuring that every document directory has\nan index.jsp (or equivalent) file is one approach to mitigating the\nvulnerability.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/web.xml | sed\n's/xmlns=\".*\"//g' | xmllint --xpath '/web-app/welcome-file-list' -\n\nExpected result:\n\n<welcome-file-list>\n    <welcome-file>index.html</welcome-file>\n    <welcome-file>index.htm</welcome-file>\n    <welcome-file>index.jsp</welcome-file>\n  </welcome-file-list>\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open /usr/lib/vmware-vsphere-ui/server/conf/web.xml\n\nAdd the following section under the <web-apps> node:\n\n <welcome-file-list>\n <welcome-file>index.html</welcome-file>\n <welcome-file>index.htm</welcome-file>\n <welcome-file>index.jsp</welcome-file>\n </welcome-file-list>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": null,
        "gid": null,
        "rid": "VCUI-67-000020",
        "stig_id": "VCUI-67-000020",
        "cci": null,
        "nist": null
      },
      "code": "control \"VCUI-67-000020\" do\n  title \"vSphere UI must set the welcome-file node to a default web page.\"\n  desc  \"Enumeration techniques, such as URL parameter manipulation, rely upon\nbeing able to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. By having a default hosted application web page, the anonymous web\nuser will not obtain directory browsing information or an error message that\nreveals the server type and version. Ensuring that every document directory has\nan index.jsp (or equivalent) file is one approach to mitigating the\nvulnerability.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: \"VCUI-67-000020\"\n  tag stig_id: \"VCUI-67-000020\"\n  tag cci: nil\n  tag nist: nil\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/web.xml | sed\n's/xmlns=\\\".*\\\"//g' | xmllint --xpath '/web-app/welcome-file-list' -\n\nExpected result:\n\n<welcome-file-list>\n    <welcome-file>index.html</welcome-file>\n    <welcome-file>index.htm</welcome-file>\n    <welcome-file>index.jsp</welcome-file>\n  </welcome-file-list>\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-vsphere-ui/server/conf/web.xml\n\nAdd the following section under the <web-apps> node:\n\n <welcome-file-list>\n <welcome-file>index.html</welcome-file>\n <welcome-file>index.htm</welcome-file>\n <welcome-file>index.jsp</welcome-file>\n </welcome-file-list>\n\"\n\n  list = [\"index.html\", \"index.htm\", \"index.jsp\"]\n  describe xml('/usr/lib/vmware-vsphere-ui/server/conf/web.xml') do\n    its('/web-app/welcome-file-list/welcome-file') { should be_in list }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000020.rb",
        "line": 1
      },
      "id": "VCUI-67-000020"
    },
    {
      "title": "vSphere UI must have Multipurpose Internet Mail Extensions (MIME) that\ninvoke OS shell programs disabled.",
      "desc": "MIME mappings tell the vSphere UI what type of program various file\ntypes and extensions are and what external utilities or programs are needed to\nexecute the file type. By ensuring that various shell script MIME types\nare not included in web.xml, the server is protected against malicious users\ntricking the server into executing shell command files.",
      "descriptions": {
        "default": "MIME mappings tell the vSphere UI what type of program various file\ntypes and extensions are and what external utilities or programs are needed to\nexecute the file type. By ensuring that various shell script MIME types\nare not included in web.xml, the server is protected against malicious users\ntricking the server into executing shell command files.",
        "check": "At the command prompt, execute the following command:\n\n# grep -En '(x-csh<)|(x-sh<)|(x-shar<)|(x-ksh<)'\n/usr/lib/vmware-vsphere-ui/server/conf/web.xml\n\nIf the command produces any output, this is a finding.",
        "fix": "Navigate to and open /usr/lib/vmware-vsphere-ui/server/conf/web.xml\n. Remove any and all of the following nodes lines.\n\n<mime-type>application/x-csh</mime-type>\n<mime-type>application/x-shar</mime-type>\n<mime-type>application/x-sh</mime-type>\n<mime-type>application/x-ksh</mime-type>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000439-WSR-000155",
        "gid": null,
        "rid": "VCUI-67-000011",
        "stig_id": "VCUI-67-000011",
        "cci": "CCI-002418",
        "nist": [
          "SC-8",
          "Rev_4"
        ]
      },
      "code": "control \"VCUI-67-000011\" do\n  title \"vSphere UI must have Multipurpose Internet Mail Extensions (MIME) that\ninvoke OS shell programs disabled.\"\n  desc  \"MIME mappings tell the vSphere UI what type of program various file\ntypes and extensions are and what external utilities or programs are needed to\nexecute the file type. By ensuring that various shell script MIME types\nare not included in web.xml, the server is protected against malicious users\ntricking the server into executing shell command files.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000439-WSR-000155\"\n  tag gid: nil\n  tag rid: \"VCUI-67-000011\"\n  tag stig_id: \"VCUI-67-000011\"\n  tag cci: \"CCI-002418\"\n  tag nist: [\"SC-8\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep -En '(x-csh<)|(x-sh<)|(x-shar<)|(x-ksh<)'\n/usr/lib/vmware-vsphere-ui/server/conf/web.xml\n\nIf the command produces any output, this is a finding.\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-vsphere-ui/server/conf/web.xml\n. Remove any and all of the following nodes lines.\n\n<mime-type>application/x-csh</mime-type>\n<mime-type>application/x-shar</mime-type>\n<mime-type>application/x-sh</mime-type>\n<mime-type>application/x-ksh</mime-type>\"\n\n  describe command('grep -En \\'(x-csh<)|(x-sh<)|(x-shar<)|(x-ksh<)\\' /usr/lib/vmware-vsphere-ui/server/conf/web.xml') do\n    its ('stdout.strip') { should eq '' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000011.rb",
        "line": 1
      },
      "id": "VCUI-67-000011"
    },
    {
      "title": "vSphere UI must protect cookies from XSS.",
      "desc": "Cookies are a common way to save session state over the HTTP(S)\nprotocol. If an attacker can compromise session data stored in a cookie, they\nare better able to launch an attack against the server and its applications.\nWhen you tag a cookie with the HttpOnly flag, it tells the browser that this\nparticular cookie should only be accessed by the originating server. Any\nattempt to access the cookie from client script is strictly forbidden.",
      "descriptions": {
        "default": "Cookies are a common way to save session state over the HTTP(S)\nprotocol. If an attacker can compromise session data stored in a cookie, they\nare better able to launch an attack against the server and its applications.\nWhen you tag a cookie with the HttpOnly flag, it tells the browser that this\nparticular cookie should only be accessed by the originating server. Any\nattempt to access the cookie from client script is strictly forbidden.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/context.xml | xmllint\n--xpath '/Context/@useHttpOnly' -\n\nExpected result:\n\nuseHttpOnly=\"true\"\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-ui/server/conf/context.xml . Add the following\nconfiguration to the <Context> node:\n\nuseHttpOnly=\"true\"\n\nEx:\n\n<Context useHttpOnly=\"true\" sessionCookieName=\"VSPHERE-UI-JSESSIONID\"\nsessionCookiePath=\"/ui\">"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000266-WSR-000159",
        "gid": null,
        "rid": "VCUI-67-000004",
        "stig_id": "VCUI-67-000004",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCUI-67-000004\" do\n  title \"vSphere UI must protect cookies from XSS.\"\n  desc  \"Cookies are a common way to save session state over the HTTP(S)\nprotocol. If an attacker can compromise session data stored in a cookie, they\nare better able to launch an attack against the server and its applications.\nWhen you tag a cookie with the HttpOnly flag, it tells the browser that this\nparticular cookie should only be accessed by the originating server. Any\nattempt to access the cookie from client script is strictly forbidden.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000266-WSR-000159\"\n  tag gid: nil\n  tag rid: \"VCUI-67-000004\"\n  tag stig_id: \"VCUI-67-000004\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/context.xml | xmllint\n--xpath '/Context/@useHttpOnly' -\n\nExpected result:\n\nuseHttpOnly=\\\"true\\\"\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-ui/server/conf/context.xml . Add the following\nconfiguration to the <Context> node:\n\nuseHttpOnly=\\\"true\\\"\n\nEx:\n\n<Context useHttpOnly=\\\"true\\\" sessionCookieName=\\\"VSPHERE-UI-JSESSIONID\\\"\nsessionCookiePath=\\\"/ui\\\">\"\n\n  describe xml('/usr/lib/vmware-vsphere-ui/server/conf/context.xml') do\n    its(['Context/attribute::useHttpOnly']) { should eq ['true'] }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000004.rb",
        "line": 1
      },
      "id": "VCUI-67-000004"
    },
    {
      "title": "vSphere UI must set URIEncoding to UTF-8.",
      "desc": "Invalid user input occurs when a user inserts data or characters into\na hosted application's data entry field and the hosted application is\nunprepared to process that data. This results in unanticipated application\nbehavior, potentially leading to an application compromise. Invalid user input\nis one of the primary methods employed when attempting to compromise an\napplication.\n\n    An attacker can also enter Unicode characters into hosted applications in\nan effort to break out of the document home or root home directory or to bypass\nsecurity checks. vSphere UI must be configured to use a consistent character\nset via the URIEncoding attribute on the Connector nodes.",
      "descriptions": {
        "default": "Invalid user input occurs when a user inserts data or characters into\na hosted application's data entry field and the hosted application is\nunprepared to process that data. This results in unanticipated application\nbehavior, potentially leading to an application compromise. Invalid user input\nis one of the primary methods employed when attempting to compromise an\napplication.\n\n    An attacker can also enter Unicode characters into hosted applications in\nan effort to break out of the document home or root home directory or to bypass\nsecurity checks. vSphere UI must be configured to use a consistent character\nset via the URIEncoding attribute on the Connector nodes.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/server.xml | sed '2\ns/xmlns=\".*\"//g' |  xmllint --xpath\n'/Server/Service/Connector[@port=\"${http.port}\"]/@URIEncoding' -\n\nExpected result:\n\nURIEncoding=\"UTF-8\"\n\nIf the output does not match the expected result, this is a finding",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-ui/server/conf/server.xml\n\nNavigate to each of the <Connector> nodes.\n\nConfigure each <Connector> node with the value 'URIEncoding=\"UTF-8\"'."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": null,
        "gid": null,
        "rid": "VCUI-67-000019",
        "stig_id": "VCUI-67-000019",
        "cci": null,
        "nist": null
      },
      "code": "control \"VCUI-67-000019\" do\n  title \"vSphere UI must set URIEncoding to UTF-8.\"\n  desc  \"Invalid user input occurs when a user inserts data or characters into\na hosted application's data entry field and the hosted application is\nunprepared to process that data. This results in unanticipated application\nbehavior, potentially leading to an application compromise. Invalid user input\nis one of the primary methods employed when attempting to compromise an\napplication.\n\n    An attacker can also enter Unicode characters into hosted applications in\nan effort to break out of the document home or root home directory or to bypass\nsecurity checks. vSphere UI must be configured to use a consistent character\nset via the URIEncoding attribute on the Connector nodes.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: \"VCUI-67-000019\"\n  tag stig_id: \"VCUI-67-000019\"\n  tag cci: nil\n  tag nist: nil\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/server.xml | sed '2\ns/xmlns=\\\".*\\\"//g' |  xmllint --xpath\n'/Server/Service/Connector[@port=\\\"${http.port}\\\"]/@URIEncoding' -\n\nExpected result:\n\nURIEncoding=\\\"UTF-8\\\"\n\nIf the output does not match the expected result, this is a finding\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-ui/server/conf/server.xml\n\nNavigate to each of the <Connector> nodes.\n\nConfigure each <Connector> node with the value 'URIEncoding=\\\"UTF-8\\\"'.\"\n\n  begin\n    vcui_conf = xml('/usr/lib/vmware-vsphere-ui/server/conf/server.xml')\n\n      if vcui_conf['Server/Service/Connector/attribute::URIEncoding'].is_a?(Array)\n        vcui_conf['Server/Service/Connector/attribute::URIEncoding'].each do |x|\n          describe x do\n            it { should eq \"UTF-8\" }\n          end\n        end\n      else\n        describe xml(vcui_conf['Server/Service/Connector/attribute::URIEncoding']) do\n          it { should eq \"UTF-8\" }\n        end\n      end\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000019.rb",
        "line": 1
      },
      "id": "VCUI-67-000019"
    },
    {
      "title": "The vSphere UI must not show directory listings.",
      "desc": "Enumeration techniques, such as URL parameter manipulation, rely upon\nbeing able to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. Ensuring that directory listing is disabled is one approach to\nmitigating the vulnerability.",
      "descriptions": {
        "default": "Enumeration techniques, such as URL parameter manipulation, rely upon\nbeing able to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. Ensuring that directory listing is disabled is one approach to\nmitigating the vulnerability.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/web.xml | sed\n's/xmlns=\".*\"//g' | xmllint --xpath\n'//param-name[text()=\"listings\"]/parent::init-param' -\n\nExpected result:\n\n<init-param>\n      <param-name>listings</param-name>\n      <param-value>false</param-value>\n</init-param>\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open /usr/lib/vmware-vsphere-ui/server/conf/web.xml\n\nSet the <param-value> to \"false\" in all <param-name>listing</param-name>\nnodes.\n\nNote: The setting should look like the below:\n\n<init-param>\n      <param-name>listings</param-name>\n      <param-value>false</param-value>\n</init-param>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": null,
        "gid": null,
        "rid": "VCUI-67-000021",
        "stig_id": "VCUI-67-000021",
        "cci": null,
        "nist": null
      },
      "code": "control \"VCUI-67-000021\" do\n  title \"The vSphere UI must not show directory listings.\"\n  desc  \"Enumeration techniques, such as URL parameter manipulation, rely upon\nbeing able to obtain information about the web server's directory structure by\nlocating directories without default pages. In the scenario, the web server\nwill display to the user a listing of the files in the directory being\naccessed. Ensuring that directory listing is disabled is one approach to\nmitigating the vulnerability.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: \"VCUI-67-000021\"\n  tag stig_id: \"VCUI-67-000021\"\n  tag cci: nil\n  tag nist: nil\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/web.xml | sed\n's/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'//param-name[text()=\\\"listings\\\"]/parent::init-param' -\n\nExpected result:\n\n<init-param>\n      <param-name>listings</param-name>\n      <param-value>false</param-value>\n</init-param>\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-vsphere-ui/server/conf/web.xml\n\nSet the <param-value> to \\\"false\\\" in all <param-name>listing</param-name>\nnodes.\n\nNote: The setting should look like the below:\n\n<init-param>\n      <param-name>listings</param-name>\n      <param-value>false</param-value>\n</init-param>\"\n\n  describe.one do\n\n    describe xml('/usr/lib/vmware-vsphere-ui/server/conf/web.xml') do\n      its('/web-app/servlet/init-param[param-name=\"listings\"]/param-value') { should eq [] }\n    end\n\n    describe xml('/usr/lib/vmware-vsphere-ui/server/conf/web.xml') do\n      its('/web-app/servlet/init-param[param-name=\"listings\"]/param-value') { should cmp \"false\" }\n    end\n\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000021.rb",
        "line": 1
      },
      "id": "VCUI-67-000021"
    },
    {
      "title": "vSphere UI must limit the number of allowed connections.",
      "desc": "Limiting the number of established connections is a basic DoS\nprotection and a best practice. Servers where the limit is too high or\nunlimited can potentiall run out of system resources and negatively affect\nsystem availability.",
      "descriptions": {
        "default": "Limiting the number of established connections is a basic DoS\nprotection and a best practice. Servers where the limit is too high or\nunlimited can potentiall run out of system resources and negatively affect\nsystem availability.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/server.xml | sed '2\ns/xmlns=\".*\"//g' |  xmllint --xpath\n'/Server/Service/Connector[@port=\"${http.port}\"]/@acceptCount' -\n\nExpected result:\n\nacceptCount=\"300\"\n\nIf the output does not match the expected result, this is a finding",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-ui/server/conf/server.xml\n\nNavigate to the <Connector> configured with port=\"${http.port}\". Add or\nchange the folllowing value:\n\nacceptCount=\"300\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": null,
        "gid": null,
        "rid": "VCUI-67-000018",
        "stig_id": "VCUI-67-000018",
        "cci": null,
        "nist": null
      },
      "code": "control \"VCUI-67-000018\" do\n  title \"vSphere UI must limit the number of allowed connections.\"\n  desc  \"Limiting the number of established connections is a basic DoS\nprotection and a best practice. Servers where the limit is too high or\nunlimited can potentiall run out of system resources and negatively affect\nsystem availability.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: \"VCUI-67-000018\"\n  tag stig_id: \"VCUI-67-000018\"\n  tag cci: nil\n  tag nist: nil\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/server.xml | sed '2\ns/xmlns=\\\".*\\\"//g' |  xmllint --xpath\n'/Server/Service/Connector[@port=\\\"${http.port}\\\"]/@acceptCount' -\n\nExpected result:\n\nacceptCount=\\\"300\\\"\n\nIf the output does not match the expected result, this is a finding\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-ui/server/conf/server.xml\n\nNavigate to the <Connector> configured with port=\\\"${http.port}\\\". Add or\nchange the folllowing value:\n\nacceptCount=\\\"300\\\"\"\n \n  describe xml('/usr/lib/vmware-vsphere-ui/server/conf/server.xml') do\n    its(['Server/Service/Connector[@port=\\'${http.port}\\']/@acceptCount']) { should cmp '300'}\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000018.rb",
        "line": 1
      },
      "id": "VCUI-67-000018"
    },
    {
      "title": "vSphere UI application files must be verified for their integrity.",
      "desc": "Verifying that the vSphere UI application code is unchanged from it's\nshipping state is essential for file validation and non-repudiation of the\nvSphere UI itself. There is no reason that the MD5 hash of the rpm original\nfiles should be changed after installation, excluding configuration files.",
      "descriptions": {
        "default": "Verifying that the vSphere UI application code is unchanged from it's\nshipping state is essential for file validation and non-repudiation of the\nvSphere UI itself. There is no reason that the MD5 hash of the rpm original\nfiles should be changed after installation, excluding configuration files.",
        "check": "At the command prompt, execute the following command:\n\n# rpm -V vsphere-ui|grep \"^..5......\"|grep -E \"\\.war|\\.jar|\\.sh|\\.py\"\n\nIf is any output, this is a finding.",
        "fix": "Re-install the VCSA or roll back to a snapshot. Modifying the\nvSphere UI installation files manually is not supported by VMware."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000358-WSR-000163",
        "gid": null,
        "rid": "VCUI-67-000008",
        "stig_id": "VCUI-67-000008",
        "cci": "CCI-001851",
        "nist": [
          "AU-4 (1)",
          "Rev_4"
        ]
      },
      "code": "control \"VCUI-67-000008\" do\n  title \"vSphere UI application files must be verified for their integrity.\"\n  desc  \"Verifying that the vSphere UI application code is unchanged from it's\nshipping state is essential for file validation and non-repudiation of the\nvSphere UI itself. There is no reason that the MD5 hash of the rpm original\nfiles should be changed after installation, excluding configuration files.\"\n  impact 0.5  \n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000358-WSR-000163\"\n  tag gid: nil\n  tag rid: \"VCUI-67-000008\"\n  tag stig_id: \"VCUI-67-000008\"\n  tag cci: \"CCI-001851\"\n  tag nist: [\"AU-4 (1)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# rpm -V vsphere-ui|grep \\\"^..5......\\\"|grep -E \\\"\\\\.war|\\\\.jar|\\\\.sh|\\\\.py\\\"\n\nIf is any output, this is a finding.\"\n  desc 'fix', \"Re-install the VCSA or roll back to a snapshot. Modifying the\nvSphere UI installation files manually is not supported by VMware.\"\n\n  describe command('rpm -V vsphere-ui|grep \"^..5......\"|grep -E \"\\.war|\\.jar|\\.sh|\\.py\"') do\n    its ('stdout.strip') { should eq '' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000008.rb",
        "line": 1
      },
      "id": "VCUI-67-000008"
    },
    {
      "title": "vSphere UI must limit the number of concurrent connections permitted.",
      "desc": "Resource exhaustion can occur when an unlimited number of concurrent\nrequests are allowed on a web site, facilitating a denial of service attack.\nUnless the number of requests is controlled, the web server can consume enough\nsystem resources to cause a system crash.\n\n    Mitigating this kind of attack will include limiting the number of\nconcurrent HTTP/HTTPS requests. Each incoming request requires a thread for the\nduration of that request. If more simultaneous requests are received than can\nbe handled by the currently available request processing threads, additional\nthreads will be created up to the value of the 'maxThreads' attribute.",
      "descriptions": {
        "default": "Resource exhaustion can occur when an unlimited number of concurrent\nrequests are allowed on a web site, facilitating a denial of service attack.\nUnless the number of requests is controlled, the web server can consume enough\nsystem resources to cause a system crash.\n\n    Mitigating this kind of attack will include limiting the number of\nconcurrent HTTP/HTTPS requests. Each incoming request requires a thread for the\nduration of that request. If more simultaneous requests are received than can\nbe handled by the currently available request processing threads, additional\nthreads will be created up to the value of the 'maxThreads' attribute.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/server.xml | sed '2\ns/xmlns=\".*\"//g' |  xmllint --xpath\n'/Server/Service/Connector[@port=\"${http.port}\"]/@maxThreads' -\n\nExpected result:\n\nmaxThreads=\"800\"\n\nIf the output does not match the expected result, this is a finding",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-ui/server/conf/server.xml\n\nConfigure each <Connector> node with the value 'maxThreads=\"800\"'\n\nEx:\n\n<Connector .. maxThreads=\"800\" ..>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000266-WSR-000142",
        "gid": null,
        "rid": "VCUI-67-000002",
        "stig_id": "VCUI-67-000002",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCUI-67-000002\" do\n  title \"vSphere UI must limit the number of concurrent connections permitted.\"\n  desc  \"Resource exhaustion can occur when an unlimited number of concurrent\nrequests are allowed on a web site, facilitating a denial of service attack.\nUnless the number of requests is controlled, the web server can consume enough\nsystem resources to cause a system crash.\n\n    Mitigating this kind of attack will include limiting the number of\nconcurrent HTTP/HTTPS requests. Each incoming request requires a thread for the\nduration of that request. If more simultaneous requests are received than can\nbe handled by the currently available request processing threads, additional\nthreads will be created up to the value of the 'maxThreads' attribute.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000266-WSR-000142\"\n  tag gid: nil\n  tag rid: \"VCUI-67-000002\"\n  tag stig_id: \"VCUI-67-000002\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/server.xml | sed '2\ns/xmlns=\\\".*\\\"//g' |  xmllint --xpath\n'/Server/Service/Connector[@port=\\\"${http.port}\\\"]/@maxThreads' -\n\nExpected result:\n\nmaxThreads=\\\"800\\\"\n\nIf the output does not match the expected result, this is a finding\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-ui/server/conf/server.xml\n\nConfigure each <Connector> node with the value 'maxThreads=\\\"800\\\"'\n\nEx:\n\n<Connector .. maxThreads=\\\"800\\\" ..>\"\n\n  begin\n    vcui_conf = xml('/usr/lib/vmware-vsphere-ui/server/conf/server.xml')\n\n      if vcui_conf['Server/Service/Connector/attribute::maxThreads'].is_a?(Array)\n        vcui_conf['Server/Service/Connector/attribute::maxThreads'].each do |x|\n          describe x do\n            it { should eq \"800\" }\n          end\n        end\n      else\n        describe xml(vcui_conf['Server/Service/Connector/attribute::maxThreads']) do\n          it { should eq \"800\" }\n        end\n      end\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000002.rb",
        "line": 1
      },
      "id": "VCUI-67-000002"
    },
    {
      "title": "vSphere UI must disable the shutdown port.",
      "desc": "An attacker has at least two reasons to stop a web server. The first\nis to cause a DoS, and the second is to put in place changes the attacker made\nto the web server configuration. If the Tomcat shutdown port feature is\nenabled, a shutdown signal can be sent to vSphere UI through this port. To\nensure availability, the shutdown port must be disabled.",
      "descriptions": {
        "default": "An attacker has at least two reasons to stop a web server. The first\nis to cause a DoS, and the second is to put in place changes the attacker made\nto the web server configuration. If the Tomcat shutdown port feature is\nenabled, a shutdown signal can be sent to vSphere UI through this port. To\nensure availability, the shutdown port must be disabled.",
        "check": "At the command prompt, execute the following commands:\n\n# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/server.xml | sed '2\ns/xmlns=\".*\"//g' |  xmllint --xpath '/Server/@port' -\n\nExpected result:\n\nport=\"${shutdown.port}\"\n\nIf the output does not match the expected result, this is a finding.\n\n# grep shutdown /etc/vmware/vmware-vmon/svcCfgfiles/vsphere-ui.json\n\nExpected result:\n\n\"-Dshutdown.port=-1\",\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-ui/server/conf/server.xml\n\nMake sure that the server port is disabled:\n\n<Server port=\"${shutdown.port}\" ...>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": null,
        "gid": null,
        "rid": "VCUI-67-000029",
        "stig_id": "VCUI-67-000029",
        "cci": null,
        "nist": null
      },
      "code": "control \"VCUI-67-000029\" do\n  title \"vSphere UI must disable the shutdown port.\"\n  desc  \"An attacker has at least two reasons to stop a web server. The first\nis to cause a DoS, and the second is to put in place changes the attacker made\nto the web server configuration. If the Tomcat shutdown port feature is\nenabled, a shutdown signal can be sent to vSphere UI through this port. To\nensure availability, the shutdown port must be disabled.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: \"VCUI-67-000029\"\n  tag stig_id: \"VCUI-67-000029\"\n  tag cci: nil\n  tag nist: nil\n  desc 'check', \"At the command prompt, execute the following commands:\n\n# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/server.xml | sed '2\ns/xmlns=\\\".*\\\"//g' |  xmllint --xpath '/Server/@port' -\n\nExpected result:\n\nport=\\\"${shutdown.port}\\\"\n\nIf the output does not match the expected result, this is a finding.\n\n# grep shutdown /etc/vmware/vmware-vmon/svcCfgfiles/vsphere-ui.json\n\nExpected result:\n\n\\\"-Dshutdown.port=-1\\\",\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-ui/server/conf/server.xml\n\nMake sure that the server port is disabled:\n\n<Server port=\\\"${shutdown.port}\\\" ...>\"\n\n  describe xml('/usr/lib/vmware-vsphere-ui/server/conf/server.xml') do\n    its('Server/attribute::port') { should include '${shutdown.port}' }\n  end\n\n  describe json('/etc/vmware/vmware-vmon/svcCfgfiles/vsphere-ui.json') do\n    its('StartCommandArgs') { should include '-Dshutdown.port=-1'}\n  end\n\nend\n",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000029.rb",
        "line": 1
      },
      "id": "VCUI-67-000029"
    },
    {
      "title": "vSphere UI must not have the Web Distributed Authoring (WebDAV)\nservlet installed.",
      "desc": "Web Distributed Authoring (WebDAV) is an extension to the HTTP\nprotocol that, when developed, was meant to allow users to create, change, and\nmove documents on a server, typically a web server or web share. WebDAV is not\nwidely used and has serious security concerns because it may allow clients to\nmodify unauthorized files on the web server and must therefore be disabled.\n\n    Tomcat uses the org.apache.catalina.servlets.WebdavServlet servlet to\nprovide WebDAV services. Because the WebDAV service has been found to have an\nexcessive number of vulnerabilities, this servlet must not be installed.\nvSphere UI does not configure WebDAV by default.",
      "descriptions": {
        "default": "Web Distributed Authoring (WebDAV) is an extension to the HTTP\nprotocol that, when developed, was meant to allow users to create, change, and\nmove documents on a server, typically a web server or web share. WebDAV is not\nwidely used and has serious security concerns because it may allow clients to\nmodify unauthorized files on the web server and must therefore be disabled.\n\n    Tomcat uses the org.apache.catalina.servlets.WebdavServlet servlet to\nprovide WebDAV services. Because the WebDAV service has been found to have an\nexcessive number of vulnerabilities, this servlet must not be installed.\nvSphere UI does not configure WebDAV by default.",
        "check": "At the command prompt, execute the following command:\n\n# grep -n 'webdav' /usr/lib/vmware-vsphere-ui/server/conf/web.xml\n\nIf the command produces any output, this is a finding.",
        "fix": "Navigate to and open /usr/lib/vmware-vsphere-ui/server/conf/web.xml.\n\nFind the <servlet-name>webdav</servlet-name> node and remove the entire parent\n<servlet> block.\n\nFind the <servlet-name>webdav</servlet-name> node and remove the entire parent\n<servlet-mapping> block."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": null,
        "gid": null,
        "rid": "VCUI-67-000013",
        "stig_id": "VCUI-67-000013",
        "cci": null,
        "nist": null
      },
      "code": "control \"VCUI-67-000013\" do\n  title \"vSphere UI must not have the Web Distributed Authoring (WebDAV)\nservlet installed.\"\n  desc  \"Web Distributed Authoring (WebDAV) is an extension to the HTTP\nprotocol that, when developed, was meant to allow users to create, change, and\nmove documents on a server, typically a web server or web share. WebDAV is not\nwidely used and has serious security concerns because it may allow clients to\nmodify unauthorized files on the web server and must therefore be disabled.\n\n    Tomcat uses the org.apache.catalina.servlets.WebdavServlet servlet to\nprovide WebDAV services. Because the WebDAV service has been found to have an\nexcessive number of vulnerabilities, this servlet must not be installed.\nvSphere UI does not configure WebDAV by default.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: \"VCUI-67-000013\"\n  tag stig_id: \"VCUI-67-000013\"\n  tag cci: nil\n  tag nist: nil\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep -n 'webdav' /usr/lib/vmware-vsphere-ui/server/conf/web.xml\n\nIf the command produces any output, this is a finding.\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-vsphere-ui/server/conf/web.xml.\n\nFind the <servlet-name>webdav</servlet-name> node and remove the entire parent\n<servlet> block.\n\nFind the <servlet-name>webdav</servlet-name> node and remove the entire parent\n<servlet-mapping> block.\"\n\n  describe xml('/usr/lib/vmware-vsphere-ui/server/conf/web.xml') do\n    its('/web-app/servlet-mapping[servlet-name=\"webdav\"]') { should eq [] }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000013.rb",
        "line": 1
      },
      "id": "VCUI-67-000013"
    },
    {
      "title": "vSphere UI must limit the maximum size of a POST request.",
      "desc": "The 'maxPostSize' value is the maximum size in bytes of the POST which\nwill be handled by the container FORM URL parameter parsing. Limit its size to\nreduce exposure to a DOS attack. If 'maxPostSize' is not set, the default value\nof 2097152 (2MB) is used. Security Token Service is configured in it's shipping\nstate to not set a value for 'maxPostSize'.",
      "descriptions": {
        "default": "The 'maxPostSize' value is the maximum size in bytes of the POST which\nwill be handled by the container FORM URL parameter parsing. Limit its size to\nreduce exposure to a DOS attack. If 'maxPostSize' is not set, the default value\nof 2097152 (2MB) is used. Security Token Service is configured in it's shipping\nstate to not set a value for 'maxPostSize'.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/server.xml | sed '2\ns/xmlns=\".*\"//g' |  xmllint --xpath\n'/Server/Service/Connector[@port=\"${http.port}\"]/@maxPostSize' -\n\nExpected result:\n\nXPath set is empty\n\nIf the output does not match the expected result, this is a finding",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-ui/server/conf/server.xml\n\nNavigate to each of the <Connector> nodes.\n\nRemove any configuration for 'maxPostSize'."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000266-WSR-000159",
        "gid": null,
        "rid": "VCUI-67-000003",
        "stig_id": "VCUI-67-000003",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCUI-67-000003\" do\n  title \"vSphere UI must limit the maximum size of a POST request.\"\n  desc  \"The 'maxPostSize' value is the maximum size in bytes of the POST which\nwill be handled by the container FORM URL parameter parsing. Limit its size to\nreduce exposure to a DOS attack. If 'maxPostSize' is not set, the default value\nof 2097152 (2MB) is used. Security Token Service is configured in it's shipping\nstate to not set a value for 'maxPostSize'.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000266-WSR-000159\"\n  tag gid: nil\n  tag rid: \"VCUI-67-000003\"\n  tag stig_id: \"VCUI-67-000003\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/server.xml | sed '2\ns/xmlns=\\\".*\\\"//g' |  xmllint --xpath\n'/Server/Service/Connector[@port=\\\"${http.port}\\\"]/@maxPostSize' -\n\nExpected result:\n\nXPath set is empty\n\nIf the output does not match the expected result, this is a finding\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-ui/server/conf/server.xml\n\nNavigate to each of the <Connector> nodes.\n\nRemove any configuration for 'maxPostSize'.\n\"\n\n  describe xml('/usr/lib/vmware-vsphere-ui/server/conf/server.xml') do\n    its('Server/Service/Connector/attribute::maxPostSize') { should eq [] }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000003.rb",
        "line": 1
      },
      "id": "VCUI-67-000003"
    },
    {
      "title": "vSphere UI must not enable support for TRACE requests.",
      "desc": "\"Trace\" is a technique for a user to request internal information\nabout Tomcat. This is useful during product development, but should not be\nenabled in production.  Allowing a attacker to conduct a Trace operation\nagainst the Security Token Service will expose information that would be useful\nto perform a more targeted attack. vSphere UI provides the allowTrace parameter\nas means to disable responding to Trace requests.",
      "descriptions": {
        "default": "\"Trace\" is a technique for a user to request internal information\nabout Tomcat. This is useful during product development, but should not be\nenabled in production.  Allowing a attacker to conduct a Trace operation\nagainst the Security Token Service will expose information that would be useful\nto perform a more targeted attack. vSphere UI provides the allowTrace parameter\nas means to disable responding to Trace requests.",
        "check": "At the command prompt, execute the following command:\n\n# grep allowTrace /usr/lib/vmware-vsphere-ui/server/conf/server.xml\n\nIf allowTrace is set to \"true\", this is a finding. If no line is returned\nthis is NOT a finding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-ui/server/conf/server.xml\n\nNavigate to and locate 'allowTrace=\"true\"'\n\nRemove the 'allowTrace=\"true\"' setting."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": null,
        "gid": null,
        "rid": "VCUI-67-000024",
        "stig_id": "VCUI-67-000024",
        "cci": null,
        "nist": null
      },
      "code": "control \"VCUI-67-000024\" do\n  title \"vSphere UI must not enable support for TRACE requests.\"\n  desc  \"\\\"Trace\\\" is a technique for a user to request internal information\nabout Tomcat. This is useful during product development, but should not be\nenabled in production.  Allowing a attacker to conduct a Trace operation\nagainst the Security Token Service will expose information that would be useful\nto perform a more targeted attack. vSphere UI provides the allowTrace parameter\nas means to disable responding to Trace requests.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: \"VCUI-67-000024\"\n  tag stig_id: \"VCUI-67-000024\"\n  tag cci: nil\n  tag nist: nil\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep allowTrace /usr/lib/vmware-vsphere-ui/server/conf/server.xml\n\nIf allowTrace is set to \\\"true\\\", this is a finding. If no line is returned\nthis is NOT a finding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-ui/server/conf/server.xml\n\nNavigate to and locate 'allowTrace=\\\"true\\\"'\n\nRemove the 'allowTrace=\\\"true\\\"' setting.\"\n\n  describe.one do\n    describe xml('/usr/lib/vmware-vsphere-ui/server/conf/server.xml') do\n      its(['Server/Service/Connector/attribute::allowTrace']) { should eq [] }\n    end\n\n    describe xml('/usr/lib/vmware-vsphere-ui/server/conf/server.xml') do\n      its(['Server/Service/Connector/attribute::allowTrace']) { should cmp \"false\" }\n    end\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000024.rb",
        "line": 1
      },
      "id": "VCUI-67-000024"
    },
    {
      "title": "vSphere UI must be configured with memory leak protection.",
      "desc": "The Java Runtime environment can cause a memory leak or lock files\nunder certain conditions. Without memory leak protection, vSphere UI can\ncontinue to consume system resources which will lead to OutOfMemoryErrors when\nre-loading web applications.\n\n    Memory leaks occur when JRE code uses the context class loader to load a\nsingleton as this will cause a memory leak if a web application class loader\nhappens to be the context class loader at the time. The\nJreMemoryLeakPreventionListener class is designed to initialise these\nsingletons when Tomcat's common class loader is the context class loader.\nProper use of JRE memory leak protection will ensure that the hosted\napplication does not consume system resources and cause an unstable environment.",
      "descriptions": {
        "default": "The Java Runtime environment can cause a memory leak or lock files\nunder certain conditions. Without memory leak protection, vSphere UI can\ncontinue to consume system resources which will lead to OutOfMemoryErrors when\nre-loading web applications.\n\n    Memory leaks occur when JRE code uses the context class loader to load a\nsingleton as this will cause a memory leak if a web application class loader\nhappens to be the context class loader at the time. The\nJreMemoryLeakPreventionListener class is designed to initialise these\nsingletons when Tomcat's common class loader is the context class loader.\nProper use of JRE memory leak protection will ensure that the hosted\napplication does not consume system resources and cause an unstable environment.",
        "check": "At the command prompt, execute the following command:\n\n# grep JreMemoryLeakPreventionListener\n/usr/lib/vmware-vsphere-ui/server/conf/server.xml\n\nExpected result:\n\n\n\n<Listener\nclassName=\"org.apache.catalina.core.JreMemoryLeakPreventionListener\"/>\n\n\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-ui/server/conf/server.xml\n\nNavigate to the <Server> node.\n\nAdd '<Listener\nclassName=\"org.apache.catalina.core.JreMemoryLeakPreventionListener\"/>' to\nthe <Server> node."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": null,
        "gid": null,
        "rid": "VCUI-67-000014",
        "stig_id": "VCUI-67-000014",
        "cci": null,
        "nist": null
      },
      "code": "control \"VCUI-67-000014\" do\n  title \"vSphere UI must be configured with memory leak protection.\"\n  desc  \"The Java Runtime environment can cause a memory leak or lock files\nunder certain conditions. Without memory leak protection, vSphere UI can\ncontinue to consume system resources which will lead to OutOfMemoryErrors when\nre-loading web applications.\n\n    Memory leaks occur when JRE code uses the context class loader to load a\nsingleton as this will cause a memory leak if a web application class loader\nhappens to be the context class loader at the time. The\nJreMemoryLeakPreventionListener class is designed to initialise these\nsingletons when Tomcat's common class loader is the context class loader.\nProper use of JRE memory leak protection will ensure that the hosted\napplication does not consume system resources and cause an unstable environment.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: \"VCUI-67-000014\"\n  tag stig_id: \"VCUI-67-000014\"\n  tag cci: nil\n  tag nist: nil\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep JreMemoryLeakPreventionListener\n/usr/lib/vmware-vsphere-ui/server/conf/server.xml\n\nExpected result:\n\n\n\n<Listener\nclassName=\\\"org.apache.catalina.core.JreMemoryLeakPreventionListener\\\"/>\n\n\n\nIf the output of the command does not match the expected result, this is a\nfinding.\n\n\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-ui/server/conf/server.xml\n\nNavigate to the <Server> node.\n\nAdd '<Listener\nclassName=\\\"org.apache.catalina.core.JreMemoryLeakPreventionListener\\\"/>' to\nthe <Server> node.\"\n\n  describe xml('/usr/lib/vmware-vsphere-ui/server/conf/server.xml') do\n    its('Server/Listener/attribute::className') { should include 'org.apache.catalina.core.JreMemoryLeakPreventionListener' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000014.rb",
        "line": 1
      },
      "id": "VCUI-67-000014"
    },
    {
      "title": "vSphere UI must have the debug option turned off.",
      "desc": "Information needed by an attacker to begin looking for possible\nvulnerabilities in a web server includes any information about the web server\nand plug-ins or modules being used. When debugging or trace information is\nenabled in a production web server, information about the web server, such as\nweb server type, version, patches installed, plug-ins and modules installed,\ntype of code being used by the hosted application, and any backends being used\nfor data storage may be displayed. Since this information may be placed in logs\nand general messages during normal operation of the web server, an attacker\ndoes not need to cause an error condition to gain this information.\n\n    vSphere UI can be configured to set the debugging level.  By setting the\ndebugging level to zero (0), no debugging information will be provided to a\nmalicious user.",
      "descriptions": {
        "default": "Information needed by an attacker to begin looking for possible\nvulnerabilities in a web server includes any information about the web server\nand plug-ins or modules being used. When debugging or trace information is\nenabled in a production web server, information about the web server, such as\nweb server type, version, patches installed, plug-ins and modules installed,\ntype of code being used by the hosted application, and any backends being used\nfor data storage may be displayed. Since this information may be placed in logs\nand general messages during normal operation of the web server, an attacker\ndoes not need to cause an error condition to gain this information.\n\n    vSphere UI can be configured to set the debugging level.  By setting the\ndebugging level to zero (0), no debugging information will be provided to a\nmalicious user.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/web.xml | sed\n's/xmlns=\".*\"//g' | xmllint --xpath\n'//param-name[text()=\"debug\"]/parent::init-param' -\n\nExpected result:\n\n<init-param>\n      <param-name>debug</param-name>\n      <param-value>0</param-value>\n    </init-param>\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open /usr/lib/vmware-vsphere-ui/server/conf/web.xml\n\nNavigate to all <debug> nodes that are not set to \"0\".\n\nSet the <param-value> to \"0\" in all <param-name>debug</param-name> nodes.\n\nNote: The debug setting should look like the below:\n\n <init-param>\n <param-name>debug</param-name>\n <param-value>0</param-value>\n </init-param>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": null,
        "gid": null,
        "rid": "VCUI-67-000025",
        "stig_id": "VCUI-67-000025",
        "cci": null,
        "nist": null
      },
      "code": "control \"VCUI-67-000025\" do\n  title \"vSphere UI must have the debug option turned off.\"\n  desc  \"Information needed by an attacker to begin looking for possible\nvulnerabilities in a web server includes any information about the web server\nand plug-ins or modules being used. When debugging or trace information is\nenabled in a production web server, information about the web server, such as\nweb server type, version, patches installed, plug-ins and modules installed,\ntype of code being used by the hosted application, and any backends being used\nfor data storage may be displayed. Since this information may be placed in logs\nand general messages during normal operation of the web server, an attacker\ndoes not need to cause an error condition to gain this information.\n\n    vSphere UI can be configured to set the debugging level.  By setting the\ndebugging level to zero (0), no debugging information will be provided to a\nmalicious user.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: \"VCUI-67-000025\"\n  tag stig_id: \"VCUI-67-000025\"\n  tag cci: nil\n  tag nist: nil\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/web.xml | sed\n's/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'//param-name[text()=\\\"debug\\\"]/parent::init-param' -\n\nExpected result:\n\n<init-param>\n      <param-name>debug</param-name>\n      <param-value>0</param-value>\n    </init-param>\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-vsphere-ui/server/conf/web.xml\n\nNavigate to all <debug> nodes that are not set to \\\"0\\\".\n\nSet the <param-value> to \\\"0\\\" in all <param-name>debug</param-name> nodes.\n\nNote: The debug setting should look like the below:\n\n <init-param>\n <param-name>debug</param-name>\n <param-value>0</param-value>\n </init-param>\"\n\n  describe.one do\n\n    describe xml('/usr/lib/vmware-vsphere-ui/server/conf/web.xml') do\n      its('/web-app/servlet/init-param[param-name=\"debug\"]/param-value') { should eq [] }\n    end\n\n    describe xml('/usr/lib/vmware-vsphere-ui/server/conf/web.xml') do\n      its('/web-app/servlet/init-param[param-name=\"debug\"]/param-value') { should cmp \"0\" }\n    end\n\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000025.rb",
        "line": 1
      },
      "id": "VCUI-67-000025"
    },
    {
      "title": "vSphere UI must not be configured with unsupported realms.",
      "desc": "vSphere UI performs user authentication at the\napplication level and not through Tomcat. In the name of eliminating\nunnecessary features and to ensure that the vSphere UI remains in\nit's shipping state, the lack of a UserDatabaseRealm configuration must be\nconfirmed.",
      "descriptions": {
        "default": "vSphere UI performs user authentication at the\napplication level and not through Tomcat. In the name of eliminating\nunnecessary features and to ensure that the vSphere UI remains in\nit's shipping state, the lack of a UserDatabaseRealm configuration must be\nconfirmed.",
        "check": "At the command prompt, execute the following command:\n\n# grep UserDatabaseRealm /usr/lib/vmware-vsphere-ui/server/conf/server.xml\n\nIf the command produces any output, this is a finding.",
        "fix": "Navigate to and open /usr/lib/vmware-vsphere-ui/server/conf/server.xml\n. Remove the <Realm> node returned in the check."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000141-WSR-000015",
        "gid": null,
        "rid": "VCUI-67-000031",
        "stig_id": "VCUI-67-000031",
        "cci": "CCI-000381",
        "nist": [
          "CM-7 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCUI-67-000031\" do\n  title \"vSphere UI must not be configured with unsupported realms.\"\n  desc  \"vSphere UI performs user authentication at the\napplication level and not through Tomcat. In the name of eliminating\nunnecessary features and to ensure that the vSphere UI remains in\nit's shipping state, the lack of a UserDatabaseRealm configuration must be\nconfirmed.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000141-WSR-000015\"\n  tag gid: nil\n  tag rid: \"VCUI-67-000031\"\n  tag stig_id: \"VCUI-67-000031\"\n  tag cci: \"CCI-000381\"\n  tag nist: [\"CM-7 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep UserDatabaseRealm /usr/lib/vmware-vsphere-ui/server/conf/server.xml\n\nIf the command produces any output, this is a finding.\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-vsphere-ui/server/conf/server.xml\n. Remove the <Realm> node returned in the check.\"\n\n  describe command('grep UserDatabaseRealm /usr/lib/vmware-vsphere-ui/server/conf/server.xml') do\n    its ('stdout.strip') { should eq '' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000031.rb",
        "line": 1
      },
      "id": "VCUI-67-000031"
    },
    {
      "title": "vSphere UI must generate log records for system startup and shutdown.",
      "desc": "Logging must be started as soon as possible when a service starts and\nwhen a service is stopped. Many forms of suspicious actions can be detected by\nanalyzing logs for unexpected service starts and stops. Also, by starting to\nlog immediately after a service starts, it becomes more difficult for suspicous\nactivity to go un-logged.\n\n    On the VCSA, the vmware-vmon service starts up the JVMs for various vCenter\nprocesses, including vSphere UI, and the individual json config files control\nthe early jvm logging. Ensuring these json files are configured correctly\nenables early java stdout and stderr logging.",
      "descriptions": {
        "default": "Logging must be started as soon as possible when a service starts and\nwhen a service is stopped. Many forms of suspicious actions can be detected by\nanalyzing logs for unexpected service starts and stops. Also, by starting to\nlog immediately after a service starts, it becomes more difficult for suspicous\nactivity to go un-logged.\n\n    On the VCSA, the vmware-vmon service starts up the JVMs for various vCenter\nprocesses, including vSphere UI, and the individual json config files control\nthe early jvm logging. Ensuring these json files are configured correctly\nenables early java stdout and stderr logging.",
        "check": "At the command prompt, execute the following command:\n\n# grep StreamRedirectFile /etc/vmware/vmware-vmon/svcCfgfiles/vsphere-ui.json\n\nExpected result:\n\n\"StreamRedirectFile\":\n\"%VMWARE_LOG_DIR%/vmware/vsphere-ui/logs/vsphere-ui-runtime.log\",\n\nIf there is no log file specified for the StreamRedirectFile setting, this is a\nfinding.",
        "fix": "Navigate to and open\n/etc/vmware/vmware-vmon/svcCfgfiles/vsphere-ui.json . Below the last line of\nthe 'PreStartCommandArg' block add or re-configure the following line:\n\n\"StreamRedirectFile\":\n\"%VMWARE_LOG_DIR%/vmware/vsphere-ui/logs/vsphere-ui-runtime.log\",\n\nRestart the appliance for changes to take effect."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000266-WSR-000160",
        "gid": null,
        "rid": "VCUI-67-000006",
        "stig_id": "VCUI-67-000006",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCUI-67-000006\" do\n  title \"vSphere UI must generate log records for system startup and shutdown.\"\n  desc  \"Logging must be started as soon as possible when a service starts and\nwhen a service is stopped. Many forms of suspicious actions can be detected by\nanalyzing logs for unexpected service starts and stops. Also, by starting to\nlog immediately after a service starts, it becomes more difficult for suspicous\nactivity to go un-logged.\n\n    On the VCSA, the vmware-vmon service starts up the JVMs for various vCenter\nprocesses, including vSphere UI, and the individual json config files control\nthe early jvm logging. Ensuring these json files are configured correctly\nenables early java stdout and stderr logging.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000266-WSR-000160\"\n  tag gid: nil\n  tag rid: \"VCUI-67-000006\"\n  tag stig_id: \"VCUI-67-000006\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep StreamRedirectFile /etc/vmware/vmware-vmon/svcCfgfiles/vsphere-ui.json\n\nExpected result:\n\n\\\"StreamRedirectFile\\\":\n\\\"%VMWARE_LOG_DIR%/vmware/vsphere-ui/logs/vsphere-ui-runtime.log\\\",\n\nIf there is no log file specified for the StreamRedirectFile setting, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open\n/etc/vmware/vmware-vmon/svcCfgfiles/vsphere-ui.json . Below the last line of\nthe 'PreStartCommandArg' block add or re-configure the following line:\n\n\\\"StreamRedirectFile\\\":\n\\\"%VMWARE_LOG_DIR%/vmware/vsphere-ui/logs/vsphere-ui-runtime.log\\\",\n\nRestart the appliance for changes to take effect.\"\n\n  describe json('/etc/vmware/vmware-vmon/svcCfgfiles/vsphere-ui.json') do\n    its('StreamRedirectFile') { should eq '%VMWARE_LOG_DIR%/vmware/vsphere-ui/logs/vsphere-ui-runtime.log'}\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000006.rb",
        "line": 1
      },
      "id": "VCUI-67-000006"
    },
    {
      "title": "vSphere UI directory tree must have permissions in an \"out of the\nbox\" state.",
      "desc": "As a rule, accounts on a web server are to be kept to a minimum. Only\nadministrators, web managers, developers, auditors, and web authors require\naccounts on the machine hosting the web server. The resources to which these\naccounts have access must also be closely monitored and controlled. The vSphere\nUI files must be adequately protected with correct permissions as applied \"out\nof the box\".",
      "descriptions": {
        "default": "As a rule, accounts on a web server are to be kept to a minimum. Only\nadministrators, web managers, developers, auditors, and web authors require\naccounts on the machine hosting the web server. The resources to which these\naccounts have access must also be closely monitored and controlled. The vSphere\nUI files must be adequately protected with correct permissions as applied \"out\nof the box\".",
        "check": "At the command prompt, execute the following command:\n\n# find /usr/lib/vmware-vsphere-ui/server/lib\n/usr/lib/vmware-vsphere-ui/server/conf -xdev -type f -a '(' -perm -o+w -o -not\n-user vsphere-ui -o -not -group root ')' -exec ls -ld {} \\;\n\nIf the command produces any output, this is a finding.",
        "fix": "At the command prompt, execute the following command:\n\n\n# chmod o-w <file>\n\n# chown vsphere-ui:root <file>\n\nRepeat the command for each file that was returned"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": null,
        "gid": null,
        "rid": "VCUI-67-000016",
        "stig_id": "VCUI-67-000016",
        "cci": null,
        "nist": null
      },
      "code": "control \"VCUI-67-000016\" do\n  title \"vSphere UI directory tree must have permissions in an \\\"out of the\nbox\\\" state.\"\n  desc  \"As a rule, accounts on a web server are to be kept to a minimum. Only\nadministrators, web managers, developers, auditors, and web authors require\naccounts on the machine hosting the web server. The resources to which these\naccounts have access must also be closely monitored and controlled. The vSphere\nUI files must be adequately protected with correct permissions as applied \\\"out\nof the box\\\".\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: \"VCUI-67-000016\"\n  tag stig_id: \"VCUI-67-000016\"\n  tag cci: nil\n  tag nist: nil\n  desc 'check', \"At the command prompt, execute the following command:\n\n# find /usr/lib/vmware-vsphere-ui/server/lib\n/usr/lib/vmware-vsphere-ui/server/conf -xdev -type f -a '(' -perm -o+w -o -not\n-user vsphere-ui -o -not -group root ')' -exec ls -ld {} \\\\;\n\nIf the command produces any output, this is a finding.\"\n  desc 'fix', \"At the command prompt, execute the following command:\n\n\n# chmod o-w <file>\n\n# chown vsphere-ui:root <file>\n\nRepeat the command for each file that was returned\n\"\n\n  command('find /usr/lib/vmware-vsphere-ui/server/lib /usr/lib/vmware-vsphere-ui/server/conf -xdev -type f').stdout.split.each do | fname |\n    describe file(fname) do\n      it { should_not be_more_permissive_than('0770') }\n      its('owner') {should eq 'vsphere-ui'}\n      its('group') {should eq 'root'}\n    end\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000016.rb",
        "line": 1
      },
      "id": "VCUI-67-000016"
    },
    {
      "title": "vSphere UI must not have any symbolic links in the web content\ndirectory tree.",
      "desc": "A web server is designed to deliver content and execute scripts or\napplications on the request of a client or user. Containing user requests to\nfiles in the directory tree of the hosted web application and limiting the\nexecution of scripts and applications guarantees that the user is not accessing\ninformation protected outside the application's realm. By checking that no\nsymbolic links exist in the document root, the web server is protected from\nusers jumping outside the hosted application directory tree and gaining access\nto the other directories, including the system root.",
      "descriptions": {
        "default": "A web server is designed to deliver content and execute scripts or\napplications on the request of a client or user. Containing user requests to\nfiles in the directory tree of the hosted web application and limiting the\nexecution of scripts and applications guarantees that the user is not accessing\ninformation protected outside the application's realm. By checking that no\nsymbolic links exist in the document root, the web server is protected from\nusers jumping outside the hosted application directory tree and gaining access\nto the other directories, including the system root.",
        "check": "At the command prompt, execute the following command:\n\n# find /usr/lib/vmware-vsphere-ui/server/static/ -type l -ls\n\nIf the command produces any output, this is a finding.",
        "fix": "At the command prompt, execute the following commands:\n\nNote: Replace <file_name> for the name of any files that were returned.\n\nunlink <file_name>\n\nRepeat the commands for each file that was returned."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": null,
        "gid": null,
        "rid": "VCUI-67-000015",
        "stig_id": "VCUI-67-000015",
        "cci": null,
        "nist": null
      },
      "code": "control \"VCUI-67-000015\" do\n  title \"vSphere UI must not have any symbolic links in the web content\ndirectory tree.\"\n  desc  \"A web server is designed to deliver content and execute scripts or\napplications on the request of a client or user. Containing user requests to\nfiles in the directory tree of the hosted web application and limiting the\nexecution of scripts and applications guarantees that the user is not accessing\ninformation protected outside the application's realm. By checking that no\nsymbolic links exist in the document root, the web server is protected from\nusers jumping outside the hosted application directory tree and gaining access\nto the other directories, including the system root.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: \"VCUI-67-000015\"\n  tag stig_id: \"VCUI-67-000015\"\n  tag cci: nil\n  tag nist: nil\n  desc 'check', \"At the command prompt, execute the following command:\n\n# find /usr/lib/vmware-vsphere-ui/server/static/ -type l -ls\n\nIf the command produces any output, this is a finding.\"\n  desc 'fix', \"At the command prompt, execute the following commands:\n\nNote: Replace <file_name> for the name of any files that were returned.\n\nunlink <file_name>\n\nRepeat the commands for each file that was returned.\"\n\n  describe command('find /usr/lib/vmware-vsphere-ui/server/static/ -type l -ls') do\n    its ('stdout.strip') { should eq '' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000015.rb",
        "line": 1
      },
      "id": "VCUI-67-000015"
    },
    {
      "title": "vSphere UI must must be configured with the appropriate ports.",
      "desc": "Web servers provide numerous processes, features, and functionalities\nthat utilize TCP/IP ports. Some of these processes may be deemed unnecessary or\ntoo unsecure to run on a production system. The ports that vSphere UI listens\non are configured in the catalina.properties file and must be veriified as\naccurate to their shipping state.",
      "descriptions": {
        "default": "Web servers provide numerous processes, features, and functionalities\nthat utilize TCP/IP ports. Some of these processes may be deemed unnecessary or\ntoo unsecure to run on a production system. The ports that vSphere UI listens\non are configured in the catalina.properties file and must be veriified as\naccurate to their shipping state.",
        "check": "At the command prompt, execute the following command:\n\n# grep '.port' /usr/lib/vmware-vsphere-ui/server/conf/catalina.properties\n\nExpected result:\n\nhttp.port=5090\nproxy.port=443\nhttps.port=5443\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-ui/server/conf/catalina.properties\n\nNavigate to the ports specification section.\n\nSet the vSphere UI port specifications according to the shipping configuration\nbelow:\n\nhttp.port=5090\nproxy.port=443\nhttps.port=5443"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": null,
        "gid": null,
        "rid": "VCUI-67-000028",
        "stig_id": "VCUI-67-000028",
        "cci": null,
        "nist": null
      },
      "code": "control \"VCUI-67-000028\" do\n  title \"vSphere UI must must be configured with the appropriate ports.\"\n  desc  \"Web servers provide numerous processes, features, and functionalities\nthat utilize TCP/IP ports. Some of these processes may be deemed unnecessary or\ntoo unsecure to run on a production system. The ports that vSphere UI listens\non are configured in the catalina.properties file and must be veriified as\naccurate to their shipping state.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: \"VCUI-67-000028\"\n  tag stig_id: \"VCUI-67-000028\"\n  tag cci: nil\n  tag nist: nil\n  desc 'check', \"At the command prompt, execute the following command:\n\n# grep '.port' /usr/lib/vmware-vsphere-ui/server/conf/catalina.properties\n\nExpected result:\n\nhttp.port=5090\nproxy.port=443\nhttps.port=5443\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-ui/server/conf/catalina.properties\n\nNavigate to the ports specification section.\n\nSet the vSphere UI port specifications according to the shipping configuration\nbelow:\n\nhttp.port=5090\nproxy.port=443\nhttps.port=5443\"\n\n  describe parse_config_file('/usr/lib/vmware-vsphere-ui/server/conf/catalina.properties').params['http.port'] do\n    it { should eq '5090' }\n  end\n  describe parse_config_file('/usr/lib/vmware-vsphere-ui/server/conf/catalina.properties').params['proxy.port'] do\n    it { should eq '443' }\n  end\n  describe parse_config_file('/usr/lib/vmware-vsphere-ui/server/conf/catalina.properties').params['https.port'] do\n    it { should eq '5443' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000028.rb",
        "line": 1
      },
      "id": "VCUI-67-000028"
    },
    {
      "title": "vSphere UI plugins must be authorized before use.",
      "desc": "The vSphere UI ships with a number of plugins out of the box. Any\nadditional plugins may affect the availability and integrity of the system and\nmust be approved and documented by the ISSO before deployment.",
      "descriptions": {
        "default": "The vSphere UI ships with a number of plugins out of the box. Any\nadditional plugins may affect the availability and integrity of the system and\nmust be approved and documented by the ISSO before deployment.",
        "check": "At the command prompt, execute the following command:\n\n# diff <(find /usr/lib/vmware-vsphere-ui/plugin-packages/vsphere-client/plugins\n-type f|sort) <(rpm -ql vsphere-ui|grep\n\"/usr/lib/vmware-vsphere-ui/plugin-packages/vsphere-client/plugins/\"|sort)\n\nIf there is any output, this indicates a vSphere UI plugin is present that does\nnot ship with the VCSA. If this plugin is not know and approved, this is a\nfinding.",
        "fix": "For every unauthorized plugin returned by the check, run the\nfollowing command.\n\n# rm <file>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000380-WSR-000072",
        "gid": null,
        "rid": "VCUI-67-000009",
        "stig_id": "VCUI-67-000009",
        "cci": "CCI-001813",
        "nist": [
          "CM-5 (1)",
          "Rev_4"
        ]
      },
      "code": "control \"VCUI-67-000009\" do\n  title \"vSphere UI plugins must be authorized before use.\"\n  desc  \"The vSphere UI ships with a number of plugins out of the box. Any\nadditional plugins may affect the availability and integrity of the system and\nmust be approved and documented by the ISSO before deployment.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000380-WSR-000072\"\n  tag gid: nil\n  tag rid: \"VCUI-67-000009\"\n  tag stig_id: \"VCUI-67-000009\"\n  tag cci: \"CCI-001813\"\n  tag nist: [\"CM-5 (1)\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# diff <(find /usr/lib/vmware-vsphere-ui/plugin-packages/vsphere-client/plugins\n-type f|sort) <(rpm -ql vsphere-ui|grep\n\\\"/usr/lib/vmware-vsphere-ui/plugin-packages/vsphere-client/plugins/\\\"|sort)\n\nIf there is any output, this indicates a vSphere UI plugin is present that does\nnot ship with the VCSA. If this plugin is not know and approved, this is a\nfinding.\"\n  desc 'fix', \"For every unauthorized plugin returned by the check, run the\nfollowing command.\n\n# rm <file>\"\n\n  describe command('diff <(find /usr/lib/vmware-vsphere-ui/plugin-packages/vsphere-client/plugins -type f|sort) <(rpm -ql vsphere-ui|grep \"/usr/lib/vmware-vsphere-ui/plugin-packages/vsphere-client/plugins/\"|sort)') do\n    its ('stdout.strip') { should eq '' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000009.rb",
        "line": 1
      },
      "id": "VCUI-67-000009"
    },
    {
      "title": "vSphere UI must record user access in a format that enables monitoring\nof remote access.",
      "desc": "Remote access can be exploited by an attacker to compromise the\nserver.  By recording all remote access activities, it will be possible to\ndetermine the attacker's location, intent, and degree of success.\n\n    Tomcat can be configured with an AccessLogValve, a component that can be\ninserted into the request processing pipeline to provide robust access logging.\nThe Access Log Valve creates log files in the same format as those created by\nstandard web servers. When AccessLogValve is properly configured, log files\nwill contain all the forensic information necessary in the case of a security\nincident.",
      "descriptions": {
        "default": "Remote access can be exploited by an attacker to compromise the\nserver.  By recording all remote access activities, it will be possible to\ndetermine the attacker's location, intent, and degree of success.\n\n    Tomcat can be configured with an AccessLogValve, a component that can be\ninserted into the request processing pipeline to provide robust access logging.\nThe Access Log Valve creates log files in the same format as those created by\nstandard web servers. When AccessLogValve is properly configured, log files\nwill contain all the forensic information necessary in the case of a security\nincident.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/server.xml | xmllint\n--xpath\n'/Server/Service/Engine/Host/Valve[@className=\"org.apache.catalina.valves.AccessLogValve\"]'/@pattern\n-\n\nExpected result:\n\npattern=\"%h %{x-forwarded-for}i %l %u %t &quot;%r&quot; %s %b\n%{#hashedSessionId#}s %I %D\"\n\nIf the output does not match the expected result, this is a finding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-ui/server/conf/server.xml\n\nEnsure the log pattern in log pattern in the\n\"org.apache.catalina.valves.AccessLogValve\" node is set to the following:\n\npattern=\"%h %{x-forwarded-for}i %l %u %t &quot;%r&quot; %s %b\n%{#hashedSessionId#}s %I %D\""
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000266-WSR-000160",
        "gid": null,
        "rid": "VCUI-67-000005",
        "stig_id": "VCUI-67-000005",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCUI-67-000005\" do\n  title \"vSphere UI must record user access in a format that enables monitoring\nof remote access.\"\n  desc  \"Remote access can be exploited by an attacker to compromise the\nserver.  By recording all remote access activities, it will be possible to\ndetermine the attacker's location, intent, and degree of success.\n\n    Tomcat can be configured with an AccessLogValve, a component that can be\ninserted into the request processing pipeline to provide robust access logging.\nThe Access Log Valve creates log files in the same format as those created by\nstandard web servers. When AccessLogValve is properly configured, log files\nwill contain all the forensic information necessary in the case of a security\nincident.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000266-WSR-000160\"\n  tag gid: nil\n  tag rid: \"VCUI-67-000005\"\n  tag stig_id: \"VCUI-67-000005\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/server.xml | xmllint\n--xpath\n'/Server/Service/Engine/Host/Valve[@className=\\\"org.apache.catalina.valves.AccessLogValve\\\"]'/@pattern\n-\n\nExpected result:\n\npattern=\\\"%h %{x-forwarded-for}i %l %u %t &quot;%r&quot; %s %b\n%{#hashedSessionId#}s %I %D\\\"\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-ui/server/conf/server.xml\n\nEnsure the log pattern in log pattern in the\n\\\"org.apache.catalina.valves.AccessLogValve\\\" node is set to the following:\n\npattern=\\\"%h %{x-forwarded-for}i %l %u %t &quot;%r&quot; %s %b\n%{#hashedSessionId#}s %I %D\\\"\"\n\n  describe xml('/usr/lib/vmware-vsphere-ui/server/conf/server.xml') do\n    its(['Server/Service/Engine/Host/Valve/attribute::pattern']) { should cmp ['%h %{x-forwarded-for}i %l %u %t &quot;%r&quot; %s %b %{#hashedSessionId#}s %I %D'] }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000005.rb",
        "line": 1
      },
      "id": "VCUI-67-000005"
    },
    {
      "title": "vSphere UI must fail to a known safe state if system initialization\nfails, shutdown fails, or aborts fail.",
      "desc": "Determining a safe state for failure and weighing that against a\npotential DoS for users depends on what type of application the web server is\nhosting. For the Security Token Service, it is preferable that the service\nabort startup on any initialization failure rather than continuing in a\ndegraded, and potentailly insecure, state.",
      "descriptions": {
        "default": "Determining a safe state for failure and weighing that against a\npotential DoS for users depends on what type of application the web server is\nhosting. For the Security Token Service, it is preferable that the service\nabort startup on any initialization failure rather than continuing in a\ndegraded, and potentailly insecure, state.",
        "check": "At the command line, execute the following command:\n\n# grep EXIT_ON_INIT_FAILURE\n/usr/lib/vmware-vsphere-ui/server/conf/catalina.properties\n\nExpected result :\n\norg.apache.catalina.startup.EXIT_ON_INIT_FAILURE=true\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open /etc/vmware-eam/catalina.properties\n\nAdd or change the following line:\n\norg.apache.catalina.startup.EXIT_ON_INIT_FAILURE=true"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": null,
        "gid": null,
        "rid": "VCUI-67-000017",
        "stig_id": "VCUI-67-000017",
        "cci": null,
        "nist": null
      },
      "code": "control \"VCUI-67-000017\" do\n  title \"vSphere UI must fail to a known safe state if system initialization\nfails, shutdown fails, or aborts fail.\"\n  desc  \"Determining a safe state for failure and weighing that against a\npotential DoS for users depends on what type of application the web server is\nhosting. For the Security Token Service, it is preferable that the service\nabort startup on any initialization failure rather than continuing in a\ndegraded, and potentailly insecure, state.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: \"VCUI-67-000017\"\n  tag stig_id: \"VCUI-67-000017\"\n  tag cci: nil\n  tag nist: nil\n  desc 'check', \"At the command line, execute the following command:\n\n# grep EXIT_ON_INIT_FAILURE\n/usr/lib/vmware-vsphere-ui/server/conf/catalina.properties\n\nExpected result :\n\norg.apache.catalina.startup.EXIT_ON_INIT_FAILURE=true\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open /etc/vmware-eam/catalina.properties\n\nAdd or change the following line:\n\norg.apache.catalina.startup.EXIT_ON_INIT_FAILURE=true\"\n\n  describe parse_config_file('/usr/lib/vmware-vsphere-ui/server/conf/catalina.properties').params['org.apache.catalina.startup.EXIT_ON_INIT_FAILURE'] do\n    it { should eq 'true' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000017.rb",
        "line": 1
      },
      "id": "VCUI-67-000017"
    },
    {
      "title": "vSphere UI must limit the amount of time that each TCP connection is\nkept alive.",
      "desc": "Denial of Service is one threat against web servers.  Many DoS attacks\nattempt to consume web server resources in such a way that no more resources\nare available to satisfy legitimate requests.\n\n    In Tomcat, the 'connectionTimeout' attribute sets the number of\nmilliseconds the server will wait after accepting a connection for the request\nURI line to be presented. This timeout will also be used when reading the\nrequest body (if any). This prevents idle sockets that are not sending HTTP\nrequests from consuming system resources and potentially denying new\nconnections.",
      "descriptions": {
        "default": "Denial of Service is one threat against web servers.  Many DoS attacks\nattempt to consume web server resources in such a way that no more resources\nare available to satisfy legitimate requests.\n\n    In Tomcat, the 'connectionTimeout' attribute sets the number of\nmilliseconds the server will wait after accepting a connection for the request\nURI line to be presented. This timeout will also be used when reading the\nrequest body (if any). This prevents idle sockets that are not sending HTTP\nrequests from consuming system resources and potentially denying new\nconnections.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/server.xml | sed '2\ns/xmlns=\".*\"//g' |  xmllint --xpath\n'/Server/Service/Connector[@port=\"${http.port}\"]/@connectionTimeout' -\n\nExpected result:\n\nconnectionTimeout=\"20000\"\n\nIf the output does not match the expected result, this is a finding",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-ui/server/conf/server.xml\n\nConfigure the http <Connector> node with the value 'connectionTimeout=\"20000\"'\n\nEx:<Connector .. connectionTimeout=\"20000\" ..>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000266-WSR-000142",
        "gid": null,
        "rid": "VCUI-67-000001",
        "stig_id": "VCUI-67-000001",
        "cci": "CCI-001312",
        "nist": [
          "SI-11 a",
          "Rev_4"
        ]
      },
      "code": "control \"VCUI-67-000001\" do\n  title \"vSphere UI must limit the amount of time that each TCP connection is\nkept alive.\"\n  desc  \"Denial of Service is one threat against web servers.  Many DoS attacks\nattempt to consume web server resources in such a way that no more resources\nare available to satisfy legitimate requests.\n\n    In Tomcat, the 'connectionTimeout' attribute sets the number of\nmilliseconds the server will wait after accepting a connection for the request\nURI line to be presented. This timeout will also be used when reading the\nrequest body (if any). This prevents idle sockets that are not sending HTTP\nrequests from consuming system resources and potentially denying new\nconnections.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000266-WSR-000142\"\n  tag gid: nil\n  tag rid: \"VCUI-67-000001\"\n  tag stig_id: \"VCUI-67-000001\"\n  tag cci: \"CCI-001312\"\n  tag nist: [\"SI-11 a\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/server.xml | sed '2\ns/xmlns=\\\".*\\\"//g' |  xmllint --xpath\n'/Server/Service/Connector[@port=\\\"${http.port}\\\"]/@connectionTimeout' -\n\nExpected result:\n\nconnectionTimeout=\\\"20000\\\"\n\nIf the output does not match the expected result, this is a finding\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-ui/server/conf/server.xml\n\nConfigure the http <Connector> node with the value 'connectionTimeout=\\\"20000\\\"'\n\nEx:<Connector .. connectionTimeout=\\\"20000\\\" ..>\"\n\n  begin\n    vcui_conf = xml('/usr/lib/vmware-vsphere-ui/server/conf/server.xml')\n\n      if vcui_conf['Server/Service/Connector/attribute::connectionTimeout'].is_a?(Array)\n        vcui_conf['Server/Service/Connector/attribute::connectionTimeout'].each do |x|\n          describe x do\n            it { should eq \"20000\" }\n          end\n        end\n      else\n        describe xml(vcui_conf['Server/Service/Connector/attribute::connectionTimeout']) do\n          it { should eq \"20000\" }\n        end\n      end\n  end\n  \nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000001.rb",
        "line": 1
      },
      "id": "VCUI-67-000001"
    },
    {
      "title": "vSphere UI must be configured to hide the server version.",
      "desc": "Web servers will often display error messages to client users\ndisplaying enough information to aid in the debugging of the error. The\ninformation given back in error messages may display the web server type,\nversion, patches installed, plug-ins and modules installed, type of code being\nused by the hosted application, and any backends being used for data storage.\nThis information could be used by an attacker to blueprint what type of attacks\nmight be successful. As such, vSphere UI must be configured to hide the server\nversion at all times.",
      "descriptions": {
        "default": "Web servers will often display error messages to client users\ndisplaying enough information to aid in the debugging of the error. The\ninformation given back in error messages may display the web server type,\nversion, patches installed, plug-ins and modules installed, type of code being\nused by the hosted application, and any backends being used for data storage.\nThis information could be used by an attacker to blueprint what type of attacks\nmight be successful. As such, vSphere UI must be configured to hide the server\nversion at all times.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/server.xml | sed '2\ns/xmlns=\".*\"//g' |  xmllint --xpath\n'/Server/Service/Connector[@port=\"${http.port}\"]/@server' -\n\nExpected result:\n\nserver=\"Anonymous\"\n\nIf the output does not match the expected result, this is a finding",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-ui/server/conf/server.xml\n\nNavigate to each of the <Connector> nodes.\n\nConfigure each <Connector> node with 'server=\"Anonymous\"'."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": null,
        "gid": null,
        "rid": "VCUI-67-000022",
        "stig_id": "VCUI-67-000022",
        "cci": null,
        "nist": null
      },
      "code": "control \"VCUI-67-000022\" do\n  title \"vSphere UI must be configured to hide the server version.\"\n  desc  \"Web servers will often display error messages to client users\ndisplaying enough information to aid in the debugging of the error. The\ninformation given back in error messages may display the web server type,\nversion, patches installed, plug-ins and modules installed, type of code being\nused by the hosted application, and any backends being used for data storage.\nThis information could be used by an attacker to blueprint what type of attacks\nmight be successful. As such, vSphere UI must be configured to hide the server\nversion at all times.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: \"VCUI-67-000022\"\n  tag stig_id: \"VCUI-67-000022\"\n  tag cci: nil\n  tag nist: nil\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/server.xml | sed '2\ns/xmlns=\\\".*\\\"//g' |  xmllint --xpath\n'/Server/Service/Connector[@port=\\\"${http.port}\\\"]/@server' -\n\nExpected result:\n\nserver=\\\"Anonymous\\\"\n\nIf the output does not match the expected result, this is a finding\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-ui/server/conf/server.xml\n\nNavigate to each of the <Connector> nodes.\n\nConfigure each <Connector> node with 'server=\\\"Anonymous\\\"'.\"\n\n  begin\n    vcui_conf = xml('/usr/lib/vmware-vsphere-ui/server/conf/server.xml')\n\n      if vcui_conf['Server/Service/Connector/attribute::server'].is_a?(Array)\n        vcui_conf['Server/Service/Connector/attribute::server'].each do |x|\n          describe x do\n            it { should eq \"Anonymous\" }\n          end\n        end\n      else\n        describe xml(vcui_conf['Server/Service/Connector/attribute::server']) do\n          it { should eq \"Anonymous\" }\n        end\n      end\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000022.rb",
        "line": 1
      },
      "id": "VCUI-67-000022"
    },
    {
      "title": "vSphere UI must be configured to show error pages with minimal\ninformation.",
      "desc": "Web servers will often display error messages to client users\ndisplaying enough information to aid in the debugging of the error. The\ninformation given back in error messages may display the web server type,\nversion, patches installed, plug-ins and modules installed, type of code being\nused by the hosted application, and any backends being used for data storage.\nThis information could be used by an attacker to blueprint what type of attacks\nmight be successful. As such, vSphere UI must be configured to not show server\nversion information in error pages.",
      "descriptions": {
        "default": "Web servers will often display error messages to client users\ndisplaying enough information to aid in the debugging of the error. The\ninformation given back in error messages may display the web server type,\nversion, patches installed, plug-ins and modules installed, type of code being\nused by the hosted application, and any backends being used for data storage.\nThis information could be used by an attacker to blueprint what type of attacks\nmight be successful. As such, vSphere UI must be configured to not show server\nversion information in error pages.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/server.xml | xmllint\n--xpath\n'/Server/Service/Engine/Host/Valve[@className=\"org.apache.catalina.valves.ErrorReportValve\"]'\n-\n\nExpected result:\n\n<Valve className=\"org.apache.catalina.valves.ErrorReportValve\"\nshowServerInfo=\"false\"/>\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open\n/usr/lib/vmware-vsphere-ui/server/conf/server.xml . Locate the following Host\nblock:\n\n<Host name=\"localhost\"\" ...>\n...\n</Host>\n\nInside this block, add the following on a new line:\n\n<Valve className=\"org.apache.catalina.valves.ErrorReportValve\"\nshowServerInfo=\"false\"/>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": null,
        "gid": null,
        "rid": "VCUI-67-000023",
        "stig_id": "VCUI-67-000023",
        "cci": null,
        "nist": null
      },
      "code": "control \"VCUI-67-000023\" do\n  title \"vSphere UI must be configured to show error pages with minimal\ninformation.\"\n  desc  \"Web servers will often display error messages to client users\ndisplaying enough information to aid in the debugging of the error. The\ninformation given back in error messages may display the web server type,\nversion, patches installed, plug-ins and modules installed, type of code being\nused by the hosted application, and any backends being used for data storage.\nThis information could be used by an attacker to blueprint what type of attacks\nmight be successful. As such, vSphere UI must be configured to not show server\nversion information in error pages.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: \"VCUI-67-000023\"\n  tag stig_id: \"VCUI-67-000023\"\n  tag cci: nil\n  tag nist: nil\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/server.xml | xmllint\n--xpath\n'/Server/Service/Engine/Host/Valve[@className=\\\"org.apache.catalina.valves.ErrorReportValve\\\"]'\n-\n\nExpected result:\n\n<Valve className=\\\"org.apache.catalina.valves.ErrorReportValve\\\"\nshowServerInfo=\\\"false\\\"/>\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open\n/usr/lib/vmware-vsphere-ui/server/conf/server.xml . Locate the following Host\nblock:\n\n<Host name=\\\"localhost\\\"\\\" ...>\n...\n</Host>\n\nInside this block, add the following on a new line:\n\n<Valve className=\\\"org.apache.catalina.valves.ErrorReportValve\\\"\nshowServerInfo=\\\"false\\\"/>\"\n\n  describe xml('/usr/lib/vmware-vsphere-ui/server/conf/server.xml') do\n    its(['Server/Service/Engine/Host/Valve[@className=\\'org.apache.catalina.valves.ErrorReportValve\\']/@showServerInfo']) { should cmp 'false' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000023.rb",
        "line": 1
      },
      "id": "VCUI-67-000023"
    },
    {
      "title": "vSphere UI must use a logging mechanism that is configured to allocate\nlog record storage capacity large enough to accommodate the logging\nrequirements of the web server.",
      "desc": "In order to make certain that the logging mechanism used by the web\nserver has sufficient storage capacity in which to write the logs, the logging\nmechanism needs to be able to allocate log record storage capacity. vSphere UI\nconfigures log sizes and roation appropriately as part of it's installation\nroutine. Verifying that the logging configuration file (serviceability.xml) has\nnot been modified is sufficient to determine if the logging configuration has\nbeen modified from the default.",
      "descriptions": {
        "default": "In order to make certain that the logging mechanism used by the web\nserver has sufficient storage capacity in which to write the logs, the logging\nmechanism needs to be able to allocate log record storage capacity. vSphere UI\nconfigures log sizes and roation appropriately as part of it's installation\nroutine. Verifying that the logging configuration file (serviceability.xml) has\nnot been modified is sufficient to determine if the logging configuration has\nbeen modified from the default.",
        "check": "At the command prompt, execute the following command:\n\n# rpm -V vsphere-ui|grep serviceability.xml|grep \"^..5......\"\n\nIf the above command returns any output, this is a finding.",
        "fix": "Re-install the VCSA or roll back to a snapshot. Modifying the\nvSphere UI installation files manually is not supported by VMware."
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": null,
        "gid": null,
        "rid": "VCUI-67-000026",
        "stig_id": "VCUI-67-000026",
        "cci": null,
        "nist": null
      },
      "code": "control \"VCUI-67-000026\" do\n  title \"vSphere UI must use a logging mechanism that is configured to allocate\nlog record storage capacity large enough to accommodate the logging\nrequirements of the web server.\"\n  desc  \"In order to make certain that the logging mechanism used by the web\nserver has sufficient storage capacity in which to write the logs, the logging\nmechanism needs to be able to allocate log record storage capacity. vSphere UI\nconfigures log sizes and roation appropriately as part of it's installation\nroutine. Verifying that the logging configuration file (serviceability.xml) has\nnot been modified is sufficient to determine if the logging configuration has\nbeen modified from the default.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: \"VCUI-67-000026\"\n  tag stig_id: \"VCUI-67-000026\"\n  tag cci: nil\n  tag nist: nil\n  desc 'check', \"At the command prompt, execute the following command:\n\n# rpm -V vsphere-ui|grep serviceability.xml|grep \\\"^..5......\\\"\n\nIf the above command returns any output, this is a finding.\"\n  desc 'fix', \"Re-install the VCSA or roll back to a snapshot. Modifying the\nvSphere UI installation files manually is not supported by VMware.\"\n\n  describe command('rpm -V vsphere-ui|grep serviceability.xml|grep \"^..5......\"') do\n    its ('stdout.strip') { should eq '' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000026.rb",
        "line": 1
      },
      "id": "VCUI-67-000026"
    },
    {
      "title": "vSphere UI must set the secure flag for cookies.",
      "desc": "The secure flag is an option that can be set by the application server\nwhen sending a new cookie to the user within an HTTP Response. The purpose of\nthe secure flag is to prevent cookies from being observed by unauthorized\nparties due to the transmission of a the cookie in clear text. By setting the\nsecure flag, the browser will prevent the transmission of a cookie over an\nunencrypted channel. vSphere UI is configured to only be accessible over a TLS\ntunnel but this cookie flag is still a recommended best practice.",
      "descriptions": {
        "default": "The secure flag is an option that can be set by the application server\nwhen sending a new cookie to the user within an HTTP Response. The purpose of\nthe secure flag is to prevent cookies from being observed by unauthorized\nparties due to the transmission of a the cookie in clear text. By setting the\nsecure flag, the browser will prevent the transmission of a cookie over an\nunencrypted channel. vSphere UI is configured to only be accessible over a TLS\ntunnel but this cookie flag is still a recommended best practice.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/web.xml | sed\n's/xmlns=\".*\"//g' | xmllint --xpath\n'/web-app/session-config/cookie-config/secure' -\n\nExpected result:\n\n<secure>true</secure>\n\nIf the output of the command does not match the expected result, this is a\nfinding.",
        "fix": "Navigate to and open /usr/lib/vmware-vsphere-ui/server/conf/web.xml\n\nNavigate to the /<web-apps>/<session-config>/<cookie-config> node and configure\nit as follows.\n\n\n\n    <cookie-config>\n      <http-only>true</http-only>\n      <secure>true</secure>\n    </cookie-config>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": null,
        "gid": null,
        "rid": "VCUI-67-000030",
        "stig_id": "VCUI-67-000030",
        "cci": null,
        "nist": null
      },
      "code": "control \"VCUI-67-000030\" do\n  title \"vSphere UI must set the secure flag for cookies.\"\n  desc  \"The secure flag is an option that can be set by the application server\nwhen sending a new cookie to the user within an HTTP Response. The purpose of\nthe secure flag is to prevent cookies from being observed by unauthorized\nparties due to the transmission of a the cookie in clear text. By setting the\nsecure flag, the browser will prevent the transmission of a cookie over an\nunencrypted channel. vSphere UI is configured to only be accessible over a TLS\ntunnel but this cookie flag is still a recommended best practice.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: \"VCUI-67-000030\"\n  tag stig_id: \"VCUI-67-000030\"\n  tag cci: nil\n  tag nist: nil\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/web.xml | sed\n's/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'/web-app/session-config/cookie-config/secure' -\n\nExpected result:\n\n<secure>true</secure>\n\nIf the output of the command does not match the expected result, this is a\nfinding.\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-vsphere-ui/server/conf/web.xml\n\nNavigate to the /<web-apps>/<session-config>/<cookie-config> node and configure\nit as follows.\n\n\n\n    <cookie-config>\n      <http-only>true</http-only>\n      <secure>true</secure>\n    </cookie-config>\"\n\n  describe xml('/usr/lib/vmware-vsphere-ui/server/conf/web.xml') do\n    its('/web-app/session-config/cookie-config/secure') { should cmp 'true' }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000030.rb",
        "line": 1
      },
      "id": "VCUI-67-000030"
    },
    {
      "title": "vSphere UI must have mappings set for Java servlet pages.",
      "desc": "Resource mapping is the process of tying a particular file type to a\nprocess in the web server that can serve that type of file to a requesting\nclient and to identify which file types are not to be delivered to a client.\n\n    By not specifying which files can and which files cannot be served to a\nuser, the web server could deliver to a user web server configuration files,\nlog files, password files, etc.\n\n    As Tomcat is a java-based web server, the main file extension used is\n*.jsp.  This check ensures that the *.jsp and *.jspx file types has been\nproperly mapped to servlets.",
      "descriptions": {
        "default": "Resource mapping is the process of tying a particular file type to a\nprocess in the web server that can serve that type of file to a requesting\nclient and to identify which file types are not to be delivered to a client.\n\n    By not specifying which files can and which files cannot be served to a\nuser, the web server could deliver to a user web server configuration files,\nlog files, password files, etc.\n\n    As Tomcat is a java-based web server, the main file extension used is\n*.jsp.  This check ensures that the *.jsp and *.jspx file types has been\nproperly mapped to servlets.",
        "check": "At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/web.xml | sed\n's/xmlns=\".*\"//g' | xmllint --xpath\n'/web-app/servlet-mapping/servlet-name[text()=\"jsp\"]/parent::servlet-mapping'\n-\n\nExpected result:\n\n<servlet-mapping>\n <servlet-name>jsp</servlet-name>\n <url-pattern>*.jsp</url-pattern>\n <url-pattern>*.jspx</url-pattern>\n</servlet-mapping>\n\nIf the jsp and jspx file url-patterns are not configured as in the expected\nresult, this is a finding.",
        "fix": "Navigate to and open /usr/lib/vmware-vsphere-ui/server/conf/web.xml\n\nNavigate to and locate the mapping for the JSP servlet. It is the\n<servlet-mapping> node that contains <servlet-name>jsp</servlet-name>\n\nConfigure the <servlet-mapping> node to look like the code snippet below\n\n <!-- The mappings for the JSP servlet -->\n <servlet-mapping>\n <servlet-name>jsp</servlet-name>\n <url-pattern>*.jsp</url-pattern>\n <url-pattern>*.jspx</url-pattern>\n </servlet-mapping>"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000456-WSR-000187",
        "gid": null,
        "rid": "VCUI-67-000012",
        "stig_id": "VCUI-67-000012",
        "cci": "CCI-002605",
        "nist": [
          "SI-2 c",
          "Rev_4"
        ]
      },
      "code": "control \"VCUI-67-000012\" do\n  title \"vSphere UI must have mappings set for Java servlet pages.\"\n  desc  \"Resource mapping is the process of tying a particular file type to a\nprocess in the web server that can serve that type of file to a requesting\nclient and to identify which file types are not to be delivered to a client.\n\n    By not specifying which files can and which files cannot be served to a\nuser, the web server could deliver to a user web server configuration files,\nlog files, password files, etc.\n\n    As Tomcat is a java-based web server, the main file extension used is\n*.jsp.  This check ensures that the *.jsp and *.jspx file types has been\nproperly mapped to servlets.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000456-WSR-000187\"\n  tag gid: nil\n  tag rid: \"VCUI-67-000012\"\n  tag stig_id: \"VCUI-67-000012\"\n  tag cci: \"CCI-002605\"\n  tag nist: [\"SI-2 c\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/web.xml | sed\n's/xmlns=\\\".*\\\"//g' | xmllint --xpath\n'/web-app/servlet-mapping/servlet-name[text()=\\\"jsp\\\"]/parent::servlet-mapping'\n-\n\nExpected result:\n\n<servlet-mapping>\n <servlet-name>jsp</servlet-name>\n <url-pattern>*.jsp</url-pattern>\n <url-pattern>*.jspx</url-pattern>\n</servlet-mapping>\n\nIf the jsp and jspx file url-patterns are not configured as in the expected\nresult, this is a finding.\"\n  desc 'fix', \"Navigate to and open /usr/lib/vmware-vsphere-ui/server/conf/web.xml\n\nNavigate to and locate the mapping for the JSP servlet. It is the\n<servlet-mapping> node that contains <servlet-name>jsp</servlet-name>\n\nConfigure the <servlet-mapping> node to look like the code snippet below\n\n <!-- The mappings for the JSP servlet -->\n <servlet-mapping>\n <servlet-name>jsp</servlet-name>\n <url-pattern>*.jsp</url-pattern>\n <url-pattern>*.jspx</url-pattern>\n </servlet-mapping>\n\"\n\n  list = [\"*.jsp\", \"*.jspx\"]\n  describe xml('/usr/lib/vmware-vsphere-ui/server/conf/web.xml') do\n    its('/web-app/servlet-mapping[servlet-name=\"jsp\"]/url-pattern') { should be_in list }\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000012.rb",
        "line": 1
      },
      "id": "VCUI-67-000012"
    },
    {
      "title": "vSphere UI log files must only be accessible by privileged users.",
      "desc": "Log data is essential in the investigation of events. If log data were\nto become compromised, then competent forensic analysis and discovery of the\ntrue source of potentially malicious system activity would be difficult, if not\nimpossible, to achieve. In addition, access to log records provides information\nan attacker could potentially use to their advantage since each event record\nmight contain communication ports, protocols, services, trust relationships,\nuser names, etc. The vSphere UI restricts all access to log file by default but\nthis configuration must be verified.",
      "descriptions": {
        "default": "Log data is essential in the investigation of events. If log data were\nto become compromised, then competent forensic analysis and discovery of the\ntrue source of potentially malicious system activity would be difficult, if not\nimpossible, to achieve. In addition, access to log records provides information\nan attacker could potentially use to their advantage since each event record\nmight contain communication ports, protocols, services, trust relationships,\nuser names, etc. The vSphere UI restricts all access to log file by default but\nthis configuration must be verified.",
        "check": "At the command prompt, execute the following command:\n\n# find /storage/log/vmware/vsphere-ui/logs/ -xdev -type f -a '(' -not -perm 600\n-o -not -user vsphere-ui ')' -exec ls -ld {} \\;\n\nIf any files are returned, this is a finding.",
        "fix": "At the command prompt, execute the following commands:\n\n# chmod 600 /storage/log/vmware/vsphere-ui/logs/<file>\n# chown vsphere-ui:users /storage/log/vmware/vsphere-ui/logs/<file>\n\nNote: Subsitute <file> with the listed file"
      },
      "impact": 0.5,
      "refs": [],
      "tags": {
        "severity": "CAT II",
        "gtitle": "SRG-APP-000357-WSR-000150",
        "gid": null,
        "rid": "VCUI-67-000007",
        "stig_id": "VCUI-67-000007",
        "cci": "CCI-001849",
        "nist": [
          "AU-4",
          "Rev_4"
        ]
      },
      "code": "control \"VCUI-67-000007\" do\n  title \"vSphere UI log files must only be accessible by privileged users.\"\n  desc  \"Log data is essential in the investigation of events. If log data were\nto become compromised, then competent forensic analysis and discovery of the\ntrue source of potentially malicious system activity would be difficult, if not\nimpossible, to achieve. In addition, access to log records provides information\nan attacker could potentially use to their advantage since each event record\nmight contain communication ports, protocols, services, trust relationships,\nuser names, etc. The vSphere UI restricts all access to log file by default but\nthis configuration must be verified.\"\n  impact 0.5\n  tag severity: \"CAT II\"\n  tag gtitle: \"SRG-APP-000357-WSR-000150\"\n  tag gid: nil\n  tag rid: \"VCUI-67-000007\"\n  tag stig_id: \"VCUI-67-000007\"\n  tag cci: \"CCI-001849\"\n  tag nist: [\"AU-4\", \"Rev_4\"]\n  desc 'check', \"At the command prompt, execute the following command:\n\n# find /storage/log/vmware/vsphere-ui/logs/ -xdev -type f -a '(' -not -perm 600\n-o -not -user vsphere-ui ')' -exec ls -ld {} \\\\;\n\nIf any files are returned, this is a finding.\"\n  desc 'fix', \"At the command prompt, execute the following commands:\n\n# chmod 600 /storage/log/vmware/vsphere-ui/logs/<file>\n# chown vsphere-ui:users /storage/log/vmware/vsphere-ui/logs/<file>\n\nNote: Subsitute <file> with the listed file\"\n\n  command('find /storage/log/vmware/vsphere-ui/logs/ -maxdepth 1 -type f').stdout.split.each do | fname |\n    describe file(fname) do\n      it { should_not be_more_permissive_than('0600') }\n      its('owner') {should eq 'vsphere-ui'}\n      its('group') {should eq 'users'}\n    end\n  end\n\nend",
      "source_location": {
        "ref": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000007.rb",
        "line": 1
      },
      "id": "VCUI-67-000007"
    }
  ],
  "groups": [
    {
      "title": null,
      "controls": [
        "VCEM-67-000023"
      ],
      "id": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000023.rb"
    },
    {
      "title": null,
      "controls": [
        "VCEM-67-000026"
      ],
      "id": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000026.rb"
    },
    {
      "title": null,
      "controls": [
        "VCEM-67-000016"
      ],
      "id": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000016.rb"
    },
    {
      "title": null,
      "controls": [
        "VCEM-67-000019"
      ],
      "id": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000019.rb"
    },
    {
      "title": null,
      "controls": [
        "VCEM-67-000013"
      ],
      "id": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000013.rb"
    },
    {
      "title": null,
      "controls": [
        "VCEM-67-000005"
      ],
      "id": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000005.rb"
    },
    {
      "title": null,
      "controls": [
        "VCEM-67-000010"
      ],
      "id": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000010.rb"
    },
    {
      "title": null,
      "controls": [
        "VCEM-67-000008"
      ],
      "id": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000008.rb"
    },
    {
      "title": null,
      "controls": [
        "VCEM-67-000030"
      ],
      "id": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000030.rb"
    },
    {
      "title": null,
      "controls": [
        "VCEM-67-000002"
      ],
      "id": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000002.rb"
    },
    {
      "title": null,
      "controls": [
        "VCEM-67-000015"
      ],
      "id": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000015.rb"
    },
    {
      "title": null,
      "controls": [
        "VCEM-67-000029"
      ],
      "id": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000029.rb"
    },
    {
      "title": null,
      "controls": [
        "VCEM-67-000007"
      ],
      "id": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000007.rb"
    },
    {
      "title": null,
      "controls": [
        "VCEM-67-000020"
      ],
      "id": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000020.rb"
    },
    {
      "title": null,
      "controls": [
        "VCEM-67-000025"
      ],
      "id": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000025.rb"
    },
    {
      "title": null,
      "controls": [
        "VCEM-67-000021"
      ],
      "id": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000021.rb"
    },
    {
      "title": null,
      "controls": [
        "VCEM-67-000006"
      ],
      "id": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000006.rb"
    },
    {
      "title": null,
      "controls": [
        "VCEM-67-000027"
      ],
      "id": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000027.rb"
    },
    {
      "title": null,
      "controls": [
        "VCEM-67-000022"
      ],
      "id": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000022.rb"
    },
    {
      "title": null,
      "controls": [
        "VCEM-67-000012"
      ],
      "id": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000012.rb"
    },
    {
      "title": null,
      "controls": [
        "VCEM-67-000024"
      ],
      "id": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000024.rb"
    },
    {
      "title": null,
      "controls": [
        "VCEM-67-000018"
      ],
      "id": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000018.rb"
    },
    {
      "title": null,
      "controls": [
        "VCEM-67-000003"
      ],
      "id": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000003.rb"
    },
    {
      "title": null,
      "controls": [
        "VCEM-67-000004"
      ],
      "id": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000004.rb"
    },
    {
      "title": null,
      "controls": [
        "VCEM-67-000014"
      ],
      "id": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000014.rb"
    },
    {
      "title": null,
      "controls": [
        "VCEM-67-000017"
      ],
      "id": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000017.rb"
    },
    {
      "title": null,
      "controls": [
        "VCEM-67-000001"
      ],
      "id": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000001.rb"
    },
    {
      "title": null,
      "controls": [
        "VCEM-67-000009"
      ],
      "id": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000009.rb"
    },
    {
      "title": null,
      "controls": [
        "VCEM-67-000011"
      ],
      "id": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000011.rb"
    },
    {
      "title": null,
      "controls": [
        "VCEM-67-000028"
      ],
      "id": "/github/home/.inspec/cache/3aa0bd4d5f677ca93dbfb56cf859b7175a583487748b2075511ad5b21713a7f0/controls/VCEM-67-000028.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPF-67-000012"
      ],
      "id": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000012.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPF-67-000019"
      ],
      "id": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000019.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPF-67-000018"
      ],
      "id": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000018.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPF-67-000014"
      ],
      "id": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000014.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPF-67-000029"
      ],
      "id": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000029.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPF-67-000011"
      ],
      "id": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000011.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPF-67-000009"
      ],
      "id": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000009.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPF-67-000003"
      ],
      "id": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000003.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPF-67-000017"
      ],
      "id": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000017.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPF-67-000016"
      ],
      "id": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000016.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPF-67-000015"
      ],
      "id": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000015.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPF-67-000005"
      ],
      "id": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000005.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPF-67-000020"
      ],
      "id": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000020.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPF-67-000008"
      ],
      "id": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000008.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPF-67-000025"
      ],
      "id": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000025.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPF-67-000023"
      ],
      "id": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000023.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPF-67-000006"
      ],
      "id": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000006.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPF-67-000026"
      ],
      "id": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000026.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPF-67-000007"
      ],
      "id": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000007.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPF-67-000013"
      ],
      "id": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000013.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPF-67-000028"
      ],
      "id": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000028.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPF-67-000030"
      ],
      "id": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000030.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPF-67-000027"
      ],
      "id": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000027.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPF-67-000002"
      ],
      "id": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000002.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPF-67-000021"
      ],
      "id": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000021.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPF-67-000022"
      ],
      "id": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000022.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPF-67-000024"
      ],
      "id": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000024.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPF-67-000001"
      ],
      "id": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000001.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPF-67-000010"
      ],
      "id": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000010.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPF-67-000004"
      ],
      "id": "/github/home/.inspec/cache/3151b4bcd16a44dc1ea9ae858d6ec65fe6a479cc20f7b7009a9eb70f2794def4/controls/VCPF-67-000004.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000115"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000115.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000017"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000017.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000021"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000021.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000087"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000087.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000079"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000079.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000002"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000002.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000051"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000051.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000007"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000007.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000095"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000095.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000088"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000088.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000025"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000025.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000091"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000091.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000040"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000040.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000018"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000018.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000106"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000106.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000097"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000097.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000077"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000077.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000047"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000047.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000036"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000036.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000053"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000053.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000003"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000003.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000005"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000005.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000080"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000080.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000050"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000050.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000061"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000061.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000082"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000082.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000081"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000081.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000064"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000064.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000103"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000103.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000065"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000065.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000099"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000099.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000041"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000041.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000119"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000119.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000123"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000123.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000004"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000004.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000011"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000011.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000035"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000035.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000001"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000001.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000045"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000045.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000121"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000121.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000107"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000107.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000075"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000075.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000026"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000026.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000101"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000101.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000029"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000029.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000068"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000068.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000094"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000094.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000037"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000037.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000093"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000093.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000016"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000016.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000012"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000012.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000034"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000034.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000057"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000057.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000062"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000062.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000092"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000092.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000027"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000027.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000108"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000108.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000085"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000085.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000116"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000116.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000069"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000069.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000073"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000073.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000070"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000070.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000086"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000086.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000042"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000042.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000043"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000043.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000074"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000074.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000031"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000031.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000013"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000013.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000044"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000044.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000023"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000023.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000054"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000054.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000120"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000120.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000022"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000022.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000028"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000028.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000038"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000038.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000109"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000109.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000078"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000078.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000033"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000033.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000039"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000039.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000072"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000072.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000055"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000055.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000046"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000046.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000059"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000059.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000100"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000100.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000056"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000056.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000015"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000015.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000071"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000071.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000019"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000019.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000111"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000111.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000058"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000058.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000112"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000112.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000048"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000048.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000084"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000084.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000114"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000114.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000063"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000063.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000060"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000060.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000067"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000067.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000089"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000089.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000118"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000118.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000049"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000049.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000110"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000110.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000020"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000020.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000104"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000104.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000052"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000052.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000010"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000010.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000122"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000122.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000076"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000076.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000014"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000014.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000008"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000008.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000083"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000083.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000117"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000117.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000113"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000113.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000124"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000124.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000009"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000009.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000006"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000006.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000105"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000105.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000066"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000066.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000096"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000096.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000032"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000032.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000090"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000090.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000024"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000024.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000030"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000030.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000098"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000098.rb"
    },
    {
      "title": null,
      "controls": [
        "PHTN-10-000102"
      ],
      "id": "/github/home/.inspec/cache/e9c48a0035273403dc438e6b896a6cd1c6cc0623edcc3507240b6494ae179b58/controls/PHTN-10-000102.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPG-67-000022"
      ],
      "id": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000022.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPG-67-000023"
      ],
      "id": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000023.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPG-67-000011"
      ],
      "id": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000011.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPG-67-000002"
      ],
      "id": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000002.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPG-67-000004"
      ],
      "id": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000004.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPG-67-000026"
      ],
      "id": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000026.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPG-67-000009"
      ],
      "id": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000009.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPG-67-000020"
      ],
      "id": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000020.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPG-67-000003"
      ],
      "id": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000003.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPG-67-000021"
      ],
      "id": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000021.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPG-67-000006"
      ],
      "id": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000006.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPG-67-000014"
      ],
      "id": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000014.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPG-67-000012"
      ],
      "id": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000012.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPG-67-000001"
      ],
      "id": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000001.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPG-67-000013"
      ],
      "id": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000013.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPG-67-000016"
      ],
      "id": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000016.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPG-67-000007"
      ],
      "id": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000007.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPG-67-000024"
      ],
      "id": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000024.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPG-67-000019"
      ],
      "id": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000019.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPG-67-000005"
      ],
      "id": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000005.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPG-67-000015"
      ],
      "id": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000015.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPG-67-000027"
      ],
      "id": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000027.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPG-67-000017"
      ],
      "id": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000017.rb"
    },
    {
      "title": null,
      "controls": [
        "VCPG-67-000008"
      ],
      "id": "/github/home/.inspec/cache/4a6389b979551bd4b6bf187498986f06c4203f7a593f12281703aaeea0d64dd8/controls/VCPG-67-000008.rb"
    },
    {
      "title": null,
      "controls": [
        "VCRP-67-000005"
      ],
      "id": "/github/home/.inspec/cache/286bdedf5e99b23d5d8a0eabb6315cd0ce3a2551346245f6ea69353506de45e6/controls/VCRP-67-000005.rb"
    },
    {
      "title": null,
      "controls": [
        "VCRP-67-000006"
      ],
      "id": "/github/home/.inspec/cache/286bdedf5e99b23d5d8a0eabb6315cd0ce3a2551346245f6ea69353506de45e6/controls/VCRP-67-000006.rb"
    },
    {
      "title": null,
      "controls": [
        "VCRP-67-000004"
      ],
      "id": "/github/home/.inspec/cache/286bdedf5e99b23d5d8a0eabb6315cd0ce3a2551346245f6ea69353506de45e6/controls/VCRP-67-000004.rb"
    },
    {
      "title": null,
      "controls": [
        "VCRP-67-000008"
      ],
      "id": "/github/home/.inspec/cache/286bdedf5e99b23d5d8a0eabb6315cd0ce3a2551346245f6ea69353506de45e6/controls/VCRP-67-000008.rb"
    },
    {
      "title": null,
      "controls": [
        "VCRP-67-000009"
      ],
      "id": "/github/home/.inspec/cache/286bdedf5e99b23d5d8a0eabb6315cd0ce3a2551346245f6ea69353506de45e6/controls/VCRP-67-000009.rb"
    },
    {
      "title": null,
      "controls": [
        "VCRP-67-000007"
      ],
      "id": "/github/home/.inspec/cache/286bdedf5e99b23d5d8a0eabb6315cd0ce3a2551346245f6ea69353506de45e6/controls/VCRP-67-000007.rb"
    },
    {
      "title": null,
      "controls": [
        "VCRP-67-000003"
      ],
      "id": "/github/home/.inspec/cache/286bdedf5e99b23d5d8a0eabb6315cd0ce3a2551346245f6ea69353506de45e6/controls/VCRP-67-000003.rb"
    },
    {
      "title": null,
      "controls": [
        "VCRP-67-000001"
      ],
      "id": "/github/home/.inspec/cache/286bdedf5e99b23d5d8a0eabb6315cd0ce3a2551346245f6ea69353506de45e6/controls/VCRP-67-000001.rb"
    },
    {
      "title": null,
      "controls": [
        "VCRP-67-000002"
      ],
      "id": "/github/home/.inspec/cache/286bdedf5e99b23d5d8a0eabb6315cd0ce3a2551346245f6ea69353506de45e6/controls/VCRP-67-000002.rb"
    },
    {
      "title": null,
      "controls": [
        "VCST-67-000028"
      ],
      "id": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000028.rb"
    },
    {
      "title": null,
      "controls": [
        "VCST-67-000005"
      ],
      "id": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000005.rb"
    },
    {
      "title": null,
      "controls": [
        "VCST-67-000020"
      ],
      "id": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000020.rb"
    },
    {
      "title": null,
      "controls": [
        "VCST-67-000024"
      ],
      "id": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000024.rb"
    },
    {
      "title": null,
      "controls": [
        "VCST-67-000014"
      ],
      "id": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000014.rb"
    },
    {
      "title": null,
      "controls": [
        "VCST-67-000006"
      ],
      "id": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000006.rb"
    },
    {
      "title": null,
      "controls": [
        "VCST-67-000021"
      ],
      "id": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000021.rb"
    },
    {
      "title": null,
      "controls": [
        "VCST-67-000026"
      ],
      "id": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000026.rb"
    },
    {
      "title": null,
      "controls": [
        "VCST-67-000012"
      ],
      "id": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000012.rb"
    },
    {
      "title": null,
      "controls": [
        "VCST-67-000010"
      ],
      "id": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000010.rb"
    },
    {
      "title": null,
      "controls": [
        "VCST-67-000019"
      ],
      "id": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000019.rb"
    },
    {
      "title": null,
      "controls": [
        "VCST-67-000027"
      ],
      "id": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000027.rb"
    },
    {
      "title": null,
      "controls": [
        "VCST-67-000002"
      ],
      "id": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000002.rb"
    },
    {
      "title": null,
      "controls": [
        "VCST-67-000001"
      ],
      "id": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000001.rb"
    },
    {
      "title": null,
      "controls": [
        "VCST-67-000011"
      ],
      "id": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000011.rb"
    },
    {
      "title": null,
      "controls": [
        "VCST-67-000007"
      ],
      "id": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000007.rb"
    },
    {
      "title": null,
      "controls": [
        "VCST-67-000013"
      ],
      "id": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000013.rb"
    },
    {
      "title": null,
      "controls": [
        "VCST-67-000030"
      ],
      "id": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000030.rb"
    },
    {
      "title": null,
      "controls": [
        "VCST-67-000009"
      ],
      "id": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000009.rb"
    },
    {
      "title": null,
      "controls": [
        "VCST-67-000015"
      ],
      "id": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000015.rb"
    },
    {
      "title": null,
      "controls": [
        "VCST-67-000022"
      ],
      "id": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000022.rb"
    },
    {
      "title": null,
      "controls": [
        "VCST-67-000003"
      ],
      "id": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000003.rb"
    },
    {
      "title": null,
      "controls": [
        "VCST-67-000023"
      ],
      "id": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000023.rb"
    },
    {
      "title": null,
      "controls": [
        "VCST-67-000025"
      ],
      "id": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000025.rb"
    },
    {
      "title": null,
      "controls": [
        "VCST-67-000029"
      ],
      "id": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000029.rb"
    },
    {
      "title": null,
      "controls": [
        "VCST-67-000017"
      ],
      "id": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000017.rb"
    },
    {
      "title": null,
      "controls": [
        "VCST-67-000018"
      ],
      "id": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000018.rb"
    },
    {
      "title": null,
      "controls": [
        "VCST-67-000004"
      ],
      "id": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000004.rb"
    },
    {
      "title": null,
      "controls": [
        "VCST-67-000008"
      ],
      "id": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000008.rb"
    },
    {
      "title": null,
      "controls": [
        "VCST-67-000016"
      ],
      "id": "/github/home/.inspec/cache/92d066ccae21f2a176101f8b680c0e290e338ca6911b9a1b3f8f3da41f807bd4/controls/VCST-67-000016.rb"
    },
    {
      "title": null,
      "controls": [
        "VCLD-67-000031"
      ],
      "id": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000031.rb"
    },
    {
      "title": null,
      "controls": [
        "VCLD-67-000005"
      ],
      "id": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000005.rb"
    },
    {
      "title": null,
      "controls": [
        "VCLD-67-000019"
      ],
      "id": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000019.rb"
    },
    {
      "title": null,
      "controls": [
        "VCLD-67-000022"
      ],
      "id": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000022.rb"
    },
    {
      "title": null,
      "controls": [
        "VCLD-67-000033"
      ],
      "id": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000033.rb"
    },
    {
      "title": null,
      "controls": [
        "VCLD-67-000025"
      ],
      "id": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000025.rb"
    },
    {
      "title": null,
      "controls": [
        "VCLD-67-000006"
      ],
      "id": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000006.rb"
    },
    {
      "title": null,
      "controls": [
        "VCLD-67-000002"
      ],
      "id": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000002.rb"
    },
    {
      "title": null,
      "controls": [
        "VCLD-67-000030"
      ],
      "id": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000030.rb"
    },
    {
      "title": null,
      "controls": [
        "VCLD-67-000016"
      ],
      "id": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000016.rb"
    },
    {
      "title": null,
      "controls": [
        "VCLD-67-000014"
      ],
      "id": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000014.rb"
    },
    {
      "title": null,
      "controls": [
        "VCLD-67-000017"
      ],
      "id": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000017.rb"
    },
    {
      "title": null,
      "controls": [
        "VCLD-67-000004"
      ],
      "id": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000004.rb"
    },
    {
      "title": null,
      "controls": [
        "VCLD-67-000024"
      ],
      "id": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000024.rb"
    },
    {
      "title": null,
      "controls": [
        "VCLD-67-000015"
      ],
      "id": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000015.rb"
    },
    {
      "title": null,
      "controls": [
        "VCLD-67-000029"
      ],
      "id": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000029.rb"
    },
    {
      "title": null,
      "controls": [
        "VCLD-67-000020"
      ],
      "id": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000020.rb"
    },
    {
      "title": null,
      "controls": [
        "VCLD-67-000034"
      ],
      "id": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000034.rb"
    },
    {
      "title": null,
      "controls": [
        "VCLD-67-000001"
      ],
      "id": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000001.rb"
    },
    {
      "title": null,
      "controls": [
        "VCLD-67-000027"
      ],
      "id": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000027.rb"
    },
    {
      "title": null,
      "controls": [
        "VCLD-67-000003"
      ],
      "id": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000003.rb"
    },
    {
      "title": null,
      "controls": [
        "VCLD-67-000028"
      ],
      "id": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000028.rb"
    },
    {
      "title": null,
      "controls": [
        "VCLD-67-000021"
      ],
      "id": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000021.rb"
    },
    {
      "title": null,
      "controls": [
        "VCLD-67-000018"
      ],
      "id": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000018.rb"
    },
    {
      "title": null,
      "controls": [
        "VCLD-67-000011"
      ],
      "id": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000011.rb"
    },
    {
      "title": null,
      "controls": [
        "VCLD-67-000023"
      ],
      "id": "/github/home/.inspec/cache/78998157b54535457899027d4cfced468f5b8c65fc2cf2f6fc123e94ed2fcbfd/controls/VCLD-67-000023.rb"
    },
    {
      "title": null,
      "controls": [
        "VCFL-67-000027"
      ],
      "id": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000027.rb"
    },
    {
      "title": null,
      "controls": [
        "VCFL-67-000003"
      ],
      "id": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000003.rb"
    },
    {
      "title": null,
      "controls": [
        "VCFL-67-000022"
      ],
      "id": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000022.rb"
    },
    {
      "title": null,
      "controls": [
        "VCFL-67-000018"
      ],
      "id": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000018.rb"
    },
    {
      "title": null,
      "controls": [
        "VCFL-67-000005"
      ],
      "id": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000005.rb"
    },
    {
      "title": null,
      "controls": [
        "VCFL-67-000028"
      ],
      "id": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000028.rb"
    },
    {
      "title": null,
      "controls": [
        "VCFL-67-000020"
      ],
      "id": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000020.rb"
    },
    {
      "title": null,
      "controls": [
        "VCFL-67-000004"
      ],
      "id": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000004.rb"
    },
    {
      "title": null,
      "controls": [
        "VCFL-67-000029"
      ],
      "id": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000029.rb"
    },
    {
      "title": null,
      "controls": [
        "VCFL-67-000024"
      ],
      "id": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000024.rb"
    },
    {
      "title": null,
      "controls": [
        "VCFL-67-000025"
      ],
      "id": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000025.rb"
    },
    {
      "title": null,
      "controls": [
        "VCFL-67-000006"
      ],
      "id": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000006.rb"
    },
    {
      "title": null,
      "controls": [
        "VCFL-67-000009"
      ],
      "id": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000009.rb"
    },
    {
      "title": null,
      "controls": [
        "VCFL-67-000026"
      ],
      "id": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000026.rb"
    },
    {
      "title": null,
      "controls": [
        "VCFL-67-000021"
      ],
      "id": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000021.rb"
    },
    {
      "title": null,
      "controls": [
        "VCFL-67-000007"
      ],
      "id": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000007.rb"
    },
    {
      "title": null,
      "controls": [
        "VCFL-67-000008"
      ],
      "id": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000008.rb"
    },
    {
      "title": null,
      "controls": [
        "VCFL-67-000002"
      ],
      "id": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000002.rb"
    },
    {
      "title": null,
      "controls": [
        "VCFL-67-000013"
      ],
      "id": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000013.rb"
    },
    {
      "title": null,
      "controls": [
        "VCFL-67-000015"
      ],
      "id": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000015.rb"
    },
    {
      "title": null,
      "controls": [
        "VCFL-67-000019"
      ],
      "id": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000019.rb"
    },
    {
      "title": null,
      "controls": [
        "VCFL-67-000011"
      ],
      "id": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000011.rb"
    },
    {
      "title": null,
      "controls": [
        "VCFL-67-000001"
      ],
      "id": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000001.rb"
    },
    {
      "title": null,
      "controls": [
        "VCFL-67-000017"
      ],
      "id": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000017.rb"
    },
    {
      "title": null,
      "controls": [
        "VCFL-67-000023"
      ],
      "id": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000023.rb"
    },
    {
      "title": null,
      "controls": [
        "VCFL-67-000030"
      ],
      "id": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000030.rb"
    },
    {
      "title": null,
      "controls": [
        "VCFL-67-000014"
      ],
      "id": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000014.rb"
    },
    {
      "title": null,
      "controls": [
        "VCFL-67-000010"
      ],
      "id": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000010.rb"
    },
    {
      "title": null,
      "controls": [
        "VCFL-67-000016"
      ],
      "id": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000016.rb"
    },
    {
      "title": null,
      "controls": [
        "VCFL-67-000012"
      ],
      "id": "/github/home/.inspec/cache/f8ff9a4d763715db92227322a46f31c5e60fbf907f81778e9b2f724cd0f2b766/controls/VCFL-67-000012.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000010"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000010.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000027"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000027.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000020"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000020.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000011"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000011.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000004"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000004.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000019"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000019.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000021"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000021.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000018"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000018.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000008"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000008.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000002"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000002.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000029"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000029.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000013"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000013.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000003"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000003.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000024"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000024.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000014"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000014.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000025"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000025.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000031"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000031.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000006"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000006.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000016"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000016.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000015"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000015.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000028"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000028.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000009"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000009.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000005"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000005.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000017"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000017.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000001"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000001.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000022"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000022.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000023"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000023.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000026"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000026.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000030"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000030.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000012"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000012.rb"
    },
    {
      "title": null,
      "controls": [
        "VCUI-67-000007"
      ],
      "id": "/github/home/.inspec/cache/3b727372c3b94de5a635aaa99031f4d0037c0c3a05d47328a05dbb6485cbc76b/controls/VCUI-67-000007.rb"
    }
  ],
  "inputs": [],
  "sha256": "50fb129f6e8e9b10b6569e7a67470c48ab00c3c7c6e4fc56e14a39ca7194c87b",
  "status_message": "",
  "status": "loaded",
  "generator": {
    "name": "inspec",
    "version": "4.33.1"
  }
}